ARM GAS  1.s 			page 1


   1              		@@ 单片机stm32f030f4p6
   2              		@lcr
   3              		@作者：yjmwxwx
   4              		@时间：2021-07-31
   5              		@编译器：ARM-NONE-EABI
   6              		.thumb
   7              		.syntax unified
   8              		.section .data
   9              	zheng_xian_100khz:
  10 0000 07000900 		.short 0x7,0x9,0xb,0xd,0xe,0xe,0xe,0xd,0xb,0x9,0x7,0x5,0x3,0x1,0x0,0x0,0x0,0x1,0x3,0x5
  10      0B000D00 
  10      0E000E00 
  10      0E000D00 
  10      0B000900 
  11              	cos_sin_biao:
  12 0028 00800000 		.int 0x00008000,0x00000000,0x0000678D,0xFFFFB4C4,0x0000278D,0xFFFF8644,0xFFFFD873,0xFFFF8644,0xFFF
  12      00000000 
  12      8D670000 
  12      C4B4FFFF 
  12      8D270000 
  13              		
  14              	kong:
  15 1f68 20202020 		.int 0x20202020
  16              	_fu:
  17 1f6c 2D       		.ascii "-"
  18              	yjmwxwx:
  19 1f6d 796A6D77 		.ascii "yjmwxwx-20210731"
  19      7877782D 
  19      32303231 
  19      30373331 
  20 1f7d 000000   		.align 4
  21              		.equ STACKINIT,        	        0x20001000
  22              		.equ asciimabiao,		0x20000000
  23              		.equ lcd_beiguang,		0x20000020
  24              		.equ shangbi_r, 		0x20000024
  25              		.equ shangbi_i,			0x20000028
  26              		.equ xiabi_r,			0x2000002c
  27              		.equ xiabi_i,			0x20000030
  28              		.equ shangxiabi_qiehuan,	0x20000034
  29              		.equ dianyabiao,		0x20000100
  30              		.equ lvboqizhizhen,		0x200008d0
  31              		.equ lvboqihuanchong,		0x200008d8
  32              		.equ lvboqizhizhen1,            0x200009e0
  33              		.equ lvboqihuanchong1,          0x200009e8
  34              	        .equ lvboqizhizhen2,            0x20000af0
  35              		.equ lvboqihuanchong2,           0x20000af8
  36              		.equ lvboqizhizhen3,            0x20000c00
  37              		.equ lvboqihuanchong3,          0x20000c08
  38              		
  39              		
  40              		.section .text
  41              	
  42              	vectors:
  43 0000 00100020 		.word STACKINIT
  44 0004 B1000000 		.word _start + 1
  45 0008 39050000 		.word _nmi_handler + 1
  46 000c 3B050000 		.word _hard_fault  + 1
ARM GAS  1.s 			page 2


  47 0010 00000000 		.word 0
  48 0014 00000000 		.word 0
  49 0018 00000000 		.word 0
  50 001c 00000000 		.word 0
  51 0020 00000000 		.word 0
  52 0024 00000000 		.word 0
  53 0028 00000000 		.word 0
  54 002c 3D050000 		.word _svc_handler +1
  55 0030 00000000 		.word 0
  56 0034 00000000 		.word 0
  57 0038 3F050000 		.word _pendsv_handler +1
  58 003c 41050000 		.word _systickzhongduan +1           @ 15
  59 0040 B9050000 		.word aaa +1     @ _wwdg +1          @ 0
  60 0044 B9050000 		.word aaa +1     @_pvd +1            @ 1
  61 0048 B9050000 		.word aaa +1     @_rtc +1            @ 2
  62 004c B9050000 		.word aaa +1     @_flash +1          @ 3
  63 0050 B9050000 		.word aaa +1	@ _rcc + 1           @ 4
  64 0054 B9050000 		.word aaa +1      @_exti0_1  +1      @ 5
  65 0058 B9050000 		.word aaa +1      @ _exti2_3 +1      @ 6
  66 005c B9050000 		.word aaa +1       @_exti4_15 +1     @ 7
  67 0060 B9050000 		.word aaa +1                         @ 8
  68 0064 B9050000 		.word aaa +1	@__dma_wan  +1	     @ 9
  69 0068 B9050000 		.word aaa +1    @_dma1_2_3 +1        @ 10
  70 006c B9050000 		.word aaa +1       @_dma1_4_5 +1     @ 11
  71 0070 B9050000 		.word aaa +1	 @_adc1 +1           @ 12
  72 0074 B9050000 		.word aaa +1       @_tim1_brk_up +1  @ 13
  73 0078 B9050000 		.word aaa +1        @ _tim1_cc +1    @ 14
  74 007c B9050000 		.word aaa +1         @_tim2 +1       @ 15
  75 0080 B9050000 		.word aaa +1          @_tim3 +1      @ 16
  76 0084 B9050000 		.word aaa +1                         @ 17
  77 0088 B9050000 		.word aaa +1		             @ 18
  78 008c B9050000 		.word aaa +1	@_tim14 +1           @ 19
  79 0090 B9050000 		.word aaa +1                         @ 20
  80 0094 B9050000 		.word aaa +1         @_tim16 +1      @ 21
  81 0098 B9050000 		.word aaa +1         @_tim17 +1      @ 22
  82 009c B9050000 		.word aaa +1          @_i2c   +1     @ 23
  83 00a0 B9050000 		.word aaa +1                         @ 24
  84 00a4 B9050000 		.word aaa +1           @_spi   +1    @ 25
  85 00a8 B9050000 		.word aaa +1                         @ 26
  86 00ac B9050000 		.word aaa +1         @_usart1 +1     @ 27
  87              		.align 2
  88              	_start:
  89              		
  90              	shizhong:
  91 00b0 AF4A     		ldr r2, = 0x40022000   @FLASH访问控制
  92 00b2 3221     		movs r1, # 0x32
  93 00b4 1160     		str r1, [r2]           @FLASH缓冲 缓冲开启
  94 00b6 AF48     		ldr r0, = 0x40021000 @ rcc
  95 00b8 AF49     		ldr r1, = 0x10001
  96 00ba 0160     		str r1, [r0]
  97              	denghse:
  98 00bc 0168     		ldr r1, [r0]
  99 00be 8903     		lsls r1, r1, # 14
 100 00c0 FCD5     		bpl denghse
 101              	dengpllguan:
 102 00c2 0168     		ldr r1, [r0]
 103 00c4 8901     		lsls r1, r1, # 6
ARM GAS  1.s 			page 3


 104 00c6 FCD4     		bmi dengpllguan
 105 00c8 AC49     		ldr r1, = 0x150002	@0x150002
 106 00ca 0046     		mov r0, r0
 107 00cc 4160     		str r1, [r0, # 0x04]
 108 00ce 0046     		mov r0, r0
 109 00d0 AB49     		ldr r1, = 0x1010000
 110 00d2 0046     		mov r0, r0
 111 00d4 0160     		str r1, [r0]
 112              	
 113              	dengpll:
 114 00d6 0168     		ldr r1, [r0]
 115 00d8 8901     		lsls r1, # 6
 116 00da FCD5     		bpl dengpll
 117              	
 118              	
 119 00dc A949     		ldr r1, = 100
 120 00de 0163     		str r1, [r0, # 0x30]
 121              	
 122              	_waisheshizhong:	                         @ 外设时钟
 123              		@+0x14=RCC_AHBENR
 124              		@ 0=DMA @ 2=SRAM @ 4=FLITF@ 6=CRC @ 17=PA @ 18=PB @ 19=PC @ 20=PD @ 22=PF
 125 00e0 A448     		ldr r0, = 0x40021000
 126 00e2 A949     		ldr r1, = 0x60001
 127 00e4 4161     		str r1, [r0, # 0x14]
 128              	
 129              		@+0x18外设时钟使能寄存器 (RCC_APB2ENR)
 130              		@0=SYSCFG @5=USART6EN @9=ADC @11=TIM1 @12=SPI1 @14=USART1 @16=TIM15 @17=TIM16 @18=TIM17 @22=DBGMCU
 131 00e6 A949     		ldr r1, = 0x1a00
 132 00e8 8161     		str r1, [r0, # 0x18]
 133              		@+0X1C=RCC_APB1ENR
 134              		@ 1=TIM3 @ 4=TIM6 @ 5=TIM7 @ 8=TIM14 @ 11=WWDG @ 14=SPI @ 17=USRT2 @ 18=USART3 @ 20=USART5 @ 21=I2
 135              		@ 22=I2C2 @ 23=USB @ 28=PWR
 136 00ea A94A     		ldr r2, = 0x902
 137 00ec C261     		str r2, [r0, # 0x1c]
 138              	
 139              	_neicunqingling:
 140 00ee A948     		ldr r0, = 0x20000000
 141 00f0 0021     		movs r1, # 0
 142 00f2 A94B     		ldr r3, = 0x1000
 143              	_neicunqinglingxunhuan:
 144 00f4 043B     		subs r3, # 4
 145 00f6 C150     		str r1, [r0, r3]
 146 00f8 FCD1     		bne _neicunqinglingxunhuan
 147              	
 148              	_waishezhongduan:					@外设中断
 149              		@0xE000E100    0-31  写1开，写0没效
 150              		@0XE000E180    0-31 写1关，写0没效
 151              		@0XE000E200    0-31 挂起，写0没效
 152              		@0XE000E280    0-31 清除， 写0没效
 153 00fa A848     		ldr r0, =  0xe000e100
 154 00fc A849     		ldr r1, = 0x200 @0x10200  @ 0x10000
 155 00fe 0160     		str r1, [r0]
 156              		
 157              	@_kanmengou:
 158              	@	ldr r0, = 0x40003000
 159              	@	ldr r1, = 0x5555
 160              	@	str r1, [r0]
ARM GAS  1.s 			page 4


 161              	@	movs r1, # 7
 162              	@	str r1, [r0, # 4]
 163              	@	ldr r1, = 0xfff
 164              	@	str r1, [r0, # 8]
 165              	@	ldr r1, = 0xaaaa
 166              	@	str r1, [r0]
 167              	@	ldr r1, = 0xcccc
 168              	@	str r1, [r0]
 169              		
 170              	io_she_zhi:
 171              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 172              		@a(0x48000000)b(0x48000400)c(0x48000800)d(0x48000c00)f(0x48001400)
 173              		@ 输入（00），通用输出（01），复用功能（10），模拟（11）
 174              		@偏移0x4 = 端口输出类型 @ （0 推挽），（ 1 开漏）
 175              		@偏移0x8 = 输出速度  00低速， 01中速， 11高速
 176              		@偏移0xC = 上拉下拉 (00无上下拉，  01 上拉， 10下拉)
 177              		@偏移0x10 = 输入数据寄存器
 178              		@偏移0x14 = 输出数据寄存器
 179              		@偏移0x18 = 端口开  0-15置位
 180              		@偏移0x28 = 端口关
 181              		@0X20 = 复用低
 182              		@GPIO口0（0-3位）每个IO口占用4位
 183              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 184              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 185              		@0x24 = 复用高
 186              		@GPIO口8 （0-3位）每个IO口占用4位
 187              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 188              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 189              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 190              	
 191 0100 A848     		ldr r0, = 0x48000000
 192 0102 A949     		ldr r1, = 0x28249a57
 193 0104 0160     		str r1, [r0]
 194 0106 B021     		movs r1, 0xb0
 195 0108 4160     		str r1, [r0, # 0x04]
 196 010a A549     		ldr r1, = 0x200
 197 010c 4162     		str r1, [r0, # 0x24]
 198              		
 199 010e A748     	        ldr r0, = 0x48000400
 200 0110 0421     		movs r1, # 0x04
 201 0112 0160     		str r1, [r0]
 202              	spi_chushihua:
 203 0114 A648     		ldr r0, = 0x40013000
 204 0116 A749     		ldr  r1, = 0x708
 205 0118 4160     		str r1, [r0, # 0x04]
 206 011a A749     		ldr r1, = 0x5c
 207 011c 0160     		str r1, [r0]
 208              		
 209              	__kai_lcd_bei_guang:
 210 011e A748     	        ldr r0, = lcd_beiguang
 211 0120 C021     		movs r1, # 0xc0
 212 0122 0160     		str r1, [r0]
 213              	
 214              	_lcdchushihua:
 215 0124 3320     		movs r0, # 0x33
 216 0126 0021     		movs r1, # 0
 217 0128 00F0A7F9 		bl _xielcd
ARM GAS  1.s 			page 5


 218 012c 00F0A0F9 		bl _lcdyanshi
 219              	
 220 0130 3220     		movs r0, # 0x32
 221 0132 0021     		movs r1, # 0
 222 0134 00F0A1F9 		bl _xielcd
 223 0138 00F09AF9 		bl _lcdyanshi
 224 013c 2820     		movs r0, # 0x28
 225 013e 0021     		movs r1, # 0
 226 0140 00F09BF9 		bl _xielcd
 227 0144 00F094F9 		bl _lcdyanshi
 228 0148 0C20     		movs r0, # 0x0c
 229 014a 0021     		movs r1, # 0
 230 014c 00F095F9 		bl _xielcd
 231 0150 00F08EF9 		bl _lcdyanshi
 232 0154 0120     		movs r0, # 0x01
 233 0156 0021     		movs r1, # 0
 234 0158 00F08FF9 		bl _xielcd
 235 015c 00F088F9 		bl _lcdyanshi
 236              	
 237 0160 8020     		movs r0, # 0x80
 238 0162 9749     		ldr r1, = yjmwxwx
 239 0164 1022     		movs r2, # 16
 240 0166 00F075F9 		bl _lcdxianshi
 241 016a 9648     		ldr r0, = 0xffffff
 242              	yjmwxwx_yanshi:
 243 016c 0138     		subs r0, r0, # 1
 244 016e FDD1     		bne yjmwxwx_yanshi
 245              	
 246 0170 0120     		movs r0, # 0x01
 247 0172 0021     		movs r1, # 0
 248 0174 00F081F9 		bl _xielcd
 249 0178 00F07AF9 		bl _lcdyanshi
 250              		
 251              		
 252              	dmachushihua:
 253              		@+0=LSR,+4=IFCR,
 254              		@+8=CCR1,+c=CNDTR1,+10=CPAR1+14=CMAR1,
 255              		@+1c=CCR2,+20=CNDTR2,+24=CPAR2,+28=CMAR2
 256              		@+30=CCR3,+34=CNDTR3,+38=CPAR2,+3c=CMAR3
 257              		@+44=CCR4,+48=CNDTR4,+4c=CPAR4,+50=CMAR4
 258              		@+58=CCR5,+5c=CNDTR5,+60=CPAR5,+64=CMAR5
 259              		@+6C=CCR6,+70=CNDTR6,+74=CPAR6,+78=CMAR6
 260              		@+80=CCR7,+84=CNDTR7,+88=CPAR7,+8c=CMAR7
 261              		@tim1ch3DMA
 262              	
 263              		@tim1ch3DMA
 264 017c 9248     		ldr r0, = 0x40020000
 265 017e 9349     		ldr r1, = 0x40012c3c @ 外设地址
 266 0180 0166     		str r1, [r0, # 0x60]
 267 0182 9349     		ldr r1, = zheng_xian_100khz @ 储存器地址
 268 0184 4166     		str r1, [r0, # 0x64]
 269 0186 9349     		ldr r1, = 20             @点数
 270 0188 C165     		str r1, [r0, # 0x5c]
 271 018a 9349     		ldr r1, = 0x35b1         @ 储存到外设
 272 018c 8165     		str r1, [r0, # 0x58]
 273              	
 274              		@ adc dma
ARM GAS  1.s 			page 6


 275 018e 8E48     		ldr r0, = 0x40020000
 276 0190 9249     		ldr r1, = 0x40012440
 277 0192 0161     		str r1, [r0, # 0x10]
 278 0194 9249     		ldr r1, = dianyabiao
 279 0196 4161     		str r1, [r0, # 0x14]
 280 0198 9249     		ldr r1, = 1000
 281 019a C160     		str r1, [r0, # 0x0c]
 282 019c 9249     		ldr r1, = 0x5a1 @  0x583 	@ 5a1
 283 019e 8160     		str r1, [r0, # 0x08]
 284              		
 285              	_adcchushihua:
 286 01a0 9248     		ldr r0, = 0x40012400  @ adc基地址
 287 01a2 9349     		ldr r1, = 0x80000000
 288 01a4 8160     		str r1, [r0, # 0x08]  @ ADC 控制寄存器 (ADC_CR)  @adc校准
 289              	_dengadcjiaozhun:
 290 01a6 8168     		ldr r1, [r0, # 0x08]
 291 01a8 0900     		movs r1, r1
 292 01aa FCD4     		bmi _dengadcjiaozhun   @ 等ADC校准
 293 01ac 0121     		movs r1, # 1
 294 01ae 0160     		str r1, [r0]
 295              	_kaiadc:
 296 01b0 8168     		ldr r1, [r0, # 0x08]
 297 01b2 0122     		movs r2, # 0x01
 298 01b4 1143     		orrs r1, r1, r2
 299 01b6 8160     		str r1, [r0, # 0x08]
 300              	_deng_adc_wen_ding:
 301 01b8 0168     		ldr r1, [r0]
 302 01ba C907     		lsls r1, r1, # 31
 303 01bc FCD5     		bpl _deng_adc_wen_ding @ 等ADC稳定
 304              	_tongdaoxuanze:
 305 01be 8D49     		ldr r1, = 0x40000000
 306 01c0 0161     		str r1, [r0, # 0x10]
 307 01c2 8D49     		ldr r1, = 0x01
 308 01c4 8162     		str r1, [r0, # 0x28]    @ 通道选择寄存器 (ADC_CHSELR)
 309 01c6 8D49     		ldr r1, = 0x8c3 @ 0xc43		@TIM3 0x8c3 @0x2003 @0x8c3
 310 01c8 C160     		str r1, [r0, # 0x0c]    @ 配置寄存器 1 (ADC_CFGR1)
 311 01ca 0021     		movs r1, # 0
 312 01cc 4161     		str r1, [r0, # 0x14]    @ ADC 采样时间寄存器 (ADC_SMPR)
 313 01ce 8168     		ldr r1, [r0, # 0x08]
 314 01d0 8B4A     		ldr r2, = 0x04         @ 开始转换
 315 01d2 1143     		orrs r1, r1, r2
 316 01d4 8160     		str r1, [r0, # 0x08]    @ 控制寄存器 (ADC_CR)
 317              	
 318              	
 319              	_systick:	                             @ systick定时器初始化
 320              	
 321 01d6 8B4F     		ldr r7, = 0xe000e010
 322 01d8 8B4E     		ldr r6, = 55999
 323 01da 7E60     		str r6, [r7, # 4]
 324 01dc BE60     		str r6, [r7, # 8]
 325 01de 0726     		movs r6, # 0x07
 326 01e0 3E60     		str r6, [r7]    @systick 开
 327              	
 328 01e2 8A4D     		ldr r5, = 0x3690
 329              	__systick_yans:	
 330 01e4 013D     		subs r5, r5, # 1
 331 01e6 FDD1     		bne __systick_yans
ARM GAS  1.s 			page 7


 332              		
 333              	tim3chushihua:
 334 01e8 894B     		ldr r3, = 0x40000400 @ tim3_cr1
 335 01ea 8A4C     		ldr r4, = 0
 336 01ec 9C62     		str r4, [r3, # 0x28] @ psc
 337 01ee 8A4C     		ldr r4, = 27
 338 01f0 DC62     		str r4, [r3, # 0x2c] @ ARR
 339 01f2 2024     		movs r4, # 0x20
 340 01f4 5C60     		str r4, [r3, # 0x04] @ TRGO
 341 01f6 0624     		movs r4, # 0x06
 342 01f8 9C60     		str r4, [r3, # 0x08]
 343 01fa 8024     		movs r4, # 0x80
 344              	@	str r4, [r3]
 345              	tim1chushiha:
 346 01fc 8748     		ldr r0, = 0x40012c00 @ tim1_cr1
 347 01fe 0021     		movs r1, # 0
 348 0200 8162     		str r1, [r0, # 0x28] @ psc
 349 0202 8549     		ldr r1, = 27
 350 0204 C162     		str r1, [r0, # 0x2c] @ ARR
 351 0206 2021     		movs r1, # 0x20
 352 0208 4160     		str r1, [r0, # 0x04] @ TRGO
 353 020a 8549     		ldr r1, = 0x68
 354 020c C161     		str r1, [r0, # 0x1c] @ ccmr2  CC3
 355 020e 8549     		ldr r1, = 0x100    @  CC3
 356 0210 0162     		str r1, [r0, # 0x20] @ ccer
 357 0212 8549     		ldr r1, = 0x8000
 358 0214 4164     		str r1, [r0, # 0x44] @ BDTR
 359 0216 8549     		ldr r1, = 0x800 @ CC3 DMA
 360 0218 C160     		str r1, [r0, # 0x0c] @ DIER
 361 021a 8549     		ldr r1, = 0x81
 362              	
 363 021c 0160     		str r1, [r0]
 364 021e 1C60     	        str r4, [r3]
 365              		
 366              		
 367              	ting:
 368 0220 00F001F8 		bl __xianshi_shangxia_bi
 369 0224 FCE7     		b ting
 370              	
 371              	
 372              	
 373              		
 374              	__xianshi_shangxia_bi:
 375 0226 FFB5     		push {r0-r7,lr}
 376 0228 8248     		ldr r0, = shangbi_r
 377 022a 834A     		ldr r2, = shangbi_i
 378 022c 0168     		ldr r1, [r0]
 379 022e 1768     		ldr r7, [r2]
 380 0230 0C00     		movs r4, r1
 381 0232 07D5     		bpl a1
 382 0234 8020     		movs r0, # 0x80
 383 0236 8149     		ldr r1, = _fu
 384 0238 0122     		movs r2, # 1
 385 023a 00F00BF9 		bl _lcdxianshi
 386 023e E443     		mvns r4, r4
 387 0240 0134     		adds r4, r4, # 1
 388 0242 04E0     		b a2
ARM GAS  1.s 			page 8


 389              	a1:
 390 0244 8020     		movs r0, # 0x80
 391 0246 7E49     		ldr r1, = kong
 392 0248 0122     		movs r2, # 1
 393 024a 00F003F9 		bl _lcdxianshi
 394              	a2:
 395 024e 2046     		mov r0, r4
 396 0250 0521     		movs r1, # 5
 397 0252 504A     		ldr r2, = asciimabiao
 398 0254 FF23     		movs r3, # 0xff
 399 0256 00F043F9 		bl _zhuanascii
 400 025a 8120     		movs r0, # 0x81
 401 025c 4D49     		ldr r1, = asciimabiao
 402 025e 0522     		movs r2, # 5
 403 0260 00F0F8F8 		bl _lcdxianshi
 404              	
 405              	
 406 0264 3C00     		movs r4, r7
 407 0266 07D5     		bpl b1
 408 0268 8A20     		movs r0, # 0x8a
 409 026a 7449     		ldr r1, = _fu
 410 026c 0122     		movs r2, # 1
 411 026e 00F0F1F8 		bl _lcdxianshi
 412 0272 E443     		mvns r4, r4
 413 0274 0134     		adds r4, r4, # 1
 414 0276 04E0     		b b2
 415              	b1:
 416 0278 8A20     		movs r0, # 0x8a
 417 027a 7149     		ldr r1, = kong
 418 027c 0122     		movs r2, # 1
 419 027e 00F0E9F8 		bl _lcdxianshi
 420              	b2:
 421 0282 2046     		mov r0, r4
 422 0284 0521     		movs r1, # 5
 423 0286 434A     		ldr r2, = asciimabiao
 424 0288 FF23     		movs r3, # 0xff
 425 028a 00F029F9 		bl _zhuanascii
 426 028e 8B20     		movs r0, # 0x8b
 427 0290 4049     		ldr r1, = asciimabiao
 428 0292 0522     		movs r2, # 5
 429 0294 00F0DEF8 		bl _lcdxianshi
 430              	
 431 0298 6A48     	        ldr r0, = xiabi_r
 432 029a 6B4A     		ldr r2, = xiabi_i
 433 029c 0168     		ldr r1, [r0]
 434 029e 1768     		ldr r7, [r2]
 435 02a0 0C00     		movs r4, r1
 436 02a2 07D5     		bpl c1
 437 02a4 C020     		movs r0, # 0xc0
 438 02a6 6549     		ldr r1, = _fu
 439 02a8 0122     		movs r2, # 1
 440 02aa 00F0D3F8 		bl _lcdxianshi
 441 02ae E443     		mvns r4, r4
 442 02b0 0134     		adds r4, r4, # 1
 443 02b2 04E0     		b c2
 444              	c1:
 445 02b4 C020     		movs r0, # 0xc0
ARM GAS  1.s 			page 9


 446 02b6 6249     		ldr r1, = kong
 447 02b8 0122     		movs r2, # 1
 448 02ba 00F0CBF8 		bl _lcdxianshi
 449              	c2:
 450 02be 2046     		mov r0, r4
 451 02c0 0521     		movs r1, # 5
 452 02c2 344A     		ldr r2, = asciimabiao
 453 02c4 FF23     		movs r3, # 0xff
 454 02c6 00F00BF9 		bl _zhuanascii
 455 02ca C120     		movs r0, # 0xc1
 456 02cc 3149     		ldr r1, = asciimabiao
 457 02ce 0522     		movs r2, # 5
 458 02d0 00F0C0F8 		bl _lcdxianshi
 459              	
 460              	
 461 02d4 3C00     		movs r4, r7
 462 02d6 07D5     		bpl d1
 463 02d8 CA20     		movs r0, # 0xca
 464 02da 5849     		ldr r1, = _fu
 465 02dc 0122     		movs r2, # 1
 466 02de 00F0B9F8 		bl _lcdxianshi
 467 02e2 E443     		mvns r4, r4
 468 02e4 0134     		adds r4, r4, # 1
 469 02e6 04E0     		b d2
 470              	d1:
 471 02e8 CA20     		movs r0, # 0xca
 472 02ea 5549     		ldr r1, = kong
 473 02ec 0122     		movs r2, # 1
 474 02ee 00F0B1F8 		bl _lcdxianshi
 475              	d2:
 476 02f2 2046     		mov r0, r4
 477 02f4 0521     		movs r1, # 5
 478 02f6 274A     		ldr r2, = asciimabiao
 479 02f8 FF23     		movs r3, # 0xff
 480 02fa 00F0F1F8 		bl _zhuanascii
 481 02fe CB20     		movs r0, # 0xcb
 482 0300 2449     		ldr r1, = asciimabiao
 483 0302 0522     		movs r2, # 5
 484 0304 00F0A6F8 		bl _lcdxianshi
 485 0308 FFBD     		pop {r0-r7,pc}
 486              	
 487              	__dft:
 488 030a FCB5     		push {r2-r7,lr}
 489 030c 4246     		mov r2, r8
 490 030e 04B4     		push {r2}
 491 0310 3348     		ldr r0, = dianyabiao
 492 0312 4E49     		ldr r1, = cos_sin_biao
 493 0314 4E4B     		ldr r3, = 1984	@ 点数*2-16
 494 0316 454C     		ldr r4, = 2048
 495 0318 1B18     		adds r3, r3, r0
 496 031a 9846     		mov r8, r3
 497 031c 0022     		movs r2, # 0
 498 031e 1746     		mov r7, r2
 499              	__dft_xunhuan:
 500 0320 0388     		ldrh r3, [r0]
 501 0322 0D68     		ldr r5, [r1]
 502 0324 4E68     		ldr r6, [r1, # 0x04]
ARM GAS  1.s 			page 10


 503 0326 1B1B     		subs r3, r3, r4
 504 0328 5D43     		muls r5, r5, r3
 505 032a ED13     		asrs r5, r5, # 15
 506 032c 5E43     		muls r6, r6, r3
 507 032e F613     		asrs r6, r6, # 15
 508 0330 5219     		adds r2, r2, r5
 509 0332 BF19     		adds r7, r7, r6
 510 0334 0230     		adds r0, r0, # 0x02
 511 0336 0831     		adds r1, r1, # 0x08
 512 0338 4045     		cmp r0, r8
 513 033a F1D1     		bne __dft_xunhuan
 514              	@	ldr r0, = r
 515              	@	ldr r1, = i
 516              	@	asrs r2, r2, # 7
 517              	@	asrs r7, r7, # 7
 518 033c 1046     		mov r0, r2
 519 033e 3946     		mov r1, r7
 520              	@	str r2, [r0]
 521              	@	str r7, [r1]
 522 0340 04BC     		pop {r2}
 523 0342 9046     		mov r8, r2
 524 0344 FCBD     		pop {r2-r7,pc}
 525              		
 526              	__lv_bo_qi:
 527              		@地址顺序：指针，累加值，缓冲区
 528              		@入口R0=缓冲区，R1=数据, r2,=指针
 529              		@出口R0
 530 0346 78B5     		push {r3-r6,lr}
 531 0348 4024     		movs r4, # 64 @ =128
 532 034a 1568     		ldr r5, [r2]
 533 034c 2B46     		mov r3, r5
 534 034e AB00     		lsls r3, r5, # 2
 535 0350 C658     		ldr r6, [r0, r3]
 536 0352 C150     		str r1, [r0, r3]
 537 0354 0135     		adds r5, r5, # 1
 538 0356 1560     		str r5, [r2]
 539 0358 A542     		cmp r5, r4
 540 035a 01D1     		bne __huanchong_leijia
 541 035c 0025     		movs r5, # 0
 542 035e 1560     		str r5, [r2]
 543              	__huanchong_leijia:
 544 0360 0438     		subs r0, r0, # 4
 545 0362 0568     		ldr r5, [r0]
 546 0364 4919     		adds r1, r1, r5
 547 0366 891B     		subs r1, r1, r6
 548 0368 0160     		str r1, [r0]
 549 036a 0813     		asrs r0, r1, # 12 @  7	@128
 550 036c 78BD     		pop {r3-r6,pc}
 551 036e 00000020 		.ltorg
 551      02400010 
 551      02400100 
 551      01000200 
 551      15000000 
 552              	
 553              		
 554              	_lcdxianshi:		  		@r0=LCD位置，r1=数据地址，r2=长度
 555 0454 1FB5     		push {r0-r4,lr}
ARM GAS  1.s 			page 11


 556 0456 0C46     		mov r4, r1
 557              	
 558 0458 0021     		movs r1, # 0
 559 045a 00F00EF8 		bl _xielcd
 560              	
 561 045e 0121     		movs r1, # 1
 562 0460 0023     		movs r3, # 0
 563              	_lcdxianshixunhuan:
 564 0462 E05C     		ldrb r0, [r4,r3]
 565 0464 00F009F8 		bl _xielcd
 566 0468 0133     		adds r3, r3, # 1
 567 046a 9342     		cmp r3, r2
 568 046c F9D1     		bne _lcdxianshixunhuan
 569 046e 1FBD     		pop {r0-r4,pc}
 570              	
 571              	_lcdyanshi:
 572 0470 20B5     		push {r5,lr}
 573 0472 524D     		ldr r5, = 0x1000
 574              	_lcdyanshixunhuan:
 575 0474 013D     		subs r5, r5, # 1
 576 0476 FDD1     		bne _lcdyanshixunhuan
 577 0478 20BD     		pop {r5,pc}
 578              	_xielcd:					@入R0=8位,r1=0命令,r1=1数据
 579 047a 3FB5     		push {r0-r5,lr}
 580 047c 504C     		ldr r4, = lcd_beiguang  @ 量程开关 (第6位和第7位)
 581 047e 0246     		mov r2, r0
 582 0480 2568     		ldr r5, [r4]
 583 0482 1209     		lsrs r2, r2, # 4
 584 0484 9200     		lsls r2, r2, # 2	@ 高四位
 585 0486 0007     		lsls r0, r0, # 28
 586 0488 800E     		lsrs r0, r0, # 26	@ 低四位
 587 048a C907     		lsls r1, r1, # 31
 588 048c 01D5     		bpl __lcd_ming_ling
 589              	__lcd_shu_ju:
 590 048e 0323     		movs r3, # 0x03		@ RS = 1 E = 1
 591 0490 00E0     		b __xie_lcd_shu_ju
 592              	__lcd_ming_ling:
 593 0492 0223     		movs r3, # 0x02		@ RS = 0 E = 1
 594              	__xie_lcd_shu_ju:
 595 0494 5B19     		adds r3, r3, r5
 596 0496 0146     		mov r1, r0
 597 0498 D218     		adds r2, r2, r3
 598 049a 4A4D     		ldr r5, = 0x4001300c
 599 049c 1000     		movs r0, r2
 600 049e 2870     		strb r0, [r5]
 601 04a0 00F016F8 		bl __spi_mang
 602 04a4 00F018F8 		bl __yanshi_595
 603 04a8 0238     		subs r0, r0, # 0x02
 604 04aa 2870     		strb r0, [r5]
 605 04ac 00F010F8 		bl __spi_mang
 606 04b0 00F012F8 		bl __yanshi_595
 607 04b4 0846     		mov r0, r1
 608 04b6 C018     		adds r0, r0, r3
 609 04b8 2870     		strb r0, [r5]
 610 04ba 00F009F8 		bl __spi_mang
 611 04be 00F00BF8 		bl __yanshi_595
 612 04c2 0238     		subs r0, r0, # 0x02
ARM GAS  1.s 			page 12


 613 04c4 2870     		strb r0, [r5]
 614 04c6 00F003F8 		bl __spi_mang
 615 04ca 00F005F8 		bl __yanshi_595
 616 04ce 3FBD     		pop {r0-r5,pc}
 617              	__spi_mang:
 618 04d0 AA68     		ldr r2, [r5, # 0x08]
 619 04d2 1206     		lsls r2, r2, # 24
 620 04d4 FCD4     		bmi __spi_mang
 621 04d6 F746     		mov pc, lr
 622              	__yanshi_595:
 623 04d8 3B4A     		ldr r2, = 0x2000
 624              	__yanshi__595:
 625 04da 013A     		subs r2, r2, # 1
 626 04dc FDD1     		bne __yanshi__595
 627 04de F746     		mov pc, lr
 628              		
 629              	
 630              	_zhuanascii:						@ 16进制转ASCII
 631              		@ R0要转的数据， R1长度，R2结果表首地址, r3=小数点位置
 632 04e0 FFB5     		push {r0-r7,lr}
 633 04e2 1F46     		mov r7, r3
 634 04e4 0546     		mov r5, r0
 635 04e6 0E46     		mov r6, r1
 636 04e8 0A21     		movs r1, # 10
 637              	_xunhuanqiuma:
 638 04ea 00F012F8 		bl _chufa
 639 04ee 0446     		mov r4, r0
 640 04f0 4C43     		muls r4, r1
 641 04f2 2B1B     		subs r3, r5, r4
 642 04f4 3033     		adds r3, r3, # 0x30
 643 04f6 0546     		mov r5, r0
 644 04f8 013E     		subs r6, r6, # 1
 645 04fa 08D0     		beq _qiumafanhui
 646 04fc BE42     		cmp r6, r7
 647 04fe 02D1     		bne _meidaoxiaoshudian
 648 0500 2E24     		movs r4, # 0x2e		@小数点
 649 0502 9455     		strb r4, [r2,r6]	@插入小数点
 650 0504 013E     		subs r6, r6, # 1
 651              	_meidaoxiaoshudian:
 652 0506 9355     		strb r3, [r2,r6]
 653 0508 3600     		movs r6, r6
 654 050a EED1     		bne _xunhuanqiuma
 655 050c FFBD     		pop {r0-r7,pc}
 656              	_qiumafanhui:
 657 050e 9355     		strb r3, [r2, r6]
 658 0510 FFBD     		pop {r0-r7,pc}
 659              	
 660              	
 661              	
 662              		
 663              	
 664              	_chufa:				@软件除法
 665              		@ r0 除以 r1 等于 商(r0)
 666 0512 1EB5     		push {r1-r4,lr}
 667 0514 0028     		cmp r0, # 0
 668 0516 0ED0     		beq _chufafanhui
 669 0518 0029     		cmp r1, # 0
ARM GAS  1.s 			page 13


 670 051a 0CD0     		beq _chufafanhui
 671 051c 0246     		mov r2, r0
 672 051e 0123     		movs r3, # 1
 673 0520 DB07     		lsls r3, r3, # 31
 674 0522 0020     		movs r0, # 0
 675 0524 0446     		mov r4, r0
 676              	_chufaxunhuan:
 677 0526 5200     		lsls r2, r2, # 1
 678 0528 6441     		adcs r4, r4, r4
 679 052a 8C42     		cmp r4, r1
 680 052c 01D3     		bcc _chufaweishubudao0
 681 052e C018     		adds r0, r0, r3
 682 0530 641A     		subs r4, r4, r1
 683              	_chufaweishubudao0:
 684 0532 5B08     		lsrs r3, r3, # 1
 685 0534 F7D1     		bne _chufaxunhuan
 686              	_chufafanhui:
 687 0536 1EBD     		pop {r1-r4,pc}
 688              	
 689              	_nmi_handler:
 690 0538 7047     		bx lr
 691              	_hard_fault:
 692 053a 7047     		bx lr
 693              	_svc_handler:
 694 053c 7047     		bx lr
 695              	_pendsv_handler:
 696 053e 7047     		bx lr
 697              	_systickzhongduan:
 698 0540 10B5     		push {r4,lr}
 699 0542 2248     		ldr r0, = 0xe0000d04
 700 0544 2249     		ldr r1, = 0x02000000
 701 0546 0160     		str r1, [r0]                 @ 清除SYSTICK中断
 702 0548 224A     		ldr r2, = shangxiabi_qiehuan
 703 054a 1368     		ldr r3, [r2]
 704 054c 012B     		cmp r3, # 1
 705 054e 19D1     		bne __shangbi_dft
 706 0550 0023     	        movs r3, # 0
 707 0552 1360     		str r3, [r2]
 708 0554 204A     		ldr r2, = 0x48000400
 709 0556 0223     		movs r3, #  0x02
 710 0558 9362     		str r3, [r2, # 0x28]    @cd4053_9_10 上臂开
 711 055a 204A     		ldr r2, = 0x20000040
 712 055c 2048     		ldr r0, = 0x40020000
 713 055e C068     		ldr r0, [r0, # 0x0c]
 714 0560 1060     		str r0, [r2]
 715 0562 FFF7D2FE 		bl __dft
 716 0566 0446     	        mov r4, r0
 717 0568 1E4A     		ldr r2, = lvboqizhizhen3
 718 056a 1F48     		ldr r0, =lvboqihuanchong3
 719 056c FFF7EBFE 		bl __lv_bo_qi
 720 0570 1E49     		ldr r1, = xiabi_i
 721 0572 0860     		str r0, [r1]
 722 0574 2146     		mov r1, r4
 723 0576 1E4A     		ldr r2, = lvboqizhizhen2
 724 0578 1E48     		ldr r0, = lvboqihuanchong2
 725 057a FFF7E4FE 		bl __lv_bo_qi
 726 057e 1E49     		ldr r1, = xiabi_r
ARM GAS  1.s 			page 14


 727 0580 0860     		str r0, [r1]
 728 0582 18E0     		b __systick_fanhui
 729              		
 730              	__shangbi_dft:
 731 0584 0123     		movs r3, # 1
 732 0586 1360     		str r3, [r2]
 733 0588 134A     		ldr r2, = 0x48000400
 734 058a 0223     	        movs r3, #  0x02
 735 058c 9361     		str r3, [r2, # 0x18]    @cd4053_9_10 下臂开
 736 058e 1B4A     		ldr r2, = 0x20000044
 737 0590 1348     		ldr r0, = 0x40020000
 738 0592 C068     		ldr r0, [r0, # 0x0c]
 739 0594 1060     		str r0, [r2]
 740 0596 FFF7B8FE 		bl __dft
 741 059a 0446     		mov r4, r0
 742 059c 184A     		ldr r2, = lvboqizhizhen1
 743 059e 1948     		ldr r0, =lvboqihuanchong1
 744 05a0 FFF7D1FE 		bl __lv_bo_qi
 745 05a4 1849     		ldr r1, = shangbi_i
 746 05a6 0860     		str r0, [r1]
 747 05a8 2146     		mov r1, r4
 748 05aa 184A     	        ldr r2, = lvboqizhizhen
 749 05ac 1848     		ldr r0, =lvboqihuanchong
 750 05ae FFF7CAFE 		bl __lv_bo_qi
 751 05b2 1849     		ldr r1, = shangbi_r
 752 05b4 0860     		str r0, [r1]
 753              		
 754              	__systick_fanhui:	
 755 05b6 10BD     		pop {r4,pc}
 756              	aaa:
 757 05b8 7047     		bx lr
 758 05ba 00000010 		.ltorg
 758      00002000 
 758      00200C30 
 758      01400020 
 758      0000040D 
 759              		.end
ARM GAS  1.s 			page 15


DEFINED SYMBOLS
                 1.s:9      .data:0000000000000000 zheng_xian_100khz
                 1.s:11     .data:0000000000000028 cos_sin_biao
                 1.s:14     .data:0000000000001f68 kong
                 1.s:16     .data:0000000000001f6c _fu
                 1.s:18     .data:0000000000001f6d yjmwxwx
                 1.s:20     .data:0000000000001f7d $d
                 1.s:21     *ABS*:0000000020001000 STACKINIT
                 1.s:22     *ABS*:0000000020000000 asciimabiao
                 1.s:23     *ABS*:0000000020000020 lcd_beiguang
                 1.s:24     *ABS*:0000000020000024 shangbi_r
                 1.s:25     *ABS*:0000000020000028 shangbi_i
                 1.s:26     *ABS*:000000002000002c xiabi_r
                 1.s:27     *ABS*:0000000020000030 xiabi_i
                 1.s:28     *ABS*:0000000020000034 shangxiabi_qiehuan
                 1.s:29     *ABS*:0000000020000100 dianyabiao
                 1.s:30     *ABS*:00000000200008d0 lvboqizhizhen
                 1.s:31     *ABS*:00000000200008d8 lvboqihuanchong
                 1.s:32     *ABS*:00000000200009e0 lvboqizhizhen1
                 1.s:33     *ABS*:00000000200009e8 lvboqihuanchong1
                 1.s:34     *ABS*:0000000020000af0 lvboqizhizhen2
                 1.s:35     *ABS*:0000000020000af8 lvboqihuanchong2
                 1.s:36     *ABS*:0000000020000c00 lvboqizhizhen3
                 1.s:37     *ABS*:0000000020000c08 lvboqihuanchong3
                 1.s:42     .text:0000000000000000 vectors
                 1.s:88     .text:00000000000000b0 _start
                 1.s:689    .text:0000000000000538 _nmi_handler
                 1.s:691    .text:000000000000053a _hard_fault
                 1.s:693    .text:000000000000053c _svc_handler
                 1.s:695    .text:000000000000053e _pendsv_handler
                 1.s:697    .text:0000000000000540 _systickzhongduan
                 1.s:756    .text:00000000000005b8 aaa
                            .text:0000000000000000 $d
                 1.s:87     .text:00000000000000b0 $t
                 1.s:90     .text:00000000000000b0 shizhong
                 1.s:97     .text:00000000000000bc denghse
                 1.s:101    .text:00000000000000c2 dengpllguan
                 1.s:113    .text:00000000000000d6 dengpll
                 1.s:122    .text:00000000000000e0 _waisheshizhong
                 1.s:139    .text:00000000000000ee _neicunqingling
                 1.s:143    .text:00000000000000f4 _neicunqinglingxunhuan
                 1.s:148    .text:00000000000000fa _waishezhongduan
                 1.s:170    .text:0000000000000100 io_she_zhi
                 1.s:202    .text:0000000000000114 spi_chushihua
                 1.s:209    .text:000000000000011e __kai_lcd_bei_guang
                 1.s:214    .text:0000000000000124 _lcdchushihua
                 1.s:578    .text:000000000000047a _xielcd
                 1.s:571    .text:0000000000000470 _lcdyanshi
                 1.s:554    .text:0000000000000454 _lcdxianshi
                 1.s:242    .text:000000000000016c yjmwxwx_yanshi
                 1.s:252    .text:000000000000017c dmachushihua
                 1.s:285    .text:00000000000001a0 _adcchushihua
                 1.s:289    .text:00000000000001a6 _dengadcjiaozhun
                 1.s:295    .text:00000000000001b0 _kaiadc
                 1.s:300    .text:00000000000001b8 _deng_adc_wen_ding
                 1.s:304    .text:00000000000001be _tongdaoxuanze
                 1.s:319    .text:00000000000001d6 _systick
ARM GAS  1.s 			page 16


                 1.s:329    .text:00000000000001e4 __systick_yans
                 1.s:333    .text:00000000000001e8 tim3chushihua
                 1.s:345    .text:00000000000001fc tim1chushiha
                 1.s:367    .text:0000000000000220 ting
                 1.s:374    .text:0000000000000226 __xianshi_shangxia_bi
                 1.s:389    .text:0000000000000244 a1
                 1.s:394    .text:000000000000024e a2
                 1.s:630    .text:00000000000004e0 _zhuanascii
                 1.s:415    .text:0000000000000278 b1
                 1.s:420    .text:0000000000000282 b2
                 1.s:444    .text:00000000000002b4 c1
                 1.s:449    .text:00000000000002be c2
                 1.s:470    .text:00000000000002e8 d1
                 1.s:475    .text:00000000000002f2 d2
                 1.s:487    .text:000000000000030a __dft
                 1.s:499    .text:0000000000000320 __dft_xunhuan
                 1.s:526    .text:0000000000000346 __lv_bo_qi
                 1.s:543    .text:0000000000000360 __huanchong_leijia
                 1.s:551    .text:000000000000036e $d
                 1.s:551    .text:0000000000000370 $d
                 1.s:555    .text:0000000000000454 $t
                 1.s:563    .text:0000000000000462 _lcdxianshixunhuan
                 1.s:574    .text:0000000000000474 _lcdyanshixunhuan
                 1.s:592    .text:0000000000000492 __lcd_ming_ling
                 1.s:589    .text:000000000000048e __lcd_shu_ju
                 1.s:594    .text:0000000000000494 __xie_lcd_shu_ju
                 1.s:617    .text:00000000000004d0 __spi_mang
                 1.s:622    .text:00000000000004d8 __yanshi_595
                 1.s:624    .text:00000000000004da __yanshi__595
                 1.s:637    .text:00000000000004ea _xunhuanqiuma
                 1.s:664    .text:0000000000000512 _chufa
                 1.s:656    .text:000000000000050e _qiumafanhui
                 1.s:651    .text:0000000000000506 _meidaoxiaoshudian
                 1.s:686    .text:0000000000000536 _chufafanhui
                 1.s:676    .text:0000000000000526 _chufaxunhuan
                 1.s:683    .text:0000000000000532 _chufaweishubudao0
                 1.s:730    .text:0000000000000584 __shangbi_dft
                 1.s:754    .text:00000000000005b6 __systick_fanhui
                 1.s:758    .text:00000000000005ba $d
                 1.s:758    .text:00000000000005bc $d

NO UNDEFINED SYMBOLS
