ARM GAS  1.s 			page 1


   1              		@@单片机stm32f030f4p6
   2              		@@ adc fft
   3              		@作者：yjmwxwx
   4              		@时间：2019-06-19
   5              		@编译器：arm-none-eabi
   6              		 .thumb                 
   7              	         .syntax unified
   8              	.section .data
   9              	shumaguanmabiao:
  10 0000 FC000000 		.int 0xfc,0x60,0xda,0xf2,0x66,0xb6,0xbe,0xe0,0xfe,0xf6
  10      60000000 
  10      DA000000 
  10      F2000000 
  10      66000000 
  11              	shumaguanshuaxinbiao:
  12 0028 00FE0000 		.int 0xfe00,0xfd00,0xfb00,0xf700,0xef00,0xdf00,0xbf00,0x7f00,0
  12      00FD0000 
  12      00FB0000 
  12      00F70000 
  12      00EF0000 
  13              	       	.equ STACKINIT,                 0x20001000
  14              		.equ shumaguanma,	0x20000804
  15              		.equ xuanzhuanyinzi,	0x20000800
  16              	dianyabiao:
  17 004c 89000000 		.int 0x089,0x039,0x18C,0x63D,0xB84,0xECF,0xFBD,0xFBF,0xE3D,0x8F7,0x3EF,0x0E1,0x039,0x074,0x366,0x8
  17      39000000 
  17      8C010000 
  17      3D060000 
  17      840B0000 
  18              	hudieweifanzhuan:
  19 044c 00000000 		.int 0x0000,0x0200,0x0100,0x0300,0x0080,0x0280,0x0180,0x0380,0x0040,0x0240,0x0140,0x0340,0x00C0,0x
  19      00020000 
  19      00010000 
  19      00030000 
  19      80000000 
  20              	
  21              	fft3xuanzhuanyinzi:
  22 084c 00800000 		.int 0x8000,0x0000,0x5A82,0xFFFFA57E,0x0000,0xFFFF8000,0xFFFFA57E,0xFFFFA57E
  22      00000000 
  22      825A0000 
  22      7EA5FFFF 
  22      00000000 
  23              	fft4xuanzhuanyinzi:
  24 086c 00800000 		.int 0x8000,0x0000,0x7641,0xFFFFCF05,0x5A82,0xFFFFA57E,0x30FB,0xFFFF89BF,0x0000,0xFFFF8000,0xFFFFC
  24      00000000 
  24      41760000 
  24      05CFFFFF 
  24      825A0000 
  25              	fft5xuanzhuanyinzi:
  26 08ac 00800000 		.int 0x8000,0x0000,0x7D8A,0xFFFFE708,0x7641,0xFFFFCF05,0x6A6D,0xFFFFB8E4,0x5A82,0xFFFFA57E,0x471C,
  26      00000000 
  26      8A7D0000 
  26      08E7FFFF 
  26      41760000 
  27              	fft6xuanzhuanyinzi:
  28 092c 00800000 		.int 0x8000,0x0000,0x7F62,0xFFFFF375,0x7D8A,0xFFFFE708,0x7A7D,0xFFFFDAD8,0x7641,0xFFFFCF05,0x70E2,
  28      00000000 
ARM GAS  1.s 			page 2


  28      627F0000 
  28      75F3FFFF 
  28      8A7D0000 
  29              	fft7xuanzhuanyinzi:
  30 0a2c 00800000 		.int 0x8000,0x0000,0x7FD8,0xFFFFF9B9,0x7F62,0xFFFFF375,0x7E9D,0xFFFFED38,0x7D8A,0xFFFFE708,0x7C29,
  30      00000000 
  30      D87F0000 
  30      B9F9FFFF 
  30      627F0000 
  31              	
  32              	fft8xuanzhuanyinzi:
  33 0c2c 00800000 		.int 0x8000,0x0000,0x7FF6,0xFFFFFCDC,0x7FD8,0xFFFFF9B9,0x7FA7,0xFFFFF696,0x7F62,0xFFFFF375,0x7F09,
  33      00000000 
  33      F67F0000 
  33      DCFCFFFF 
  33      D87F0000 
  34              		
  35              		
  36              	
  37              		
  38              			
  39              		
  40              	.section .text
  41              	vectors:        
  42 0000 00100020 	        .word STACKINIT         
  43 0004 B1000000 	        .word _start + 1        
  44 0008 A1040000 	        .word _nmi_handler + 1  
  45 000c A3040000 	        .word _hard_fault  + 1  
  46 0010 00000000 	        .word 0 
  47 0014 00000000 	        .word 0    
  48 0018 00000000 	        .word 0
  49 001c 00000000 		.word 0
  50 0020 00000000 		.word 0
  51 0024 00000000 		.word 0
  52 0028 00000000 		.word 0
  53 002c A5040000 		.word _svc_handler +1
  54 0030 00000000 		.word 0 
  55 0034 00000000 		.word 0
  56 0038 A7040000 		.word _pendsv_handler +1
  57 003c 00000000 		.word 0 @_systick +1               @ 15   
  58 0040 00000000 		.word 0     @ _wwdg +1          @ 0
  59 0044 00000000 		.word 0     @_pvd +1            @ 1
  60 0048 00000000 		.word 0     @_rtc +1            @ 2
  61 004c 00000000 		.word 0     @_flash +1          @ 3
  62 0050 00000000 		.word 0     @ _rcc + 1          @ 4
  63 0054 00000000 		.word 0      @_exti0_1  +1      @ 5
  64 0058 00000000 		.word 0      @ _exti2_3 +1      @ 6
  65 005c 00000000 		.word 0       @_exti4_15 +1     @ 7
  66 0060 00000000 		.word 0                         @ 8
  67 0064 00000000 		.word 0 	@_dma1_1  +1    @ 9
  68 0068 00000000 		.word 0    @_dma1_2_3 +1        @ 10
  69 006c 00000000 		.word 0       @_dma1_4_5 +1     @ 11
  70 0070 00000000 		.word 0 	@_adc1 +1          @ 12
  71 0074 00000000 		.word 0       @_tim1_brk_up +1  @ 13
  72 0078 00000000 		.word 0        @ _tim1_cc +1    @ 14
  73 007c 00000000 		.word 0         @_tim2 +1       @ 15
  74 0080 00000000 		.word 0          @_tim3 +1      @ 16
ARM GAS  1.s 			page 3


  75 0084 00000000 		.word 0                         @ 17
  76 0088 00000000 		.word 0		                @ 18
  77 008c 00000000 		.word 0		@_tim14 +1    @ 19
  78 0090 00000000 		.word 0                         @ 20
  79 0094 00000000 		.word 0         @_tim16 +1      @ 21
  80 0098 00000000 		.word 0         @_tim17 +1      @ 22
  81 009c 00000000 		.word 0          @_i2c   +1     @ 23
  82 00a0 00000000 		.word 0                         @ 24
  83 00a4 00000000 		.word 0           @_spi   +1    @ 25
  84 00a8 00000000 		.word 0                         @ 26
  85 00ac 00000000 		.word 0         @_usart1 +1     @ 27
  86              	_start:
  87              	shizhong:
  88 00b0 694A     		ldr r2, = 0x40022000   @FLASH访问控制
  89 00b2 3221     		movs r1, # 0x32
  90 00b4 1160     		str r1, [r2]           @FLASH缓冲 缓冲开启
  91 00b6 6948     	        ldr r0, = 0x40021000 @ rcc
  92 00b8 6949     	        ldr r1, = 0x10001
  93 00ba 0160     	        str r1, [r0]
  94              	denghse:
  95 00bc 0168     	        ldr r1, [r0]
  96 00be 8903     	        lsls r1, r1, # 14
  97 00c0 FCD5     	        bpl denghse
  98              	dengpllguan:
  99 00c2 0168     	        ldr r1, [r0]
 100 00c4 8901     	        lsls r1, r1, # 6
 101 00c6 FCD4     	        bmi dengpllguan
 102 00c8 6649     	        ldr r1, = 0x110002
 103 00ca 4160     	        str r1, [r0, # 0x04]
 104 00cc 6649     	        ldr r1, = 0x1010000
 105 00ce 0000     		movs r0, r0
 106 00d0 0160     	        str r1, [r0]
 107              		
 108              	dengpll:
 109 00d2 0168     		ldr r1, [r0]
 110 00d4 8901     		lsls r1, # 6
 111 00d6 FCD5     		bpl dengpll
 112              		@0x34时钟控制寄存器 2 (RCC_CR2)
 113 00d8 0121     		movs r1, # 0x01
 114 00da 4163     		str r1, [r0, # 0x34]  @ HSI开14M时钟
 115              	dengdai14mshizhongwending:
 116 00dc 416B     		ldr r1, [r0, # 0x34]
 117 00de 8907     		lsls r1, r1, # 30     @ 左移30位
 118 00e0 FCD5     		bpl dengdai14mshizhongwending  @ 等待14M时钟稳定
 119              	
 120              	neicunqingling:
 121 00e2 6248     		ldr r0, = 0x20000000
 122 00e4 0021     		movs r1, # 0
 123 00e6 624B     		ldr r3, = 0x1000
 124              	neicunqinglingxunhuan:
 125 00e8 043B     		subs r3, # 4
 126 00ea C150     		str r1, [r0, r3]
 127 00ec FCD1     		bne neicunqinglingxunhuan
 128              	
 129              	_waisheshizhong:		 @ 外设时钟
 130              		@+0x14=RCC_AHBENR
 131              		@0=DMA @2=SRAM @4=FLITF@6=CRC @17=PA @18=PB @19=PC @20=PD @22=PF
ARM GAS  1.s 			page 4


 132 00ee 5B48     		ldr r0, = 0x40021000
 133 00f0 6049     		ldr r1, = 0x460005
 134 00f2 4161     		str r1, [r0, # 0x14]
 135              	
 136              		@+0x18外设时钟使能寄存器 (RCC_APB2ENR)
 137              		@0=SYSCFG @5=USART6EN @9=ADC @11=TIM1 @12=SPI1 @14=USART1 @16=TIM15 @17=TIM16 @18=TIM17 @22=DBGMCU
 138 00f4 6049     		ldr r1, = 0xa00
 139 00f6 8161     		str r1, [r0, # 0x18]
 140              		@+0X1C=RCC_APB1ENR
 141              		@ 1=TIM3 @ 4=TIM6 @5=TIM7 @8=TIM14 @11=WWDG @14=SPI @17=USRT2 @18=USART3 @20=USART5 @21=I2C1 @22=I
 142 00f8 0221     		movs r1, # 0x02
 143 00fa C161     		str r1, [r0, # 0x1c]
 144              	io_she_zhi:
 145              	@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 146              		@a(0x48000000)b(0x48000400)c(0x48000800)d(0x48000c00)f(0x48001400)
 147              		@ 输入（00），通用输出（01），复用功能（10），模拟（11）
 148              		@偏移0x4 = 端口输出类型 @ （0 推挽），（ 1 开漏）
 149              		@偏移0x8 = 输出速度  00低速， 01中速， 11高速
 150              		@偏移0xC = 上拉下拉 (00无上下拉，  01 上拉， 10下拉)
 151              		@偏移0x10 = 输入数据寄存器
 152              		@偏移0x14 = 输出数据寄存器
 153              		@偏移0x18 = 端口开  0-15置位 
 154              		@偏移0x28 = 端口关
 155              		@0X20 = 复用低
 156              		@GPIO口0（0-3位）每个IO口占用4位
 157              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 158              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 159              		@0x24 = 复用高
 160              		@GPIO口8 （0-3位）每个IO口占用4位
 161              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 162              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 163              	@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 164              	
 165 00fc 5F48     		ldr r0, = 0x48000000
 166 00fe 6049     		ldr r1, = 0x28005403
 167 0100 0160     		str r1, [r0]
 168              	
 169 0102 6049     		ldr r1, = 0x200
 170 0104 4162     		str r1, [r0, # 0x24]
 171              	tim3chushihua:				@ 24M
 172 0106 6048     		ldr r0, = 0x40000400 @ tim3_cr1
 173 0108 6049     		ldr r1, =  0
 174 010a 8162     		str r1, [r0, # 0x28] @ psc
 175 010c 6049     		ldr r1, = 10
 176 010e C162     		str r1, [r0, # 0x2c] @ ARR
 177 0110 6049     		ldr r1, =   0x3800
 178 0112 C161     		str r1, [r0, # 0x1c] @ ccmr2
 179 0114 5649     		ldr r1, =  0x1000
 180 0116 0162     		str r1, [r0, # 0x20] @ ccer
 181 0118 5D49     		ldr r1, = 10
 182 011a 0164     		str r1, [r0, # 0x40] @ ccr4
 183 011c 7021     		movs r1, # 0x70
 184 011e 4160     		str r1, [r0, # 0x04]
 185 0120 8121     		movs r1, # 0x81
 186 0122 0160     		str r1, [r0]
 187              	dmachushihua:
 188              		@+0=LSR,+4=IFCR,
ARM GAS  1.s 			page 5


 189              		@+8=CCR1,+c=CNDTR1,+10=CPAR1+14=CMAR1,
 190              		@+1c=CCR2,+20=CNDTR2,+24=CPAR2,+28=CMAR2
 191              		@+30=CCR3,+34=CNDTR3,+38=CPAR2,+3c=CMAR3
 192              		@+44=CCR4,+48=CNDTR4,+4c=CPAR4,+50=CMAR4
 193              		@+58=CCR5,+5c=CNDTR5,+60=CPAR5,+64=CMAR5
 194              		@+6C=CCR6,+70=CNDTR6,+74=CPAR6,+78=CMAR6
 195              		@+80=CCR7,+84=CNDTR7,+88=CPAR7,+8c=CMAR7
 196              		@ tim1DMA
 197              		@ adc dma
 198 0124 5C48     		ldr r0, = 0x40020000
 199 0126 5D49     		ldr r1, = 0x40012440
 200 0128 0161     		str r1, [r0, # 0x10]
 201 012a 5D49     		ldr r1, = dianyabiao
 202 012c 4161     		str r1, [r0, # 0x14]
 203 012e 5D49     		ldr r1, =  256
 204 0130 C160     		str r1, [r0, # 0x0c]
 205 0132 5D49     		ldr r1, = 0xa81
 206 0134 8160     		str r1, [r0, # 0x08]
 207              		
 208              	
 209              	
 210              	_adcchushihua:
 211 0136 5D48     		ldr r0, = 0x40012400  @ adc基地址
 212 0138 5D49     		ldr r1, = 0x80000000
 213 013a 8160     		str r1, [r0, # 0x08]  @ ADC 控制寄存器 (ADC_CR)  @adc校准
 214              	_dengadcjiaozhun:
 215 013c 8168     		ldr r1, [r0, # 0x08]
 216 013e 0900     		 movs r1, r1
 217 0140 FCD4     		bmi _dengadcjiaozhun   @ 等ADC校准
 218              	_kaiadc:
 219 0142 8168     		ldr r1, [r0, # 0x08]
 220 0144 0122     		movs r2, # 0x01
 221 0146 1143     		orrs r1, r1, r2
 222 0148 8160     		str r1, [r0, # 0x08]
 223              	_dengdaiadcwending:
 224 014a 0168     		ldr r1, [r0]
 225 014c C907     		lsls r1, r1, # 31
 226 014e FCD5     		bpl _dengdaiadcwending @ 等ADC稳定
 227              	_tongdaoxuanze:
 228 0150 5849     		ldr r1, = 0x01
 229 0152 8162     		str r1, [r0, # 0x28]    @ 通道选择寄存器 (ADC_CHSELR)
 230              		@	ldr r1, = 0xcC3         @ tim3触发ADC
 231 0154 5849     		ldr r1, = 0x3003
 232 0156 C160     		str r1, [r0, # 0x0c]    @ 配置寄存器 1 (ADC_CFGR1)
 233 0158 0021     		movs r1, # 0        
 234 015a 4161     		str r1, [r0, # 0x14]    @ ADC 采样时间寄存器 (ADC_SMPR)
 235 015c 8168     		ldr r1, [r0, # 0x08]
 236 015e 574A     		ldr r2, = 0x04         @ 开始转换
 237 0160 1143     		orrs r1, r1, r2
 238 0162 8160     		str r1, [r0, # 0x08]    @ 控制寄存器 (ADC_CR)
 239              	
 240              	
 241              		
 242              	_waishezhongduan:		@外设中断
 243              		@0xE000E100    0-31  写1开，写0没效
 244              		@0XE000E180    0-31 写1关，写0没效
 245              		@0XE000E200    0-31 挂起，写0没效
ARM GAS  1.s 			page 6


 246              		@0XE000E280    0-31 清除， 写0没效
 247              	
 248 0164 5648     		ldr r0, = 0xfffff
 249              	yanshi11:
 250 0166 0138     		subs r0, r0, # 1
 251 0168 FDD1     		bne yanshi11
 252              	
 253              		
 254              	ting:
 255 016a 4D48     		ldr r0, = dianyabiao
 256 016c 00F0B4F8 		bl _fftjisuan
 257 0170 01BE     		bkpt # 1
 258              	neicunqingling1:
 259 0172 3E48     	        ldr r0, = 0x20000000
 260 0174 0021     	        movs r1, # 0
 261 0176 534B     	        ldr r3, = 0x850
 262              	neicunqinglingxunhuan1:
 263 0178 043B     	        subs r3, # 4
 264 017a C150     	        str r1, [r0, r3]
 265 017c FCD1     	        bne neicunqinglingxunhuan1
 266              	
 267 017e F4E7     		b ting
 268              		
 269              	
 270              		
 271              		
 272              	_maopaopaixu:
 273 0180 FFB5     		push {r0-r7,lr}
 274              		@ r0= 表地址, r1= 长度
 275 0182 0F46     		mov r7, r1
 276              	_paixu:
 277 0184 B900     		lsls r1, r7, # 2
 278              	_paixuxunhuan:	
 279 0186 425A     		ldrh r2, [r0, r1]
 280 0188 0239     		subs r1, r1, # 2
 281 018a 06D4     		bmi _paixu1
 282 018c 445A     		ldrh r4, [r0, r1]
 283 018e A242     		cmp r2, r4
 284 0190 F9D9     		bls _paixuxunhuan
 285 0192 4252     		strh r2, [r0, r1]
 286 0194 8B1C     		adds r3, r1, # 2
 287 0196 C452     		strh r4, [r0, r3]
 288 0198 F5E7     		b _paixuxunhuan
 289              	_paixu1:
 290 019a 0230     		adds r0, r0, # 2
 291 019c 013F     		subs r7, r7, # 1
 292 019e F1D1     		bne _paixu
 293 01a0 FFBD     		pop {r0-r7,pc}
 294              	
 295              	_zhuanshumaguanma:@ 16进制转数码管码
 296              			@ R0要转的数据， R1长度，R2结果表首地址
 297 01a2 FFB5     		push {r0-r7,lr}
 298 01a4 484F     		ldr r7, = shumaguanmabiao
 299 01a6 0546     		mov r5, r0
 300 01a8 0E46     		mov r6, r1
 301 01aa 0A21     		movs r1, # 10
 302              	_xunhuanqiuma:
ARM GAS  1.s 			page 7


 303 01ac 00F040F8 		bl _chufa
 304 01b0 0446     		mov r4, r0
 305 01b2 4C43     		muls r4, r1
 306 01b4 2B1B     		subs r3, r5, r4
 307 01b6 9B00     		lsls r3, # 2
 308 01b8 FC58     		ldr r4, [r7, r3]
 309 01ba 1460     		str r4, [r2]
 310 01bc 0546     		mov r5, r0
 311 01be 0432     		adds r2, r2, # 4
 312 01c0 013E     		subs r6, # 1
 313 01c2 F3D1     		bne _xunhuanqiuma
 314 01c4 FFBD     		pop {r0-r7,pc}
 315              	_xieshumaguan: @ r0=位数 @数码管码
 316 01c6 FFB5     		push {r0-r7,lr}
 317 01c8 8000     		lsls r0, r0, # 2
 318 01ca 0027     		movs r7, # 0
 319 01cc 0646     		mov r6, r0
 320 01ce 3F4D     		ldr r5, = shumaguanma
 321 01d0 3F4A     		ldr r2, = shumaguanshuaxinbiao
 322              	_shumaguanshuaxin:
 323 01d2 EB59     		ldr r3, [r5, r7]
 324 01d4 D459     		ldr r4, [r2, r7]
 325 01d6 1C43     		orrs r4, r4, r3
 326 01d8 2046     		mov r0, r4
 327 01da 00F004F8 		bl _xie595
 328 01de 0437     		adds  r7, r7, # 4
 329 01e0 B742     		cmp r7, r6
 330 01e2 F6D9     		bls _shumaguanshuaxin
 331 01e4 FFBD     		pop {r0-r7,pc}
 332              		
 333              	_xie595: @ R0=要写的数据
 334 01e6 FFB5     		push {r0-r7,lr}
 335 01e8 0546     		mov r5, r0
 336 01ea 4020     		movs r0, # 0x40
 337 01ec 8027     		movs r7, # 0x80 
 338 01ee 2026     		movs r6, # 0x20 
 339 01f0 1023     		movs r3, # 16   @16位
 340 01f2 224A     		ldr r2, = 0x48000000 @ gpioa
 341 01f4 0121     		movs r1, # 0x01
 342              	_xunhuan595:
 343 01f6 9761     		str r7, [r2, # 0x18]
 344 01f8 00F014F8 		bl _yanshi
 345 01fc 0D42     		tst r5, r1
 346 01fe 01D1     		bne _xie595_0
 347 0200 9062     		str r0, [r2, # 0x28]
 348 0202 00E0     		b _suocun595
 349              	_xie595_0:
 350 0204 9061     		str r0, [r2, # 0x18]
 351              	_suocun595:
 352 0206 00F00DF8 		bl _yanshi
 353 020a 6D08     		lsrs r5, # 1
 354 020c 9762     		str r7, [r2, # 0x28]
 355 020e 00F009F8 		bl _yanshi
 356 0212 013B     		subs r3, r3, # 1
 357 0214 EFD1     		bne _xunhuan595
 358 0216 9661     		str r6, [r2, # 0x18]
 359 0218 00F004F8 		bl _yanshi
ARM GAS  1.s 			page 8


 360 021c 9662     		str r6, [r2, # 0x28]
 361 021e 00F001F8 		bl _yanshi
 362 0222 FFBD     		pop {r0-r7,pc}
 363              	
 364              	
 365              	_yanshi:
 366 0224 80B4     		push {r7}
 367 0226 2B4F     		ldr r7, = 30
 368              	_yanshi11:
 369 0228 013F     		subs r7, # 1
 370 022a FDD1     		bne _yanshi11
 371 022c 80BC     		pop {r7}
 372 022e 7047     		bx lr
 373              	_chufa:			@软件除法
 374              		@ r0 除以 r1 等于 商(r0)余数R1
 375 0230 1EB5     		push {r1-r4,lr}
 376 0232 0028     		cmp r0, # 0
 377 0234 0ED0     		beq _chufafanhui
 378 0236 0029     		cmp r1, # 0
 379 0238 0CD0     		beq _chufafanhui
 380 023a 0246     		mov r2, r0
 381 023c 0123     		movs r3, # 1
 382 023e DB07     		lsls r3, r3, # 31
 383 0240 0020     		movs r0, # 0
 384 0242 0446     		mov r4, r0
 385              	_chufaxunhuan:
 386 0244 5200     		lsls r2, r2, # 1
 387 0246 6441     		adcs r4, r4, r4
 388 0248 8C42     		cmp r4, r1
 389 024a 01D3     		bcc _chufaweishubudao0
 390 024c C018     		adds r0, r0, r3
 391 024e 641A     		subs r4, r4, r1
 392              	_chufaweishubudao0:
 393 0250 5B08     		lsrs r3, r3, # 1
 394 0252 F7D1     		bne _chufaxunhuan
 395              	_chufafanhui:
 396 0254 1EBD     		pop {r1-r4,pc}
 397 0256 00000020 		.ltorg
 397      02400010 
 397      02400100 
 397      01000200 
 397      11000000 
 398              	
 399              	
 400              		
 401              	_fftjisuan:
 402              					@R0=输入地址
 403              					@输出实部=0X20000000-0X20000400
 404              					@输出虚部=0X20000400-0X20000800
 405 02d8 00B5     		push {lr}
 406              	_fft1:
 407 02da 6749     		ldr r1, = 0x20000000       @输出地址
 408 02dc 8022     		movs r2, # 128             @蝴蝶数量
 409 02de 674B     		ldr r3, = hudieweifanzhuan @蝴蝶位反转表
 410              	_fft1xunhuan:
 411 02e0 1E68     		ldr r6, [r3]               @取出位反转表里的地一个数据
 412 02e2 5F68     		ldr r7, [r3, # 0x04]       @取出第二个
ARM GAS  1.s 			page 9


 413 02e4 8659     		ldr r6, [r0, r6]           @给据位反转表找到对应的输入数据  
 414 02e6 C759     		ldr r7, [r0, r7]           @第二个
 415 02e8 F419     		adds r4, r6, r7            @求出蝴蝶上
 416 02ea F51B     		subs r5, r6, r7            @求出蝴蝶下
 417 02ec 6410     		asrs r4, r4, # 1           @数据缩小一位防后面溢出
 418 02ee 6D10     		asrs r5, r5, # 1           @数据缩小一位
 419 02f0 0C60     		str r4, [r1]
 420 02f2 4D60     		str r5, [r1, # 0x04]       @把反过来的顺序排列
 421 02f4 0831     		adds r1, r1, # 0x08        @输出的地址自增
 422 02f6 0833     		adds r3, r3, # 0x08        @反转表自增
 423 02f8 013A     		subs r2, r2, # 1           @蝴蝶数减1
 424 02fa F1D1     		bne _fft1xunhuan           @蝴蝶数不到
 425              	
 426              	_fft2:
 427 02fc 5E48     		ldr r0, = 0x20000000       @实部输出地址
 428 02fe 0124     		movs r4, # 1               
 429 0300 A402     		lsls r4, r4, # 10          
 430 0302 2418     		adds r4, r4, r0            @虚部输出地址
 431 0304 A046     		mov r8, r4                 @实部和虚部中间
 432              	_fft2xunhuan:
 433 0306 0468     		ldr r4, [r0]               @取出数据0
 434 0308 8568     		ldr r5, [r0, # 0x08]       @取出数据2
 435 030a 4668     		ldr r6, [r0, # 0x04]       @取出数据1
 436 030c C768     		ldr r7, [r0, # 0x0c]       @取出数据3
 437 030e 6119     		adds r1, r4, r5            @计算蝴蝶上
 438 0310 621B     		subs r2, r4, r5            @计算蝴蝶下
 439 0312 3346     		mov r3, r6		@0r 蝴蝶上实部
 440 0314 0024     		movs r4, # 0
 441 0316 E41B     		subs r4, r4, r7		@0i 蝴蝶上虚部
 442 0318 3546     		mov r5, r6		@3r 蝴蝶下实部
 443 031a 3E46     		mov r6, r7		@3i 蝴蝶下虚部
 444 031c 0127     		movs r7, # 1
 445 031e BF02     		lsls r7, r7, # 10       @内存实部和虚部中间
 446 0320 3F18     		adds r7, r7, r0         @R7等于虚部首地址  
 447 0322 0160     		str r1, [r0]            @蝴蝶上保存实部
 448 0324 8260     		str r2, [r0, # 0x08]    @蝴蝶下实部
 449 0326 4360     		str r3, [r0, # 0x04]    @第二组蝴蝶上实部
 450 0328 7C60     		str r4, [r7, # 0x04]    @第二组蝴蝶上虚部
 451 032a C560     		str r5, [r0, # 0x0c]	@第二组蝴蝶下实部
 452 032c FE60     		str r6, [r7, # 0x0c]    @第二组下虚部
 453 032e 1030     		adds r0, r0, # 0x10     @蝴蝶组自增
 454 0330 4045     		cmp r0, r8     
 455 0332 E8D1     		bne _fft2xunhuan        @地址不到循环
 456              	_fft3:
 457 0334 524E     		ldr r6, = xuanzhuanyinzi       @旋转因子自增变量
 458 0336 534A     		ldr r2, = fft3xuanzhuanyinzi   @旋转因子第三部的表
 459 0338 4F48     		ldr r0, = 0x20000000           @实部输出地址
 460 033a 3260     		str r2, [r6]                   @旋转因子表首地址写到变量
 461 033c 0121     		movs r1, # 1
 462 033e 8902     		lsls r1, r1, # 10             
 463 0340 0918     		adds r1, r1, r0                @虚部输出地址
 464 0342 8846     		mov r8, r1		       @R8虚部地址自增变量
 465 0344 8146     		mov r9, r0                     @R9实部地址自增变量
 466 0346 9246     		mov r10, r2		       @旋转因子地址写到R10
 467 0348 1025     		movs r5, # 0x10		       @两组蝴蝶的距离	
 468 034a AB46     		mov r11, r5                    @写到R11
 469 034c 0425     		movs r5, # 4                   @旋转因子数量
ARM GAS  1.s 			page 10


 470 034e AC46     		mov r12, r5		       @旋转因子数量写到R12
 471 0350 00F053F8 		bl _fftg
 472              	_fft4:
 473 0354 4A4E     		ldr r6, = xuanzhuanyinzi
 474 0356 4C4A     		ldr r2, = fft4xuanzhuanyinzi
 475 0358 4748     		ldr r0, = 0x20000000
 476 035a 3260     		str r2, [r6]
 477 035c 0121     		movs r1, # 1
 478 035e 8902     		lsls r1, r1, # 10
 479 0360 0918     		adds r1, r1, r0
 480 0362 8846     		mov r8, r1
 481 0364 8146     		mov r9, r0
 482 0366 9246     		mov r10, r2
 483 0368 2025     		movs r5, # 0x20
 484 036a AB46     		mov r11, r5
 485 036c 0825     		movs r5, # 8
 486 036e AC46     		mov r12, r5
 487 0370 00F043F8 		bl _fftg
 488              	_fft5:
 489 0374 424E     		ldr r6, = xuanzhuanyinzi
 490 0376 454A     		ldr r2, = fft5xuanzhuanyinzi
 491 0378 3F48     		ldr r0, = 0x20000000
 492 037a 3260     		str r2, [r6]
 493 037c 0121     		movs r1, # 1
 494 037e 8902     		lsls r1, r1, # 10
 495 0380 0918     		adds r1, r1, r0
 496 0382 8846     		mov r8, r1
 497 0384 8146     		mov r9, r0
 498 0386 9246     		mov r10, r2
 499 0388 4025     		movs r5, # 0x40
 500 038a AB46     		mov r11, r5
 501 038c 1025     		movs r5, # 16
 502 038e AC46     		mov r12, r5
 503 0390 00F033F8 		bl _fftg
 504              	
 505              	_fft6:
 506 0394 3A4E     		ldr r6, = xuanzhuanyinzi
 507 0396 3E4A     		ldr r2, = fft6xuanzhuanyinzi
 508 0398 3748     		ldr r0, = 0x20000000
 509 039a 3260     		str r2, [r6]
 510 039c 0121     		movs r1, # 1
 511 039e 8902     		lsls r1, r1, # 10
 512 03a0 0918     		adds r1, r1, r0
 513 03a2 8846     		mov r8, r1
 514 03a4 8146     		mov r9, r0
 515 03a6 9246     		mov r10, r2
 516 03a8 8025     		movs r5, # 0x80
 517 03aa AB46     		mov r11, r5
 518 03ac 2025     		movs r5, # 32
 519 03ae AC46     		mov r12, r5
 520 03b0 00F023F8 		bl _fftg
 521              	
 522              	_fft7:
 523 03b4 324E     		ldr r6, = xuanzhuanyinzi
 524 03b6 374A     		ldr r2, = fft7xuanzhuanyinzi
 525 03b8 2F48     		ldr r0, = 0x20000000
 526 03ba 3260     		str r2, [r6]
ARM GAS  1.s 			page 11


 527 03bc 0121     		movs r1, # 1
 528 03be 8902     		lsls r1, r1, # 10
 529 03c0 0918     		adds r1, r1, r0
 530 03c2 8846     		mov r8, r1
 531 03c4 8146     		mov r9, r0
 532 03c6 9246     		mov r10, r2
 533 03c8 0125     		movs r5, # 1
 534 03ca 2D02     		lsls r5, r5, # 8
 535 03cc AB46     		mov r11, r5
 536 03ce 4025     		movs r5, # 64
 537 03d0 AC46     		mov r12, r5
 538 03d2 00F012F8 		bl _fftg
 539              	
 540              	_fft8:
 541 03d6 2A4E     		ldr r6, = xuanzhuanyinzi
 542 03d8 2F4A     		ldr r2, = fft8xuanzhuanyinzi
 543 03da 2748     		ldr r0, = 0x20000000
 544 03dc 3260     		str r2, [r6]
 545 03de 0121     		movs r1, # 1
 546 03e0 8902     		lsls r1, r1, # 10
 547 03e2 0918     		adds r1, r1, r0
 548 03e4 8846     		mov r8, r1
 549 03e6 8146     		mov r9, r0
 550 03e8 9246     		mov r10, r2
 551 03ea 0125     		movs r5, # 1
 552 03ec 6D02     		lsls r5, r5, # 9
 553 03ee AB46     		mov r11, r5
 554 03f0 8025     		movs r5, # 128
 555 03f2 AC46     		mov r12, r5
 556 03f4 00F001F8 		bl _fftg
 557              	
 558              	
 559 03f8 00BD     		pop {pc}
 560              	_fftg:
 561 03fa 00B5     		push {lr}
 562 03fc 0024     		movs r4, # 0
 563 03fe A646     		mov lr, r4
 564              	_fftxunhuan:
 565 0400 4846     		mov r0, r9
 566 0402 4146     		mov r1, r8
 567 0404 5246     		mov r2, r10
 568 0406 5B46     		mov r3, r11
 569 0408 0468     		ldr r4, [r0]
 570 040a 0D68     		ldr r5, [r1]
 571 040c C658     		ldr r6, [r0, r3]
 572 040e CF58     		ldr r7, [r1, r3]
 573 0410 1368     		ldr r3, [r2]		@sr
 574 0412 5268     		ldr r2, [r2, # 0x04]	@si
 575 0414 30B4     		push {r4,r5}
 576 0416 3446     		mov r4, r6
 577 0418 5C43     		muls r4, r4, r3
 578 041a 3D46     		mov r5, r7
 579 041c 5543     		muls r5, r5, r2
 580 041e 641B     		subs r4, r4, r5		@r
 581 0420 E413     		asrs r4, r4, # 15
 582 0422 3546     		mov r5, r6
 583 0424 5543     		muls r5, r5, r2
ARM GAS  1.s 			page 12


 584 0426 5F43     		muls r7, r7, r3
 585 0428 7F19     		adds r7, r7, r5    @i
 586 042a FF13     		asrs r7, r7, # 15
 587 042c 24BC     		pop {r2,r5}
 588 042e 1319     		adds r3, r2, r4    @0r
 589 0430 121B     		subs r2, r2, r4    @1r
 590 0432 EC19     		adds r4, r5, r7
 591 0434 ED1B     		subs r5, r5, r7
 592 0436 5E46     		mov r6, r11
 593 0438 0360     		str r3, [r0]
 594 043a 0C60     		str r4, [r1]
 595 043c 8251     		str r2, [r0, r6]
 596 043e 8D51     		str r5, [r1, r6]
 597 0440 0430     		adds r0, r0, # 0x04
 598 0442 0431     		adds r1, r1, # 0x04
 599 0444 8146     		mov r9, r0
 600 0446 8846     		mov r8, r1
 601 0448 5246     		mov r2, r10
 602 044a 0832     		adds r2, r2, # 0x08
 603 044c 9246     		mov r10, r2
 604 044e 7446     		mov r4, lr		@取出旋转因子自增变量
 605 0450 0134     		adds r4, r4, # 1        @自增
 606 0452 A646     		mov lr, r4              @保存回去
 607 0454 6746     		mov r7, r12             @取出旋转因子总数量
 608 0456 BC42     		cmp r4, r7              @到没到数量
 609 0458 D2D1     		bne _fftxunhuan         @没到继续循环
 610 045a 0024     		movs  r4, # 0
 611 045c 084E     		ldr r6, = xuanzhuanyinzi
 612 045e 0F4D     		ldr r5, = 0x20000400
 613 0460 3668     		ldr r6, [r6]
 614 0462 B246     		mov r10, r6
 615 0464 A646     		mov lr, r4
 616 0466 5F46     		mov r7, r11
 617 0468 C019     		adds r0, r0, r7
 618 046a C919     		adds r1, r1, r7
 619 046c 8146     		mov r9, r0
 620 046e 8846     		mov r8, r1
 621 0470 A842     		cmp r0, r5
 622 0472 C5D1     		bne _fftxunhuan
 623 0474 00BD     		pop {pc}
 624 0476 00000000 		.ltorg
 624      00204C04 
 624      00000008 
 624      00204C08 
 624      00006C08 
 625              		
 626              	_nmi_handler:
 627 04a0 7047     		bx lr
 628              	_hard_fault:
 629 04a2 7047     		bx lr
 630              	_svc_handler:
 631 04a4 7047     		bx lr
 632              	_pendsv_handler:
 633 04a6 7047     		bx lr
ARM GAS  1.s 			page 13


DEFINED SYMBOLS
                 1.s:9      .data:0000000000000000 shumaguanmabiao
                 1.s:11     .data:0000000000000028 shumaguanshuaxinbiao
                 1.s:13     *ABS*:0000000020001000 STACKINIT
                 1.s:14     *ABS*:0000000020000804 shumaguanma
                 1.s:15     *ABS*:0000000020000800 xuanzhuanyinzi
                 1.s:16     .data:000000000000004c dianyabiao
                 1.s:18     .data:000000000000044c hudieweifanzhuan
                 1.s:21     .data:000000000000084c fft3xuanzhuanyinzi
                 1.s:23     .data:000000000000086c fft4xuanzhuanyinzi
                 1.s:25     .data:00000000000008ac fft5xuanzhuanyinzi
                 1.s:27     .data:000000000000092c fft6xuanzhuanyinzi
                 1.s:29     .data:0000000000000a2c fft7xuanzhuanyinzi
                 1.s:32     .data:0000000000000c2c fft8xuanzhuanyinzi
                 1.s:41     .text:0000000000000000 vectors
                 1.s:86     .text:00000000000000b0 _start
                 1.s:626    .text:00000000000004a0 _nmi_handler
                 1.s:628    .text:00000000000004a2 _hard_fault
                 1.s:630    .text:00000000000004a4 _svc_handler
                 1.s:632    .text:00000000000004a6 _pendsv_handler
                 1.s:87     .text:00000000000000b0 shizhong
                            .text:0000000000000000 $d
                 1.s:88     .text:00000000000000b0 $t
                 1.s:94     .text:00000000000000bc denghse
                 1.s:98     .text:00000000000000c2 dengpllguan
                 1.s:108    .text:00000000000000d2 dengpll
                 1.s:115    .text:00000000000000dc dengdai14mshizhongwending
                 1.s:120    .text:00000000000000e2 neicunqingling
                 1.s:124    .text:00000000000000e8 neicunqinglingxunhuan
                 1.s:129    .text:00000000000000ee _waisheshizhong
                 1.s:144    .text:00000000000000fc io_she_zhi
                 1.s:171    .text:0000000000000106 tim3chushihua
                 1.s:187    .text:0000000000000124 dmachushihua
                 1.s:210    .text:0000000000000136 _adcchushihua
                 1.s:214    .text:000000000000013c _dengadcjiaozhun
                 1.s:218    .text:0000000000000142 _kaiadc
                 1.s:223    .text:000000000000014a _dengdaiadcwending
                 1.s:227    .text:0000000000000150 _tongdaoxuanze
                 1.s:242    .text:0000000000000164 _waishezhongduan
                 1.s:249    .text:0000000000000166 yanshi11
                 1.s:254    .text:000000000000016a ting
                 1.s:401    .text:00000000000002d8 _fftjisuan
                 1.s:258    .text:0000000000000172 neicunqingling1
                 1.s:262    .text:0000000000000178 neicunqinglingxunhuan1
                 1.s:272    .text:0000000000000180 _maopaopaixu
                 1.s:276    .text:0000000000000184 _paixu
                 1.s:278    .text:0000000000000186 _paixuxunhuan
                 1.s:289    .text:000000000000019a _paixu1
                 1.s:295    .text:00000000000001a2 _zhuanshumaguanma
                 1.s:302    .text:00000000000001ac _xunhuanqiuma
                 1.s:373    .text:0000000000000230 _chufa
                 1.s:315    .text:00000000000001c6 _xieshumaguan
                 1.s:322    .text:00000000000001d2 _shumaguanshuaxin
                 1.s:333    .text:00000000000001e6 _xie595
                 1.s:342    .text:00000000000001f6 _xunhuan595
                 1.s:365    .text:0000000000000224 _yanshi
                 1.s:349    .text:0000000000000204 _xie595_0
ARM GAS  1.s 			page 14


                 1.s:351    .text:0000000000000206 _suocun595
                 1.s:368    .text:0000000000000228 _yanshi11
                 1.s:395    .text:0000000000000254 _chufafanhui
                 1.s:385    .text:0000000000000244 _chufaxunhuan
                 1.s:392    .text:0000000000000250 _chufaweishubudao0
                 1.s:397    .text:0000000000000256 $d
                 1.s:397    .text:0000000000000258 $d
                 1.s:405    .text:00000000000002d8 $t
                 1.s:406    .text:00000000000002da _fft1
                 1.s:410    .text:00000000000002e0 _fft1xunhuan
                 1.s:426    .text:00000000000002fc _fft2
                 1.s:432    .text:0000000000000306 _fft2xunhuan
                 1.s:456    .text:0000000000000334 _fft3
                 1.s:560    .text:00000000000003fa _fftg
                 1.s:472    .text:0000000000000354 _fft4
                 1.s:488    .text:0000000000000374 _fft5
                 1.s:505    .text:0000000000000394 _fft6
                 1.s:522    .text:00000000000003b4 _fft7
                 1.s:540    .text:00000000000003d6 _fft8
                 1.s:564    .text:0000000000000400 _fftxunhuan
                 1.s:624    .text:0000000000000476 $d
                 1.s:624    .text:0000000000000478 $d
                 1.s:627    .text:00000000000004a0 $t

NO UNDEFINED SYMBOLS
