ARM GAS  1.s 			page 1


   1              		@@单片机stm32f030f4p6
   2              		@@ 高频阻抗测量
   3              		@作者：yjmwxwx
   4              		@时间：2019-06-30
   5              		@编译器：ARM-NONE-EABI
   6              		 .thumb
   7              		         .syntax unified
   8              		.section .data
   9              		.align 4
  10              	shumaguanmabiao:
  11 0000 FC000000 		.int 0xfc,0x60,0xda,0xf2,0x66,0xb6,0xbe,0xe0,0xfe,0xf6
  11      60000000 
  11      DA000000 
  11      F2000000 
  11      66000000 
  12              	shumaguanshuaxinbiao:
  13 0028 00FE0000 		.int 0xfe00,0xfd00,0xfb00,0xf700,0xef00,0xdf00,0xbf00,0x7f00,0
  13      00FD0000 
  13      00FB0000 
  13      00F70000 
  13      00EF0000 
  14              	xuanzhuanyinzi:
  15 004c 00800000 		.int 0x8000,0x0000,0x7FF6,0xFFFFFCDC,0x7FD8,0xFFFFF9B9,0x7FA7,0xFFFFF696,0x7F62,0xFFFFF375,0x7F09,
  15      00000000 
  15      F67F0000 
  15      DCFCFFFF 
  15      D87F0000 
  16              	yjmwxwx:
  17              		.equ STACKINIT,        	        0x20001000
  18              		.equ shumaguanma,		0x20000000
  19              		.equ fuhao,			0x20000010
  20              		.equ dmawan,			0x200000f4
  21              		.equ jishu2,			0x200000f8
  22              		.equ jishu,			0x200000fc
  23              		.equ shibu,			0x20000120
  24              		.equ xubu,			0x20000128
  25              		.equ shibuhuanchong,		0x20000140
  26              		.equ lvboqizhizhen,		0x20000150
  27              		.equ lvboqihuanchong,		0x20000154
  28              		.equ dianyabiaoman,		0x200001fc
  29              		.equ dianyabiao,		0x20000200
  30              		.section .text
  31              	vectors:
  32 0000 00100020 		.word STACKINIT
  33 0004 B1000000 		.word _start + 1
  34 0008 D7030000 		.word _nmi_handler + 1
  35 000c D9030000 		.word _hard_fault  + 1
  36 0010 00000000 		.word 0
  37 0014 00000000 		.word 0
  38 0018 00000000 		.word 0
  39 001c 00000000 		.word 0
  40 0020 00000000 		.word 0
  41 0024 00000000 		.word 0
  42 0028 00000000 		.word 0
  43 002c DB030000 		.word _svc_handler +1
  44 0030 00000000 		.word 0
  45 0034 00000000 		.word 0
ARM GAS  1.s 			page 2


  46 0038 DD030000 		.word _pendsv_handler +1
  47 003c F1030000 		.word _systickzhongduan +1               @ 15
  48 0040 DF030000 		.word aaa +1           @ _wwdg +1          	@ 0
  49 0044 DF030000 		.word aaa +1           @_pvd +1            	@ 1
  50 0048 DF030000 		.word aaa +1           @_rtc +1            	@ 2
  51 004c DF030000 		.word aaa +1           @_flash +1          	@ 3
  52 0050 DF030000 		.word aaa +1	       @ _rcc + 1          	@ 4
  53 0054 DF030000 		.word aaa +1           @_exti0_1  +1      	@ 5
  54 0058 DF030000 		.word aaa +1           @ _exti2_3 +1      	@ 6
  55 005c DF030000 		.word aaa +1           @_exti4_15 +1     	@ 7
  56 0060 DF030000 		.word aaa +1                         		@ 8
  57 0064 03040000 		.word __dma_wan  +1  		      		@ 9
  58 0068 DF030000 		.word aaa +1	       @_dma1_2_3 +1        	@ 10
  59 006c DF030000 		.word aaa +1	       @ _dma1_4_5 +1	        @ 11
  60 0070 DF030000 		.word aaa +1	       @_adc1 +1          	@ 12
  61 0074 DF030000 		.word aaa +1           @_tim1_brk_up +1  	@ 13
  62 0078 DF030000 		.word aaa +1           @ _tim1_cc +1            @ 14
  63 007c DF030000 		.word aaa +1           @_tim2 +1      	        @ 15
  64 0080 E1030000 		.word _tim3 +1                             	@ 16
  65 0084 DF030000 		.word aaa +1                                    @ 17
  66 0088 DF030000 		.word aaa +1		                	@ 18
  67 008c DF030000 		.word aaa +1	       @_tim14 +1   	        @ 19
  68 0090 DF030000 		.word aaa +1                         		@ 20
  69 0094 DF030000 		.word aaa +1           @_tim16 +1      		@ 21
  70 0098 DF030000 		.word aaa +1           @_tim17 +1      		@ 22
  71 009c DF030000 		.word aaa +1           @_i2c   +1     		@ 23
  72 00a0 DF030000 		.word aaa +1                         		@ 24
  73 00a4 DF030000 		.word aaa +1           @_spi   +1    		@ 25
  74 00a8 DF030000 		.word aaa +1                         		@ 26
  75 00ac DF030000 		.word aaa +1           @_usart1 +1     		@ 27
  76              		.align 2
  77              	
  78              	_start:
  79              	shizhong:
  80 00b0 E74A     	        ldr r2, = 0x40022000   @FLASH访问控制
  81 00b2 3221     	        movs r1, # 0x32
  82 00b4 1160     	        str r1, [r2]           @FLASH缓冲 缓冲开启
  83 00b6 E748     	        ldr r0, = 0x40021000 @ rcc
  84 00b8 E749     		ldr r1, = 0x10001
  85 00ba 0160     	        str r1, [r0]
  86              	denghse:
  87 00bc 0168     	        ldr r1, [r0]
  88 00be 8903     	        lsls r1, r1, # 14
  89 00c0 FCD5     	        bpl denghse
  90              	dengpllguan:
  91 00c2 0168     	        ldr r1, [r0]
  92 00c4 8901     		lsls r1, r1, # 6
  93 00c6 FCD4     		bmi dengpllguan
  94 00c8 E449     		ldr r1, = 0x150002
  95 00ca 0046     		mov r0, r0
  96 00cc 4160     		str r1, [r0, # 0x04]
  97 00ce 0046     		mov r0, r0
  98 00d0 E349     		ldr r1, = 0x1010000
  99 00d2 0046     		mov r0, r0
 100 00d4 0160     		str r1, [r0]
 101              	
 102              	dengpll:
ARM GAS  1.s 			page 3


 103 00d6 0168     	        ldr r1, [r0]
 104 00d8 8901     		lsls r1, # 6
 105 00da FCD5     		bpl dengpll
 106              	
 107 00dc E149     		ldr r1, = 100
 108 00de 0163     		str r1, [r0, # 0x30]
 109              	
 110              	neicunqingling:
 111 00e0 E148     		ldr r0, = 0x20000000
 112 00e2 0021     		movs r1, # 0
 113 00e4 E14B     		ldr r3, = 0x1000
 114              	neicunqinglingxunhuan:
 115 00e6 043B     		subs r3, # 4
 116 00e8 C150     		str r1, [r0, r3]
 117 00ea FCD1     		bne neicunqinglingxunhuan
 118              		
 119              	_waisheshizhong:			 @ 外设时钟
 120              		@+0x14=RCC_AHBENR
 121              		@ 0=DMA @ 2=SRAM @ 4=FLITF@ 6=CRC @ 17=PA @ 18=PB @ 19=PC @ 20=PD @ 22=PF
 122 00ec D948     		ldr r0, = 0x40021000
 123 00ee E049     		ldr r1, = 0x60001
 124 00f0 4161     		str r1, [r0, # 0x14]
 125              	
 126              		@+0x18外设时钟使能寄存器 (RCC_APB2ENR)
 127              		@0=SYSCFG @5=USART6EN @9=ADC @11=TIM1 @12=SPI1 @14=USART1 @16=TIM15 @17=TIM16 @18=TIM17 @22=DBGMCU
 128 00f2 E049     		ldr r1, = 0xa00
 129 00f4 8161     		str r1, [r0, # 0x18]
 130              		@+0X1C=RCC_APB1ENR
 131              		@ 1=TIM3 @ 4=TIM6 @ 5=TIM7 @ 8=TIM14 @ 11=WWDG @ 14=SPI @ 17=USRT2 @ 18=USART3 @ 20=USART5 @ 21=I2
 132              		@ 22=I2C2 @ 23=USB @ 28=PWR
 133 00f6 E04A     		ldr r2, = 0x102
 134 00f8 C261     		str r2, [r0, # 0x1c]
 135              	
 136              	_waishezhongduan:				@外设中断
 137              		@0xE000E100    0-31  写1开，写0没效
 138              		@0XE000E180    0-31 写1关，写0没效
 139              		@0XE000E200    0-31 挂起，写0没效
 140              		@0XE000E280    0-31 清除， 写0没效
 141              	
 142 00fa E048     		ldr r0, =  0xe000e100
 143 00fc E049     		ldr r1, = 0x200 @0x10200  @ 0x10000
 144 00fe 0160     		str r1, [r0]
 145              	
 146              	
 147              	_adcchushihua:
 148 0100 E048     	        ldr r0, = 0x40012400  @ adc基地址
 149 0102 E149     	        ldr r1, = 0x80000000
 150 0104 8160     	        str r1, [r0, # 0x08]  @ ADC 控制寄存器 (ADC_CR)  @adc校准
 151              	_dengadcjiaozhun:
 152 0106 8168     	        ldr r1, [r0, # 0x08]
 153 0108 0900     	        movs r1, r1
 154 010a FCD4     	        bmi _dengadcjiaozhun   @ 等ADC校准
 155              	_kaiadc:
 156 010c 8168     	        ldr r1, [r0, # 0x08]
 157 010e 0122     	        movs r2, # 0x01
 158 0110 1143     	        orrs r1, r1, r2
 159 0112 8160     	        str r1, [r0, # 0x08]
ARM GAS  1.s 			page 4


 160              	_dengdaiadcwending:
 161 0114 0168     	        ldr r1, [r0]
 162 0116 C907     	        lsls r1, r1, # 31
 163 0118 FCD5     	         bpl _dengdaiadcwending @ 等ADC稳定
 164              	_tongdaoxuanze:
 165 011a DB49     	        ldr r1, = 0x80000000
 166 011c 0161     	        str r1, [r0, # 0x10]
 167 011e DB49     	        ldr r1, = 0x63
 168 0120 8162     	        str r1, [r0, # 0x28]    @ 通道选择寄存器 (ADC_CHSELR)
 169 0122 DB49     	        ldr r1, = 0x8c3 @0x2003 @0x8c3
 170 0124 C160     	        str r1, [r0, # 0x0c]    @ 配置寄存器 1 (ADC_CFGR1)
 171 0126 0021     	        movs r1, # 0
 172 0128 4161     		str r1, [r0, # 0x14]    @ ADC 采样时间寄存器 (ADC_SMPR)
 173 012a 8168     	        ldr r1, [r0, # 0x08]
 174 012c D94A     	        ldr r2, = 0x04         @ 开始转换
 175 012e 1143     		orrs r1, r1, r2
 176 0130 8160     	        str r1, [r0, # 0x08]    @ 控制寄存器 (ADC_CR)
 177              	
 178              	dmachushihua:
 179              	        @+0=LSR,+4=IFCR,
 180              	        @+8=CCR1,+c=CNDTR1,+10=CPAR1+14=CMAR1,
 181              	        @+1c=CCR2,+20=CNDTR2,+24=CPAR2,+28=CMAR2
 182              	        @+30=CCR3,+34=CNDTR3,+38=CPAR2,+3c=CMAR3
 183              	        @+44=CCR4,+48=CNDTR4,+4c=CPAR4,+50=CMAR4
 184              	        @+58=CCR5,+5c=CNDTR5,+60=CPAR5,+64=CMAR5
 185              	        @+6C=CCR6,+70=CNDTR6,+74=CPAR6,+78=CMAR6
 186              	        @+80=CCR7,+84=CNDTR7,+88=CPAR7,+8c=CMAR7
 187              	
 188              		@ adc dma
 189 0132 D948     		ldr r0, = 0x40020000
 190 0134 D949     		ldr r1, = 0x40012440
 191 0136 0161     		str r1, [r0, # 0x10]
 192 0138 D949     		ldr r1, = 0x20000200
 193 013a 4161     		str r1, [r0, # 0x14]
 194 013c D049     		ldr r1, =  512
 195 013e C160     		str r1, [r0, # 0x0c]
 196 0140 D849     		ldr r1, = 0x583 	@ 5a1
 197 0142 8160     		str r1, [r0, # 0x08]
 198              	
 199              	
 200              	tim1chushiha:				
 201 0144 D84D     		ldr r5, = 0x40012c00 @ tim1_cr1
 202 0146 D949     		ldr r1, = 0
 203 0148 A962     		str r1, [r5, # 0x28] @ psc
 204 014a D949     		ldr r1, = 1
 205 014c E962     		str r1, [r5, # 0x2c] @ ARR
 206 014e D949     		ldr r1, = 0x38
 207 0150 E961     		str r1, [r5, # 0x1c] @ ccmr2  CC3
 208 0152 D949     		ldr r1, = 0x100    @  CC3
 209 0154 2962     		str r1, [r5, # 0x20] @ ccer
 210 0156 D949     		ldr r1, = 0x8000
 211 0158 6964     		str r1, [r5, # 0x44] @ BDTR
 212 015a D549     		ldr r1, = 1
 213 015c E963     		str r1, [r5, # 0x3c]
 214 015e E124     		movs r4, # 0xe1
 215              	
 216              	tim3chushihua:				
ARM GAS  1.s 			page 5


 217 0160 D748     		ldr r0, = 0x40000400 @ tim3_cr1
 218 0162 D249     		ldr r1, = 0
 219 0164 8162     		str r1, [r0, # 0x28] @ psc
 220 0166 D749     		ldr r1, = 279
 221 0168 C162     		str r1, [r0, # 0x2c] @ ARR
 222 016a D749     		ldr r1, =  0x3800 @ 0x3800
 223 016c C161     		str r1, [r0, # 0x1c] @ ccmr2
 224 016e BF49     		ldr r1, =  0x1000
 225 0170 0162     		str r1, [r0, # 0x20] @ ccer
 226 0172 D449     		ldr r1, = 279
 227 0174 0164     		str r1, [r0, # 0x40] @ ccr4
 228 0176 7021     		movs r1, # 0x70
 229 0178 4160     		str r1, [r0, # 0x04]
 230              		@movs r1, # 0x01
 231              		@str r1, [r0, # 0x0c]
 232 017a E121     		movs r1, # 0xe1
 233 017c 0160     		str r1, [r0]
 234 017e 2C60     		str r4, [r5]
 235              	@_systick:				@ systick定时器初始化
 236              	@
 237              	@	ldr r0, = 0xe000e010
 238              	@	ldr r1, = 4800000
 239              	@	str r1, [r0, # 4]
 240              	@	str r1, [r0, # 8]
 241              	@	movs r1, # 0x07
 242              	@	str r1, [r0]
 243              	io_she_zhi:
 244              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 245              		@a(0x48000000)b(0x48000400)c(0x48000800)d(0x48000c00)f(0x48001400)
 246              		@ 输入（00），通用输出（01），复用功能（10），模拟（11）
 247              		@偏移0x4 = 端口输出类型 @ （0 推挽），（ 1 开漏）
 248              		@偏移0x8 = 输出速度  00低速， 01中速， 11高速
 249              		@偏移0xC = 上拉下拉 (00无上下拉，  01 上拉， 10下拉)
 250              		@偏移0x10 = 输入数据寄存器
 251              		@偏移0x14 = 输出数据寄存器
 252              		@偏移0x18 = 端口开  0-15置位
 253              		@偏移0x28 = 端口关
 254              		@0X20 = 复用低
 255              		@GPIO口0（0-3位）每个IO口占用4位
 256              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 257              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 258              		@0x24 = 复用高
 259              		@GPIO口8 （0-3位）每个IO口占用4位
 260              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 261              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 262              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 263              	
 264 0180 D248     		ldr r0, = 0x48000000
 265 0182 D349     		ldr r1, = 0x28203d5f
 266 0184 0160     		str r1, [r0]
 267 0186 BE49     		ldr r1, = 0x200
 268 0188 4162     		str r1, [r0, # 0x24]
 269              	
 270              	ting:
 271 018a D248     		ldr r0, = jishu
 272 018c D249     		ldr r1, = 0x800
 273 018e 0268     		ldr r2, [r0]
ARM GAS  1.s 			page 6


 274 0190 0132     		adds r2, r2, # 1
 275 0192 0260     		str r2, [r0]
 276 0194 8A42     		cmp r2, r1
 277 0196 09D1     		bne __xianshi
 278 0198 0022     		movs r2, # 0
 279 019a 0260     		str r2, [r0]
 280              	dd:	
 281 019c CF48     		ldr r0, = dianyabiaoman
 282 019e 0168     		ldr r1, [r0]
 283 01a0 0129     		cmp r1, # 1
 284 01a2 03D1     		bne __xianshi
 285 01a4 0021     		movs r1, # 0
 286 01a6 0160     		str r1, [r0]
 287 01a8 00F016F8 		bl __dft
 288              	__xianshi:
 289 01ac CC48     		ldr r0, = shibu
 290 01ae 0068     		ldr r0, [r0]
 291              	       @ mov r3, r0
 292              		@ldr r0, = lvboqihuanchong
 293              		@ldr r1, = 32
 294              	        @ldr r2, = lvboqizhizhen
 295              	        @bl _lvboqi
 296 01b0 0000     		movs r0, r0
 297 01b2 05D5     		bpl __shu_ma_guan_xian_shi
 298 01b4 C043     		mvns r0, r0
 299 01b6 0130     		adds r0, r0, # 1
 300 01b8 CA4A     		ldr r2, = fuhao
 301 01ba 0023     		movs r3, # 0
 302 01bc 1360     		str r3, [r2]
 303 01be 02E0     		b __led_xian_shi
 304              	__shu_ma_guan_xian_shi:
 305 01c0 C84B     		ldr r3, = fuhao
 306 01c2 0222     		movs r2, # 0x02
 307 01c4 1A60     		str r2, [r3]
 308              	__led_xian_shi:	
 309 01c6 0421     		movs r1, # 4
 310 01c8 A74A     	        ldr r2, = shumaguanma
 311 01ca FF23     		movs r3, # 0xff		@小数点位置
 312 01cc 00F064F8 	        bl _zhuanshumaguanma
 313 01d0 0520     		movs r0, # 5
 314 01d2 00F078F8 	        bl _xieshumaguan
 315 01d6 D8E7     		b ting
 316              	
 317              	__dft:
 318 01d8 FFB5     		push {r0-r7,lr}
 319 01da 4046     		mov r0, r8
 320 01dc 4946     		mov r1, r9
 321 01de 5246     		mov r2, r10
 322 01e0 5B46     		mov r3, r11
 323 01e2 6446     		mov r4, r12
 324 01e4 1FB4     		push {r0-r4}
 325 01e6 AE48     		ldr r0, = dianyabiao
 326 01e8 BF49     		ldr r1, = xuanzhuanyinzi
 327 01ea 0122     		movs r2, # 1
 328 01ec D202     		lsls r2, r2, # 11
 329 01ee 9046     		mov r8, r2
 330 01f0 0023     		movs r3, # 0
ARM GAS  1.s 			page 7


 331 01f2 9B46     		mov r11, r3
 332 01f4 9C46     		mov r12, r3
 333              	__dft_xun_huan:	
 334 01f6 C458     		ldr r4, [r0, r3]
 335 01f8 CA58     		ldr r2, [r1, r3]	@r
 336 01fa 04B4     		push {r2}
 337 01fc 0433     		adds r3, r3, # 4
 338 01fe C558     		ldr r5, [r0, r3]
 339 0200 C258     		ldr r2, [r0, r3]
 340 0202 0433     		adds r3, r3, # 4
 341 0204 2646     		mov r6, r4
 342 0206 2F46     		mov r7, r5
 343 0208 2404     		lsls r4, r4, # 16
 344 020a 240C     		lsrs r4, r4, # 16
 345 020c 360C     		lsrs r6, r6, # 16
 346 020e 2D04     		lsls r5, r5, # 16
 347 0210 2D0C     		lsrs r5, r5, # 16
 348 0212 3F0C     		lsrs r7, r7, # 16
 349 0214 A41B     		subs r4, r4, r6
 350 0216 ED1B     		subs r5, r5, r7
 351 0218 2646     		mov r6, r4
 352 021a 2F46     		mov r7, r5
 353 021c 5443     		muls r4, r4, r2		@i
 354 021e 5543     		muls r5, r5, r2		@i
 355 0220 E413     		asrs r4, r4, # 15
 356 0222 ED13     		asrs r5, r5, # 15
 357 0224 4A46     		mov r2, r9
 358 0226 1219     		adds r2, r2, r4
 359 0228 9146     		mov r9, r2
 360 022a 5246     		mov r2, r10
 361 022c 5219     		adds r2, r2, r5
 362 022e 9246     		mov r10, r2
 363 0230 04BC     		pop {r2}
 364 0232 5643     		muls r6, r6, r2		@i
 365 0234 5743     		muls r7, r7, r2		@i
 366 0236 5A46     		mov r2, r11		@r
 367 0238 9219     		adds r2, r2, r6
 368 023a 9346     		mov r11, r2
 369 023c 6246     		mov r2, r12
 370 023e D219     		adds r2, r2, r7
 371 0240 9446     		mov r12, r2
 372 0242 4345     		cmp r3, r8
 373 0244 D7D1     		bne __dft_xun_huan
 374 0246 A648     		ldr r0, = shibu
 375 0248 A849     		ldr r1, = xubu
 376 024a 4A46     		mov r2, r9
 377 024c 5346     		mov r3, r10
 378 024e 5C46     		mov r4, r11
 379 0250 6546     		mov r5, r12
 380 0252 1212     		asrs r2, r2, # 8
 381 0254 1B12     		asrs r3, r3, # 8
 382 0256 2412     		asrs r4, r4, # 8
 383 0258 2D12     		asrs r5, r5, # 8
 384 025a 0260     		str r2, [r0]
 385 025c 4360     		str r3, [r0, # 0x04]
 386 025e 0C60     		str r4, [r1]
 387 0260 4D60     		str r5, [r1, # 0x04]
ARM GAS  1.s 			page 8


 388 0262 1FBC     		pop {r0-r4}
 389 0264 8046     		mov r8, r0
 390 0266 8946     		mov r9, r1
 391 0268 9246     		mov r10, r2
 392 026a 9B46     		mov r11, r3
 393 026c A446     		mov r12, r4
 394 026e FFBD     		pop {r0-r7,pc}
 395              		
 396              		
 397              		
 398              	_lvboqi:
 399              				@滤波器
 400              				@R0=地址，R1=长度,r2=表指针地址,r3=ADC数值
 401              				@出R0=结果
 402 0270 FEB5     		push {r1-r7,lr}	
 403 0272 1568     		ldr r5, [r2]		@读出表指针
 404 0274 8E00     		lsls r6, r1, # 2	
 405 0276 4351     		str r3, [r0, r5]	@数值写到滤波器缓冲区
 406 0278 0435     		adds r5, r5, # 4
 407 027a B542     		cmp r5, r6
 408 027c 00D1     		bne _lvboqimeidaohuanchongquding
 409 027e 0025     		movs r5, # 0
 410              	_lvboqimeidaohuanchongquding:
 411 0280 1560     		str r5, [r2]
 412 0282 0027     		movs r7, # 0
 413              	_lvboqixunhuan:
 414 0284 B542     		cmp r5, r6
 415 0286 00D1     		bne _lvbozonghe
 416 0288 0025     		movs r5, # 0
 417              	_lvbozonghe:
 418 028a 4459     		ldr r4, [r0, r5]
 419 028c 0435     		adds r5, r5, # 4
 420 028e 3F19     		adds r7, r7, r4
 421 0290 0139     		subs r1, r1, # 1
 422 0292 F7D1     		bne _lvboqixunhuan
 423 0294 7811     		asrs r0, r7, # 5	@修改
 424 0296 FEBD     		pop {r1-r7,pc}
 425              	
 426              	_zhuanshumaguanma:@ 16进制转数码管码
 427              		@ R0要转的数据， R1长度，R2结果表首地址
 428              		@ r3 小数点位置
 429 0298 F0B5     		push {r4-r7,lr}
 430 029a 954F     		ldr r7, = shumaguanmabiao
 431 029c 0546     		mov r5, r0
 432 029e 0E46     		mov r6, r1
 433 02a0 0A21     		movs r1, # 10
 434 02a2 9846     		mov r8, r3
 435              	_xunhuanqiuma:
 436 02a4 00F044F8 		bl _chufa
 437 02a8 0446     		mov r4, r0
 438 02aa 4C43     		muls r4, r1
 439 02ac 2B1B     		subs r3, r5, r4
 440 02ae 9B00     		lsls r3, # 2
 441 02b0 FC58     		ldr r4, [r7, r3]
 442 02b2 4645     		cmp r6, r8
 443 02b4 00D0     		beq __tian_jia_xiao_shu_dian
 444 02b6 00E0     		b __bao_cun_shu_ma_guan_ma
ARM GAS  1.s 			page 9


 445              	__tian_jia_xiao_shu_dian:
 446 02b8 0134     		adds r4, r4, # 1
 447              	__bao_cun_shu_ma_guan_ma:	
 448 02ba 1460     		str r4, [r2]
 449 02bc 0546     		mov r5, r0
 450 02be 0432     		adds r2, r2, # 4
 451 02c0 013E     		subs r6, # 1
 452 02c2 EFD1     		bne _xunhuanqiuma
 453 02c4 F0BD     		pop {r4-r7,pc}
 454              	_xieshumaguan: @ r0=位数 @数码管码
 455 02c6 FEB5     		push {r1-r7,lr}
 456 02c8 8000     		lsls r0, r0, # 2
 457 02ca 0027     		movs r7, # 0
 458 02cc 0646     		mov r6, r0
 459 02ce 664D     		ldr r5, = shumaguanma
 460 02d0 884A     		ldr r2, = shumaguanshuaxinbiao
 461              	_shumaguanshuaxin:
 462 02d2 EB59     		ldr r3, [r5, r7]
 463 02d4 D459     		ldr r4, [r2, r7]
 464 02d6 1C43     		orrs r4, r4, r3
 465 02d8 2046     		mov r0, r4
 466 02da 00F004F8 		bl _xie595
 467 02de 0437     		adds  r7, r7, # 4
 468 02e0 B742     		cmp r7, r6
 469 02e2 F6D9     		bls _shumaguanshuaxin
 470 02e4 FEBD     		pop {r1-r7,pc}
 471              		
 472              	_xie595: @ R0=要写的数据
 473 02e6 FEB5     		push {r1-r7,lr}
 474 02e8 0546     		mov r5, r0
 475 02ea 0820     		movs r0, # 0x08      @pa6
 476 02ec 1027     		movs r7, # 0x10      @pa7
 477 02ee 0426     		movs r6, # 0x04      @pa5 
 478 02f0 1023     		movs r3, # 16   @16位
 479 02f2 764A     		ldr r2, = 0x48000000 @ gpioa
 480 02f4 0121     		movs r1, # 0x01
 481              	_xunhuan595:
 482 02f6 9761     		str r7, [r2, # 0x18]
 483 02f8 00F014F8 		bl _yanshi
 484 02fc 0D42     		tst r5, r1
 485 02fe 01D1     		bne _xie595_0
 486 0300 9062     		str r0, [r2, # 0x28]
 487 0302 00E0     		b _suocun595
 488              	_xie595_0:
 489 0304 9061     		str r0, [r2, # 0x18]
 490              	_suocun595:
 491 0306 00F00DF8 		bl _yanshi
 492 030a 6D08     		lsrs r5, # 1
 493 030c 9762     		str r7, [r2, # 0x28]
 494 030e 00F009F8 		bl _yanshi
 495 0312 013B     		subs r3, r3, # 1
 496 0314 EFD1     		bne _xunhuan595
 497 0316 9661     		str r6, [r2, # 0x18]
 498 0318 00F004F8 		bl _yanshi
 499 031c 9662     		str r6, [r2, # 0x28]
 500 031e 00F001F8 		bl _yanshi
 501 0322 FEBD     		pop {r1-r7,pc}
ARM GAS  1.s 			page 10


 502              	
 503              	
 504              	_yanshi:
 505 0324 80B4     		push {r7}
 506 0326 744F     		ldr r7, = 30
 507              	_yanshi11:
 508 0328 013F     		subs r7, # 1
 509 032a FDD1     		bne _yanshi11
 510 032c 80BC     		pop {r7}
 511 032e 7047     		bx lr
 512              	
 513              	_chufa:				@软件除法
 514              		@ r0 除以 r1 等于 商(r0)余数R1
 515 0330 1EB5     		push {r1-r4,lr}
 516 0332 0028     		cmp r0, # 0
 517 0334 0ED0     		beq _chufafanhui
 518 0336 0029     		cmp r1, # 0
 519 0338 0CD0     		beq _chufafanhui
 520 033a 0246     		mov r2, r0
 521 033c 0123     		movs r3, # 1
 522 033e DB07     		lsls r3, r3, # 31
 523 0340 0020     		movs r0, # 0
 524 0342 0446     		mov r4, r0
 525              	_chufaxunhuan:
 526 0344 5200     		lsls r2, r2, # 1
 527 0346 6441     		adcs r4, r4, r4
 528 0348 8C42     		cmp r4, r1
 529 034a 01D3     		bcc _chufaweishubudao0
 530 034c C018     		adds r0, r0, r3
 531 034e 641A     		subs r4, r4, r1
 532              	_chufaweishubudao0:
 533 0350 5B08     		lsrs r3, r3, # 1
 534 0352 F7D1     		bne _chufaxunhuan
 535              	_chufafanhui:
 536 0354 1EBD     		pop {r1-r4,pc}
 537              	__chu_fa:	@带符号
 538 0356 FEB5     		push {r1-r7,lr}
 539 0358 0028     	        cmp r0, # 0
 540 035a 1DD0     	        beq _chufafanhui1
 541 035c 0029     	        cmp r1, # 0
 542 035e 1BD0     	        beq _chufafanhui1
 543 0360 0025     		movs r5, # 0
 544 0362 0000     		movs r0, r0
 545 0364 02D5     		bpl __pan_duan_bei_chu_shu
 546 0366 0135     		adds r5, r5, # 1
 547 0368 C043     		mvns r0, r0
 548 036a 0130     		adds r0, r0, # 1
 549              	__pan_duan_bei_chu_shu:
 550 036c 0900     		movs r1, r1
 551 036e 02D5     		bpl __ji_suan_chu_fa11
 552 0370 0135     		adds r5, r5, # 1
 553 0372 C943     		mvns r1, r1
 554 0374 0131     		adds r1, r1, # 1
 555              	__ji_suan_chu_fa11:	
 556 0376 0246     	        mov r2, r0
 557 0378 0123     	        movs r3, # 1
 558 037a DB07     	        lsls r3, r3, # 31
ARM GAS  1.s 			page 11


 559 037c 0020     	        movs r0, # 0
 560 037e 0446     	        mov r4, r0
 561              	_chufaxunhuan1:
 562 0380 5200     	        lsls r2, r2, # 1
 563 0382 6441     	        adcs r4, r4, r4
 564 0384 8C42     	        cmp r4, r1
 565 0386 01D3     		bcc _chufaweishubudao00
 566 0388 C018     		adds r0, r0, r3
 567 038a 641A     		subs r4, r4, r1
 568              	_chufaweishubudao00:
 569 038c 5B08     		lsrs r3, r3, # 1
 570 038e F7D1     		bne _chufaxunhuan1
 571 0390 012D     		cmp r5, # 1
 572 0392 01D1     		bne _chufafanhui1
 573 0394 C043     		mvns r0, r0
 574 0396 0130     		adds r0, r0, # 1
 575              	_chufafanhui1:
 576 0398 FEBD     		pop {r1-r7,pc}
 577              	__zhuan_bcd:
 578 039a F7B5     		push {r0-r2,r4-r7,lr}
 579 039c 0A21     		movs r1, # 10
 580 039e 1846     		mov r0, r3
 581 03a0 1D46     		mov r5, r3
 582 03a2 0826     		movs r6, # 8
 583              	__bcd_xun_huan:
 584 03a4 FFF7C4FF 		bl _chufa
 585 03a8 0446     		mov r4, r0
 586 03aa 4C43     		muls r4, r4, r1
 587 03ac 2D1B     		subs r5, r5, r4
 588 03ae 20B4     		push {r5}
 589 03b0 0546     		mov r5, r0
 590 03b2 013E     		subs r6, r6, # 1
 591 03b4 F6D1     		bne __bcd_xun_huan
 592 03b6 FFBC     		pop {r0-r7}
 593 03b8 3601     		lsls r6, r6, # 4
 594 03ba 2D02     		lsls r5, r5, # 8
 595 03bc 2403     		lsls r4, r4, # 12
 596 03be 1B04     		lsls r3, r3, # 16
 597 03c0 1205     		lsls r2, r2, # 20
 598 03c2 0906     		lsls r1, r1, # 24
 599 03c4 0007     		lsls r0, r0, # 28
 600 03c6 0343     		orrs r3, r3, r0
 601 03c8 0B43     		orrs r3, r3, r1
 602 03ca 1343     		orrs r3, r3, r2
 603 03cc 2343     		orrs r3, r3, r4
 604 03ce 2B43     		orrs r3, r3, r5
 605 03d0 3343     		orrs r3, r3, r6
 606 03d2 3B43     		orrs r3, r3, r7
 607 03d4 F7BD     		pop {r0-r2,r4-r7,pc}
 608              		
 609              	_nmi_handler:
 610 03d6 7047     		bx lr
 611              	_hard_fault:
 612 03d8 7047     		bx lr
 613              	_svc_handler:
 614 03da 7047     		bx lr
 615              	_pendsv_handler:
ARM GAS  1.s 			page 12


 616 03dc 7047     		bx lr
 617              	aaa:
 618 03de 7047     		bx lr
 619              	_tim3:
 620 03e0 4648     		ldr r0, = jishu2
 621 03e2 0168     		ldr r1, [r0]
 622 03e4 0131     		adds r1, r1, #1
 623 03e6 0160     		str r1, [r0]
 624              	_tim3fanhui:
 625 03e8 3548     		ldr r0, = 0x40000400
 626 03ea 0021     		movs r1, # 0
 627 03ec 0161     		str r1, [r0, # 0x10]
 628 03ee 7047     		bx lr
 629              	_systickzhongduan:
 630 03f0 2948     		ldr r0, = 0x40020000
 631 03f2 4349     	        ldr r1, =  86
 632 03f4 C160     	        str r1, [r0, # 0x0c]
 633 03f6 4349     	        ldr r1, = 0xa83 @ 0xaa3 @ 5a1
 634 03f8 8160     	        str r1, [r0, # 0x08]
 635              	
 636              		
 637 03fa 4348     		ldr r0, = 0xe0000d04
 638 03fc 4349     		ldr r1, = 0x02000000
 639 03fe 0160     		str r1, [r0]                 @ 清除SYSTICK中断
 640 0400 7047     		bx lr
 641              	__dma_wan:
 642 0402 2748     		ldr r0, = 0x20000200
 643 0404 2C49     		ldr r1, = 256
 644 0406 8900     		lsls r1, r1, # 2
 645 0408 0022     		movs r2, # 0
 646              	__fu_zhi_xun_huan:
 647 040a 8358     		ldr r3, [r0, r2]
 648 040c 1C46     		mov r4, r3
 649 040e 1B04     		lsls r3, r3, # 16
 650 0410 1B0C     		lsrs r3, r3, # 16
 651 0412 240C     		lsrs r4, r4, # 16
 652 0414 1B1B     		subs r3, r3, r4
 653 0416 07D5     		bpl __bao_cun
 654 0418 DB43     		mvns r3, r3
 655 041a 0133     		adds r3, r3, # 1
 656 041c FFF7BDFF 		bl __zhuan_bcd
 657 0420 194C     		ldr r4, = 0x80000000
 658 0422 2343     		orrs r3, r3, r4
 659 0424 00F002F8 		bl __fu_shu_bao_cun
 660              	__bao_cun:
 661 0428 FFF7B7FF 		bl __zhuan_bcd
 662              	__fu_shu_bao_cun:	
 663 042c 8350     		str r3, [r0, r2]
 664 042e 0432     		adds r2, r2, # 4
 665 0430 8A42     		cmp r2, r1
 666 0432 EAD1     		bne __fu_zhi_xun_huan
 667              		
 668              	
 669              		
 670 0434 01BE     		bkpt # 1
 671              		
 672 0436 1848     	        ldr r0, = 0x40020000
ARM GAS  1.s 			page 13


 673 0438 1A49     		ldr r1, = 0x583
 674 043a 354B     		ldr r3, = 1024
 675 043c 0022     		movs r2, # 0
 676 043e 8260     		str r2, [r0, # 0x08]
 677 0440 C360     		str r3, [r0, # 0x0c]
 678 0442 0222     	        movs r2, # 2
 679 0444 4260     		str r2, [r0, # 0x04]
 680 0446 8160     		str r1, [r0, # 0x08]
 681 0448 2448     		ldr r0, = dianyabiaoman
 682 044a 0121     		movs r1, # 1
 683 044c 0160     		str r1, [r0]
 684              	__dma_fan_hui:
 685 044e 70470020 		bx lr
 685      02400010 
 685      02400100 
 685      01000200 
 685      15000000 
ARM GAS  1.s 			page 14


DEFINED SYMBOLS
                 1.s:9      .data:0000000000000000 $d
                 1.s:10     .data:0000000000000000 shumaguanmabiao
                 1.s:12     .data:0000000000000028 shumaguanshuaxinbiao
                 1.s:14     .data:000000000000004c xuanzhuanyinzi
                 1.s:16     .data:000000000000104c yjmwxwx
                 1.s:17     *ABS*:0000000020001000 STACKINIT
                 1.s:18     *ABS*:0000000020000000 shumaguanma
                 1.s:19     *ABS*:0000000020000010 fuhao
                 1.s:20     *ABS*:00000000200000f4 dmawan
                 1.s:21     *ABS*:00000000200000f8 jishu2
                 1.s:22     *ABS*:00000000200000fc jishu
                 1.s:23     *ABS*:0000000020000120 shibu
                 1.s:24     *ABS*:0000000020000128 xubu
                 1.s:25     *ABS*:0000000020000140 shibuhuanchong
                 1.s:26     *ABS*:0000000020000150 lvboqizhizhen
                 1.s:27     *ABS*:0000000020000154 lvboqihuanchong
                 1.s:28     *ABS*:00000000200001fc dianyabiaoman
                 1.s:29     *ABS*:0000000020000200 dianyabiao
                 1.s:31     .text:0000000000000000 vectors
                 1.s:78     .text:00000000000000b0 _start
                 1.s:609    .text:00000000000003d6 _nmi_handler
                 1.s:611    .text:00000000000003d8 _hard_fault
                 1.s:613    .text:00000000000003da _svc_handler
                 1.s:615    .text:00000000000003dc _pendsv_handler
                 1.s:629    .text:00000000000003f0 _systickzhongduan
                 1.s:617    .text:00000000000003de aaa
                 1.s:641    .text:0000000000000402 __dma_wan
                 1.s:619    .text:00000000000003e0 _tim3
                            .text:0000000000000000 $d
                 1.s:76     .text:00000000000000b0 $t
                 1.s:79     .text:00000000000000b0 shizhong
                 1.s:86     .text:00000000000000bc denghse
                 1.s:90     .text:00000000000000c2 dengpllguan
                 1.s:102    .text:00000000000000d6 dengpll
                 1.s:110    .text:00000000000000e0 neicunqingling
                 1.s:114    .text:00000000000000e6 neicunqinglingxunhuan
                 1.s:119    .text:00000000000000ec _waisheshizhong
                 1.s:136    .text:00000000000000fa _waishezhongduan
                 1.s:147    .text:0000000000000100 _adcchushihua
                 1.s:151    .text:0000000000000106 _dengadcjiaozhun
                 1.s:155    .text:000000000000010c _kaiadc
                 1.s:160    .text:0000000000000114 _dengdaiadcwending
                 1.s:164    .text:000000000000011a _tongdaoxuanze
                 1.s:178    .text:0000000000000132 dmachushihua
                 1.s:200    .text:0000000000000144 tim1chushiha
                 1.s:216    .text:0000000000000160 tim3chushihua
                 1.s:243    .text:0000000000000180 io_she_zhi
                 1.s:270    .text:000000000000018a ting
                 1.s:288    .text:00000000000001ac __xianshi
                 1.s:280    .text:000000000000019c dd
                 1.s:317    .text:00000000000001d8 __dft
                 1.s:304    .text:00000000000001c0 __shu_ma_guan_xian_shi
                 1.s:308    .text:00000000000001c6 __led_xian_shi
                 1.s:426    .text:0000000000000298 _zhuanshumaguanma
                 1.s:454    .text:00000000000002c6 _xieshumaguan
                 1.s:333    .text:00000000000001f6 __dft_xun_huan
ARM GAS  1.s 			page 15


                 1.s:398    .text:0000000000000270 _lvboqi
                 1.s:410    .text:0000000000000280 _lvboqimeidaohuanchongquding
                 1.s:413    .text:0000000000000284 _lvboqixunhuan
                 1.s:417    .text:000000000000028a _lvbozonghe
                 1.s:435    .text:00000000000002a4 _xunhuanqiuma
                 1.s:513    .text:0000000000000330 _chufa
                 1.s:445    .text:00000000000002b8 __tian_jia_xiao_shu_dian
                 1.s:447    .text:00000000000002ba __bao_cun_shu_ma_guan_ma
                 1.s:461    .text:00000000000002d2 _shumaguanshuaxin
                 1.s:472    .text:00000000000002e6 _xie595
                 1.s:481    .text:00000000000002f6 _xunhuan595
                 1.s:504    .text:0000000000000324 _yanshi
                 1.s:488    .text:0000000000000304 _xie595_0
                 1.s:490    .text:0000000000000306 _suocun595
                 1.s:507    .text:0000000000000328 _yanshi11
                 1.s:535    .text:0000000000000354 _chufafanhui
                 1.s:525    .text:0000000000000344 _chufaxunhuan
                 1.s:532    .text:0000000000000350 _chufaweishubudao0
                 1.s:537    .text:0000000000000356 __chu_fa
                 1.s:575    .text:0000000000000398 _chufafanhui1
                 1.s:549    .text:000000000000036c __pan_duan_bei_chu_shu
                 1.s:555    .text:0000000000000376 __ji_suan_chu_fa11
                 1.s:561    .text:0000000000000380 _chufaxunhuan1
                 1.s:568    .text:000000000000038c _chufaweishubudao00
                 1.s:577    .text:000000000000039a __zhuan_bcd
                 1.s:583    .text:00000000000003a4 __bcd_xun_huan
                 1.s:624    .text:00000000000003e8 _tim3fanhui
                 1.s:646    .text:000000000000040a __fu_zhi_xun_huan
                 1.s:660    .text:0000000000000428 __bao_cun
                 1.s:662    .text:000000000000042c __fu_shu_bao_cun
                 1.s:684    .text:000000000000044e __dma_fan_hui
                 1.s:685    .text:0000000000000450 $d

NO UNDEFINED SYMBOLS
