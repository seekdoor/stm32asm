ARM GAS  1.s 			page 1


   1              		@@单片机stm32f030f4p6
   2              		@@ 高频阻抗测量
   3              		@作者：yjmwxwx
   4              		@时间：2020-01-01
   5              		@编译器：ARM-NONE-EABI
   6              		 .thumb
   7              		         .syntax unified
   8              		.section .data
   9              		.align 4
  10              	shumaguanmabiao:
  11 0000 FC000000 		.int 0xfc,0x60,0xda,0xf2,0x66,0xb6,0xbe,0xe0,0xfe,0xf6
  11      60000000 
  11      DA000000 
  11      F2000000 
  11      66000000 
  12              	shumaguanshuaxinbiao:
  13 0028 00FE0000 		.int 0xfe00,0xfd00,0xfb00,0xf700,0xef00,0xdf00,0xbf00,0x7f00,0
  13      00FD0000 
  13      00FB0000 
  13      00F70000 
  13      00EF0000 
  14              	xuanzhuanyinzi:
  15 004c 00800000 		.int 0x8000,0x0000,0x7FF6,0xFFFFFCDC,0x7FD8,0xFFFFF9B9,0x7FA7,0xFFFFF696,0x7F62,0xFFFFF375,0x7F09,
  15      00000000 
  15      F67F0000 
  15      DCFCFFFF 
  15      D87F0000 
  16              	yjmwxwx:
  17              		.equ STACKINIT,        	        0x20001000
  18              		.equ shumaguanma,		0x20000000
  19              		.equ fuhao,			0x20000010
  20              		.equ dmawan,			0x200000f4
  21              		.equ jishu2,			0x200000f8
  22              		.equ jishu,			0x200000fc
  23              		.equ shibu,			0x20000120
  24              		.equ xubu,			0x20000128
  25              		.equ shibuhuanchong,		0x20000140
  26              		.equ lvboqizhizhen,		0x20000150
  27              		.equ lvboqihuanchong,		0x20000154
  28              		.equ dianyabiaozhizhen,		0x200001f8
  29              		.equ dianyabiaoman,		0x200001fc
  30              		.equ dianyabiao,		0x20000200
  31              		.section .text
  32              	vectors:
  33 0000 00100020 		.word STACKINIT
  34 0004 B1000000 		.word _start + 1
  35 0008 FD040000 		.word _nmi_handler + 1
  36 000c FF040000 		.word _hard_fault  + 1
  37 0010 00000000 		.word 0
  38 0014 00000000 		.word 0
  39 0018 00000000 		.word 0
  40 001c 00000000 		.word 0
  41 0020 00000000 		.word 0
  42 0024 00000000 		.word 0
  43 0028 00000000 		.word 0
  44 002c 01050000 		.word _svc_handler +1
  45 0030 00000000 		.word 0
ARM GAS  1.s 			page 2


  46 0034 00000000 		.word 0
  47 0038 03050000 		.word _pendsv_handler +1
  48 003c 17050000 		.word _systickzhongduan +1               @ 15
  49 0040 05050000 		.word aaa +1           @ _wwdg +1          	@ 0
  50 0044 05050000 		.word aaa +1           @_pvd +1            	@ 1
  51 0048 05050000 		.word aaa +1           @_rtc +1            	@ 2
  52 004c 05050000 		.word aaa +1           @_flash +1          	@ 3
  53 0050 05050000 		.word aaa +1	       @ _rcc + 1          	@ 4
  54 0054 05050000 		.word aaa +1           @_exti0_1  +1      	@ 5
  55 0058 05050000 		.word aaa +1           @ _exti2_3 +1      	@ 6
  56 005c 05050000 		.word aaa +1           @_exti4_15 +1     	@ 7
  57 0060 05050000 		.word aaa +1                         		@ 8
  58 0064 29050000 		.word __dma_wan  +1  		      		@ 9
  59 0068 05050000 		.word aaa +1	       @_dma1_2_3 +1        	@ 10
  60 006c 05050000 		.word aaa +1	       @ _dma1_4_5 +1	        @ 11
  61 0070 05050000 		.word aaa +1	       @_adc1 +1          	@ 12
  62 0074 05050000 		.word aaa +1           @_tim1_brk_up +1  	@ 13
  63 0078 05050000 		.word aaa +1           @ _tim1_cc +1            @ 14
  64 007c 05050000 		.word aaa +1           @_tim2 +1      	        @ 15
  65 0080 07050000 		.word _tim3 +1                             	@ 16
  66 0084 05050000 		.word aaa +1                                    @ 17
  67 0088 05050000 		.word aaa +1		                	@ 18
  68 008c 05050000 		.word aaa +1	       @_tim14 +1   	        @ 19
  69 0090 05050000 		.word aaa +1                         		@ 20
  70 0094 05050000 		.word aaa +1           @_tim16 +1      		@ 21
  71 0098 05050000 		.word aaa +1           @_tim17 +1      		@ 22
  72 009c 05050000 		.word aaa +1           @_i2c   +1     		@ 23
  73 00a0 05050000 		.word aaa +1                         		@ 24
  74 00a4 05050000 		.word aaa +1           @_spi   +1    		@ 25
  75 00a8 05050000 		.word aaa +1                         		@ 26
  76 00ac 05050000 		.word aaa +1           @_usart1 +1     		@ 27
  77              		.align 2
  78              	
  79              	_start:
  80              	shizhong:
  81 00b0 744A     	        ldr r2, = 0x40022000   @FLASH访问控制
  82 00b2 3221     	        movs r1, # 0x32
  83 00b4 1160     	        str r1, [r2]           @FLASH缓冲 缓冲开启
  84 00b6 7448     	        ldr r0, = 0x40021000 @ rcc
  85 00b8 7449     		ldr r1, = 0x10001
  86 00ba 0160     	        str r1, [r0]
  87              	denghse:
  88 00bc 0168     	        ldr r1, [r0]
  89 00be 8903     	        lsls r1, r1, # 14
  90 00c0 FCD5     	        bpl denghse
  91              	dengpllguan:
  92 00c2 0168     	        ldr r1, [r0]
  93 00c4 8901     		lsls r1, r1, # 6
  94 00c6 FCD4     		bmi dengpllguan
  95 00c8 7149     		ldr r1, = 0x150002
  96 00ca 0046     		mov r0, r0
  97 00cc 4160     		str r1, [r0, # 0x04]
  98 00ce 0046     		mov r0, r0
  99 00d0 7049     		ldr r1, = 0x1010000
 100 00d2 0046     		mov r0, r0
 101 00d4 0160     		str r1, [r0]
 102              	
ARM GAS  1.s 			page 3


 103              	dengpll:
 104 00d6 0168     	        ldr r1, [r0]
 105 00d8 8901     		lsls r1, # 6
 106 00da FCD5     		bpl dengpll
 107              	
 108 00dc 6E49     		ldr r1, = 100
 109 00de 0163     		str r1, [r0, # 0x30]
 110              	
 111              	neicunqingling:
 112 00e0 6E48     		ldr r0, = 0x20000000
 113 00e2 0021     		movs r1, # 0
 114 00e4 6E4B     		ldr r3, = 0x1000
 115              	neicunqinglingxunhuan:
 116 00e6 043B     		subs r3, # 4
 117 00e8 C150     		str r1, [r0, r3]
 118 00ea FCD1     		bne neicunqinglingxunhuan
 119              		
 120              	_waisheshizhong:			 @ 外设时钟
 121              		@+0x14=RCC_AHBENR
 122              		@ 0=DMA @ 2=SRAM @ 4=FLITF@ 6=CRC @ 17=PA @ 18=PB @ 19=PC @ 20=PD @ 22=PF
 123 00ec 6648     		ldr r0, = 0x40021000
 124 00ee 6D49     		ldr r1, = 0x60001
 125 00f0 4161     		str r1, [r0, # 0x14]
 126              	
 127              		@+0x18外设时钟使能寄存器 (RCC_APB2ENR)
 128              		@0=SYSCFG @5=USART6EN @9=ADC @11=TIM1 @12=SPI1 @14=USART1 @16=TIM15 @17=TIM16 @18=TIM17 @22=DBGMCU
 129 00f2 6D49     		ldr r1, = 0xa00
 130 00f4 8161     		str r1, [r0, # 0x18]
 131              		@+0X1C=RCC_APB1ENR
 132              		@ 1=TIM3 @ 4=TIM6 @ 5=TIM7 @ 8=TIM14 @ 11=WWDG @ 14=SPI @ 17=USRT2 @ 18=USART3 @ 20=USART5 @ 21=I2
 133              		@ 22=I2C2 @ 23=USB @ 28=PWR
 134 00f6 6D4A     		ldr r2, = 0x102
 135 00f8 C261     		str r2, [r0, # 0x1c]
 136              	
 137              	_waishezhongduan:				@外设中断
 138              		@0xE000E100    0-31  写1开，写0没效
 139              		@0XE000E180    0-31 写1关，写0没效
 140              		@0XE000E200    0-31 挂起，写0没效
 141              		@0XE000E280    0-31 清除， 写0没效
 142              	
 143 00fa 6D48     		ldr r0, =  0xe000e100
 144 00fc 6D49     		ldr r1, = 0x200 @0x10200  @ 0x10000
 145 00fe 0160     		str r1, [r0]
 146              	
 147              	
 148              	_adcchushihua:
 149 0100 6D48     	        ldr r0, = 0x40012400  @ adc基地址
 150 0102 6E49     	        ldr r1, = 0x80000000
 151 0104 8160     	        str r1, [r0, # 0x08]  @ ADC 控制寄存器 (ADC_CR)  @adc校准
 152              	_dengadcjiaozhun:
 153 0106 8168     	        ldr r1, [r0, # 0x08]
 154 0108 0900     	        movs r1, r1
 155 010a FCD4     	        bmi _dengadcjiaozhun   @ 等ADC校准
 156              	_kaiadc:
 157 010c 8168     	        ldr r1, [r0, # 0x08]
 158 010e 0122     	        movs r2, # 0x01
 159 0110 1143     	        orrs r1, r1, r2
ARM GAS  1.s 			page 4


 160 0112 8160     	        str r1, [r0, # 0x08]
 161              	_dengdaiadcwending:
 162              	       @ ldr r1, [r0]
 163              	       @ lsls r1, r1, # 31
 164              	        @ bpl _dengdaiadcwending @ 等ADC稳定
 165              	_tongdaoxuanze:
 166 0114 6949     	        ldr r1, = 0x80000000
 167 0116 0161     	        str r1, [r0, # 0x10]
 168 0118 6949     	        ldr r1, = 0x63
 169 011a 8162     	        str r1, [r0, # 0x28]    @ 通道选择寄存器 (ADC_CHSELR)
 170 011c 6949     	        ldr r1, = 0x8c3 @0x2003 @0x8c3
 171 011e C160     	        str r1, [r0, # 0x0c]    @ 配置寄存器 1 (ADC_CFGR1)
 172 0120 0021     	        movs r1, # 0
 173 0122 4161     		str r1, [r0, # 0x14]    @ ADC 采样时间寄存器 (ADC_SMPR)
 174 0124 8168     	        ldr r1, [r0, # 0x08]
 175 0126 684A     	        ldr r2, = 0x04         @ 开始转换
 176 0128 1143     		orrs r1, r1, r2
 177 012a 8160     	        str r1, [r0, # 0x08]    @ 控制寄存器 (ADC_CR)
 178              	
 179              	dmachushihua:
 180              	        @+0=LSR,+4=IFCR,
 181              	        @+8=CCR1,+c=CNDTR1,+10=CPAR1+14=CMAR1,
 182              	        @+1c=CCR2,+20=CNDTR2,+24=CPAR2,+28=CMAR2
 183              	        @+30=CCR3,+34=CNDTR3,+38=CPAR2,+3c=CMAR3
 184              	        @+44=CCR4,+48=CNDTR4,+4c=CPAR4,+50=CMAR4
 185              	        @+58=CCR5,+5c=CNDTR5,+60=CPAR5,+64=CMAR5
 186              	        @+6C=CCR6,+70=CNDTR6,+74=CPAR6,+78=CMAR6
 187              	        @+80=CCR7,+84=CNDTR7,+88=CPAR7,+8c=CMAR7
 188              	
 189              		@ adc dma
 190 012c 6748     		ldr r0, = 0x40020000
 191 012e 6849     		ldr r1, = 0x40012440
 192 0130 0161     		str r1, [r0, # 0x10]
 193 0132 6849     		ldr r1, = dianyabiao
 194 0134 4161     		str r1, [r0, # 0x14]
 195 0136 6849     		ldr r1, = 912
 196 0138 C160     		str r1, [r0, # 0x0c]
 197 013a 6849     		ldr r1, = 0x583 @  0x583 	@ 5a1
 198 013c 8160     		str r1, [r0, # 0x08]
 199              	
 200              	
 201              	tim1chushiha:				
 202 013e 684D     		ldr r5, = 0x40012c00 @ tim1_cr1
 203 0140 6849     		ldr r1, = 0
 204 0142 A962     		str r1, [r5, # 0x28] @ psc
 205 0144 6849     		ldr r1, = 1
 206 0146 E962     		str r1, [r5, # 0x2c] @ ARR
 207 0148 6849     		ldr r1, = 0x38
 208 014a E961     		str r1, [r5, # 0x1c] @ ccmr2  CC3
 209 014c 6849     		ldr r1, = 0x100    @  CC3
 210 014e 2962     		str r1, [r5, # 0x20] @ ccer
 211 0150 6849     		ldr r1, = 0x8000
 212 0152 6964     		str r1, [r5, # 0x44] @ BDTR
 213 0154 6449     		ldr r1, = 1
 214 0156 E963     		str r1, [r5, # 0x3c]
 215 0158 E124     		movs r4, # 0xe1
 216              	tim3chushihua:				
ARM GAS  1.s 			page 5


 217 015a 6748     		ldr r0, = 0x40000400 @ tim3_cr1
 218 015c 6149     		ldr r1, = 0
 219 015e 8162     		str r1, [r0, # 0x28] @ psc
 220 0160 6649     		ldr r1, = 279
 221 0162 C162     		str r1, [r0, # 0x2c] @ ARR
 222 0164 6649     		ldr r1, =  0x3800 @ 0x3800
 223 0166 C161     		str r1, [r0, # 0x1c] @ ccmr2
 224 0168 4D49     		ldr r1, =  0x1000
 225 016a 0162     		str r1, [r0, # 0x20] @ ccer
 226 016c 6349     		ldr r1, = 279
 227 016e 0164     		str r1, [r0, # 0x40] @ ccr4
 228 0170 7021     		movs r1, # 0x70
 229 0172 4160     		str r1, [r0, # 0x04]
 230              		@movs r1, # 0x01
 231              		@str r1, [r0, # 0x0c]
 232 0174 E121     		movs r1, # 0xe1
 233 0176 0160     		str r1, [r0]
 234 0178 2C60     		str r4, [r5]
 235              	@_systick:				@ systick定时器初始化
 236              	@
 237              	@	ldr r0, = 0xe000e010
 238              	@	ldr r1, = 4800000
 239              	@	str r1, [r0, # 4]
 240              	@	str r1, [r0, # 8]
 241              	@	movs r1, # 0x07
 242              	@	str r1, [r0]
 243              	io_she_zhi:
 244              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 245              		@a(0x48000000)b(0x48000400)c(0x48000800)d(0x48000c00)f(0x48001400)
 246              		@ 输入（00），通用输出（01），复用功能（10），模拟（11）
 247              		@偏移0x4 = 端口输出类型 @ （0 推挽），（ 1 开漏）
 248              		@偏移0x8 = 输出速度  00低速， 01中速， 11高速
 249              		@偏移0xC = 上拉下拉 (00无上下拉，  01 上拉， 10下拉)
 250              		@偏移0x10 = 输入数据寄存器
 251              		@偏移0x14 = 输出数据寄存器
 252              		@偏移0x18 = 端口开  0-15置位
 253              		@偏移0x28 = 端口关
 254              		@0X20 = 复用低
 255              		@GPIO口0（0-3位）每个IO口占用4位
 256              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 257              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 258              		@0x24 = 复用高
 259              		@GPIO口8 （0-3位）每个IO口占用4位
 260              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 261              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 262              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 263              	
 264 017a 6248     		ldr r0, = 0x48000000
 265 017c 6249     		ldr r1, = 0x28203d5f
 266 017e 0160     		str r1, [r0]
 267 0180 4C49     		ldr r1, = 0x200
 268 0182 4162     		str r1, [r0, # 0x24]
 269              	ting:
 270 0184 6148     		ldr r0, = jishu
 271 0186 6249     		ldr r1, = 0x800
 272 0188 0268     		ldr r2, [r0]
 273 018a 0132     		adds r2, r2, # 1
ARM GAS  1.s 			page 6


 274 018c 0260     		str r2, [r0]
 275 018e 8A42     		cmp r2, r1
 276 0190 03D1     		bne __xianshi
 277 0192 0022     		movs r2, # 0
 278 0194 0260     		str r2, [r0]
 279 0196 00F017F8 		bl __kai_dma
 280              	__xianshi:
 281 019a 5E48     		ldr r0, = dianyabiaozhizhen
 282 019c 0068     		ldr r0, [r0]
 283 019e 0068     		ldr r0, [r0]
 284              	       @ mov r3, r0
 285              		@ldr r0, = lvboqihuanchong
 286              		@ldr r1, = 32
 287              	        @ldr r2, = lvboqizhizhen
 288              	        @bl _lvboqi
 289 01a0 0000     		movs r0, r0
 290 01a2 05D5     		bpl __shu_ma_guan_xian_shi
 291 01a4 C043     		mvns r0, r0
 292 01a6 0130     		adds r0, r0, # 1
 293 01a8 5B4A     		ldr r2, = fuhao
 294 01aa 0023     		movs r3, # 0
 295 01ac 1360     		str r3, [r2]
 296 01ae 02E0     		b __led_xian_shi
 297              	__shu_ma_guan_xian_shi:
 298 01b0 594B     		ldr r3, = fuhao
 299 01b2 0222     		movs r2, # 0x02
 300 01b4 1A60     		str r2, [r3]
 301              	__led_xian_shi:	
 302 01b6 0421     		movs r1, # 4
 303 01b8 384A     	        ldr r2, = shumaguanma
 304 01ba FF23     		movs r3, # 0xff		@小数点位置
 305 01bc 00F0C8F8 	        bl _zhuanshumaguanma
 306 01c0 0520     		movs r0, # 5
 307 01c2 00F0DCF8 	        bl _xieshumaguan
 308 01c6 DDE7     		b ting
 309              	__kai_dma:
 310 01c8 07B5     		push {r0-r2,lr}
 311 01ca 3B4A     		ldr r2, = 0x40012400
 312 01cc 1121     		movs r1, # 0x11
 313 01ce 9160     		str r1, [r2, # 0x08]
 314              	__deng_adc_wan:
 315 01d0 9168     		ldr r1, [r2, # 0x08]
 316 01d2 0129     		cmp r1, # 1
 317 01d4 FCD1     		bne __deng_adc_wan
 318 01d6 3D48     		ldr r0, = 0x40020000
 319 01d8 0021     		movs r1, # 0
 320 01da 8160     		str r1, [r0, # 0x08]
 321 01dc 3E49     		ldr r1, = 912
 322 01de C160     		str r1, [r0, # 0x0c]
 323 01e0 3E49     		ldr r1, = 0x583
 324 01e2 8160     		str r1, [r0, # 0x08]
 325 01e4 0521     		movs r1, # 0x05
 326 01e6 9160     		str r1, [r2, # 0x08]
 327 01e8 07BD     		pop {r0-r2,pc}
 328              		
 329              	
 330              	__dft:
ARM GAS  1.s 			page 7


 331 01ea FFB5     		push {r0-r7,lr}
 332 01ec 4046     		mov r0, r8
 333 01ee 4946     		mov r1, r9
 334 01f0 5246     		mov r2, r10
 335 01f2 5B46     		mov r3, r11
 336 01f4 6446     		mov r4, r12
 337 01f6 1FB4     		push {r0-r4}
 338 01f8 3648     		ldr r0, = dianyabiao
 339 01fa 4849     		ldr r1, = xuanzhuanyinzi
 340 01fc 0122     		movs r2, # 1
 341 01fe D202     		lsls r2, r2, # 11
 342 0200 9046     		mov r8, r2
 343 0202 0023     		movs r3, # 0
 344 0204 9B46     		mov r11, r3
 345 0206 9C46     		mov r12, r3
 346              	__dft_xun_huan:	
 347 0208 C458     		ldr r4, [r0, r3]
 348 020a CA58     		ldr r2, [r1, r3]	@r
 349 020c 04B4     		push {r2}
 350 020e 0433     		adds r3, r3, # 4
 351 0210 C558     		ldr r5, [r0, r3]
 352 0212 C258     		ldr r2, [r0, r3]
 353 0214 0433     		adds r3, r3, # 4
 354 0216 2646     		mov r6, r4
 355 0218 2F46     		mov r7, r5
 356 021a 2404     		lsls r4, r4, # 16
 357 021c 240C     		lsrs r4, r4, # 16
 358 021e 360C     		lsrs r6, r6, # 16
 359 0220 2D04     		lsls r5, r5, # 16
 360 0222 2D0C     		lsrs r5, r5, # 16
 361 0224 3F0C     		lsrs r7, r7, # 16
 362 0226 A41B     		subs r4, r4, r6
 363 0228 ED1B     		subs r5, r5, r7
 364 022a 2646     		mov r6, r4
 365 022c 2F46     		mov r7, r5
 366 022e 5443     		muls r4, r4, r2		@i
 367 0230 5543     		muls r5, r5, r2		@i
 368 0232 E413     		asrs r4, r4, # 15
 369 0234 ED13     		asrs r5, r5, # 15
 370 0236 4A46     		mov r2, r9
 371 0238 1219     		adds r2, r2, r4
 372 023a 9146     		mov r9, r2
 373 023c 5246     		mov r2, r10
 374 023e 5219     		adds r2, r2, r5
 375 0240 9246     		mov r10, r2
 376 0242 04BC     		pop {r2}
 377 0244 5643     		muls r6, r6, r2		@i
 378 0246 5743     		muls r7, r7, r2		@i
 379 0248 5A46     		mov r2, r11		@r
 380 024a 9219     		adds r2, r2, r6
 381 024c 9346     		mov r11, r2
 382 024e 6246     		mov r2, r12
 383 0250 D219     		adds r2, r2, r7
 384 0252 9446     		mov r12, r2
 385 0254 4345     		cmp r3, r8
 386 0256 D7D1     		bne __dft_xun_huan
 387 0258 3148     		ldr r0, = shibu
ARM GAS  1.s 			page 8


 388 025a 3249     		ldr r1, = xubu
 389 025c 4A46     		mov r2, r9
 390 025e 5346     		mov r3, r10
 391 0260 5C46     		mov r4, r11
 392 0262 6546     		mov r5, r12
 393 0264 1212     		asrs r2, r2, # 8
 394 0266 1B12     		asrs r3, r3, # 8
 395 0268 2412     		asrs r4, r4, # 8
 396 026a 2D12     		asrs r5, r5, # 8
 397 026c 0260     		str r2, [r0]
 398 026e 4360     		str r3, [r0, # 0x04]
 399 0270 0C60     		str r4, [r1]
 400 0272 4D60     		str r5, [r1, # 0x04]
 401 0274 1FBC     		pop {r0-r4}
 402 0276 8046     		mov r8, r0
 403 0278 8946     		mov r9, r1
 404 027a 9246     		mov r10, r2
 405 027c 9B46     		mov r11, r3
 406 027e A446     		mov r12, r4
 407 0280 FFBD     		pop {r0-r7,pc}
 408 0282 00000020 		.ltorg
 408      02400010 
 408      02400100 
 408      01000200 
 408      15000000 
 409              		
 410              		
 411              		
 412              		
 413              	_lvboqi:
 414              				@滤波器
 415              				@R0=地址，R1=长度,r2=表指针地址,r3=ADC数值
 416              				@出R0=结果
 417 0328 FEB5     		push {r1-r7,lr}	
 418 032a 1568     		ldr r5, [r2]		@读出表指针
 419 032c 8E00     		lsls r6, r1, # 2	
 420 032e 4351     		str r3, [r0, r5]	@数值写到滤波器缓冲区
 421 0330 0435     		adds r5, r5, # 4
 422 0332 B542     		cmp r5, r6
 423 0334 00D1     		bne _lvboqimeidaohuanchongquding
 424 0336 0025     		movs r5, # 0
 425              	_lvboqimeidaohuanchongquding:
 426 0338 1560     		str r5, [r2]
 427 033a 0027     		movs r7, # 0
 428              	_lvboqixunhuan:
 429 033c B542     		cmp r5, r6
 430 033e 00D1     		bne _lvbozonghe
 431 0340 0025     		movs r5, # 0
 432              	_lvbozonghe:
 433 0342 4459     		ldr r4, [r0, r5]
 434 0344 0435     		adds r5, r5, # 4
 435 0346 3F19     		adds r7, r7, r4
 436 0348 0139     		subs r1, r1, # 1
 437 034a F7D1     		bne _lvboqixunhuan
 438 034c 7811     		asrs r0, r7, # 5	@修改
 439 034e FEBD     		pop {r1-r7,pc}
 440              	
ARM GAS  1.s 			page 9


 441              	_zhuanshumaguanma:@ 16进制转数码管码
 442              		@ R0要转的数据， R1长度，R2结果表首地址
 443              		@ r3 小数点位置
 444 0350 F0B5     		push {r4-r7,lr}
 445 0352 614F     		ldr r7, = shumaguanmabiao
 446 0354 0546     		mov r5, r0
 447 0356 0E46     		mov r6, r1
 448 0358 0A21     		movs r1, # 10
 449 035a 9846     		mov r8, r3
 450              	_xunhuanqiuma:
 451 035c 00F044F8 		bl _chufa
 452 0360 0446     		mov r4, r0
 453 0362 4C43     		muls r4, r1
 454 0364 2B1B     		subs r3, r5, r4
 455 0366 9B00     		lsls r3, # 2
 456 0368 FC58     		ldr r4, [r7, r3]
 457 036a 4645     		cmp r6, r8
 458 036c 00D0     		beq __tian_jia_xiao_shu_dian
 459 036e 00E0     		b __bao_cun_shu_ma_guan_ma
 460              	__tian_jia_xiao_shu_dian:
 461 0370 0134     		adds r4, r4, # 1
 462              	__bao_cun_shu_ma_guan_ma:	
 463 0372 1460     		str r4, [r2]
 464 0374 0546     		mov r5, r0
 465 0376 0432     		adds r2, r2, # 4
 466 0378 013E     		subs r6, # 1
 467 037a EFD1     		bne _xunhuanqiuma
 468 037c F0BD     		pop {r4-r7,pc}
 469              	_xieshumaguan: @ r0=位数 @数码管码
 470 037e FEB5     		push {r1-r7,lr}
 471 0380 8000     		lsls r0, r0, # 2
 472 0382 0027     		movs r7, # 0
 473 0384 0646     		mov r6, r0
 474 0386 554D     		ldr r5, = shumaguanma
 475 0388 554A     		ldr r2, = shumaguanshuaxinbiao
 476              	_shumaguanshuaxin:
 477 038a EB59     		ldr r3, [r5, r7]
 478 038c D459     		ldr r4, [r2, r7]
 479 038e 1C43     		orrs r4, r4, r3
 480 0390 2046     		mov r0, r4
 481 0392 00F004F8 		bl _xie595
 482 0396 0437     		adds  r7, r7, # 4
 483 0398 B742     		cmp r7, r6
 484 039a F6D9     		bls _shumaguanshuaxin
 485 039c FEBD     		pop {r1-r7,pc}
 486              		
 487              	_xie595: @ R0=要写的数据
 488 039e FEB5     		push {r1-r7,lr}
 489 03a0 0546     		mov r5, r0
 490 03a2 0820     		movs r0, # 0x08      @pa6
 491 03a4 1027     		movs r7, # 0x10      @pa7
 492 03a6 0426     		movs r6, # 0x04      @pa5 
 493 03a8 1023     		movs r3, # 16   @16位
 494 03aa 4E4A     		ldr r2, = 0x48000000 @ gpioa
 495 03ac 0121     		movs r1, # 0x01
 496              	_xunhuan595:
 497 03ae 9761     		str r7, [r2, # 0x18]
ARM GAS  1.s 			page 10


 498 03b0 00F014F8 		bl _yanshi
 499 03b4 0D42     		tst r5, r1
 500 03b6 01D1     		bne _xie595_0
 501 03b8 9062     		str r0, [r2, # 0x28]
 502 03ba 00E0     		b _suocun595
 503              	_xie595_0:
 504 03bc 9061     		str r0, [r2, # 0x18]
 505              	_suocun595:
 506 03be 00F00DF8 		bl _yanshi
 507 03c2 6D08     		lsrs r5, # 1
 508 03c4 9762     		str r7, [r2, # 0x28]
 509 03c6 00F009F8 		bl _yanshi
 510 03ca 013B     		subs r3, r3, # 1
 511 03cc EFD1     		bne _xunhuan595
 512 03ce 9661     		str r6, [r2, # 0x18]
 513 03d0 00F004F8 		bl _yanshi
 514 03d4 9662     		str r6, [r2, # 0x28]
 515 03d6 00F001F8 		bl _yanshi
 516 03da FEBD     		pop {r1-r7,pc}
 517              	
 518              	
 519              	_yanshi:
 520 03dc 80B4     		push {r7}
 521 03de 424F     		ldr r7, = 30
 522              	_yanshi11:
 523 03e0 013F     		subs r7, # 1
 524 03e2 FDD1     		bne _yanshi11
 525 03e4 80BC     		pop {r7}
 526 03e6 7047     		bx lr
 527              	
 528              	_chufa:				@软件除法
 529              		@ r0 除以 r1 等于 商(r0)余数R1
 530 03e8 1EB5     		push {r1-r4,lr}
 531 03ea 0028     		cmp r0, # 0
 532 03ec 0ED0     		beq _chufafanhui
 533 03ee 0029     		cmp r1, # 0
 534 03f0 0CD0     		beq _chufafanhui
 535 03f2 0246     		mov r2, r0
 536 03f4 0123     		movs r3, # 1
 537 03f6 DB07     		lsls r3, r3, # 31
 538 03f8 0020     		movs r0, # 0
 539 03fa 0446     		mov r4, r0
 540              	_chufaxunhuan:
 541 03fc 5200     		lsls r2, r2, # 1
 542 03fe 6441     		adcs r4, r4, r4
 543 0400 8C42     		cmp r4, r1
 544 0402 01D3     		bcc _chufaweishubudao0
 545 0404 C018     		adds r0, r0, r3
 546 0406 641A     		subs r4, r4, r1
 547              	_chufaweishubudao0:
 548 0408 5B08     		lsrs r3, r3, # 1
 549 040a F7D1     		bne _chufaxunhuan
 550              	_chufafanhui:
 551 040c 1EBD     		pop {r1-r4,pc}
 552              	__chu_fa:	@带符号
 553 040e FEB5     		push {r1-r7,lr}
 554 0410 0028     	        cmp r0, # 0
ARM GAS  1.s 			page 11


 555 0412 1DD0     	        beq _chufafanhui1
 556 0414 0029     	        cmp r1, # 0
 557 0416 1BD0     	        beq _chufafanhui1
 558 0418 0025     		movs r5, # 0
 559 041a 0000     		movs r0, r0
 560 041c 02D5     		bpl __pan_duan_bei_chu_shu
 561 041e 0135     		adds r5, r5, # 1
 562 0420 C043     		mvns r0, r0
 563 0422 0130     		adds r0, r0, # 1
 564              	__pan_duan_bei_chu_shu:
 565 0424 0900     		movs r1, r1
 566 0426 02D5     		bpl __ji_suan_chu_fa11
 567 0428 0135     		adds r5, r5, # 1
 568 042a C943     		mvns r1, r1
 569 042c 0131     		adds r1, r1, # 1
 570              	__ji_suan_chu_fa11:	
 571 042e 0246     	        mov r2, r0
 572 0430 0123     	        movs r3, # 1
 573 0432 DB07     	        lsls r3, r3, # 31
 574 0434 0020     	        movs r0, # 0
 575 0436 0446     	        mov r4, r0
 576              	_chufaxunhuan1:
 577 0438 5200     	        lsls r2, r2, # 1
 578 043a 6441     	        adcs r4, r4, r4
 579 043c 8C42     	        cmp r4, r1
 580 043e 01D3     		bcc _chufaweishubudao00
 581 0440 C018     		adds r0, r0, r3
 582 0442 641A     		subs r4, r4, r1
 583              	_chufaweishubudao00:
 584 0444 5B08     		lsrs r3, r3, # 1
 585 0446 F7D1     		bne _chufaxunhuan1
 586 0448 012D     		cmp r5, # 1
 587 044a 01D1     		bne _chufafanhui1
 588 044c C043     		mvns r0, r0
 589 044e 0130     		adds r0, r0, # 1
 590              	_chufafanhui1:
 591 0450 FEBD     		pop {r1-r7,pc}
 592              	__he_cheng_dian_ya_biao:
 593 0452 1FB5     		push {r0-r4,lr}
 594 0454 2548     	        ldr r0, = dianyabiao
 595 0456 0838     		subs r0, r0, # 0x08
 596              	__zhao_shang_sheng:
 597 0458 0830     		adds r0, r0, # 0x08
 598 045a 0288     		ldrh r2, [r0]
 599 045c 002A     		cmp r2, # 0
 600 045e FBD1     		bne __zhao_shang_sheng
 601 0460 0389     		ldrh r3, [r0, # 0x08]
 602 0462 D21A     		subs r2, r2, r3
 603 0464 F8D5     		bpl __zhao_shang_sheng
 604 0466 2249     		ldr r1, = dianyabiaozhizhen
 605 0468 0860     		str r0, [r1]
 606 046a 2249     	        ldr r1, = 256
 607 046c 8900     	        lsls r1, r1, # 2
 608 046e 0022     	        movs r2, # 0
 609              	__fu_zhi_xun_huan:
 610 0470 8358     	        ldr r3, [r0, r2]
 611 0472 1C46     	        mov r4, r3
ARM GAS  1.s 			page 12


 612 0474 1B04     	        lsls r3, r3, # 16
 613 0476 1B0C     	        lsrs r3, r3, # 16
 614 0478 240C     	        lsrs r4, r4, # 16
 615 047a 1B1B     		subs r3, r3, r4
 616 047c 07D5     	        bpl __bao_cun
 617 047e DB43     	        mvns r3, r3
 618 0480 0133     	        adds r3, r3, # 1
 619 0482 00F00BF8 	        bl __zhuan_bcd
 620 0486 1C4C     	        ldr r4, = 0x80000000
 621 0488 2343     	        orrs r3, r3, r4
 622 048a 00F002F8 	        bl __fu_shu_bao_cun
 623              	__bao_cun:
 624 048e 00F005F8 		bl __zhuan_bcd
 625              	__fu_shu_bao_cun:
 626 0492 8350     	        str r3, [r0, r2]
 627 0494 0432     		adds r2, r2, # 4
 628 0496 8A42     		cmp r2, r1
 629 0498 EAD1     	        bne __fu_zhi_xun_huan
 630 049a 1FBD     		pop {r0-r4,pc}
 631              		
 632              	__zhuan_bcd:
 633 049c F7B5     		push {r0-r2,r4-r7,lr}
 634 049e 0A21     		movs r1, # 10
 635 04a0 1846     		mov r0, r3
 636 04a2 1D46     		mov r5, r3
 637 04a4 0826     		movs r6, # 8
 638              	__bcd_xun_huan:
 639 04a6 FFF79FFF 		bl _chufa
 640 04aa 0446     		mov r4, r0
 641 04ac 4C43     		muls r4, r4, r1
 642 04ae 2D1B     		subs r5, r5, r4
 643 04b0 20B4     		push {r5}
 644 04b2 0546     		mov r5, r0
 645 04b4 013E     		subs r6, r6, # 1
 646 04b6 F6D1     		bne __bcd_xun_huan
 647 04b8 FFBC     		pop {r0-r7}
 648 04ba 3601     		lsls r6, r6, # 4
 649 04bc 2D02     		lsls r5, r5, # 8
 650 04be 2403     		lsls r4, r4, # 12
 651 04c0 1B04     		lsls r3, r3, # 16
 652 04c2 1205     		lsls r2, r2, # 20
 653 04c4 0906     		lsls r1, r1, # 24
 654 04c6 0007     		lsls r0, r0, # 28
 655 04c8 0343     		orrs r3, r3, r0
 656 04ca 0B43     		orrs r3, r3, r1
 657 04cc 1343     		orrs r3, r3, r2
 658 04ce 2343     		orrs r3, r3, r4
 659 04d0 2B43     		orrs r3, r3, r5
 660 04d2 3343     		orrs r3, r3, r6
 661 04d4 3B43     		orrs r3, r3, r7
 662 04d6 F7BD     		pop {r0-r2,r4-r7,pc}
 663 04d8 00000000 		.ltorg
 663      00000020 
 663      28000000 
 663      00000048 
 663      1E000000 
 664              	_nmi_handler:
ARM GAS  1.s 			page 13


 665 04fc 7047     		bx lr
 666              	_hard_fault:
 667 04fe 7047     		bx lr
 668              	_svc_handler:
 669 0500 7047     		bx lr
 670              	_pendsv_handler:
 671 0502 7047     		bx lr
 672              	aaa:
 673 0504 7047     		bx lr
 674              	_tim3:
 675 0506 0D48     		ldr r0, = jishu2
 676 0508 0168     		ldr r1, [r0]
 677 050a 0131     		adds r1, r1, #1
 678 050c 0160     		str r1, [r0]
 679              	_tim3fanhui:
 680 050e 0C48     		ldr r0, = 0x40000400
 681 0510 0021     		movs r1, # 0
 682 0512 0161     		str r1, [r0, # 0x10]
 683 0514 7047     		bx lr
 684              	_systickzhongduan:
 685 0516 0B48     		ldr r0, = 0x40020000
 686 0518 0B49     	        ldr r1, =  86
 687 051a C160     	        str r1, [r0, # 0x0c]
 688 051c 0B49     	        ldr r1, = 0xa83 @ 0xaa3 @ 5a1
 689 051e 8160     	        str r1, [r0, # 0x08]
 690              	
 691              		
 692 0520 0B48     		ldr r0, = 0xe0000d04
 693 0522 0C49     		ldr r1, = 0x02000000
 694 0524 0160     		str r1, [r0]                 @ 清除SYSTICK中断
 695 0526 7047     		bx lr
 696              	__dma_wan:
 697 0528 00B5     		push {lr}
 698 052a FFF792FF 		bl __he_cheng_dian_ya_biao
 699 052e 0548     		ldr r0, = 0x40020000
 700 0530 0222     	        movs r2, # 2
 701 0532 4260     		str r2, [r0, # 0x04]
 702 0534 0848     		ldr r0, = dianyabiaoman
 703 0536 0121     		movs r1, # 1
 704 0538 0160     		str r1, [r0]
 705              	__dma_fan_hui:
 706 053a 00BDF800 		pop {pc}
 706      00200004 
 706      00400000 
 706      02405600 
 706      0000830A 
ARM GAS  1.s 			page 14


DEFINED SYMBOLS
                 1.s:9      .data:0000000000000000 $d
                 1.s:10     .data:0000000000000000 shumaguanmabiao
                 1.s:12     .data:0000000000000028 shumaguanshuaxinbiao
                 1.s:14     .data:000000000000004c xuanzhuanyinzi
                 1.s:16     .data:000000000000104c yjmwxwx
                 1.s:17     *ABS*:0000000020001000 STACKINIT
                 1.s:18     *ABS*:0000000020000000 shumaguanma
                 1.s:19     *ABS*:0000000020000010 fuhao
                 1.s:20     *ABS*:00000000200000f4 dmawan
                 1.s:21     *ABS*:00000000200000f8 jishu2
                 1.s:22     *ABS*:00000000200000fc jishu
                 1.s:23     *ABS*:0000000020000120 shibu
                 1.s:24     *ABS*:0000000020000128 xubu
                 1.s:25     *ABS*:0000000020000140 shibuhuanchong
                 1.s:26     *ABS*:0000000020000150 lvboqizhizhen
                 1.s:27     *ABS*:0000000020000154 lvboqihuanchong
                 1.s:28     *ABS*:00000000200001f8 dianyabiaozhizhen
                 1.s:29     *ABS*:00000000200001fc dianyabiaoman
                 1.s:30     *ABS*:0000000020000200 dianyabiao
                 1.s:32     .text:0000000000000000 vectors
                 1.s:79     .text:00000000000000b0 _start
                 1.s:664    .text:00000000000004fc _nmi_handler
                 1.s:666    .text:00000000000004fe _hard_fault
                 1.s:668    .text:0000000000000500 _svc_handler
                 1.s:670    .text:0000000000000502 _pendsv_handler
                 1.s:684    .text:0000000000000516 _systickzhongduan
                 1.s:672    .text:0000000000000504 aaa
                 1.s:696    .text:0000000000000528 __dma_wan
                 1.s:674    .text:0000000000000506 _tim3
                            .text:0000000000000000 $d
                 1.s:77     .text:00000000000000b0 $t
                 1.s:80     .text:00000000000000b0 shizhong
                 1.s:87     .text:00000000000000bc denghse
                 1.s:91     .text:00000000000000c2 dengpllguan
                 1.s:103    .text:00000000000000d6 dengpll
                 1.s:111    .text:00000000000000e0 neicunqingling
                 1.s:115    .text:00000000000000e6 neicunqinglingxunhuan
                 1.s:120    .text:00000000000000ec _waisheshizhong
                 1.s:137    .text:00000000000000fa _waishezhongduan
                 1.s:148    .text:0000000000000100 _adcchushihua
                 1.s:152    .text:0000000000000106 _dengadcjiaozhun
                 1.s:156    .text:000000000000010c _kaiadc
                 1.s:161    .text:0000000000000114 _dengdaiadcwending
                 1.s:165    .text:0000000000000114 _tongdaoxuanze
                 1.s:179    .text:000000000000012c dmachushihua
                 1.s:201    .text:000000000000013e tim1chushiha
                 1.s:216    .text:000000000000015a tim3chushihua
                 1.s:243    .text:000000000000017a io_she_zhi
                 1.s:269    .text:0000000000000184 ting
                 1.s:280    .text:000000000000019a __xianshi
                 1.s:309    .text:00000000000001c8 __kai_dma
                 1.s:297    .text:00000000000001b0 __shu_ma_guan_xian_shi
                 1.s:301    .text:00000000000001b6 __led_xian_shi
                 1.s:441    .text:0000000000000350 _zhuanshumaguanma
                 1.s:469    .text:000000000000037e _xieshumaguan
                 1.s:314    .text:00000000000001d0 __deng_adc_wan
ARM GAS  1.s 			page 15


                 1.s:330    .text:00000000000001ea __dft
                 1.s:346    .text:0000000000000208 __dft_xun_huan
                 1.s:408    .text:0000000000000282 $d
                 1.s:408    .text:0000000000000284 $d
                 1.s:413    .text:0000000000000328 _lvboqi
                 1.s:417    .text:0000000000000328 $t
                 1.s:425    .text:0000000000000338 _lvboqimeidaohuanchongquding
                 1.s:428    .text:000000000000033c _lvboqixunhuan
                 1.s:432    .text:0000000000000342 _lvbozonghe
                 1.s:450    .text:000000000000035c _xunhuanqiuma
                 1.s:528    .text:00000000000003e8 _chufa
                 1.s:460    .text:0000000000000370 __tian_jia_xiao_shu_dian
                 1.s:462    .text:0000000000000372 __bao_cun_shu_ma_guan_ma
                 1.s:476    .text:000000000000038a _shumaguanshuaxin
                 1.s:487    .text:000000000000039e _xie595
                 1.s:496    .text:00000000000003ae _xunhuan595
                 1.s:519    .text:00000000000003dc _yanshi
                 1.s:503    .text:00000000000003bc _xie595_0
                 1.s:505    .text:00000000000003be _suocun595
                 1.s:522    .text:00000000000003e0 _yanshi11
                 1.s:550    .text:000000000000040c _chufafanhui
                 1.s:540    .text:00000000000003fc _chufaxunhuan
                 1.s:547    .text:0000000000000408 _chufaweishubudao0
                 1.s:552    .text:000000000000040e __chu_fa
                 1.s:590    .text:0000000000000450 _chufafanhui1
                 1.s:564    .text:0000000000000424 __pan_duan_bei_chu_shu
                 1.s:570    .text:000000000000042e __ji_suan_chu_fa11
                 1.s:576    .text:0000000000000438 _chufaxunhuan1
                 1.s:583    .text:0000000000000444 _chufaweishubudao00
                 1.s:592    .text:0000000000000452 __he_cheng_dian_ya_biao
                 1.s:596    .text:0000000000000458 __zhao_shang_sheng
                 1.s:609    .text:0000000000000470 __fu_zhi_xun_huan
                 1.s:623    .text:000000000000048e __bao_cun
                 1.s:632    .text:000000000000049c __zhuan_bcd
                 1.s:625    .text:0000000000000492 __fu_shu_bao_cun
                 1.s:638    .text:00000000000004a6 __bcd_xun_huan
                 1.s:663    .text:00000000000004d8 $d
                 1.s:665    .text:00000000000004fc $t
                 1.s:679    .text:000000000000050e _tim3fanhui
                 1.s:705    .text:000000000000053a __dma_fan_hui
                 1.s:706    .text:000000000000053c $d

NO UNDEFINED SYMBOLS
