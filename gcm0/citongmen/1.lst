ARM GAS  1.s 			page 1


   1              		@@ 单片机stm32f030f4p6
   2              		@磁通门传感器
   3              		@作者：yjmwxwx
   4              		@时间：2021-05-28
   5              		@编译器：ARM-NONE-EABI
   6              		.thumb
   7              		.syntax unified
   8              		.section .data
   9              	cos_sin_biao:
  10 0000 00800000 		.int 0x00008000,0x00000000,0x00007EFD,0xFFFFEFF6,0x00007BFA,0xFFFFE02B,0x00007702,0xFFFFD0E2,0x000
  10      00000000 
  10      FD7E0000 
  10      F6EFFFFF 
  10      FA7B0000 
  11              	
  12              	kong:
  13 1f40 20202020 		.int 0x20202020
  14              	_fu:
  15 1f44 2D       		.ascii "-"
  16              	yjmwxwx:
  17 1f45 796A6D77 		.ascii "yjmwxwx-20210528"
  17      7877782D 
  17      32303231 
  17      30353238 
  18 1f55 00000000 		.align 4
  18      00000000 
  18      000000
  19              		.equ STACKINIT,        	        0x20001000
  20              		.equ asciimabiao,		0x20000000
  21              		.equ lcd_beiguang,		0x20000020
  22              		.equ r, 			0x20000024
  23              		.equ i,				0x20000028
  24              		.equ dianyabiao,		0x20000100
  25              		.equ lvboqizhizhen,		0x200009b0
  26              		.equ lvboqihuanchong,		0x200009b8
  27              		.section .text
  28              	
  29              	vectors:
  30 0000 00100020 		.word STACKINIT
  31 0004 B1000000 		.word _start + 1
  32 0008 8F040000 		.word _nmi_handler + 1
  33 000c 91040000 		.word _hard_fault  + 1
  34 0010 00000000 		.word 0
  35 0014 00000000 		.word 0
  36 0018 00000000 		.word 0
  37 001c 00000000 		.word 0
  38 0020 00000000 		.word 0
  39 0024 00000000 		.word 0
  40 0028 00000000 		.word 0
  41 002c 93040000 		.word _svc_handler +1
  42 0030 00000000 		.word 0
  43 0034 00000000 		.word 0
  44 0038 95040000 		.word _pendsv_handler +1
  45 003c 97040000 		.word _systickzhongduan +1           @ 15
  46 0040 A5040000 		.word aaa +1     @ _wwdg +1          @ 0
  47 0044 A5040000 		.word aaa +1     @_pvd +1            @ 1
  48 0048 A5040000 		.word aaa +1     @_rtc +1            @ 2
ARM GAS  1.s 			page 2


  49 004c A5040000 		.word aaa +1     @_flash +1          @ 3
  50 0050 A5040000 		.word aaa +1	@ _rcc + 1           @ 4
  51 0054 A5040000 		.word aaa +1      @_exti0_1  +1      @ 5
  52 0058 A5040000 		.word aaa +1      @ _exti2_3 +1      @ 6
  53 005c A5040000 		.word aaa +1       @_exti4_15 +1     @ 7
  54 0060 A5040000 		.word aaa +1                         @ 8
  55 0064 A5040000 		.word aaa +1	@__dma_wan  +1	     @ 9
  56 0068 A5040000 		.word aaa +1    @_dma1_2_3 +1        @ 10
  57 006c A5040000 		.word aaa +1       @_dma1_4_5 +1     @ 11
  58 0070 A5040000 		.word aaa +1	 @_adc1 +1           @ 12
  59 0074 A5040000 		.word aaa +1       @_tim1_brk_up +1  @ 13
  60 0078 A5040000 		.word aaa +1        @ _tim1_cc +1    @ 14
  61 007c A5040000 		.word aaa +1         @_tim2 +1       @ 15
  62 0080 A5040000 		.word aaa +1          @_tim3 +1      @ 16
  63 0084 A5040000 		.word aaa +1                         @ 17
  64 0088 A5040000 		.word aaa +1		             @ 18
  65 008c A5040000 		.word aaa +1	@_tim14 +1           @ 19
  66 0090 A5040000 		.word aaa +1                         @ 20
  67 0094 A5040000 		.word aaa +1         @_tim16 +1      @ 21
  68 0098 A5040000 		.word aaa +1         @_tim17 +1      @ 22
  69 009c A5040000 		.word aaa +1          @_i2c   +1     @ 23
  70 00a0 A5040000 		.word aaa +1                         @ 24
  71 00a4 A5040000 		.word aaa +1           @_spi   +1    @ 25
  72 00a8 A5040000 		.word aaa +1                         @ 26
  73 00ac A5040000 		.word aaa +1         @_usart1 +1     @ 27
  74              		.align 2
  75              	_start:
  76              		
  77              	shizhong:
  78 00b0 8A4A     		ldr r2, = 0x40022000   @FLASH访问控制
  79 00b2 3221     		movs r1, # 0x32
  80 00b4 1160     		str r1, [r2]           @FLASH缓冲 缓冲开启
  81 00b6 8A48     		ldr r0, = 0x40021000 @ rcc
  82 00b8 8A49     		ldr r1, = 0x10001
  83 00ba 0160     		str r1, [r0]
  84              	denghse:
  85 00bc 0168     		ldr r1, [r0]
  86 00be 8903     		lsls r1, r1, # 14
  87 00c0 FCD5     		bpl denghse
  88              	dengpllguan:
  89 00c2 0168     		ldr r1, [r0]
  90 00c4 8901     		lsls r1, r1, # 6
  91 00c6 FCD4     		bmi dengpllguan
  92 00c8 8749     		ldr r1, = 0x150002	@0x150002
  93 00ca 0046     		mov r0, r0
  94 00cc 4160     		str r1, [r0, # 0x04]
  95 00ce 0046     		mov r0, r0
  96 00d0 8649     		ldr r1, = 0x1010000
  97 00d2 0046     		mov r0, r0
  98 00d4 0160     		str r1, [r0]
  99              	
 100              	dengpll:
 101 00d6 0168     		ldr r1, [r0]
 102 00d8 8901     		lsls r1, # 6
 103 00da FCD5     		bpl dengpll
 104              	
 105              	
ARM GAS  1.s 			page 3


 106 00dc 8449     		ldr r1, = 100
 107 00de 0163     		str r1, [r0, # 0x30]
 108              	
 109              	_waisheshizhong:	                         @ 外设时钟
 110              		@+0x14=RCC_AHBENR
 111              		@ 0=DMA @ 2=SRAM @ 4=FLITF@ 6=CRC @ 17=PA @ 18=PB @ 19=PC @ 20=PD @ 22=PF
 112 00e0 7F48     		ldr r0, = 0x40021000
 113 00e2 8449     		ldr r1, = 0x60001
 114 00e4 4161     		str r1, [r0, # 0x14]
 115              	
 116              		@+0x18外设时钟使能寄存器 (RCC_APB2ENR)
 117              		@0=SYSCFG @5=USART6EN @9=ADC @11=TIM1 @12=SPI1 @14=USART1 @16=TIM15 @17=TIM16 @18=TIM17 @22=DBGMCU
 118 00e6 8449     		ldr r1, = 0x1a00
 119 00e8 8161     		str r1, [r0, # 0x18]
 120              		@+0X1C=RCC_APB1ENR
 121              		@ 1=TIM3 @ 4=TIM6 @ 5=TIM7 @ 8=TIM14 @ 11=WWDG @ 14=SPI @ 17=USRT2 @ 18=USART3 @ 20=USART5 @ 21=I2
 122              		@ 22=I2C2 @ 23=USB @ 28=PWR
 123 00ea 844A     		ldr r2, = 0x902
 124 00ec C261     		str r2, [r0, # 0x1c]
 125              	
 126              	_neicunqingling:
 127 00ee 8448     		ldr r0, = 0x20000000
 128 00f0 0021     		movs r1, # 0
 129 00f2 844B     		ldr r3, = 0x1000
 130              	_neicunqinglingxunhuan:
 131 00f4 043B     		subs r3, # 4
 132 00f6 C150     		str r1, [r0, r3]
 133 00f8 FCD1     		bne _neicunqinglingxunhuan
 134              	
 135              	_waishezhongduan:					@外设中断
 136              		@0xE000E100    0-31  写1开，写0没效
 137              		@0XE000E180    0-31 写1关，写0没效
 138              		@0XE000E200    0-31 挂起，写0没效
 139              		@0XE000E280    0-31 清除， 写0没效
 140 00fa 8348     		ldr r0, =  0xe000e100
 141 00fc 8349     		ldr r1, = 0x200 @0x10200  @ 0x10000
 142 00fe 0160     		str r1, [r0]
 143              		
 144              	@_kanmengou:
 145              	@	ldr r0, = 0x40003000
 146              	@	ldr r1, = 0x5555
 147              	@	str r1, [r0]
 148              	@	movs r1, # 7
 149              	@	str r1, [r0, # 4]
 150              	@	ldr r1, = 0xfff
 151              	@	str r1, [r0, # 8]
 152              	@	ldr r1, = 0xaaaa
 153              	@	str r1, [r0]
 154              	@	ldr r1, = 0xcccc
 155              	@	str r1, [r0]
 156              		
 157              	io_she_zhi:
 158              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 159              		@a(0x48000000)b(0x48000400)c(0x48000800)d(0x48000c00)f(0x48001400)
 160              		@ 输入（00），通用输出（01），复用功能（10），模拟（11）
 161              		@偏移0x4 = 端口输出类型 @ （0 推挽），（ 1 开漏）
 162              		@偏移0x8 = 输出速度  00低速， 01中速， 11高速
ARM GAS  1.s 			page 4


 163              		@偏移0xC = 上拉下拉 (00无上下拉，  01 上拉， 10下拉)
 164              		@偏移0x10 = 输入数据寄存器
 165              		@偏移0x14 = 输出数据寄存器
 166              		@偏移0x18 = 端口开  0-15置位
 167              		@偏移0x28 = 端口关
 168              		@0X20 = 复用低
 169              		@GPIO口0（0-3位）每个IO口占用4位
 170              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 171              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 172              		@0x24 = 复用高
 173              		@GPIO口8 （0-3位）每个IO口占用4位
 174              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 175              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 176              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 177              	
 178 0100 8348     		ldr r0, = 0x48000000
 179 0102 8449     		ldr r1, = 0x2800a0d5
 180 0104 0160     		str r1, [r0]
 181 0106 8449     		ldr r1, = 0x11040000
 182 0108 0162     		str r1, [r0, # 0x20]
 183 010a 8049     		ldr r1, = 0x200
 184 010c 4162     		str r1, [r0, # 0x24]
 185              	
 186              	
 187              		
 188 010e 8348     		ldr r0, = 0x48000400
 189 0110 0821     		movs r1, # 0x08 @ pb1
 190 0112 0160     		str r1, [r0]
 191 0114 2021     		movs r1, # 0x20
 192 0116 0162     		str r1, [r0, # 0x20]
 193              	
 194              	
 195              	__kai_lcd_bei_guang:
 196 0118 8148     	        ldr r0, = lcd_beiguang
 197 011a C021     		movs r1, # 0xc0
 198 011c 0160     		str r1, [r0]
 199              	
 200              	_lcdchushihua:
 201 011e 3320     		movs r0, # 0x33
 202 0120 0021     		movs r1, # 0
 203 0122 00F04CF9 		bl _xielcd
 204 0126 00F045F9 		bl _lcdyanshi
 205              	
 206 012a 3220     		movs r0, # 0x32
 207 012c 0021     		movs r1, # 0
 208 012e 00F046F9 		bl _xielcd
 209 0132 00F03FF9 		bl _lcdyanshi
 210 0136 2820     		movs r0, # 0x28
 211 0138 0021     		movs r1, # 0
 212 013a 00F040F9 		bl _xielcd
 213 013e 00F039F9 		bl _lcdyanshi
 214 0142 0C20     		movs r0, # 0x0c
 215 0144 0021     		movs r1, # 0
 216 0146 00F03AF9 		bl _xielcd
 217 014a 00F033F9 		bl _lcdyanshi
 218 014e 0120     		movs r0, # 0x01
 219 0150 0021     		movs r1, # 0
ARM GAS  1.s 			page 5


 220 0152 00F034F9 		bl _xielcd
 221 0156 00F02DF9 		bl _lcdyanshi
 222              	
 223 015a 8020     		movs r0, # 0x80
 224 015c 7149     		ldr r1, = yjmwxwx
 225 015e 1022     		movs r2, # 16
 226 0160 00F01AF9 		bl _lcdxianshi
 227 0164 7048     		ldr r0, = 0xffffff
 228              	yjmwxwx_yanshi:
 229 0166 0138     		subs r0, r0, # 1
 230 0168 FDD1     		bne yjmwxwx_yanshi
 231              	
 232 016a 0120     		movs r0, # 0x01
 233 016c 0021     		movs r1, # 0
 234 016e 00F026F9 		bl _xielcd
 235 0172 00F01FF9 		bl _lcdyanshi
 236              	
 237              		
 238              	dmachushihua:
 239              		@+0=LSR,+4=IFCR,
 240              		@+8=CCR1,+c=CNDTR1,+10=CPAR1+14=CMAR1,
 241              		@+1c=CCR2,+20=CNDTR2,+24=CPAR2,+28=CMAR2
 242              		@+30=CCR3,+34=CNDTR3,+38=CPAR2,+3c=CMAR3
 243              		@+44=CCR4,+48=CNDTR4,+4c=CPAR4,+50=CMAR4
 244              		@+58=CCR5,+5c=CNDTR5,+60=CPAR5,+64=CMAR5
 245              		@+6C=CCR6,+70=CNDTR6,+74=CPAR6,+78=CMAR6
 246              		@+80=CCR7,+84=CNDTR7,+88=CPAR7,+8c=CMAR7
 247              	
 248              		@ adc dma
 249 0176 6D48     		ldr r0, = 0x40020000
 250 0178 6D49     		ldr r1, = 0x40012440
 251 017a 0161     		str r1, [r0, # 0x10]
 252 017c 6D49     		ldr r1, = dianyabiao
 253 017e 4161     		str r1, [r0, # 0x14]
 254 0180 6D49     		ldr r1, =  1100
 255 0182 C160     		str r1, [r0, # 0x0c]
 256 0184 6D49     		ldr r1, = 0x5a1 @0x581 @0x5a1 @0xaa1  
 257 0186 8160     		str r1, [r0, # 0x08]
 258              		
 259              	_adcchushihua:
 260 0188 6D48     		ldr r0, = 0x40012400  @ adc基地址
 261 018a 6E49     		ldr r1, = 0x80000000
 262 018c 8160     		str r1, [r0, # 0x08]  @ ADC 控制寄存器 (ADC_CR)  @adc校准
 263              	_dengadcjiaozhun:
 264 018e 8168     		ldr r1, [r0, # 0x08]
 265 0190 0900     		movs r1, r1
 266 0192 FCD4     		bmi _dengadcjiaozhun   @ 等ADC校准
 267 0194 0121     		movs r1, # 1
 268 0196 0160     		str r1, [r0]
 269              	_kaiadc:
 270 0198 8168     		ldr r1, [r0, # 0x08]
 271 019a 0122     		movs r2, # 0x01
 272 019c 1143     		orrs r1, r1, r2
 273 019e 8160     		str r1, [r0, # 0x08]
 274              	_deng_adc_wen_ding:
 275 01a0 0168     		ldr r1, [r0]
 276 01a2 C907     		lsls r1, r1, # 31
ARM GAS  1.s 			page 6


 277 01a4 FCD5     		bpl _deng_adc_wen_ding @ 等ADC稳定
 278              	_tongdaoxuanze:
 279 01a6 6849     		ldr r1, = 0x40000000
 280 01a8 0161     		str r1, [r0, # 0x10]
 281 01aa 0821     		movs r1, # 0x08
 282 01ac 8162     		str r1, [r0, # 0x28]    @ 通道选择寄存器 (ADC_CHSELR)
 283 01ae 6749     		ldr r1, = 0xc03 @连续0x2003  @TIM30x803
 284 01b0 C160     		str r1, [r0, # 0x0c]    @ 配置寄存器 1 (ADC_CFGR1)
 285 01b2 0021     		movs r1, # 0
 286 01b4 4161     		str r1, [r0, # 0x14]    @ ADC 采样时间寄存器 (ADC_SMPR)
 287 01b6 8168     		ldr r1, [r0, # 0x08]
 288 01b8 654A     		ldr r2, = 0x04         @ 开始转换
 289 01ba 1143     		orrs r1, r1, r2
 290 01bc 8160     		str r1, [r0, # 0x08]    @ 控制寄存器 (ADC_CR)
 291              	
 292              	_systick:	@ systick定时器初始化
 293              	
 294 01be 654F     		ldr r7, = 0xe000e010
 295 01c0 654E     		ldr r6, = 55999
 296 01c2 7E60     		str r6, [r7, # 4]
 297 01c4 BE60     		str r6, [r7, # 8]
 298 01c6 0726     		movs r6, # 0x07
 299              		
 300              	tim3chushihua:
 301 01c8 6448     		ldr r0, = 0x40000400 @ tim3_cr1
 302 01ca 0021     		movs r1, # 0
 303 01cc 8162     		str r1, [r0, # 0x28] @ psc
 304 01ce 4849     		ldr r1, = 100 @2799 @2799
 305 01d0 C162     		str r1, [r0, # 0x2c] @ ARR
 306 01d2 6349     		ldr r1, = 0x7868
 307 01d4 8161     		str r1, [r0, # 0x18]
 308 01d6 6349     		ldr r1, = 8  @200
 309 01d8 4163     		str r1, [r0, # 0x34]
 310 01da 6349     		ldr r1, = 92  @2599
 311 01dc 8163     		str r1, [r0, # 0x38]
 312 01de 3321     		movs r1, # 0x33
 313 01e0 0162     		str r1, [r0, # 0x20]
 314 01e2 0721     		movs r1, # 0x07
 315 01e4 8160     		str r1, [r0, # 0x08]
 316 01e6 6149     		ldr r1, = 0xe1
 317 01e8 0160     		str r1, [r0]
 318              	tim1chushiha:
 319 01ea 6148     		ldr r0, = 0x40012c00 @ tim1_cr1
 320 01ec 0021     		movs r1, # 0
 321 01ee 8162     		str r1, [r0, # 0x28] @ psc
 322 01f0 6049     		ldr r1, = 27
 323 01f2 C162     		str r1, [r0, # 0x2c] @ ARR
 324 01f4 2021     		movs r1, # 0x20
 325 01f6 4160     		str r1, [r0, # 0x04] @ TRGO
 326 01f8 5F49     		ldr r1, = 0x81
 327 01fa 0160     		str r1, [r0]
 328 01fc 3E60     		str r6, [r7]    @systick 开
 329              		
 330              		
 331              	ting:
 332              		
 333 01fe 5F48     		ldr r0, = r
ARM GAS  1.s 			page 7


 334 0200 5F4A     		ldr r2, = i
 335 0202 0168     		ldr r1, [r0]
 336 0204 1768     		ldr r7, [r2]
 337 0206 0C00     		movs r4, r1
 338 0208 07D5     		bpl a1
 339 020a 8020     		movs r0, # 0x80
 340 020c 5D49     		ldr r1, = _fu
 341 020e 0122     		movs r2, # 1
 342 0210 00F0C2F8 		bl _lcdxianshi
 343 0214 E443     		mvns r4, r4
 344 0216 0134     		adds r4, r4, # 1
 345 0218 04E0     		b a2
 346              	a1:
 347 021a 8020     		movs r0, # 0x80
 348 021c 5A49     		ldr r1, = kong
 349 021e 0122     		movs r2, # 1
 350 0220 00F0BAF8 		bl _lcdxianshi
 351              	a2:
 352 0224 2046     		mov r0, r4
 353 0226 0821     		movs r1, # 8
 354 0228 354A     		ldr r2, = asciimabiao
 355 022a FF23     		movs r3, # 0xff
 356 022c 00F003F9 		bl _zhuanascii
 357 0230 8120     		movs r0, # 0x81
 358 0232 3349     		ldr r1, = asciimabiao
 359 0234 0822     		movs r2, # 8
 360 0236 00F0AFF8 		bl _lcdxianshi
 361              	
 362              	
 363 023a 3C00     		movs r4, r7
 364 023c 07D5     		bpl b1
 365 023e C020     		movs r0, # 0xc0
 366 0240 5049     		ldr r1, = _fu
 367 0242 0122     		movs r2, # 1
 368 0244 00F0A8F8 		bl _lcdxianshi
 369 0248 E443     		mvns r4, r4
 370 024a 0134     		adds r4, r4, # 1
 371 024c 04E0     		b b2
 372              	b1:
 373 024e C020     		movs r0, # 0xc0
 374 0250 4D49     		ldr r1, = kong
 375 0252 0122     		movs r2, # 1
 376 0254 00F0A0F8 		bl _lcdxianshi
 377              	b2:
 378 0258 2046     		mov r0, r4
 379 025a 0821     		movs r1, # 8
 380 025c 284A     		ldr r2, = asciimabiao
 381 025e FF23     		movs r3, # 0xff
 382 0260 00F0E9F8 		bl _zhuanascii
 383 0264 C120     		movs r0, # 0xc1
 384 0266 2649     		ldr r1, = asciimabiao
 385 0268 0822     		movs r2, # 8
 386 026a 00F095F8 		bl _lcdxianshi
 387 026e C6E7     		b ting
 388              	
 389              	__dft:
 390 0270 FFB5     		push {r0-r7,lr}
ARM GAS  1.s 			page 8


 391 0272 4246     		mov r2, r8
 392 0274 04B4     		push {r2}
 393 0276 2F48     		ldr r0, = dianyabiao
 394 0278 4449     		ldr r1, = cos_sin_biao
 395 027a 454B     		ldr r3, = 1984	@ 点数*2-16
 396 027c 454C     		ldr r4, = 2048
 397 027e 1B18     		adds r3, r3, r0
 398 0280 9846     		mov r8, r3
 399 0282 0022     		movs r2, # 0
 400 0284 1746     		mov r7, r2
 401              	__dft_xunhuan:	
 402 0286 0388     		ldrh r3, [r0]
 403 0288 0D68     		ldr r5, [r1]
 404 028a 4E68     		ldr r6, [r1, # 0x04]
 405 028c 1B1B     		subs r3, r3, r4
 406 028e 5D43     		muls r5, r5, r3
 407 0290 ED13     		asrs r5, r5, # 15
 408 0292 5E43     		muls r6, r6, r3
 409 0294 F613     		asrs r6, r6, # 15
 410 0296 5219     		adds r2, r2, r5
 411 0298 BF19     		adds r7, r7, r6
 412 029a 0230     		adds r0, r0, # 0x02
 413 029c 0831     		adds r1, r1, # 0x08
 414 029e 4045     		cmp r0, r8
 415 02a0 F1D1     		bne __dft_xunhuan
 416 02a2 3648     		ldr r0, = r
 417 02a4 3649     		ldr r1, = i
 418 02a6 5212     		asrs r2, r2, # 9
 419 02a8 7F12     		asrs r7, r7, # 9
 420 02aa 0260     		str r2, [r0]
 421 02ac 0F60     		str r7, [r1]
 422 02ae 04BC     		pop {r2}
 423 02b0 9046     		mov r8, r2
 424 02b2 FFBD     		pop {r0-r7,pc}
 425              		
 426              	__lv_bo_qi:
 427              		@地址顺序：指针，累加值，缓冲区
 428              		@入口R0=缓冲区，R1=数据, r2,=指针
 429              		@出口R0
 430 02b4 78B5     		push {r3-r6,lr}
 431 02b6 4024     		movs r4, # 64 @128
 432 02b8 1568     		ldr r5, [r2]
 433 02ba 2B46     		mov r3, r5
 434 02bc AB00     		lsls r3, r5, # 2
 435 02be C658     		ldr r6, [r0, r3]
 436 02c0 C150     		str r1, [r0, r3]
 437 02c2 0135     		adds r5, r5, # 1
 438 02c4 1560     		str r5, [r2]
 439 02c6 A542     		cmp r5, r4
 440 02c8 01D1     		bne __huanchong_leijia
 441 02ca 0025     		movs r5, # 0
 442 02cc 1560     		str r5, [r2]
 443              	__huanchong_leijia:
 444 02ce 0438     		subs r0, r0, # 4
 445 02d0 0568     		ldr r5, [r0]
 446 02d2 4919     		adds r1, r1, r5
 447 02d4 891B     		subs r1, r1, r6
ARM GAS  1.s 			page 9


 448 02d6 0160     		str r1, [r0]
 449 02d8 8811     		asrs r0, r1, # 6 @  7	@128
 450 02da 78BD     		pop {r3-r6,pc}
 451 02dc 00200240 		.ltorg
 451      00100240 
 451      01000100 
 451      02001500 
 451      00000101 
 452              	
 453              		
 454              	_lcdxianshi:		  		@r0=LCD位置，r1=数据地址，r2=长度
 455 0398 1FB5     		push {r0-r4,lr}
 456 039a 0C46     		mov r4, r1
 457              	
 458 039c 0021     		movs r1, # 0
 459 039e 00F00EF8 		bl _xielcd
 460              	
 461 03a2 0121     		movs r1, # 1
 462 03a4 0023     		movs r3, # 0
 463              	_lcdxianshixunhuan:
 464 03a6 E05C     		ldrb r0, [r4,r3]
 465 03a8 00F009F8 		bl _xielcd
 466 03ac 0133     		adds r3, r3, # 1
 467 03ae 9342     		cmp r3, r2
 468 03b0 F9D1     		bne _lcdxianshixunhuan
 469 03b2 1FBD     		pop {r0-r4,pc}
 470              	
 471              	_lcdyanshi:
 472 03b4 20B5     		push {r5,lr}
 473 03b6 3C4D     		ldr r5, = 0x1000
 474              	_lcdyanshixunhuan:
 475 03b8 013D     		subs r5, r5, # 1
 476 03ba FDD1     		bne _lcdyanshixunhuan
 477 03bc 20BD     		pop {r5,pc}
 478              	
 479              	_xielcd:				@入R0=8位,r1=0命令,r1=1数据
 480 03be 3FB5     		push {r0-r5,lr}
 481 03c0 3A4C     		ldr r4, = lcd_beiguang  @ 量程开关 (第6位和第7位)
 482 03c2 0246     		mov r2, r0
 483 03c4 2568     		ldr r5, [r4]
 484 03c6 1209     		lsrs r2, r2, # 4
 485 03c8 9200     		lsls r2, r2, # 2	@ 高四位
 486 03ca 0007     		lsls r0, r0, # 28
 487 03cc 800E     		lsrs r0, r0, # 26	@ 低四位
 488 03ce C907     		lsls r1, r1, # 31
 489 03d0 01D5     		bpl __lcd_ming_ling
 490              	__lcd_shu_ju:
 491 03d2 0323     		movs r3, # 0x03		@ RS = 1 E = 1
 492 03d4 00E0     		b __xie_lcd_shu_ju
 493              	__lcd_ming_ling:
 494 03d6 0223     		movs r3, # 0x02		@ RS = 0 E = 1
 495              	__xie_lcd_shu_ju:
 496 03d8 5B19     		adds r3, r3, r5
 497 03da 0146     		mov r1, r0
 498 03dc D218     		adds r2, r2, r3
 499 03de 1000     		movs r0, r2
 500 03e0 00F00BF8 		bl __74hc595
ARM GAS  1.s 			page 10


 501 03e4 0238     		subs r0, r0, # 0x02
 502 03e6 00F008F8 		bl __74hc595
 503 03ea 0846     		mov r0, r1
 504 03ec C018     		adds r0, r0, r3
 505 03ee 00F004F8 		bl __74hc595
 506 03f2 0238     		subs r0, r0, # 0x02
 507 03f4 00F001F8 		bl __74hc595
 508 03f8 3FBD     		pop {r0-r5,pc}
 509              	
 510              	__74hc595:				@ 入R0=8位
 511 03fa FFB5     		push {r0-r7,lr}
 512 03fc 2C4E     		ldr r6, = 0x48000000
 513 03fe 0125     		movs r5, # 0x01		@ SRCLK
 514 0400 0222     		movs r2, # 0x02		@ RCLK
 515 0402 0423     		movs r3, # 0x04		@ SER
 516 0404 1824     		movs r4, # 24
 517              	__595_yiweixunhuan:
 518 0406 B261     		str r2, [r6, # 0x18]	@ rclk=0
 519 0408 B561     		str r5, [r6, # 0x18]	@ srclk=0
 520              		@movs r7, # 0xff
 521 040a 2A4F     		ldr r7, = 0x1ff
 522              	__595_yanshi:
 523 040c 013F     		subs r7, r7, # 1
 524 040e FDD1     		bne __595_yanshi
 525 0410 0146     		mov r1, r0
 526 0412 A140     		lsls r1, r1, r4
 527 0414 01D5     		bpl __ser_0
 528              	__ser_1:
 529 0416 B362     		str r3, [r6, # 0x28]	@ ser=1
 530 0418 00E0     		b __595_yiwei
 531              	__ser_0:
 532 041a B361     		str r3, [r6, # 0x18]	@ ser=0
 533              	__595_yiwei:
 534 041c B562     		str r5, [r6, # 0x28]
 535              		@movs r7, # 0xff
 536 041e 254F     		ldr r7, = 0x1ff
 537              	__595_yanshi1:
 538 0420 013F     		subs r7, r7, # 1
 539 0422 FDD1     		bne __595_yanshi1
 540 0424 0134     		adds r4, r4, # 1
 541 0426 202C     		cmp r4, # 32
 542 0428 EDD1     		bne __595_yiweixunhuan
 543 042a B262     		str r2, [r6, # 0x28]	@ rclk=1
 544              		@movs r7, # 0xff
 545 042c 214F     		ldr r7, = 0x1ff
 546              	__595_yanshi2:
 547 042e 013F     		subs r7, r7, # 1
 548 0430 FDD1     		bne __595_yanshi2
 549 0432 B261     		str r2, [r6, # 0x18]	@ rclk = 0
 550 0434 FFBD     		pop {r0-r7,pc}
 551              		
 552              	
 553              	_zhuanascii:						@ 16进制转ASCII
 554              		@ R0要转的数据， R1长度，R2结果表首地址, r3=小数点位置
 555 0436 FFB5     		push {r0-r7,lr}
 556 0438 1F46     		mov r7, r3
 557 043a 0546     		mov r5, r0
ARM GAS  1.s 			page 11


 558 043c 0E46     		mov r6, r1
 559 043e 0A21     		movs r1, # 10
 560              	_xunhuanqiuma:
 561 0440 00F012F8 		bl _chufa
 562 0444 0446     		mov r4, r0
 563 0446 4C43     		muls r4, r1
 564 0448 2B1B     		subs r3, r5, r4
 565 044a 3033     		adds r3, r3, # 0x30
 566 044c 0546     		mov r5, r0
 567 044e 013E     		subs r6, r6, # 1
 568 0450 08D0     		beq _qiumafanhui
 569 0452 BE42     		cmp r6, r7
 570 0454 02D1     		bne _meidaoxiaoshudian
 571 0456 2E24     		movs r4, # 0x2e		@小数点
 572 0458 9455     		strb r4, [r2,r6]	@插入小数点
 573 045a 013E     		subs r6, r6, # 1
 574              	_meidaoxiaoshudian:
 575 045c 9355     		strb r3, [r2,r6]
 576 045e 3600     		movs r6, r6
 577 0460 EED1     		bne _xunhuanqiuma
 578 0462 FFBD     		pop {r0-r7,pc}
 579              	_qiumafanhui:
 580 0464 9355     		strb r3, [r2, r6]
 581 0466 FFBD     		pop {r0-r7,pc}
 582              	
 583              	
 584              	
 585              		
 586              	
 587              	_chufa:				@软件除法
 588              		@ r0 除以 r1 等于 商(r0)
 589 0468 1EB5     		push {r1-r4,lr}
 590 046a 0028     		cmp r0, # 0
 591 046c 0ED0     		beq _chufafanhui
 592 046e 0029     		cmp r1, # 0
 593 0470 0CD0     		beq _chufafanhui
 594 0472 0246     		mov r2, r0
 595 0474 0123     		movs r3, # 1
 596 0476 DB07     		lsls r3, r3, # 31
 597 0478 0020     		movs r0, # 0
 598 047a 0446     		mov r4, r0
 599              	_chufaxunhuan:
 600 047c 5200     		lsls r2, r2, # 1
 601 047e 6441     		adcs r4, r4, r4
 602 0480 8C42     		cmp r4, r1
 603 0482 01D3     		bcc _chufaweishubudao0
 604 0484 C018     		adds r0, r0, r3
 605 0486 641A     		subs r4, r4, r1
 606              	_chufaweishubudao0:
 607 0488 5B08     		lsrs r3, r3, # 1
 608 048a F7D1     		bne _chufaxunhuan
 609              	_chufafanhui:
 610 048c 1EBD     		pop {r1-r4,pc}
 611              	
 612              	_nmi_handler:
 613 048e 7047     		bx lr
 614              	_hard_fault:
ARM GAS  1.s 			page 12


 615 0490 7047     		bx lr
 616              	_svc_handler:
 617 0492 7047     		bx lr
 618              	_pendsv_handler:
 619 0494 7047     		bx lr
 620              	_systickzhongduan:
 621 0496 00B5     		push {lr}
 622 0498 0748     		ldr r0, = 0xe0000d04
 623 049a 0849     		ldr r1, = 0x02000000
 624 049c 0160     		str r1, [r0]                 @ 清除SYSTICK中断
 625 049e FFF7E7FE 		bl __dft
 626 04a2 00BD     		pop {pc}
 627              	aaa:
 628 04a4 7047     		bx lr
 629 04a6 00000010 		.ltorg
 629      00002000 
 629      00200000 
 629      0048FF01 
 629      0000040D 
 630              		.end
ARM GAS  1.s 			page 13


DEFINED SYMBOLS
                 1.s:9      .data:0000000000000000 cos_sin_biao
                 1.s:12     .data:0000000000001f40 kong
                 1.s:14     .data:0000000000001f44 _fu
                 1.s:16     .data:0000000000001f45 yjmwxwx
                 1.s:18     .data:0000000000001f55 $d
                 1.s:19     *ABS*:0000000020001000 STACKINIT
                 1.s:20     *ABS*:0000000020000000 asciimabiao
                 1.s:21     *ABS*:0000000020000020 lcd_beiguang
                 1.s:22     *ABS*:0000000020000024 r
                 1.s:23     *ABS*:0000000020000028 i
                 1.s:24     *ABS*:0000000020000100 dianyabiao
                 1.s:25     *ABS*:00000000200009b0 lvboqizhizhen
                 1.s:26     *ABS*:00000000200009b8 lvboqihuanchong
                 1.s:29     .text:0000000000000000 vectors
                 1.s:75     .text:00000000000000b0 _start
                 1.s:612    .text:000000000000048e _nmi_handler
                 1.s:614    .text:0000000000000490 _hard_fault
                 1.s:616    .text:0000000000000492 _svc_handler
                 1.s:618    .text:0000000000000494 _pendsv_handler
                 1.s:620    .text:0000000000000496 _systickzhongduan
                 1.s:627    .text:00000000000004a4 aaa
                            .text:0000000000000000 $d
                 1.s:74     .text:00000000000000b0 $t
                 1.s:77     .text:00000000000000b0 shizhong
                 1.s:84     .text:00000000000000bc denghse
                 1.s:88     .text:00000000000000c2 dengpllguan
                 1.s:100    .text:00000000000000d6 dengpll
                 1.s:109    .text:00000000000000e0 _waisheshizhong
                 1.s:126    .text:00000000000000ee _neicunqingling
                 1.s:130    .text:00000000000000f4 _neicunqinglingxunhuan
                 1.s:135    .text:00000000000000fa _waishezhongduan
                 1.s:157    .text:0000000000000100 io_she_zhi
                 1.s:195    .text:0000000000000118 __kai_lcd_bei_guang
                 1.s:200    .text:000000000000011e _lcdchushihua
                 1.s:479    .text:00000000000003be _xielcd
                 1.s:471    .text:00000000000003b4 _lcdyanshi
                 1.s:454    .text:0000000000000398 _lcdxianshi
                 1.s:228    .text:0000000000000166 yjmwxwx_yanshi
                 1.s:238    .text:0000000000000176 dmachushihua
                 1.s:259    .text:0000000000000188 _adcchushihua
                 1.s:263    .text:000000000000018e _dengadcjiaozhun
                 1.s:269    .text:0000000000000198 _kaiadc
                 1.s:274    .text:00000000000001a0 _deng_adc_wen_ding
                 1.s:278    .text:00000000000001a6 _tongdaoxuanze
                 1.s:292    .text:00000000000001be _systick
                 1.s:300    .text:00000000000001c8 tim3chushihua
                 1.s:318    .text:00000000000001ea tim1chushiha
                 1.s:331    .text:00000000000001fe ting
                 1.s:346    .text:000000000000021a a1
                 1.s:351    .text:0000000000000224 a2
                 1.s:553    .text:0000000000000436 _zhuanascii
                 1.s:372    .text:000000000000024e b1
                 1.s:377    .text:0000000000000258 b2
                 1.s:389    .text:0000000000000270 __dft
                 1.s:401    .text:0000000000000286 __dft_xunhuan
                 1.s:426    .text:00000000000002b4 __lv_bo_qi
ARM GAS  1.s 			page 14


                 1.s:443    .text:00000000000002ce __huanchong_leijia
                 1.s:451    .text:00000000000002dc $d
                 1.s:455    .text:0000000000000398 $t
                 1.s:463    .text:00000000000003a6 _lcdxianshixunhuan
                 1.s:474    .text:00000000000003b8 _lcdyanshixunhuan
                 1.s:493    .text:00000000000003d6 __lcd_ming_ling
                 1.s:490    .text:00000000000003d2 __lcd_shu_ju
                 1.s:495    .text:00000000000003d8 __xie_lcd_shu_ju
                 1.s:510    .text:00000000000003fa __74hc595
                 1.s:517    .text:0000000000000406 __595_yiweixunhuan
                 1.s:522    .text:000000000000040c __595_yanshi
                 1.s:531    .text:000000000000041a __ser_0
                 1.s:528    .text:0000000000000416 __ser_1
                 1.s:533    .text:000000000000041c __595_yiwei
                 1.s:537    .text:0000000000000420 __595_yanshi1
                 1.s:546    .text:000000000000042e __595_yanshi2
                 1.s:560    .text:0000000000000440 _xunhuanqiuma
                 1.s:587    .text:0000000000000468 _chufa
                 1.s:579    .text:0000000000000464 _qiumafanhui
                 1.s:574    .text:000000000000045c _meidaoxiaoshudian
                 1.s:609    .text:000000000000048c _chufafanhui
                 1.s:599    .text:000000000000047c _chufaxunhuan
                 1.s:606    .text:0000000000000488 _chufaweishubudao0
                 1.s:629    .text:00000000000004a6 $d
                 1.s:629    .text:00000000000004a8 $d

NO UNDEFINED SYMBOLS
