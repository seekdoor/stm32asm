ARM GAS  1.s 			page 1


   1              		@@ 单片机stm32f030f4p6
   2              		@磁通门传感器
   3              		@作者：yjmwxwx
   4              		@时间：2021-05-28
   5              		@编译器：ARM-NONE-EABI
   6              		.thumb
   7              		.syntax unified
   8              		.section .data
   9              	cos_sin_biao:
  10 0000 00800000 		.int 0x00008000,0x00000000,0x00007F11,0xFFFFF093,0x00007C47,0xFFFFE15F,0x000077AE,0xFFFFD29D,0x000
  10      00000000 
  10      117F0000 
  10      93F0FFFF 
  10      477C0000 
  11              	
  12              	kong:
  13 0340 20202020 		.int 0x20202020
  14              	_fu:
  15 0344 2D       		.ascii "-"
  16              	yjmwxwx:
  17 0345 796A6D77 		.ascii "yjmwxwx-20210528"
  17      7877782D 
  17      32303231 
  17      30353238 
  18 0355 00000000 		.align 4
  18      00000000 
  18      000000
  19              		.equ STACKINIT,        	        0x20001000
  20              		.equ asciimabiao,		0x20000000
  21              		.equ lcd_beiguang,		0x20000020
  22              		.equ r, 			0x20000024
  23              		.equ i,				0x20000028
  24              		.equ dianyabiao,		0x20000100
  25              		.equ lvboqizhizhen,		0x200009b0
  26              		.equ lvboqihuanchong,		0x200009b8
  27              		.section .text
  28              	
  29              	vectors:
  30 0000 00100020 		.word STACKINIT
  31 0004 B1000000 		.word _start + 1
  32 0008 AB040000 		.word _nmi_handler + 1
  33 000c AD040000 		.word _hard_fault  + 1
  34 0010 00000000 		.word 0
  35 0014 00000000 		.word 0
  36 0018 00000000 		.word 0
  37 001c 00000000 		.word 0
  38 0020 00000000 		.word 0
  39 0024 00000000 		.word 0
  40 0028 00000000 		.word 0
  41 002c AF040000 		.word _svc_handler +1
  42 0030 00000000 		.word 0
  43 0034 00000000 		.word 0
  44 0038 B1040000 		.word _pendsv_handler +1
  45 003c B3040000 		.word _systickzhongduan +1           @ 15
  46 0040 C1040000 		.word aaa +1     @ _wwdg +1          @ 0
  47 0044 C1040000 		.word aaa +1     @_pvd +1            @ 1
  48 0048 C1040000 		.word aaa +1     @_rtc +1            @ 2
ARM GAS  1.s 			page 2


  49 004c C1040000 		.word aaa +1     @_flash +1          @ 3
  50 0050 C1040000 		.word aaa +1	@ _rcc + 1           @ 4
  51 0054 C1040000 		.word aaa +1      @_exti0_1  +1      @ 5
  52 0058 C1040000 		.word aaa +1      @ _exti2_3 +1      @ 6
  53 005c C1040000 		.word aaa +1       @_exti4_15 +1     @ 7
  54 0060 C1040000 		.word aaa +1                         @ 8
  55 0064 C1040000 		.word aaa +1	@__dma_wan  +1	     @ 9
  56 0068 C1040000 		.word aaa +1    @_dma1_2_3 +1        @ 10
  57 006c C1040000 		.word aaa +1       @_dma1_4_5 +1     @ 11
  58 0070 C1040000 		.word aaa +1	 @_adc1 +1           @ 12
  59 0074 C1040000 		.word aaa +1       @_tim1_brk_up +1  @ 13
  60 0078 C1040000 		.word aaa +1        @ _tim1_cc +1    @ 14
  61 007c C1040000 		.word aaa +1         @_tim2 +1       @ 15
  62 0080 C1040000 		.word aaa +1          @_tim3 +1      @ 16
  63 0084 C1040000 		.word aaa +1                         @ 17
  64 0088 C1040000 		.word aaa +1		             @ 18
  65 008c C1040000 		.word aaa +1	@_tim14 +1           @ 19
  66 0090 C1040000 		.word aaa +1                         @ 20
  67 0094 C1040000 		.word aaa +1         @_tim16 +1      @ 21
  68 0098 C1040000 		.word aaa +1         @_tim17 +1      @ 22
  69 009c C1040000 		.word aaa +1          @_i2c   +1     @ 23
  70 00a0 C1040000 		.word aaa +1                         @ 24
  71 00a4 C1040000 		.word aaa +1           @_spi   +1    @ 25
  72 00a8 C1040000 		.word aaa +1                         @ 26
  73 00ac C1040000 		.word aaa +1         @_usart1 +1     @ 27
  74              		.align 2
  75              	_start:
  76              		
  77              	shizhong:
  78 00b0 904A     		ldr r2, = 0x40022000   @FLASH访问控制
  79 00b2 3221     		movs r1, # 0x32
  80 00b4 1160     		str r1, [r2]           @FLASH缓冲 缓冲开启
  81 00b6 9048     		ldr r0, = 0x40021000 @ rcc
  82 00b8 9049     		ldr r1, = 0x10001
  83 00ba 0160     		str r1, [r0]
  84              	denghse:
  85 00bc 0168     		ldr r1, [r0]
  86 00be 8903     		lsls r1, r1, # 14
  87 00c0 FCD5     		bpl denghse
  88              	dengpllguan:
  89 00c2 0168     		ldr r1, [r0]
  90 00c4 8901     		lsls r1, r1, # 6
  91 00c6 FCD4     		bmi dengpllguan
  92 00c8 8D49     		ldr r1, = 0x150002	@0x150002
  93 00ca 0046     		mov r0, r0
  94 00cc 4160     		str r1, [r0, # 0x04]
  95 00ce 0046     		mov r0, r0
  96 00d0 8C49     		ldr r1, = 0x1010000
  97 00d2 0046     		mov r0, r0
  98 00d4 0160     		str r1, [r0]
  99              	
 100              	dengpll:
 101 00d6 0168     		ldr r1, [r0]
 102 00d8 8901     		lsls r1, # 6
 103 00da FCD5     		bpl dengpll
 104              	
 105              	
ARM GAS  1.s 			page 3


 106 00dc 8A49     		ldr r1, = 100
 107 00de 0163     		str r1, [r0, # 0x30]
 108              	
 109              	_waisheshizhong:	                         @ 外设时钟
 110              		@+0x14=RCC_AHBENR
 111              		@ 0=DMA @ 2=SRAM @ 4=FLITF@ 6=CRC @ 17=PA @ 18=PB @ 19=PC @ 20=PD @ 22=PF
 112 00e0 8548     		ldr r0, = 0x40021000
 113 00e2 8A49     		ldr r1, = 0x60001
 114 00e4 4161     		str r1, [r0, # 0x14]
 115              	
 116              		@+0x18外设时钟使能寄存器 (RCC_APB2ENR)
 117              		@0=SYSCFG @5=USART6EN @9=ADC @11=TIM1 @12=SPI1 @14=USART1 @16=TIM15 @17=TIM16 @18=TIM17 @22=DBGMCU
 118 00e6 8A49     		ldr r1, = 0x1a00
 119 00e8 8161     		str r1, [r0, # 0x18]
 120              		@+0X1C=RCC_APB1ENR
 121              		@ 1=TIM3 @ 4=TIM6 @ 5=TIM7 @ 8=TIM14 @ 11=WWDG @ 14=SPI @ 17=USRT2 @ 18=USART3 @ 20=USART5 @ 21=I2
 122              		@ 22=I2C2 @ 23=USB @ 28=PWR
 123 00ea 8A4A     		ldr r2, = 0x902
 124 00ec C261     		str r2, [r0, # 0x1c]
 125              	
 126              	_neicunqingling:
 127 00ee 8A48     		ldr r0, = 0x20000000
 128 00f0 0021     		movs r1, # 0
 129 00f2 8A4B     		ldr r3, = 0x1000
 130              	_neicunqinglingxunhuan:
 131 00f4 043B     		subs r3, # 4
 132 00f6 C150     		str r1, [r0, r3]
 133 00f8 FCD1     		bne _neicunqinglingxunhuan
 134              	
 135              	_waishezhongduan:					@外设中断
 136              		@0xE000E100    0-31  写1开，写0没效
 137              		@0XE000E180    0-31 写1关，写0没效
 138              		@0XE000E200    0-31 挂起，写0没效
 139              		@0XE000E280    0-31 清除， 写0没效
 140 00fa 8948     		ldr r0, =  0xe000e100
 141 00fc 8949     		ldr r1, = 0x200 @0x10200  @ 0x10000
 142 00fe 0160     		str r1, [r0]
 143              		
 144              	@_kanmengou:
 145              	@	ldr r0, = 0x40003000
 146              	@	ldr r1, = 0x5555
 147              	@	str r1, [r0]
 148              	@	movs r1, # 7
 149              	@	str r1, [r0, # 4]
 150              	@	ldr r1, = 0xfff
 151              	@	str r1, [r0, # 8]
 152              	@	ldr r1, = 0xaaaa
 153              	@	str r1, [r0]
 154              	@	ldr r1, = 0xcccc
 155              	@	str r1, [r0]
 156              		
 157              	io_she_zhi:
 158              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 159              		@a(0x48000000)b(0x48000400)c(0x48000800)d(0x48000c00)f(0x48001400)
 160              		@ 输入（00），通用输出（01），复用功能（10），模拟（11）
 161              		@偏移0x4 = 端口输出类型 @ （0 推挽），（ 1 开漏）
 162              		@偏移0x8 = 输出速度  00低速， 01中速， 11高速
ARM GAS  1.s 			page 4


 163              		@偏移0xC = 上拉下拉 (00无上下拉，  01 上拉， 10下拉)
 164              		@偏移0x10 = 输入数据寄存器
 165              		@偏移0x14 = 输出数据寄存器
 166              		@偏移0x18 = 端口开  0-15置位
 167              		@偏移0x28 = 端口关
 168              		@0X20 = 复用低
 169              		@GPIO口0（0-3位）每个IO口占用4位
 170              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 171              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 172              		@0x24 = 复用高
 173              		@GPIO口8 （0-3位）每个IO口占用4位
 174              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 175              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 176              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 177              	
 178 0100 8948     		ldr r0, = 0x48000000
 179 0102 8A49     		ldr r1, = 0x2800a0d5
 180 0104 0160     		str r1, [r0]
 181 0106 8A49     		ldr r1, = 0x11040000
 182 0108 0162     		str r1, [r0, # 0x20]
 183 010a 8649     		ldr r1, = 0x200
 184 010c 4162     		str r1, [r0, # 0x24]
 185              	
 186              	
 187              		
 188 010e 8948     		ldr r0, = 0x48000400
 189 0110 0821     		movs r1, # 0x08 @ pb1
 190 0112 0160     		str r1, [r0]
 191 0114 2021     		movs r1, # 0x20
 192 0116 0162     		str r1, [r0, # 0x20]
 193              	
 194              	
 195              	__kai_lcd_bei_guang:
 196 0118 8748     	        ldr r0, = lcd_beiguang
 197 011a C021     		movs r1, # 0xc0
 198 011c 0160     		str r1, [r0]
 199              	
 200              	_lcdchushihua:
 201 011e 3320     		movs r0, # 0x33
 202 0120 0021     		movs r1, # 0
 203 0122 00F05AF9 		bl _xielcd
 204 0126 00F053F9 		bl _lcdyanshi
 205              	
 206 012a 3220     		movs r0, # 0x32
 207 012c 0021     		movs r1, # 0
 208 012e 00F054F9 		bl _xielcd
 209 0132 00F04DF9 		bl _lcdyanshi
 210 0136 2820     		movs r0, # 0x28
 211 0138 0021     		movs r1, # 0
 212 013a 00F04EF9 		bl _xielcd
 213 013e 00F047F9 		bl _lcdyanshi
 214 0142 0C20     		movs r0, # 0x0c
 215 0144 0021     		movs r1, # 0
 216 0146 00F048F9 		bl _xielcd
 217 014a 00F041F9 		bl _lcdyanshi
 218 014e 0120     		movs r0, # 0x01
 219 0150 0021     		movs r1, # 0
ARM GAS  1.s 			page 5


 220 0152 00F042F9 		bl _xielcd
 221 0156 00F03BF9 		bl _lcdyanshi
 222              	
 223 015a 8020     		movs r0, # 0x80
 224 015c 7749     		ldr r1, = yjmwxwx
 225 015e 1022     		movs r2, # 16
 226 0160 00F028F9 		bl _lcdxianshi
 227 0164 7648     		ldr r0, = 0xffffff
 228              	yjmwxwx_yanshi:
 229 0166 0138     		subs r0, r0, # 1
 230 0168 FDD1     		bne yjmwxwx_yanshi
 231              	
 232 016a 0120     		movs r0, # 0x01
 233 016c 0021     		movs r1, # 0
 234 016e 00F034F9 		bl _xielcd
 235 0172 00F02DF9 		bl _lcdyanshi
 236              	
 237              		
 238              	dmachushihua:
 239              		@+0=LSR,+4=IFCR,
 240              		@+8=CCR1,+c=CNDTR1,+10=CPAR1+14=CMAR1,
 241              		@+1c=CCR2,+20=CNDTR2,+24=CPAR2,+28=CMAR2
 242              		@+30=CCR3,+34=CNDTR3,+38=CPAR2,+3c=CMAR3
 243              		@+44=CCR4,+48=CNDTR4,+4c=CPAR4,+50=CMAR4
 244              		@+58=CCR5,+5c=CNDTR5,+60=CPAR5,+64=CMAR5
 245              		@+6C=CCR6,+70=CNDTR6,+74=CPAR6,+78=CMAR6
 246              		@+80=CCR7,+84=CNDTR7,+88=CPAR7,+8c=CMAR7
 247              	
 248              		@ adc dma
 249 0176 7348     		ldr r0, = 0x40020000
 250 0178 7349     		ldr r1, = 0x40012440
 251 017a 0161     		str r1, [r0, # 0x10]
 252 017c 7349     		ldr r1, = dianyabiao
 253 017e 4161     		str r1, [r0, # 0x14]
 254 0180 7349     		ldr r1, =  1100
 255 0182 C160     		str r1, [r0, # 0x0c]
 256 0184 7349     		ldr r1, = 0x5a1 @0x581 @0x5a1 @0xaa1  
 257 0186 8160     		str r1, [r0, # 0x08]
 258              		
 259              	_adcchushihua:
 260 0188 7348     		ldr r0, = 0x40012400  @ adc基地址
 261 018a 7449     		ldr r1, = 0x80000000
 262 018c 8160     		str r1, [r0, # 0x08]  @ ADC 控制寄存器 (ADC_CR)  @adc校准
 263              	_dengadcjiaozhun:
 264 018e 8168     		ldr r1, [r0, # 0x08]
 265 0190 0900     		movs r1, r1
 266 0192 FCD4     		bmi _dengadcjiaozhun   @ 等ADC校准
 267 0194 0121     		movs r1, # 1
 268 0196 0160     		str r1, [r0]
 269              	_kaiadc:
 270 0198 8168     		ldr r1, [r0, # 0x08]
 271 019a 0122     		movs r2, # 0x01
 272 019c 1143     		orrs r1, r1, r2
 273 019e 8160     		str r1, [r0, # 0x08]
 274              	_deng_adc_wen_ding:
 275 01a0 0168     		ldr r1, [r0]
 276 01a2 C907     		lsls r1, r1, # 31
ARM GAS  1.s 			page 6


 277 01a4 FCD5     		bpl _deng_adc_wen_ding @ 等ADC稳定
 278              	_tongdaoxuanze:
 279 01a6 6E49     		ldr r1, = 0x40000000
 280 01a8 0161     		str r1, [r0, # 0x10]
 281 01aa 0821     		movs r1, # 0x08
 282 01ac 8162     		str r1, [r0, # 0x28]    @ 通道选择寄存器 (ADC_CHSELR)
 283 01ae 6D49     		ldr r1, = 0xc03 @连续0x2003  @TIM30x803
 284 01b0 C160     		str r1, [r0, # 0x0c]    @ 配置寄存器 1 (ADC_CFGR1)
 285 01b2 0021     		movs r1, # 0
 286 01b4 4161     		str r1, [r0, # 0x14]    @ ADC 采样时间寄存器 (ADC_SMPR)
 287 01b6 8168     		ldr r1, [r0, # 0x08]
 288 01b8 6B4A     		ldr r2, = 0x04         @ 开始转换
 289 01ba 1143     		orrs r1, r1, r2
 290 01bc 8160     		str r1, [r0, # 0x08]    @ 控制寄存器 (ADC_CR)
 291              	
 292              	_systick:	@ systick定时器初始化
 293              	
 294 01be 6B4F     		ldr r7, = 0xe000e010
 295 01c0 6B4E     		ldr r6, = 55999
 296 01c2 7E60     		str r6, [r7, # 4]
 297 01c4 BE60     		str r6, [r7, # 8]
 298 01c6 0726     		movs r6, # 0x07
 299              		
 300              	tim3chushihua:
 301 01c8 6A48     		ldr r0, = 0x40000400 @ tim3_cr1
 302 01ca 0021     		movs r1, # 0
 303 01cc 8162     		str r1, [r0, # 0x28] @ psc
 304 01ce 4E49     		ldr r1, = 100 @2799 @2799
 305 01d0 C162     		str r1, [r0, # 0x2c] @ ARR
 306 01d2 6949     		ldr r1, = 0x7868
 307 01d4 8161     		str r1, [r0, # 0x18]
 308 01d6 6949     		ldr r1, = 8  @200
 309 01d8 4163     		str r1, [r0, # 0x34]
 310 01da 6949     		ldr r1, = 92  @2599
 311 01dc 8163     		str r1, [r0, # 0x38]
 312 01de 3321     		movs r1, # 0x33
 313 01e0 0162     		str r1, [r0, # 0x20]
 314 01e2 0721     		movs r1, # 0x07
 315 01e4 8160     		str r1, [r0, # 0x08]
 316 01e6 6749     		ldr r1, = 0xe1
 317 01e8 0160     		str r1, [r0]
 318              	tim1chushiha:
 319 01ea 6748     		ldr r0, = 0x40012c00 @ tim1_cr1
 320 01ec 0021     		movs r1, # 0
 321 01ee 8162     		str r1, [r0, # 0x28] @ psc
 322 01f0 6649     		ldr r1, = 27
 323 01f2 C162     		str r1, [r0, # 0x2c] @ ARR
 324 01f4 2021     		movs r1, # 0x20
 325 01f6 4160     		str r1, [r0, # 0x04] @ TRGO
 326 01f8 6549     		ldr r1, = 0x81
 327 01fa 0160     		str r1, [r0]
 328 01fc 3E60     		str r6, [r7]    @systick 开
 329              		
 330              		
 331              	ting:
 332              		
 333 01fe 6548     		ldr r0, = r
ARM GAS  1.s 			page 7


 334 0200 6549     		ldr r1, = i
 335 0202 0668     		ldr r6, [r0]
 336 0204 0F68     		ldr r7, [r1]
 337 0206 3400     		movs r4, r6
 338 0208 07D5     		bpl a1
 339 020a 8020     		movs r0, # 0x80
 340 020c 6349     		ldr r1, = _fu
 341 020e 0122     		movs r2, # 1
 342 0210 00F0D0F8 		bl _lcdxianshi
 343 0214 E443     		mvns r4, r4
 344 0216 0134     		adds r4, r4, # 1
 345 0218 04E0     		b a2
 346              	a1:
 347 021a 8020     		movs r0, # 0x80
 348 021c 6049     		ldr r1, = kong
 349 021e 0122     		movs r2, # 1
 350 0220 00F0C8F8 		bl _lcdxianshi
 351              	a2:
 352 0224 2046     		mov r0, r4
 353 0226 0821     		movs r1, # 8
 354 0228 3B4A     		ldr r2, = asciimabiao
 355 022a FF23     		movs r3, # 0xff
 356 022c 00F011F9 		bl _zhuanascii
 357 0230 8120     		movs r0, # 0x81
 358 0232 3949     		ldr r1, = asciimabiao
 359 0234 0822     		movs r2, # 8
 360 0236 00F0BDF8 		bl _lcdxianshi
 361              	
 362              	
 363 023a 3C00     		movs r4, r7
 364 023c 07D5     		bpl b1
 365 023e C020     		movs r0, # 0xc0
 366 0240 5649     		ldr r1, = _fu
 367 0242 0122     		movs r2, # 1
 368 0244 00F0B6F8 		bl _lcdxianshi
 369 0248 E443     		mvns r4, r4
 370 024a 0134     		adds r4, r4, # 1
 371 024c 04E0     		b b2
 372              	b1:
 373 024e C020     		movs r0, # 0xc0
 374 0250 5349     		ldr r1, = kong
 375 0252 0122     		movs r2, # 1
 376 0254 00F0AEF8 		bl _lcdxianshi
 377              	b2:
 378 0258 2046     		mov r0, r4
 379 025a 0821     		movs r1, # 8
 380 025c 2E4A     		ldr r2, = asciimabiao
 381 025e FF23     		movs r3, # 0xff
 382 0260 00F0F7F8 		bl _zhuanascii
 383 0264 C120     		movs r0, # 0xc1
 384 0266 2C49     		ldr r1, = asciimabiao
 385 0268 0822     		movs r2, # 8
 386 026a 00F0A3F8 		bl _lcdxianshi
 387 026e C6E7     		b ting
 388              	
 389              	
 390              	
ARM GAS  1.s 			page 8


 391              	
 392              	
 393              	
 394              	
 395              	
 396              	
 397              	
 398              	
 399              	
 400              	
 401              	
 402              		
 403              	dada:	
 404 0270 3648     	        ldr r0, = 0x20000100
 405 0272 0088     		ldrh r0, [r0]
 406              	@	mov r1, r0
 407              	@	ldr r2, = lvboqizhizhen
 408              	@	ldr r0, =lvboqihuanchong
 409              	@	bl __lv_bo_qi
 410 0274 0621     		movs r1, # 6
 411 0276 284A     		ldr r2, = asciimabiao
 412 0278 FF23     		movs r3, # 0xff
 413 027a 00F0EAF8 		bl _zhuanascii
 414 027e 8020     		movs r0, # 0x80
 415 0280 2549     		ldr r1, = asciimabiao
 416 0282 0622     		movs r2, # 6
 417 0284 00F096F8 		bl _lcdxianshi
 418 0288 B9E7     		b ting
 419              	
 420              	
 421              	__dft:
 422 028a FFB5     		push {r0-r7,lr}
 423 028c 4246     		mov r2, r8
 424 028e 04B4     		push {r2}
 425 0290 2E48     		ldr r0, = dianyabiao
 426 0292 4449     		ldr r1, = cos_sin_biao
 427 0294 444B     		ldr r3, = 0x900
 428 0296 454C     		ldr r4, = 208 @2048
 429 0298 1B18     		adds r3, r3, r0
 430 029a 454B     		ldr r3, = 0x200001c0
 431 029c 9846     		mov r8, r3
 432 029e 0022     		movs r2, # 0
 433 02a0 1746     		mov r7, r2
 434              	__dft_xunhuan:	
 435 02a2 0388     		ldrh r3, [r0]
 436 02a4 0D68     		ldr r5, [r1]
 437 02a6 4E68     		ldr r6, [r1, # 0x04]
 438 02a8 1B1B     		subs r3, r3, r4
 439 02aa 5D43     		muls r5, r5, r3
 440 02ac ED13     		asrs r5, r5, # 15
 441 02ae 5E43     		muls r6, r6, r3
 442 02b0 F613     		asrs r6, r6, # 15
 443 02b2 5219     		adds r2, r2, r5
 444 02b4 BF19     		adds r7, r7, r6
 445 02b6 0230     		adds r0, r0, # 0x02
 446 02b8 0831     		adds r1, r1, # 0x08
 447 02ba 4045     		cmp r0, r8
ARM GAS  1.s 			page 9


 448 02bc F1D1     		bne __dft_xunhuan
 449 02be 3548     		ldr r0, = r
 450 02c0 3549     		ldr r1, = i
 451 02c2 0260     		str r2, [r0]
 452 02c4 0F60     		str r7, [r1]
 453 02c6 04BC     		pop {r2}
 454 02c8 9046     		mov r8, r2
 455 02ca FFBD     		pop {r0-r7,pc}
 456              		
 457              	__lv_bo_qi:
 458              		@地址顺序：指针，累加值，缓冲区
 459              		@入口R0=缓冲区，R1=数据, r2,=指针
 460              		@出口R0
 461 02cc 78B5     		push {r3-r6,lr}
 462 02ce 8024     		movs r4, # 128
 463 02d0 1568     		ldr r5, [r2]
 464 02d2 2B46     		mov r3, r5
 465 02d4 AB00     		lsls r3, r5, # 2
 466 02d6 C658     		ldr r6, [r0, r3]
 467 02d8 C150     		str r1, [r0, r3]
 468 02da 0135     		adds r5, r5, # 1
 469 02dc 1560     		str r5, [r2]
 470 02de A542     		cmp r5, r4
 471 02e0 01D1     		bne __huanchong_leijia
 472 02e2 0025     		movs r5, # 0
 473 02e4 1560     		str r5, [r2]
 474              	__huanchong_leijia:
 475 02e6 0438     		subs r0, r0, # 4
 476 02e8 0568     		ldr r5, [r0]
 477 02ea 4919     		adds r1, r1, r5
 478 02ec 891B     		subs r1, r1, r6
 479 02ee 0160     		str r1, [r0]
 480 02f0 C811     		asrs r0, r1, # 7	@128
 481 02f2 78BD     		pop {r3-r6,pc}
 482 02f4 00200240 		.ltorg
 482      00100240 
 482      01000100 
 482      02001500 
 482      00000101 
 483              	
 484              		
 485              	_lcdxianshi:		  		@r0=LCD位置，r1=数据地址，r2=长度
 486 03b4 1FB5     		push {r0-r4,lr}
 487 03b6 0C46     		mov r4, r1
 488              	
 489 03b8 0021     		movs r1, # 0
 490 03ba 00F00EF8 		bl _xielcd
 491              	
 492 03be 0121     		movs r1, # 1
 493 03c0 0023     		movs r3, # 0
 494              	_lcdxianshixunhuan:
 495 03c2 E05C     		ldrb r0, [r4,r3]
 496 03c4 00F009F8 		bl _xielcd
 497 03c8 0133     		adds r3, r3, # 1
 498 03ca 9342     		cmp r3, r2
 499 03cc F9D1     		bne _lcdxianshixunhuan
 500 03ce 1FBD     		pop {r0-r4,pc}
ARM GAS  1.s 			page 10


 501              	
 502              	_lcdyanshi:
 503 03d0 20B5     		push {r5,lr}
 504 03d2 3C4D     		ldr r5, = 0x1000
 505              	_lcdyanshixunhuan:
 506 03d4 013D     		subs r5, r5, # 1
 507 03d6 FDD1     		bne _lcdyanshixunhuan
 508 03d8 20BD     		pop {r5,pc}
 509              	
 510              	_xielcd:				@入R0=8位,r1=0命令,r1=1数据
 511 03da 3FB5     		push {r0-r5,lr}
 512 03dc 3A4C     		ldr r4, = lcd_beiguang  @ 量程开关 (第6位和第7位)
 513 03de 0246     		mov r2, r0
 514 03e0 2568     		ldr r5, [r4]
 515 03e2 1209     		lsrs r2, r2, # 4
 516 03e4 9200     		lsls r2, r2, # 2	@ 高四位
 517 03e6 0007     		lsls r0, r0, # 28
 518 03e8 800E     		lsrs r0, r0, # 26	@ 低四位
 519 03ea C907     		lsls r1, r1, # 31
 520 03ec 01D5     		bpl __lcd_ming_ling
 521              	__lcd_shu_ju:
 522 03ee 0323     		movs r3, # 0x03		@ RS = 1 E = 1
 523 03f0 00E0     		b __xie_lcd_shu_ju
 524              	__lcd_ming_ling:
 525 03f2 0223     		movs r3, # 0x02		@ RS = 0 E = 1
 526              	__xie_lcd_shu_ju:
 527 03f4 5B19     		adds r3, r3, r5
 528 03f6 0146     		mov r1, r0
 529 03f8 D218     		adds r2, r2, r3
 530 03fa 1000     		movs r0, r2
 531 03fc 00F00BF8 		bl __74hc595
 532 0400 0238     		subs r0, r0, # 0x02
 533 0402 00F008F8 		bl __74hc595
 534 0406 0846     		mov r0, r1
 535 0408 C018     		adds r0, r0, r3
 536 040a 00F004F8 		bl __74hc595
 537 040e 0238     		subs r0, r0, # 0x02
 538 0410 00F001F8 		bl __74hc595
 539 0414 3FBD     		pop {r0-r5,pc}
 540              	
 541              	__74hc595:				@ 入R0=8位
 542 0416 FFB5     		push {r0-r7,lr}
 543 0418 2C4E     		ldr r6, = 0x48000000
 544 041a 0125     		movs r5, # 0x01		@ SRCLK
 545 041c 0222     		movs r2, # 0x02		@ RCLK
 546 041e 0423     		movs r3, # 0x04		@ SER
 547 0420 1824     		movs r4, # 24
 548              	__595_yiweixunhuan:
 549 0422 B261     		str r2, [r6, # 0x18]	@ rclk=0
 550 0424 B561     		str r5, [r6, # 0x18]	@ srclk=0
 551              		@movs r7, # 0xff
 552 0426 2A4F     		ldr r7, = 0x1ff
 553              	__595_yanshi:
 554 0428 013F     		subs r7, r7, # 1
 555 042a FDD1     		bne __595_yanshi
 556 042c 0146     		mov r1, r0
 557 042e A140     		lsls r1, r1, r4
ARM GAS  1.s 			page 11


 558 0430 01D5     		bpl __ser_0
 559              	__ser_1:
 560 0432 B362     		str r3, [r6, # 0x28]	@ ser=1
 561 0434 00E0     		b __595_yiwei
 562              	__ser_0:
 563 0436 B361     		str r3, [r6, # 0x18]	@ ser=0
 564              	__595_yiwei:
 565 0438 B562     		str r5, [r6, # 0x28]
 566              		@movs r7, # 0xff
 567 043a 254F     		ldr r7, = 0x1ff
 568              	__595_yanshi1:
 569 043c 013F     		subs r7, r7, # 1
 570 043e FDD1     		bne __595_yanshi1
 571 0440 0134     		adds r4, r4, # 1
 572 0442 202C     		cmp r4, # 32
 573 0444 EDD1     		bne __595_yiweixunhuan
 574 0446 B262     		str r2, [r6, # 0x28]	@ rclk=1
 575              		@movs r7, # 0xff
 576 0448 214F     		ldr r7, = 0x1ff
 577              	__595_yanshi2:
 578 044a 013F     		subs r7, r7, # 1
 579 044c FDD1     		bne __595_yanshi2
 580 044e B261     		str r2, [r6, # 0x18]	@ rclk = 0
 581 0450 FFBD     		pop {r0-r7,pc}
 582              		
 583              	
 584              	_zhuanascii:						@ 16进制转ASCII
 585              		@ R0要转的数据， R1长度，R2结果表首地址, r3=小数点位置
 586 0452 FFB5     		push {r0-r7,lr}
 587 0454 1F46     		mov r7, r3
 588 0456 0546     		mov r5, r0
 589 0458 0E46     		mov r6, r1
 590 045a 0A21     		movs r1, # 10
 591              	_xunhuanqiuma:
 592 045c 00F012F8 		bl _chufa
 593 0460 0446     		mov r4, r0
 594 0462 4C43     		muls r4, r1
 595 0464 2B1B     		subs r3, r5, r4
 596 0466 3033     		adds r3, r3, # 0x30
 597 0468 0546     		mov r5, r0
 598 046a 013E     		subs r6, r6, # 1
 599 046c 08D0     		beq _qiumafanhui
 600 046e BE42     		cmp r6, r7
 601 0470 02D1     		bne _meidaoxiaoshudian
 602 0472 2E24     		movs r4, # 0x2e		@小数点
 603 0474 9455     		strb r4, [r2,r6]	@插入小数点
 604 0476 013E     		subs r6, r6, # 1
 605              	_meidaoxiaoshudian:
 606 0478 9355     		strb r3, [r2,r6]
 607 047a 3600     		movs r6, r6
 608 047c EED1     		bne _xunhuanqiuma
 609 047e FFBD     		pop {r0-r7,pc}
 610              	_qiumafanhui:
 611 0480 9355     		strb r3, [r2, r6]
 612 0482 FFBD     		pop {r0-r7,pc}
 613              	
 614              	
ARM GAS  1.s 			page 12


 615              	
 616              		
 617              	
 618              	_chufa:				@软件除法
 619              		@ r0 除以 r1 等于 商(r0)
 620 0484 1EB5     		push {r1-r4,lr}
 621 0486 0028     		cmp r0, # 0
 622 0488 0ED0     		beq _chufafanhui
 623 048a 0029     		cmp r1, # 0
 624 048c 0CD0     		beq _chufafanhui
 625 048e 0246     		mov r2, r0
 626 0490 0123     		movs r3, # 1
 627 0492 DB07     		lsls r3, r3, # 31
 628 0494 0020     		movs r0, # 0
 629 0496 0446     		mov r4, r0
 630              	_chufaxunhuan:
 631 0498 5200     		lsls r2, r2, # 1
 632 049a 6441     		adcs r4, r4, r4
 633 049c 8C42     		cmp r4, r1
 634 049e 01D3     		bcc _chufaweishubudao0
 635 04a0 C018     		adds r0, r0, r3
 636 04a2 641A     		subs r4, r4, r1
 637              	_chufaweishubudao0:
 638 04a4 5B08     		lsrs r3, r3, # 1
 639 04a6 F7D1     		bne _chufaxunhuan
 640              	_chufafanhui:
 641 04a8 1EBD     		pop {r1-r4,pc}
 642              	
 643              	_nmi_handler:
 644 04aa 7047     		bx lr
 645              	_hard_fault:
 646 04ac 7047     		bx lr
 647              	_svc_handler:
 648 04ae 7047     		bx lr
 649              	_pendsv_handler:
 650 04b0 7047     		bx lr
 651              	_systickzhongduan:
 652 04b2 00B5     		push {lr}
 653 04b4 0748     		ldr r0, = 0xe0000d04
 654 04b6 0849     		ldr r1, = 0x02000000
 655 04b8 0160     		str r1, [r0]                 @ 清除SYSTICK中断
 656 04ba FFF7E6FE 		bl __dft
 657 04be 00BD     		pop {pc}
 658              	aaa:
 659 04c0 7047     		bx lr
 660 04c2 00000010 		.ltorg
 660      00002000 
 660      00200000 
 660      0048FF01 
 660      0000040D 
 661              		.end
ARM GAS  1.s 			page 13


DEFINED SYMBOLS
                 1.s:9      .data:0000000000000000 cos_sin_biao
                 1.s:12     .data:0000000000000340 kong
                 1.s:14     .data:0000000000000344 _fu
                 1.s:16     .data:0000000000000345 yjmwxwx
                 1.s:18     .data:0000000000000355 $d
                 1.s:19     *ABS*:0000000020001000 STACKINIT
                 1.s:20     *ABS*:0000000020000000 asciimabiao
                 1.s:21     *ABS*:0000000020000020 lcd_beiguang
                 1.s:22     *ABS*:0000000020000024 r
                 1.s:23     *ABS*:0000000020000028 i
                 1.s:24     *ABS*:0000000020000100 dianyabiao
                 1.s:25     *ABS*:00000000200009b0 lvboqizhizhen
                 1.s:26     *ABS*:00000000200009b8 lvboqihuanchong
                 1.s:29     .text:0000000000000000 vectors
                 1.s:75     .text:00000000000000b0 _start
                 1.s:643    .text:00000000000004aa _nmi_handler
                 1.s:645    .text:00000000000004ac _hard_fault
                 1.s:647    .text:00000000000004ae _svc_handler
                 1.s:649    .text:00000000000004b0 _pendsv_handler
                 1.s:651    .text:00000000000004b2 _systickzhongduan
                 1.s:658    .text:00000000000004c0 aaa
                            .text:0000000000000000 $d
                 1.s:74     .text:00000000000000b0 $t
                 1.s:77     .text:00000000000000b0 shizhong
                 1.s:84     .text:00000000000000bc denghse
                 1.s:88     .text:00000000000000c2 dengpllguan
                 1.s:100    .text:00000000000000d6 dengpll
                 1.s:109    .text:00000000000000e0 _waisheshizhong
                 1.s:126    .text:00000000000000ee _neicunqingling
                 1.s:130    .text:00000000000000f4 _neicunqinglingxunhuan
                 1.s:135    .text:00000000000000fa _waishezhongduan
                 1.s:157    .text:0000000000000100 io_she_zhi
                 1.s:195    .text:0000000000000118 __kai_lcd_bei_guang
                 1.s:200    .text:000000000000011e _lcdchushihua
                 1.s:510    .text:00000000000003da _xielcd
                 1.s:502    .text:00000000000003d0 _lcdyanshi
                 1.s:485    .text:00000000000003b4 _lcdxianshi
                 1.s:228    .text:0000000000000166 yjmwxwx_yanshi
                 1.s:238    .text:0000000000000176 dmachushihua
                 1.s:259    .text:0000000000000188 _adcchushihua
                 1.s:263    .text:000000000000018e _dengadcjiaozhun
                 1.s:269    .text:0000000000000198 _kaiadc
                 1.s:274    .text:00000000000001a0 _deng_adc_wen_ding
                 1.s:278    .text:00000000000001a6 _tongdaoxuanze
                 1.s:292    .text:00000000000001be _systick
                 1.s:300    .text:00000000000001c8 tim3chushihua
                 1.s:318    .text:00000000000001ea tim1chushiha
                 1.s:331    .text:00000000000001fe ting
                 1.s:346    .text:000000000000021a a1
                 1.s:351    .text:0000000000000224 a2
                 1.s:584    .text:0000000000000452 _zhuanascii
                 1.s:372    .text:000000000000024e b1
                 1.s:377    .text:0000000000000258 b2
                 1.s:403    .text:0000000000000270 dada
                 1.s:421    .text:000000000000028a __dft
                 1.s:434    .text:00000000000002a2 __dft_xunhuan
ARM GAS  1.s 			page 14


                 1.s:457    .text:00000000000002cc __lv_bo_qi
                 1.s:474    .text:00000000000002e6 __huanchong_leijia
                 1.s:482    .text:00000000000002f4 $d
                 1.s:486    .text:00000000000003b4 $t
                 1.s:494    .text:00000000000003c2 _lcdxianshixunhuan
                 1.s:505    .text:00000000000003d4 _lcdyanshixunhuan
                 1.s:524    .text:00000000000003f2 __lcd_ming_ling
                 1.s:521    .text:00000000000003ee __lcd_shu_ju
                 1.s:526    .text:00000000000003f4 __xie_lcd_shu_ju
                 1.s:541    .text:0000000000000416 __74hc595
                 1.s:548    .text:0000000000000422 __595_yiweixunhuan
                 1.s:553    .text:0000000000000428 __595_yanshi
                 1.s:562    .text:0000000000000436 __ser_0
                 1.s:559    .text:0000000000000432 __ser_1
                 1.s:564    .text:0000000000000438 __595_yiwei
                 1.s:568    .text:000000000000043c __595_yanshi1
                 1.s:577    .text:000000000000044a __595_yanshi2
                 1.s:591    .text:000000000000045c _xunhuanqiuma
                 1.s:618    .text:0000000000000484 _chufa
                 1.s:610    .text:0000000000000480 _qiumafanhui
                 1.s:605    .text:0000000000000478 _meidaoxiaoshudian
                 1.s:640    .text:00000000000004a8 _chufafanhui
                 1.s:630    .text:0000000000000498 _chufaxunhuan
                 1.s:637    .text:00000000000004a4 _chufaweishubudao0
                 1.s:660    .text:00000000000004c2 $d
                 1.s:660    .text:00000000000004c4 $d

NO UNDEFINED SYMBOLS
