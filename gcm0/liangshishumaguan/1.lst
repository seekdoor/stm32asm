ARM GAS  1.s 			page 1


   1              		@@单片机stm32f030f4p6
   2              		@@电容小麦水分测量数码管版
   3              		@作者：yjmwxwx
   4              		@时间：2019-05-26
   5              		@编译器：ARM-NONE-EABI-AS
   6              		 .thumb
   7              		         .syntax unified
   8              		.section .data
   9              	shumaguanmabiao:
  10 0000 FC000000 		.int 0xfc,0x60,0xda,0xf2,0x66,0xb6,0xbe,0xe0,0xfe,0xf6
  10      60000000 
  10      DA000000 
  10      F2000000 
  10      66000000 
  11              	shumaguanshuaxinbiao:
  12 0028 00FE0000 		.int 0xfe00,0xfd00,0xfb00,0xf700,0xef00,0xdf00,0xbf00,0x7f00,0
  12      00FD0000 
  12      00FB0000 
  12      00F70000 
  12      00EF0000 
  13              	
  14              	zheng_xian_biao:
  15 004c 30003300 		.short 0x30,0x33,0x36,0x38,0x3b,0x3e,0x41,0x44,0x47,0x49,0x4c,0x4e,0x50,0x52,0x54,0x56,0x58,0x59,0
  15      36003800 
  15      3B003E00 
  15      41004400 
  15      47004900 
  16              	yjmwxwx:
  17 0114 796A6D77 		.ascii  "yjmwxwx-201906003-xiao_mai_shui_fen_shu_ma_guan"
  17      7877782D 
  17      32303139 
  17      30363030 
  17      332D7869 
  18              		.equ STACKINIT,        	        0x20001000
  19              		.equ shumaguanma,		0x20000000
  20              		.equ jishu,			0x20000030
  21              		.equ lvbozhizhen,		0x20000040
  22              		.equ lvbohuanchong,		0x20000044
  23              		.equ adccaiyang,		0x20000500
  24              		.section .text
  25              	vectors:
  26 0000 00100020 		.word STACKINIT
  27 0004 B1000000 		.word _start + 1
  28 0008 E7020000 		.word _nmi_handler + 1
  29 000c E9020000 		.word _hard_fault  + 1
  30 0010 00000000 		.word 0
  31 0014 00000000 		.word 0
  32 0018 00000000 		.word 0
  33 001c 00000000 		.word 0
  34 0020 00000000 		.word 0
  35 0024 00000000 		.word 0
  36 0028 00000000 		.word 0
  37 002c EB020000 		.word _svc_handler +1
  38 0030 00000000 		.word 0
  39 0034 00000000 		.word 0
  40 0038 ED020000 		.word _pendsv_handler +1
  41 003c EF020000 		.word _systickzhongduan +1               @ 15
ARM GAS  1.s 			page 2


  42 0040 FD020000 		.word aaa +1     @ _wwdg +1          @ 0
  43 0044 FD020000 		.word aaa +1     @_pvd +1            @ 1
  44 0048 FD020000 		.word aaa +1     @_rtc +1            @ 2
  45 004c FD020000 		.word aaa +1     @_flash +1          @ 3
  46 0050 FD020000 		.word aaa +1	@ _rcc + 1          @ 4
  47 0054 FD020000 		.word aaa +1      @_exti0_1  +1      @ 5
  48 0058 FD020000 		.word aaa +1      @ _exti2_3 +1      @ 6
  49 005c FD020000 		.word aaa +1       @_exti4_15 +1     @ 7
  50 0060 FD020000 		.word aaa +1                         @ 8
  51 0064 FD020000 		.word aaa +1 	@_dma1_1  +1    @ 9
  52 0068 FD020000 		.word aaa +1    @_dma1_2_3 +1        @ 10
  53 006c FD020000 		.word aaa +1       @_dma1_4_5 +1     @ 11
  54 0070 FD020000 		.word aaa +1	 @_adc1 +1          @ 12
  55 0074 FD020000 		.word aaa +1       @_tim1_brk_up +1  @ 13
  56 0078 FD020000 		.word aaa +1        @ _tim1_cc +1    @ 14
  57 007c FD020000 		.word aaa +1         @_tim2 +1       @ 15
  58 0080 FD020000 		.word aaa +1          @_tim3 +1      @ 16
  59 0084 FD020000 		.word aaa +1                         @ 17
  60 0088 FD020000 		.word aaa +1		                @ 18
  61 008c FD020000 		.word aaa +1	@_tim14 +1    @ 19
  62 0090 FD020000 		.word aaa +1                         @ 20
  63 0094 FD020000 		.word aaa +1         @_tim16 +1      @ 21
  64 0098 FD020000 		.word aaa +1         @_tim17 +1      @ 22
  65 009c FD020000 		.word aaa +1          @_i2c   +1     @ 23
  66 00a0 FD020000 		.word aaa +1                         @ 24
  67 00a4 FD020000 		.word aaa +1           @_spi   +1    @ 25
  68 00a8 FD020000 		.word aaa +1                         @ 26
  69 00ac FD020000 		.word aaa +1         @_usart1 +1     @ 27
  70              		.align 2
  71              	
  72              	_start:
  73              	shizhong:
  74 00b0 934A     		ldr r2, = 0x40022000   @FLASH访问控制
  75 00b2 3221     		movs r1, # 0x32
  76 00b4 1160     		str r1, [r2]           @FLASH缓冲 缓冲开启
  77 00b6 9348     		ldr r0, = 0x40021000 @ rcc
  78 00b8 9349     		ldr r1, = 0x10001
  79 00ba 0160     		str r1, [r0]
  80              	denghse:
  81 00bc 0168     		ldr r1, [r0]
  82 00be 8903     		lsls r1, r1, # 14
  83 00c0 FCD5     		bpl denghse
  84              	dengpllguan:
  85 00c2 0168     		ldr r1, [r0]
  86 00c4 8901     		lsls r1, r1, # 6
  87 00c6 FCD4     		bmi dengpllguan
  88 00c8 9049     	        ldr r1, = 0x110002
  89 00ca 4160     	        str r1, [r0, # 0x04]
  90 00cc 9049     		ldr r1, = 0x1010001
  91 00ce 0160     		str r1, [r0]
  92              	dengpll:
  93 00d0 0168     		ldr r1, [r0]
  94 00d2 8901     		lsls r1, # 6
  95 00d4 FCD5     		bpl dengpll
  96              		@0x34时钟控制寄存器 2 (RCC_CR2)
  97 00d6 0121     		movs r1, # 0x01
  98 00d8 4163     		str r1, [r0, # 0x34]  @ HSI开14M时钟
ARM GAS  1.s 			page 3


  99              	dengdai14mshizhongwending:
 100 00da 416B     		ldr r1, [r0, # 0x34]
 101 00dc 8907     		lsls r1, r1, # 30     @ 左移30位
 102 00de FCD5     		bpl dengdai14mshizhongwending  @ 等待14M时钟稳定
 103              	
 104              	_neicunqingling:
 105 00e0 8C48     		ldr r0, = 0x20000000
 106 00e2 0021     		movs r1, # 0
 107 00e4 8C4B     		ldr r3, = 0x1000
 108              	_neicunqinglingxunhuan:
 109 00e6 043B     		subs r3, # 4
 110 00e8 C150     		str r1, [r0, r3]
 111 00ea FCD1     		bne _neicunqinglingxunhuan
 112              	
 113              	_waisheshizhong:			 @ 外设时钟
 114              		@+0x14=RCC_AHBENR
 115              		@0=DMA @2=SRAM @4=FLITF@6=CRC @17=PA @18=PB @19=PC @20=PD @22=PF
 116 00ec 8548     		ldr r0, = 0x40021000
 117 00ee 8B49     		ldr r1, = 0x460005
 118 00f0 4161     		str r1, [r0, # 0x14]
 119              	
 120              		@+0x18外设时钟使能寄存器 (RCC_APB2ENR)
 121              		@0=SYSCFG @5=USART6EN @9=ADC @11=TIM1 @12=SPI1 @14=USART1 @16=TIM15 @17=TIM16 @18=TIM17 @22=DBGMCU
 122 00f2 8B49     		ldr r1, = 0xa00
 123 00f4 8161     		str r1, [r0, # 0x18]
 124              		@+0X1C=RCC_APB1ENR
 125              		@1=TIM3 @4=TIM6 @5=TIM7 @8=TIM14 @11=WWDG @14=SPI @17=USRT2 @18=USART3 @20=USART5 @21=I2C1
 126              		@22=I2C2 @23=USB @28=PWR
 127              		
 128              	tim1chushiha:
 129 00f6 8B48     		ldr r0, = 0x40012c00 @ tim1_cr1
 130 00f8 0021     		movs r1, # 0
 131 00fa 8162     		str r1, [r0, # 0x28] @ psc
 132 00fc 8A49     		ldr r1, = 96
 133 00fe C162     		str r1, [r0, # 0x2c] @ ARR
 134 0100 8A49     		ldr r1, = 0x68
 135 0102 C161     		str r1, [r0, # 0x1c] @ ccmr2  CC3
 136 0104 8A49     		ldr r1, = 0x100    @  CC3
 137 0106 0162     		str r1, [r0, # 0x20] @ ccer
 138 0108 8A49     		ldr r1, = 0x8000
 139 010a 4164     		str r1, [r0, # 0x44] @ BDTR
 140 010c 8A49     		ldr r1, = 0x800 @ CC3 DMA
 141 010e C160     		str r1, [r0, # 0x0c] @ DIER
 142 0110 8A49     		ldr r1, = 0xe1
 143 0112 0160     		str r1, [r0]
 144              	
 145              		
 146              	_adcchushihua:
 147 0114 8A48     		ldr r0, = 0x40012400  @ adc基地址
 148 0116 8B49     		ldr r1, = 0x80000000
 149 0118 8160     		str r1, [r0, # 0x08]  @ ADC 控制寄存器 (ADC_CR)  @adc校准
 150              	_dengadcjiaozhun:
 151 011a 8168     		ldr r1, [r0, # 0x08]
 152 011c 0900     		 movs r1, r1
 153 011e FCD4     		bmi _dengadcjiaozhun   @ 等ADC校准
 154              	_kaiadc:
 155 0120 8168     		ldr r1, [r0, # 0x08]
ARM GAS  1.s 			page 4


 156 0122 0122     		movs r2, # 0x01
 157 0124 1143     		orrs r1, r1, r2
 158 0126 8160     		str r1, [r0, # 0x08]
 159              	_dengdaiadcwending:
 160 0128 0168     		ldr r1, [r0]
 161 012a C907     		lsls r1, r1, # 31
 162 012c FCD5     		bpl _dengdaiadcwending @ 等ADC稳定
 163              	_tongdaoxuanze:
 164 012e 8649     		ldr r1, = 0x01
 165 0130 8162     		str r1, [r0, # 0x28]    @ 通道选择寄存器 (ADC_CHSELR)
 166 0132 8649     		ldr r1, = 0x3000        @ 13 连续转换
 167 0134 C160     		str r1, [r0, # 0x0c]    @ 配置寄存器 1 (ADC_CFGR1)
 168 0136 0021     		movs r1, # 0	         @
 169 0138 4161     		str r1, [r0, # 0x14]    @ ADC 采样时间寄存器 (ADC_SMPR)
 170 013a 8168     		ldr r1, [r0, # 0x08]
 171 013c 0422     		movs r2, # 0x04         @ 开始转换
 172 013e 1143     		orrs r1, r1, r2
 173 0140 8160     		str r1, [r0, # 0x08]    @ 控制寄存器 (ADC_CR)
 174              	
 175              	dmachushihua:
 176              		@+0=LSR,+4=IFCR,
 177              		@+8=CCR1,+c=CNDTR1,+10=CPAR1+14=CMAR1,
 178              		@+1c=CCR2,+20=CNDTR2,+24=CPAR2,+28=CMAR2
 179              		@+30=CCR3,+34=CNDTR3,+38=CPAR2,+3c=CMAR3
 180              		@+44=CCR4,+48=CNDTR4,+4c=CPAR4,+50=CMAR4
 181              		@+58=CCR5,+5c=CNDTR5,+60=CPAR5,+64=CMAR5
 182              		@+6C=CCR6,+70=CNDTR6,+74=CPAR6,+78=CMAR6
 183              		@+80=CCR7,+84=CNDTR7,+88=CPAR7,+8c=CMAR7
 184              	
 185              		@tim1ch3DMA
 186 0142 8348     		ldr r0, = 0x40020000
 187 0144 8349     		ldr r1, = 0x40012c3c @ 外设地址
 188 0146 0166     		str r1, [r0, # 0x60]
 189 0148 8349     		ldr r1, = zheng_xian_biao @ 储存器地址
 190 014a 4166     		str r1, [r0, # 0x64]
 191 014c 8349     		ldr r1, = 100             @点数
 192 014e C165     		str r1, [r0, # 0x5c]
 193 0150 8349     		ldr r1, = 0x25b1         @ 储存到外设
 194 0152 8165     		str r1, [r0, # 0x58]
 195              	
 196              	_waishezhongduan:				@外设中断
 197              		@0xE000E100    0-31  写1开，写0没效
 198              		@0XE000E180    0-31 写1关，写0没效
 199              		@0XE000E200    0-31 挂起，写0没效
 200              		@0XE000E280    0-31 清除， 写0没效
 201              	
 202              	@_systick:				@ systick定时器初始化
 203              	
 204              	@	ldr r0, = 0xe000e010
 205              	@	ldr r1, = 0xffffff
 206              	@	str r1, [r0, # 4]
 207              	@	str r1, [r0, # 8]
 208              	@	movs r1, # 0x07
 209              	@	str r1, [r0]
 210              		
 211              	io_she_zhi:
 212              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
ARM GAS  1.s 			page 5


 213              		@a(0x48000000)b(0x48000400)c(0x48000800)d(0x48000c00)f(0x48001400)
 214              		@ 输入（00），通用输出（01），复用功能（10），模拟（11）
 215              		@偏移0x4 = 端口输出类型 @ （0 推挽），（ 1 开漏）
 216              		@偏移0x8 = 输出速度  00低速， 01中速， 11高速
 217              		@偏移0xC = 上拉下拉 (00无上下拉，  01 上拉， 10下拉)
 218              		@偏移0x10 = 输入数据寄存器
 219              		@偏移0x14 = 输出数据寄存器
 220              		@偏移0x18 = 端口开  0-15置位
 221              		@偏移0x28 = 端口关
 222              		@0X20 = 复用低
 223              		@GPIO口0（0-3位）每个IO口占用4位
 224              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 225              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 226              		@0x24 = 复用高
 227              		@GPIO口8 （0-3位）每个IO口占用4位
 228              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 229              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 230              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 231              	
 232 0154 8348     		ldr r0, = 0x48000000
 233 0156 8449     		ldr r1, = 0x28205403
 234 0158 0160     		str r1, [r0]
 235 015a 8449     		ldr r1, = 0x200
 236 015c 4162     		str r1, [r0, # 0x24]
 237              		
 238              	_tingting:
 239 015e 00F04FF8 		bl __chuanganqi
 240 0162 6C4A     		ldr r2, = shumaguanma
 241 0164 0821     		movs r1, # 8
 242 0166 00F004F8 		bl _zhuanshumaguanma
 243 016a 0820     		movs r0, # 8
 244 016c 00F013F8 		bl _xieshumaguan
 245 0170 F5E7     		b _tingting
 246              	
 247              	_zhuanshumaguanma:@ 16进制转数码管码
 248              			@ R0要转的数据， R1长度，R2结果表首地址
 249 0172 FFB5     		push {r0-r7,lr}
 250 0174 7E4F     		ldr r7, = shumaguanmabiao
 251 0176 0546     		mov r5, r0
 252 0178 0E46     		mov r6, r1
 253 017a 0A21     		movs r1, # 10
 254              	_xunhuanqiuma:
 255 017c 00F0A0F8 		bl _chufa
 256 0180 0446     		mov r4, r0
 257 0182 4C43     		muls r4, r1
 258 0184 2B1B     		subs r3, r5, r4
 259 0186 9B00     		lsls r3, # 2
 260 0188 FC58     		ldr r4, [r7, r3]
 261 018a 1460     		str r4, [r2]
 262 018c 0546     		mov r5, r0
 263 018e 0432     		adds r2, r2, # 4
 264 0190 013E     		subs r6, # 1
 265 0192 F3D1     		bne _xunhuanqiuma
 266 0194 FFBD     		pop {r0-r7,pc}
 267              	_xieshumaguan: @ r0=位数 @数码管码
 268 0196 FFB5     		push {r0-r7,lr}
 269 0198 8000     		lsls r0, r0, # 2
ARM GAS  1.s 			page 6


 270 019a 0027     		movs r7, # 0
 271 019c 0646     		mov r6, r0
 272 019e 5D4D     		ldr r5, = shumaguanma
 273 01a0 744A     		ldr r2, = shumaguanshuaxinbiao
 274              	_shumaguanshuaxin:
 275 01a2 EB59     		ldr r3, [r5, r7]
 276 01a4 D459     		ldr r4, [r2, r7]
 277 01a6 1C43     		orrs r4, r4, r3
 278 01a8 2046     		mov r0, r4
 279 01aa 00F004F8 		bl _xie595
 280 01ae 0437     		adds  r7, r7, # 4
 281 01b0 B742     		cmp r7, r6
 282 01b2 F6D9     		bls _shumaguanshuaxin
 283 01b4 FFBD     		pop {r0-r7,pc}
 284              		
 285              	_xie595: @ R0=要写的数据
 286 01b6 FFB5     		push {r0-r7,lr}
 287 01b8 0546     		mov r5, r0
 288 01ba 4020     		movs r0, # 0x40
 289 01bc 8027     		movs r7, # 0x80 
 290 01be 2026     		movs r6, # 0x20 
 291 01c0 1023     		movs r3, # 16   @16位
 292 01c2 684A     		ldr r2, = 0x48000000 @ gpioa
 293 01c4 0121     		movs r1, # 0x01
 294              	_xunhuan595:
 295 01c6 9761     		str r7, [r2, # 0x18]
 296 01c8 00F014F8 		bl _yanshi
 297 01cc 0D42     		tst r5, r1
 298 01ce 01D1     		bne _xie595_0
 299 01d0 9062     		str r0, [r2, # 0x28]
 300 01d2 00E0     		b _suocun595
 301              	_xie595_0:
 302 01d4 9061     		str r0, [r2, # 0x18]
 303              	_suocun595:
 304 01d6 00F00DF8 		bl _yanshi
 305 01da 6D08     		lsrs r5, # 1
 306 01dc 9762     		str r7, [r2, # 0x28]
 307 01de 00F009F8 		bl _yanshi
 308 01e2 013B     		subs r3, r3, # 1
 309 01e4 EFD1     		bne _xunhuan595
 310 01e6 9661     		str r6, [r2, # 0x18]
 311 01e8 00F004F8 		bl _yanshi
 312 01ec 9662     		str r6, [r2, # 0x28]
 313 01ee 00F001F8 		bl _yanshi
 314 01f2 FFBD     		pop {r0-r7,pc}
 315              	
 316              	
 317              	_yanshi:
 318 01f4 80B4     		push {r7}
 319 01f6 604F     		ldr r7, = 30
 320              	_yanshi11:
 321 01f8 013F     		subs r7, # 1
 322 01fa FDD1     		bne _yanshi11
 323 01fc 80BC     		pop {r7}
 324 01fe 7047     		bx lr
 325              	
 326              	__chuanganqi:		@出
ARM GAS  1.s 			page 7


 327              				@R0=幅值，R1=相位
 328 0200 FCB5     		push {r2-r7,lr}
 329 0202 4F48     		ldr r0, = 0x40012400
 330 0204 0121     		movs r1, # 0x01
 331 0206 8162     		str r1, [r0, # 0x28]
 332 0208 00F038F8 		bl _jianbo			@检波90、270
 333 020c 00F022F8 		bl _jisuanfuzhi			@计算90幅度
 334 0210 0246     		mov r2, r0
 335 0212 0846     		mov r0, r1
 336 0214 00F01EF8 		bl _jisuanfuzhi			@计算270幅度
 337 0218 0146     		mov r1, r0
 338 021a 1046     		mov r0, r2
 339 021c 00F009F8 		bl _xiangweipanduan		@判断相位
 340 0220 0C46     		mov r4, r1
 341 0222 0346     		mov r3, r0
 342 0224 5548     		ldr r0, = lvbohuanchong		@滤波器缓冲区
 343 0226 5649     		ldr r1, = 1024			@级数
 344 0228 564A     		ldr r2, = lvbozhizhen		@滤波器指针
 345 022a 00F035F8 		bl _lvboqi			@平滑，平均滤波器
 346 022e 2146     		mov r1, r4
 347 0230 FCBD     		pop {r2-r7,pc}
 348              	
 349              	
 350              	_xiangweipanduan:		@相位判断
 351              					@入R0=90度，R1=270度
 352              					@出R0=相之间相差的数值，
 353              					@出R1=1,90度是正，R1=0，90度是负
 354 0232 04B5     		push {r2,lr}
 355 0234 0039     		subs r1, r1, # 0	@ 校准0点
 356 0236 421A     		subs r2, r0, r1
 357 0238 03D5     		bpl _adc90shizheng
 358 023a 0A1A     		subs r2, r1, r0
 359 023c 04D5     		bpl _adc90shifu
 360 023e 8842     		cmp r0, r1
 361 0240 05D1     		bne _xiangweipanduanfanhui
 362              	_adc90shizheng:
 363 0242 1046     		mov r0, r2
 364 0244 0121     		movs r1, # 1
 365 0246 04BD     		pop {r2,pc}
 366              	_adc90shifu:
 367 0248 1046     		mov r0, r2
 368 024a 0021     		movs r1, # 0
 369 024c 04BD     		pop {r2,pc}
 370              	_xiangweipanduanfanhui:
 371 024e 0020     		movs r0, # 0
 372 0250 0121     		movs r1, # 1
 373 0252 04BD     		pop {r2,pc}
 374              		
 375              		
 376              	_jisuanfuzhi:			@计算幅值
 377              					@入R0出R0
 378              					@R0=ADC90度采样
 379 0254 0EB5     		push {r1-r3,lr}
 380 0256 0028     		cmp r0, # 0
 381 0258 0FD0     		beq _adcshi0fanhui
 382 025a 4B49     		ldr r1, = 0x04		@实 Q15
 383 025c 4B4A     		ldr r2, = 0xffff8004    @虚 Q15
ARM GAS  1.s 			page 8


 384 025e 0346     		mov r3, r0
 385 0260 4843     		muls r0, r0, r1		@实
 386 0262 C013     		asrs r0, r0, # 15
 387 0264 5343     		muls r3, r3, r2		@虚
 388 0266 DB13     		asrs r3, r3, # 15
 389              	_shibushibushi0:		@检测实部是不是负数
 390 0268 0000     		movs r0, r0
 391 026a 01D5     		bpl _fzbushifushu1
 392 026c C043     		mvns r0, r0		@是负数转成正数
 393 026e 0130     		adds r0, r0, # 1
 394              	_fzbushifushu1:			@检测虚部是不是负数
 395 0270 1B00     		movs  r3, r3
 396 0272 01D5     		bpl _fzbushifushu
 397 0274 DB43     		mvns r3, r3		@是负数转成正数
 398 0276 0133     		adds r3, r3, # 1
 399              	_fzbushifushu:
 400 0278 C018     		adds r0, r0, r3		@相加得到副值
 401              	_adcshi0fanhui:	
 402 027a 0EBD     		pop {r1-r3,pc}
 403              		
 404              	_jianbo:				@检波
 405              						@输出r0=90度，R1=270度
 406 027c 1CB5     		push {r2-r4,lr}
 407 027e 444A     		ldr r2, = 0x4002005c
 408 0280 444B     		ldr r3, = 0x40012440
 409 0282 72B6     		cpsid i
 410              	_jianbo90du:
 411 0284 1468     		ldr r4, [r2]
 412 0286 192C     		cmp r4, # 25
 413 0288 FCD1     		bne _jianbo90du
 414 028a 1868     		ldr r0, [r3]			@取出90度
 415              	_jianbo270du:
 416 028c 1468     		ldr r4, [r2]
 417 028e 4B2C     		cmp r4, # 75
 418 0290 FCD1     		bne _jianbo270du
 419 0292 1968     		ldr r1, [r3]
 420 0294 62B6     		cpsie i
 421 0296 1CBD     		pop {r2-r4,pc}
 422              	
 423              	_lvboqi:				@滤波器
 424              				@R0=地址，R1=长度,r2=表指针地址,r3=ADC数值
 425              				@出R0=结果
 426 0298 FEB5     		push {r1-r7,lr}	
 427 029a 1568     		ldr r5, [r2]		@读出表指针
 428 029c 4E00     		lsls r6, r1, # 1	
 429 029e 4353     		strh r3, [r0, r5]	@数值写到滤波器缓冲区
 430 02a0 0235     		adds r5, r5, # 2
 431 02a2 B542     		cmp r5, r6
 432 02a4 00D1     		bne _lvboqimeidaohuanchongquding
 433 02a6 0025     		movs r5, # 0
 434              	_lvboqimeidaohuanchongquding:
 435 02a8 1560     		str r5, [r2]
 436 02aa 0027     		movs r7, # 0
 437              	_lvboqixunhuan:
 438 02ac B542     		cmp r5, r6
 439 02ae 00D1     		bne _lvbozonghe
 440 02b0 0025     		movs r5, # 0
ARM GAS  1.s 			page 9


 441              	_lvbozonghe:
 442 02b2 445B     		ldrh r4, [r0, r5]
 443 02b4 0235     		adds r5, r5, # 2
 444 02b6 3F19     		adds r7, r7, r4
 445 02b8 0139     		subs r1, r1, # 1
 446 02ba F7D1     		bne _lvboqixunhuan
 447 02bc B812     		asrs r0, r7, # 10	@修改
 448 02be FEBD     		pop {r1-r7,pc}
 449              			
 450              	_chufa:				@软件除法
 451              		@ r0 除以 r1 等于 商(r0)余数R1
 452 02c0 1EB5     		push {r1-r4,lr}
 453 02c2 0028     		cmp r0, # 0
 454 02c4 0ED0     		beq _chufafanhui
 455 02c6 0029     		cmp r1, # 0
 456 02c8 0CD0     		beq _chufafanhui
 457 02ca 0246     		mov r2, r0
 458 02cc 0123     		movs r3, # 1
 459 02ce DB07     		lsls r3, r3, # 31
 460 02d0 0020     		movs r0, # 0
 461 02d2 0446     		mov r4, r0
 462              	_chufaxunhuan:
 463 02d4 5200     		lsls r2, r2, # 1
 464 02d6 6441     		adcs r4, r4, r4
 465 02d8 8C42     		cmp r4, r1
 466 02da 01D3     		bcc _chufaweishubudao0
 467 02dc C018     		adds r0, r0, r3
 468 02de 641A     		subs r4, r4, r1
 469              	_chufaweishubudao0:
 470 02e0 5B08     		lsrs r3, r3, # 1
 471 02e2 F7D1     		bne _chufaxunhuan
 472              	_chufafanhui:
 473 02e4 1EBD     		pop {r1-r4,pc}
 474              	_nmi_handler:
 475 02e6 7047     		bx lr
 476              	_hard_fault:
 477 02e8 7047     		bx lr
 478              	_svc_handler:
 479 02ea 7047     		bx lr
 480              	_pendsv_handler:
 481 02ec 7047     		bx lr
 482              	_systickzhongduan:
 483 02ee 2A4A     		ldr r2, = jishu
 484 02f0 2A48     		ldr r0, = 0xe0000d04
 485 02f2 1368     		ldr r3, [r2]
 486 02f4 2A49     		ldr r1, = 0x02000000
 487 02f6 0133     		adds r3, r3, # 1
 488 02f8 1360     		str r3, [r2]
 489 02fa 0160     		str r1, [r0]                 @ 清除SYSTICK中断
 490              	aaa:
 491 02fc 70470000 		bx lr
 491      00200240 
 491      00100240 
 491      01000100 
 491      02001100 
ARM GAS  1.s 			page 10


DEFINED SYMBOLS
                 1.s:9      .data:0000000000000000 shumaguanmabiao
                 1.s:11     .data:0000000000000028 shumaguanshuaxinbiao
                 1.s:14     .data:000000000000004c zheng_xian_biao
                 1.s:16     .data:0000000000000114 yjmwxwx
                 1.s:18     *ABS*:0000000020001000 STACKINIT
                 1.s:19     *ABS*:0000000020000000 shumaguanma
                 1.s:20     *ABS*:0000000020000030 jishu
                 1.s:21     *ABS*:0000000020000040 lvbozhizhen
                 1.s:22     *ABS*:0000000020000044 lvbohuanchong
                 1.s:23     *ABS*:0000000020000500 adccaiyang
                 1.s:25     .text:0000000000000000 vectors
                 1.s:72     .text:00000000000000b0 _start
                 1.s:474    .text:00000000000002e6 _nmi_handler
                 1.s:476    .text:00000000000002e8 _hard_fault
                 1.s:478    .text:00000000000002ea _svc_handler
                 1.s:480    .text:00000000000002ec _pendsv_handler
                 1.s:482    .text:00000000000002ee _systickzhongduan
                 1.s:490    .text:00000000000002fc aaa
                            .text:0000000000000000 $d
                 1.s:70     .text:00000000000000b0 $t
                 1.s:73     .text:00000000000000b0 shizhong
                 1.s:80     .text:00000000000000bc denghse
                 1.s:84     .text:00000000000000c2 dengpllguan
                 1.s:92     .text:00000000000000d0 dengpll
                 1.s:99     .text:00000000000000da dengdai14mshizhongwending
                 1.s:104    .text:00000000000000e0 _neicunqingling
                 1.s:108    .text:00000000000000e6 _neicunqinglingxunhuan
                 1.s:113    .text:00000000000000ec _waisheshizhong
                 1.s:128    .text:00000000000000f6 tim1chushiha
                 1.s:146    .text:0000000000000114 _adcchushihua
                 1.s:150    .text:000000000000011a _dengadcjiaozhun
                 1.s:154    .text:0000000000000120 _kaiadc
                 1.s:159    .text:0000000000000128 _dengdaiadcwending
                 1.s:163    .text:000000000000012e _tongdaoxuanze
                 1.s:175    .text:0000000000000142 dmachushihua
                 1.s:196    .text:0000000000000154 _waishezhongduan
                 1.s:211    .text:0000000000000154 io_she_zhi
                 1.s:238    .text:000000000000015e _tingting
                 1.s:326    .text:0000000000000200 __chuanganqi
                 1.s:247    .text:0000000000000172 _zhuanshumaguanma
                 1.s:267    .text:0000000000000196 _xieshumaguan
                 1.s:254    .text:000000000000017c _xunhuanqiuma
                 1.s:450    .text:00000000000002c0 _chufa
                 1.s:274    .text:00000000000001a2 _shumaguanshuaxin
                 1.s:285    .text:00000000000001b6 _xie595
                 1.s:294    .text:00000000000001c6 _xunhuan595
                 1.s:317    .text:00000000000001f4 _yanshi
                 1.s:301    .text:00000000000001d4 _xie595_0
                 1.s:303    .text:00000000000001d6 _suocun595
                 1.s:320    .text:00000000000001f8 _yanshi11
                 1.s:404    .text:000000000000027c _jianbo
                 1.s:376    .text:0000000000000254 _jisuanfuzhi
                 1.s:350    .text:0000000000000232 _xiangweipanduan
                 1.s:423    .text:0000000000000298 _lvboqi
                 1.s:362    .text:0000000000000242 _adc90shizheng
                 1.s:366    .text:0000000000000248 _adc90shifu
ARM GAS  1.s 			page 11


                 1.s:370    .text:000000000000024e _xiangweipanduanfanhui
                 1.s:401    .text:000000000000027a _adcshi0fanhui
                 1.s:389    .text:0000000000000268 _shibushibushi0
                 1.s:394    .text:0000000000000270 _fzbushifushu1
                 1.s:399    .text:0000000000000278 _fzbushifushu
                 1.s:410    .text:0000000000000284 _jianbo90du
                 1.s:415    .text:000000000000028c _jianbo270du
                 1.s:434    .text:00000000000002a8 _lvboqimeidaohuanchongquding
                 1.s:437    .text:00000000000002ac _lvboqixunhuan
                 1.s:441    .text:00000000000002b2 _lvbozonghe
                 1.s:472    .text:00000000000002e4 _chufafanhui
                 1.s:462    .text:00000000000002d4 _chufaxunhuan
                 1.s:469    .text:00000000000002e0 _chufaweishubudao0
                 1.s:491    .text:00000000000002fe $d
                 1.s:491    .text:0000000000000300 $d

NO UNDEFINED SYMBOLS
