ARM GAS  1.s 			page 1


   1              		@@单片机stm32f030f4p6
   2              		@@电子天平
   3              		@作者：yjmwxwx
   4              		@时间：2019-12-01
   5              		@编译器：ARM-NONE-EABI
   6              		 .thumb
   7              		         .syntax unified
   8              		.section .data
   9              	shumaguanmabiao:
  10 0000 FC000000 		.int 0xfc,0x60,0xda,0xf2,0x66,0xb6,0xbe,0xe0,0xfe,0xf6
  10      60000000 
  10      DA000000 
  10      F2000000 
  10      66000000 
  11              	shumaguanshuaxinbiao:
  12 0028 00FE0000 		.int 0xfe00,0xfd00,0xfb00,0xf700,0xef00,0xdf00,0xbf00,0x7f00,0
  12      00FD0000 
  12      00FB0000 
  12      00F70000 
  12      00EF0000 
  13              	zheng_xian_biao:
  14 004c 30003300 		.short 0x30,0x33,0x36,0x38,0x3b,0x3e,0x41,0x44,0x47,0x49,0x4c,0x4e,0x50,0x52,0x54,0x56,0x58,0x59,0
  14      36003800 
  14      3B003E00 
  14      41004400 
  14      47004900 
  15              	yjmwxwx:
  16 0114 796A6D77 		.ascii  "yjmwxwx-20191201-dian_zi_tian_ping"
  16      7877782D 
  16      32303139 
  16      31323031 
  16      2D646961 
  17              		.equ STACKINIT,        	        0x20001000
  18              		.equ shumaguanma,		0x20000000
  19              		.equ fuhao,			0x20000010
  20              		.equ jishu,			0x20000030
  21              		.equ lvboqizhizhen,		0x20000040
  22              		.equ lvboqihuanchong,		0x20000044
  23              		.equ diancitiexia,		0x20000250
  24              		.equ diancitieshang,		0x20000254
  25              		.equ pinghengdian,		0x20000258
  26              		.equ dianyabiao,		0x20000500
  27              		.section .text
  28              	vectors:
  29 0000 00100020 		.word STACKINIT
  30 0004 B1000000 		.word _start + 1
  31 0008 0D030000 		.word _nmi_handler + 1
  32 000c 0F030000 		.word _hard_fault  + 1
  33 0010 00000000 		.word 0
  34 0014 00000000 		.word 0
  35 0018 00000000 		.word 0
  36 001c 00000000 		.word 0
  37 0020 00000000 		.word 0
  38 0024 00000000 		.word 0
  39 0028 00000000 		.word 0
  40 002c 11030000 		.word _svc_handler +1
  41 0030 00000000 		.word 0
ARM GAS  1.s 			page 2


  42 0034 00000000 		.word 0
  43 0038 13030000 		.word _pendsv_handler +1
  44 003c 15030000 		.word _systickzhongduan +1               @ 15
  45 0040 23030000 		.word aaa +1     @ _wwdg +1          @ 0
  46 0044 23030000 		.word aaa +1     @_pvd +1            @ 1
  47 0048 23030000 		.word aaa +1     @_rtc +1            @ 2
  48 004c 23030000 		.word aaa +1     @_flash +1          @ 3
  49 0050 23030000 		.word aaa +1	@ _rcc + 1          @ 4
  50 0054 23030000 		.word aaa +1      @_exti0_1  +1      @ 5
  51 0058 23030000 		.word aaa +1      @ _exti2_3 +1      @ 6
  52 005c 23030000 		.word aaa +1       @_exti4_15 +1     @ 7
  53 0060 23030000 		.word aaa +1                         @ 8
  54 0064 23030000 		.word aaa +1 	@_dma1_1  +1    @ 9
  55 0068 23030000 		.word aaa +1    @_dma1_2_3 +1        @ 10
  56 006c 23030000 		.word aaa +1       @_dma1_4_5 +1     @ 11
  57 0070 23030000 		.word aaa +1	 @_adc1 +1          @ 12
  58 0074 23030000 		.word aaa +1       @_tim1_brk_up +1  @ 13
  59 0078 23030000 		.word aaa +1        @ _tim1_cc +1    @ 14
  60 007c 23030000 		.word aaa +1         @_tim2 +1       @ 15
  61 0080 23030000 		.word aaa +1          @_tim3 +1      @ 16
  62 0084 23030000 		.word aaa +1                         @ 17
  63 0088 23030000 		.word aaa +1		                @ 18
  64 008c 23030000 		.word aaa +1	@_tim14 +1    @ 19
  65 0090 23030000 		.word aaa +1                         @ 20
  66 0094 23030000 		.word aaa +1         @_tim16 +1      @ 21
  67 0098 23030000 		.word aaa +1         @_tim17 +1      @ 22
  68 009c 23030000 		.word aaa +1          @_i2c   +1     @ 23
  69 00a0 23030000 		.word aaa +1                         @ 24
  70 00a4 23030000 		.word aaa +1           @_spi   +1    @ 25
  71 00a8 23030000 		.word aaa +1                         @ 26
  72 00ac 23030000 		.word aaa +1         @_usart1 +1     @ 27
  73              		.align 2
  74              	
  75              	_start:
  76              	shizhong:
  77 00b0 9C4A     		ldr r2, = 0x40022000   @FLASH访问控制
  78 00b2 3221     		movs r1, # 0x32
  79 00b4 1160     		str r1, [r2]           @FLASH缓冲 缓冲开启
  80 00b6 9C48     		ldr r0, = 0x40021000 @ rcc
  81 00b8 9C49     		ldr r1, = 0x10001
  82 00ba 0160     		str r1, [r0]
  83              	denghse:
  84 00bc 0168     		ldr r1, [r0]
  85 00be 8903     		lsls r1, r1, # 14
  86 00c0 FCD5     		bpl denghse
  87              	dengpllguan:
  88 00c2 0168     		ldr r1, [r0]
  89 00c4 8901     		lsls r1, r1, # 6
  90 00c6 FCD4     		bmi dengpllguan
  91 00c8 9949     	        ldr r1, = 0x110002
  92 00ca 4160     	        str r1, [r0, # 0x04]
  93 00cc 9949     		ldr r1, = 0x1010001
  94 00ce 0160     		str r1, [r0]
  95              	dengpll:
  96 00d0 0168     		ldr r1, [r0]
  97 00d2 8901     		lsls r1, # 6
  98 00d4 FCD5     		bpl dengpll
ARM GAS  1.s 			page 3


  99              		@0x34时钟控制寄存器 2 (RCC_CR2)
 100 00d6 0121     		movs r1, # 0x01
 101 00d8 4163     		str r1, [r0, # 0x34]  @ HSI开14M时钟
 102              	dengdai14mshizhongwending:
 103 00da 416B     		ldr r1, [r0, # 0x34]
 104 00dc 8907     		lsls r1, r1, # 30     @ 左移30位
 105 00de FCD5     		bpl dengdai14mshizhongwending  @ 等待14M时钟稳定
 106              	
 107              	_neicunqingling:
 108 00e0 9548     		ldr r0, = 0x20000000
 109 00e2 0021     		movs r1, # 0
 110 00e4 954B     		ldr r3, = 0x1000
 111              	_neicunqinglingxunhuan:
 112 00e6 043B     		subs r3, # 4
 113 00e8 C150     		str r1, [r0, r3]
 114 00ea FCD1     		bne _neicunqinglingxunhuan
 115              	
 116              	_waisheshizhong:			 @ 外设时钟
 117              		@ +0x14=RCC_AHBENR
 118              		@ 0=DMA 2=SRAM 4=FLITF 6=CRC  17=PA  18=PB 19=PC 20=PD 22=PF
 119 00ec 8E48     		ldr r0, = 0x40021000
 120 00ee 9449     		ldr r1, = 0x460005
 121 00f0 4161     		str r1, [r0, # 0x14]
 122              	
 123              		@ +0x18外设时钟使能寄存器 (RCC_APB2ENR)
 124              		@ 0=SYSCFG 5=USART6EN 9=ADC 11=TIM1 12=SPI1 14=USART1
 125              		@ 16=TIM15 17=TIM16 18=TIM17 22=DBGMCU
 126 00f2 9449     		ldr r1, = 0xa00
 127 00f4 8161     		str r1, [r0, # 0x18]
 128              		@+0X1C=RCC_APB1ENR
 129              		@ 1=TIM3 4=TIM6 5=TIM7 8=TIM14 11=WWDG 14=SPI 17=USRT2 18=USART3
 130              		@ 20=USART5 21=I2C1 22=I2C2  23=USB 28=PWR
 131 00f6 0221     		movs r1, # 0x02
 132 00f8 C161     		str r1, [r0, # 0x1c]
 133              	
 134              	
 135              	_waishezhongduan:				@外设中断
 136              		@0xE000E100    0-31  写1开，写0没效
 137              		@0XE000E180    0-31 写1关，写0没效
 138              		@0XE000E200    0-31 挂起，写0没效
 139              		@0XE000E280    0-31 清除， 写0没效
 140              	
 141              	@_systick:				@ systick定时器初始化
 142              	
 143              	@	ldr r0, = 0xe000e010
 144              	@	ldr r1, = 0xffffff
 145              	@	str r1, [r0, # 4]
 146              	@	str r1, [r0, # 8]
 147              	@	movs r1, # 0x07
 148              	@	str r1, [r0]
 149              		
 150              	io_she_zhi:
 151              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 152              		@a(0x48000000)b(0x48000400)c(0x48000800)d(0x48000c00)f(0x48001400)
 153              		@ 输入（00），通用输出（01），复用功能（10），模拟（11）
 154              		@偏移0x4 = 端口输出类型 @ （0 推挽），（ 1 开漏）
 155              		@偏移0x8 = 输出速度  00低速， 01中速， 11高速
ARM GAS  1.s 			page 4


 156              		@偏移0xC = 上拉下拉 (00无上下拉，  01 上拉， 10下拉)
 157              		@偏移0x10 = 输入数据寄存器
 158              		@偏移0x14 = 输出数据寄存器
 159              		@偏移0x18 = 端口开  0-15置位
 160              		@偏移0x28 = 端口关
 161              		@0X20 = 复用低
 162              		@GPIO口0（0-3位）每个IO口占用4位
 163              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 164              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 165              		@0x24 = 复用高
 166              		@GPIO口8 （0-3位）每个IO口占用4位
 167              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 168              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 169              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 170              	
 171 00fa 9348     		ldr r0, = 0x48000000
 172 00fc 9349     		ldr r1, = 0x2800a15b
 173 00fe 0160     		str r1, [r0]
 174              	
 175 0100 9349     		ldr r1, = 0x11000000
 176 0102 0162     		str r1, [r0, # 0x20]	@ pa6\pa7 TIM3
 177              	
 178 0104 9348     		ldr r0, = 0x48000400
 179 0106 0821     		movs r1, # 0x08 @ pb1
 180 0108 0160     		str r1, [r0]
 181 010a 2021     		movs r1, # 0x20
 182 010c 0162     		str r1, [r0, # 0x20]
 183              	
 184              	_adcchushihua:
 185 010e 9248     	        ldr r0, = 0x40012400  @ adc基地址
 186 0110 9249     	        ldr r1, = 0x80000000
 187 0112 8160     	        str r1, [r0, # 0x08]  @ ADC 控制寄存器 (ADC_CR)  @adc校准
 188              	_dengadcjiaozhun:
 189 0114 8168     	        ldr r1, [r0, # 0x08]
 190 0116 0900     	        movs r1, r1
 191 0118 FCD4     	        bmi _dengadcjiaozhun   @ 等ADC校准
 192              	_kaiadc:
 193 011a 8168     		ldr r1, [r0, # 0x08]
 194 011c 0122     	        movs r2, # 0x01
 195 011e 1143     		orrs r1, r1, r2
 196 0120 8160     	        str r1, [r0, # 0x08]
 197              	_dengdaiadcwending:
 198 0122 0168     		ldr r1, [r0]
 199 0124 C907     		lsls r1, r1, # 31
 200 0126 FCD5     		bpl _dengdaiadcwending @ 等ADC稳定
 201              	_tongdaoxuanze:
 202 0128 8D49     		ldr r1, = 1
 203 012a 8162     	        str r1, [r0, # 0x28]    @ 通道选择寄存器 (ADC_CHSELR)
 204 012c 8D49     	        ldr r1, = 0x803
 205 012e C160     	        str r1, [r0, # 0x0c]    @ 配置寄存器 1 (ADC_CFGR1)
 206 0130 0021     		movs r1, # 0
 207 0132 4161     	        str r1, [r0, # 0x14]    @ ADC 采样时间寄存器 (ADC_SMPR)
 208 0134 8168     		ldr r1, [r0, # 0x08]
 209 0136 8C4A     	        ldr r2, = 0x04         @ 开始转换
 210 0138 1143     	        orrs r1, r1, r2
 211 013a 8160     		str r1, [r0, # 0x08]    @ 控制寄存器 (ADC_CR)
 212              	
ARM GAS  1.s 			page 5


 213              	
 214              		
 215              	dmachushihua:
 216              	        @+0=LSR,+4=IFCR,
 217              	        @+8=CCR1,+c=CNDTR1,+10=CPAR1+14=CMAR1,
 218              	        @+1c=CCR2,+20=CNDTR2,+24=CPAR2,+28=CMAR2
 219              	        @+30=CCR3,+34=CNDTR3,+38=CPAR2,+3c=CMAR3
 220              	        @+44=CCR4,+48=CNDTR4,+4c=CPAR4,+50=CMAR4
 221              	        @+58=CCR5,+5c=CNDTR5,+60=CPAR5,+64=CMAR5
 222              	        @+6C=CCR6,+70=CNDTR6,+74=CPAR6,+78=CMAR6
 223              	        @+80=CCR7,+84=CNDTR7,+88=CPAR7,+8c=CMAR7
 224              	
 225              	        @tim1ch3DMA
 226 013c 8B48     	        ldr r0, = 0x40020000
 227 013e 8C49     	        ldr r1, = 0x40012c3c @ 外设地址
 228 0140 0166     	        str r1, [r0, # 0x60]
 229 0142 8C49     	        ldr r1, = zheng_xian_biao @ 储存器地址
 230 0144 4166     	        str r1, [r0, # 0x64]
 231 0146 8C49     	        ldr r1, = 100             @点数
 232 0148 C165     	        str r1, [r0, # 0x5c]
 233 014a 8C49     	        ldr r1, = 0x35b1         @ 储存到外设
 234 014c 8165     	        str r1, [r0, # 0x58]
 235              		@ adc dma
 236 014e 8748     		ldr r0, = 0x40020000
 237 0150 8B49     		ldr r1, = 0x40012440
 238 0152 0161     		str r1, [r0, # 0x10]
 239 0154 8B49     		ldr r1, = dianyabiao
 240 0156 4161     		str r1, [r0, # 0x14]
 241 0158 8749     		ldr r1, =  100
 242 015a C160     		str r1, [r0, # 0x0c]
 243 015c 8A49     		ldr r1, = 0x5a1		@ 5a1
 244 015e 8160     		str r1, [r0, # 0x08]
 245              	
 246              		
 247              	tim1chushihua:
 248 0160 8A48     	        ldr r0, = 0x40012c00 @ tim1_cr1
 249 0162 0021     	        movs r1, # 0
 250 0164 8162     	        str r1, [r0, # 0x28] @ psc
 251 0166 8A49     	        ldr r1, = 96
 252 0168 C162     	        str r1, [r0, # 0x2c] @ ARR
 253              		@	movs r1, # 0x40
 254 016a 2021     		movs r1, # 0x20
 255 016c 4160     		str r1, [r0, # 0x04] @ TRGO
 256 016e 3821     		movs r1, # 0x38
 257 0170 8161     		str r1, [r0, # 0x18] @ ccmr1 cc1
 258 0172 6021     		movs r1, # 96
 259 0174 4163     		str r1, [r0, # 0x34]
 260 0176 8749     	        ldr r1, = 0x68
 261 0178 C161     	        str r1, [r0, # 0x1c] @ ccmr2  CC3
 262 017a 8749     	        ldr r1, = 0x400    @  CC3
 263 017c 0162     	        str r1, [r0, # 0x20] @ ccer
 264 017e 8749     	        ldr r1, = 0x8000
 265 0180 4164     	        str r1, [r0, # 0x44] @ BDTR
 266 0182 8749     	        ldr r1, = 0x800 @ CC3 DMA
 267 0184 C160     	        str r1, [r0, # 0x0c] @ DIER
 268 0186 8749     	        ldr r1, = 0x81
 269 0188 0160     	        str r1, [r0]
ARM GAS  1.s 			page 6


 270              	
 271              	_tim3chushiha:				
 272 018a 8748     		ldr r0, = 0x40000400 @ tim3_cr1
 273 018c 0021     		movs r1, # 0
 274 018e 8162     		str r1, [r0, # 0x28] @ psc
 275 0190 8649     		ldr r1, = 0xffff
 276 0192 C162     		str r1, [r0, # 0x2c] @ ARR
 277 0194 8649     		ldr r1, = 0x6868
 278 0196 8161     		str r1, [r0, # 0x18] @ ccmr1
 279 0198 1121     		movs r1, # 0x11
 280 019a 0162     		str r1, [r0, # 0x20] @ ccer
 281 019c 8549     		ldr r1, = 0
 282 019e 4163     		str r1, [r0, # 0x34]
 283 01a0 7549     		ldr  r1, = 100
 284 01a2 8163     		str r1, [r0, # 0x38]
 285 01a4 8121     		movs r1, # 0x81
 286 01a6 0160     		str r1, [r0]
 287              	_tingting:
 288 01a8 8348     		ldr r0, = 0x20000530
 289 01aa 844A     		ldr r2, = 0x20000590
 290 01ac 0188     		ldrh r1, [r0]
 291 01ae 1388     		ldrh r3, [r2]
 292 01b0 9942     		cmp r1, r3
 293 01b2 05D8     		bhi __zheng
 294 01b4 5B1A     		subs r3, r3, r1
 295 01b6 8248     		ldr r0, = fuhao
 296 01b8 0021     		movs r1, # 0
 297 01ba 0160     		str r1, [r0]
 298 01bc 0020     		movs r0, # 0
 299 01be 05E0     		b __xian_shi_led
 300              	__zheng:
 301 01c0 C91A     		subs r1, r1, r3
 302 01c2 0B46     		mov r3, r1
 303 01c4 7E48     		ldr r0, = fuhao
 304 01c6 0221     		movs r1, # 0x02
 305 01c8 0160     		str r1, [r0]
 306 01ca 0120     		movs r0, # 1
 307              	__xian_shi_led:
 308 01cc 00F00EF8 		bl __pwm_ping_heng
 309 01d0 7C48     		ldr r0, = lvboqihuanchong
 310 01d2 7D49     		ldr r1, = 256
 311 01d4 7D4A     		ldr r2, = lvboqizhizhen
 312 01d6 00F072F8 		bl _lvboqi
 313 01da 0421     		movs r1, # 4
 314 01dc 564A     	        ldr r2, = shumaguanma
 315 01de FF23     		movs r3, # 0xff		@小数点位置
 316 01e0 00F021F8 	        bl _zhuanshumaguanma
 317 01e4 0520     		movs r0, # 5
 318 01e6 00F035F8 	        bl _xieshumaguan
 319 01ea DDE7     		b _tingting
 320              	__pwm_ping_heng:
 321 01ec FEB5     		push {r1-r7,lr}
 322 01ee 6E49     		ldr r1, = 0x40000400
 323 01f0 774A     		ldr r2, = diancitiexia
 324 01f2 784B     		ldr r3, = diancitieshang
 325 01f4 784D     		ldr r5, = 0x2fff
 326 01f6 0128     		cmp r0, # 1
ARM GAS  1.s 			page 7


 327 01f8 0AD1     		bne __diancitieshang
 328              	__dian_ci_tie_xia:	
 329 01fa 0024     		movs r4, # 0
 330 01fc 4863     		str r0, [r1, # 0x34]
 331 01fe 1468     		ldr r4, [r2]
 332 0200 0134     		adds r4, r4, # 1
 333 0202 1460     		str r4, [r2]
 334 0204 8C63     		str r4, [r1, # 0x38]
 335 0206 AC42     		cmp r4, r5
 336 0208 0CD3     		bcc __pwm_ping_heng_fan_hui
 337 020a 8D63     		str r5, [r1, # 0x38]
 338 020c 1560     		str r5, [r2]
 339 020e 09E0     		b __pwm_ping_heng_fan_hui
 340              	__diancitieshang:
 341 0210 0024     		movs r4, # 0
 342 0212 8863     		str r0, [r1, # 0x38]
 343 0214 1C68     		ldr r4, [r3]
 344 0216 0134     		adds r4, r4, # 1
 345 0218 4C63     		str r4, [r1, # 0x34]
 346 021a 1C60     		str r4, [r3]
 347 021c AC42     		cmp r4, r5
 348 021e 01D3     		bcc __pwm_ping_heng_fan_hui
 349 0220 4D63     		str r5, [r1, # 0x34]
 350 0222 1D60     		str r5, [r3]
 351              	__pwm_ping_heng_fan_hui:
 352 0224 FEBD     		pop {r1-r7,pc}
 353              	
 354              	_zhuanshumaguanma:@ 16进制转数码管码
 355              		@ R0要转的数据， R1长度，R2结果表首地址
 356              		@ r3 小数点位置
 357 0226 F0B5     		push {r4-r7,lr}
 358 0228 6C4F     		ldr r7, = shumaguanmabiao
 359 022a 0546     		mov r5, r0
 360 022c 0E46     		mov r6, r1
 361 022e 0A21     		movs r1, # 10
 362 0230 9846     		mov r8, r3
 363              	_xunhuanqiuma:
 364 0232 00F058F8 		bl _chufa
 365 0236 0446     		mov r4, r0
 366 0238 4C43     		muls r4, r1
 367 023a 2B1B     		subs r3, r5, r4
 368 023c 9B00     		lsls r3, # 2
 369 023e FC58     		ldr r4, [r7, r3]
 370 0240 4645     		cmp r6, r8
 371 0242 00D0     		beq __tian_jia_xiao_shu_dian
 372 0244 00E0     		b __bao_cun_shu_ma_guan_ma
 373              	__tian_jia_xiao_shu_dian:
 374 0246 0134     		adds r4, r4, # 1
 375              	__bao_cun_shu_ma_guan_ma:	
 376 0248 1460     		str r4, [r2]
 377 024a 0546     		mov r5, r0
 378 024c 0432     		adds r2, r2, # 4
 379 024e 013E     		subs r6, # 1
 380 0250 EFD1     		bne _xunhuanqiuma
 381 0252 F0BD     		pop {r4-r7,pc}
 382              	_xieshumaguan: @ r0=位数 @数码管码
 383 0254 FEB5     		push {r1-r7,lr}
ARM GAS  1.s 			page 8


 384 0256 8000     		lsls r0, r0, # 2
 385 0258 0027     		movs r7, # 0
 386 025a 0646     		mov r6, r0
 387 025c 364D     		ldr r5, = shumaguanma
 388 025e 604A     		ldr r2, = shumaguanshuaxinbiao
 389              	_shumaguanshuaxin:
 390 0260 EB59     		ldr r3, [r5, r7]
 391 0262 D459     		ldr r4, [r2, r7]
 392 0264 1C43     		orrs r4, r4, r3
 393 0266 2046     		mov r0, r4
 394 0268 00F004F8 		bl _xie595
 395 026c 0437     		adds  r7, r7, # 4
 396 026e B742     		cmp r7, r6
 397 0270 F6D9     		bls _shumaguanshuaxin
 398 0272 FEBD     		pop {r1-r7,pc}
 399              		
 400              	_xie595: @ R0=要写的数据
 401 0274 FEB5     		push {r1-r7,lr}
 402 0276 0546     		mov r5, r0
 403 0278 0820     		movs r0, # 0x08      @pa6
 404 027a 1027     		movs r7, # 0x10      @pa7
 405 027c 0426     		movs r6, # 0x04      @pa5 
 406 027e 1023     		movs r3, # 16   @16位
 407 0280 314A     		ldr r2, = 0x48000000 @ gpioa
 408 0282 0121     		movs r1, # 0x01
 409              	_xunhuan595:
 410 0284 9761     		str r7, [r2, # 0x18]
 411 0286 00F014F8 		bl _yanshi
 412 028a 0D42     		tst r5, r1
 413 028c 01D1     		bne _xie595_0
 414 028e 9062     		str r0, [r2, # 0x28]
 415 0290 00E0     		b _suocun595
 416              	_xie595_0:
 417 0292 9061     		str r0, [r2, # 0x18]
 418              	_suocun595:
 419 0294 00F00DF8 		bl _yanshi
 420 0298 6D08     		lsrs r5, # 1
 421 029a 9762     		str r7, [r2, # 0x28]
 422 029c 00F009F8 		bl _yanshi
 423 02a0 013B     		subs r3, r3, # 1
 424 02a2 EFD1     		bne _xunhuan595
 425 02a4 9661     		str r6, [r2, # 0x18]
 426 02a6 00F004F8 		bl _yanshi
 427 02aa 9662     		str r6, [r2, # 0x28]
 428 02ac 00F001F8 		bl _yanshi
 429 02b0 FEBD     		pop {r1-r7,pc}
 430              	
 431              	
 432              	_yanshi:
 433 02b2 80B4     		push {r7}
 434 02b4 4B4F     		ldr r7, = 30
 435              	_yanshi11:
 436 02b6 013F     		subs r7, # 1
 437 02b8 FDD1     		bne _yanshi11
 438 02ba 80BC     		pop {r7}
 439 02bc 7047     		bx lr
 440              	_lvboqi:				@滤波器
ARM GAS  1.s 			page 9


 441              				@R0=地址，R1=长度,r2=表指针地址,r3=ADC数值
 442              				@出R0=结果
 443 02be FEB5     		push {r1-r7,lr}	
 444 02c0 1568     		ldr r5, [r2]		@读出表指针
 445 02c2 4E00     		lsls r6, r1, # 1	
 446 02c4 4353     		strh r3, [r0, r5]	@数值写到滤波器缓冲区
 447 02c6 0235     		adds r5, r5, # 2
 448 02c8 B542     		cmp r5, r6
 449 02ca 00D1     		bne _lvboqimeidaohuanchongquding
 450 02cc 0025     		movs r5, # 0
 451              	_lvboqimeidaohuanchongquding:
 452 02ce 1560     		str r5, [r2]
 453 02d0 0027     		movs r7, # 0
 454              	_lvboqixunhuan:
 455 02d2 B542     		cmp r5, r6
 456 02d4 00D1     		bne _lvbozonghe
 457 02d6 0025     		movs r5, # 0
 458              	_lvbozonghe:
 459 02d8 445B     		ldrh r4, [r0, r5]
 460 02da 0235     		adds r5, r5, # 2
 461 02dc 3F19     		adds r7, r7, r4
 462 02de 0139     		subs r1, r1, # 1
 463 02e0 F7D1     		bne _lvboqixunhuan
 464 02e2 3812     		asrs r0, r7, # 8	@修改
 465 02e4 FEBD     		pop {r1-r7,pc}
 466              			
 467              	_chufa:				@软件除法
 468              		@ r0 除以 r1 等于 商(r0)余数R1
 469 02e6 1EB5     		push {r1-r4,lr}
 470 02e8 0028     		cmp r0, # 0
 471 02ea 0ED0     		beq _chufafanhui
 472 02ec 0029     		cmp r1, # 0
 473 02ee 0CD0     		beq _chufafanhui
 474 02f0 0246     		mov r2, r0
 475 02f2 0123     		movs r3, # 1
 476 02f4 DB07     		lsls r3, r3, # 31
 477 02f6 0020     		movs r0, # 0
 478 02f8 0446     		mov r4, r0
 479              	_chufaxunhuan:
 480 02fa 5200     		lsls r2, r2, # 1
 481 02fc 6441     		adcs r4, r4, r4
 482 02fe 8C42     		cmp r4, r1
 483 0300 01D3     		bcc _chufaweishubudao0
 484 0302 C018     		adds r0, r0, r3
 485 0304 641A     		subs r4, r4, r1
 486              	_chufaweishubudao0:
 487 0306 5B08     		lsrs r3, r3, # 1
 488 0308 F7D1     		bne _chufaxunhuan
 489              	_chufafanhui:
 490 030a 1EBD     		pop {r1-r4,pc}
 491              	_nmi_handler:
 492 030c 7047     		bx lr
 493              	_hard_fault:
 494 030e 7047     		bx lr
 495              	_svc_handler:
 496 0310 7047     		bx lr
 497              	_pendsv_handler:
ARM GAS  1.s 			page 10


 498 0312 7047     		bx lr
 499              	_systickzhongduan:
 500 0314 344A     		ldr r2, = jishu
 501 0316 3548     		ldr r0, = 0xe0000d04
 502 0318 1368     		ldr r3, [r2]
 503 031a 3549     		ldr r1, = 0x02000000
 504 031c 0133     		adds r3, r3, # 1
 505 031e 1360     		str r3, [r2]
 506 0320 0160     		str r1, [r0]                 @ 清除SYSTICK中断
 507              	aaa:
 508 0322 70470020 		bx lr
 508      02400010 
 508      02400100 
 508      01000200 
 508      11000100 
ARM GAS  1.s 			page 11


DEFINED SYMBOLS
                 1.s:9      .data:0000000000000000 shumaguanmabiao
                 1.s:11     .data:0000000000000028 shumaguanshuaxinbiao
                 1.s:13     .data:000000000000004c zheng_xian_biao
                 1.s:15     .data:0000000000000114 yjmwxwx
                 1.s:17     *ABS*:0000000020001000 STACKINIT
                 1.s:18     *ABS*:0000000020000000 shumaguanma
                 1.s:19     *ABS*:0000000020000010 fuhao
                 1.s:20     *ABS*:0000000020000030 jishu
                 1.s:21     *ABS*:0000000020000040 lvboqizhizhen
                 1.s:22     *ABS*:0000000020000044 lvboqihuanchong
                 1.s:23     *ABS*:0000000020000250 diancitiexia
                 1.s:24     *ABS*:0000000020000254 diancitieshang
                 1.s:25     *ABS*:0000000020000258 pinghengdian
                 1.s:26     *ABS*:0000000020000500 dianyabiao
                 1.s:28     .text:0000000000000000 vectors
                 1.s:75     .text:00000000000000b0 _start
                 1.s:491    .text:000000000000030c _nmi_handler
                 1.s:493    .text:000000000000030e _hard_fault
                 1.s:495    .text:0000000000000310 _svc_handler
                 1.s:497    .text:0000000000000312 _pendsv_handler
                 1.s:499    .text:0000000000000314 _systickzhongduan
                 1.s:507    .text:0000000000000322 aaa
                            .text:0000000000000000 $d
                 1.s:73     .text:00000000000000b0 $t
                 1.s:76     .text:00000000000000b0 shizhong
                 1.s:83     .text:00000000000000bc denghse
                 1.s:87     .text:00000000000000c2 dengpllguan
                 1.s:95     .text:00000000000000d0 dengpll
                 1.s:102    .text:00000000000000da dengdai14mshizhongwending
                 1.s:107    .text:00000000000000e0 _neicunqingling
                 1.s:111    .text:00000000000000e6 _neicunqinglingxunhuan
                 1.s:116    .text:00000000000000ec _waisheshizhong
                 1.s:135    .text:00000000000000fa _waishezhongduan
                 1.s:150    .text:00000000000000fa io_she_zhi
                 1.s:184    .text:000000000000010e _adcchushihua
                 1.s:188    .text:0000000000000114 _dengadcjiaozhun
                 1.s:192    .text:000000000000011a _kaiadc
                 1.s:197    .text:0000000000000122 _dengdaiadcwending
                 1.s:201    .text:0000000000000128 _tongdaoxuanze
                 1.s:215    .text:000000000000013c dmachushihua
                 1.s:247    .text:0000000000000160 tim1chushihua
                 1.s:271    .text:000000000000018a _tim3chushiha
                 1.s:287    .text:00000000000001a8 _tingting
                 1.s:300    .text:00000000000001c0 __zheng
                 1.s:307    .text:00000000000001cc __xian_shi_led
                 1.s:320    .text:00000000000001ec __pwm_ping_heng
                 1.s:440    .text:00000000000002be _lvboqi
                 1.s:354    .text:0000000000000226 _zhuanshumaguanma
                 1.s:382    .text:0000000000000254 _xieshumaguan
                 1.s:340    .text:0000000000000210 __diancitieshang
                 1.s:328    .text:00000000000001fa __dian_ci_tie_xia
                 1.s:351    .text:0000000000000224 __pwm_ping_heng_fan_hui
                 1.s:363    .text:0000000000000232 _xunhuanqiuma
                 1.s:467    .text:00000000000002e6 _chufa
                 1.s:373    .text:0000000000000246 __tian_jia_xiao_shu_dian
                 1.s:375    .text:0000000000000248 __bao_cun_shu_ma_guan_ma
ARM GAS  1.s 			page 12


                 1.s:389    .text:0000000000000260 _shumaguanshuaxin
                 1.s:400    .text:0000000000000274 _xie595
                 1.s:409    .text:0000000000000284 _xunhuan595
                 1.s:432    .text:00000000000002b2 _yanshi
                 1.s:416    .text:0000000000000292 _xie595_0
                 1.s:418    .text:0000000000000294 _suocun595
                 1.s:435    .text:00000000000002b6 _yanshi11
                 1.s:451    .text:00000000000002ce _lvboqimeidaohuanchongquding
                 1.s:454    .text:00000000000002d2 _lvboqixunhuan
                 1.s:458    .text:00000000000002d8 _lvbozonghe
                 1.s:489    .text:000000000000030a _chufafanhui
                 1.s:479    .text:00000000000002fa _chufaxunhuan
                 1.s:486    .text:0000000000000306 _chufaweishubudao0
                 1.s:508    .text:0000000000000324 $d

NO UNDEFINED SYMBOLS
