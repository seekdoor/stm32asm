ARM GAS  1.s 			page 1


   1              		@@ 单片机stm32f030f4p6
   2              		@@ 阻抗桥
   3              		@作者：yjmwxwx
   4              		@时间：2019-08-12
   5              		@编译器：ARM-NONE-EABI
   6              		 .thumb
   7              		         .syntax unified
   8              	.section .data
   9              	zheng_xian_biao:
  10 0000 18001900 		.short 0x18,0x19,0x1a,0x1c,0x1d,0x1f,0x20,0x22,0x23,0x24,0x25,0x26,0x28,0x29,0x2a,0x2b,0x2b,0x2c,0
  10      1A001C00 
  10      1D001F00 
  10      20002200 
  10      23002400 
  11              	lcdshuju:
  12 00ca 796A6D77 		.ascii  "yjmwxwx-20190812"
  12      7877782D 
  12      32303139 
  12      30383132 
  13              	dianhua:	
  14 00da 20202020 		.ascii	"     15552208295"
  14      20313535 
  14      35323230 
  14      38323935 
  15              	qq:
  16 00ea 20202051 		.ascii	"   QQ:3341656346"
  16      513A3333 
  16      34313635 
  16      36333436 
  17              	xushu:
  18 00fa 69       		.ascii "i"
  19              	fu:
  20 00fb 2D       		.ascii "-"
  21              	zheng:
  22 00fc 2B       		.ascii "+"
  23              	dianzu:
  24 00fd 523D     		.ascii	"R="
  25              	dianrong:
  26 00ff 433D     		.ascii	"C="
  27              	pinlv:
  28 0101 31304B48 		.ascii	"10KHZ"
  28      5A
  29              	qianou:
  30 0106 4B       		.ascii	"K"
  31              	ou:
  32 0107 F4000000 	        .int    0xf4
  33              	kong:
  34 010b 20202020 		.int 0x20202020
  35              	pifa:
  36 010f 5046     		.ascii "PF"
  37              	xiaomai:
  38 0111 7869616F 		.ascii "xiaomai ="
  38      6D616920 
  38      3D
  39              		.equ STACKINIT,        	        0x20001000
  40              		.equ asciimabiao,		0x20000000
  41              		.equ liangcheng,		0x20000030
ARM GAS  1.s 			page 2


  42              		.equ jishu,			0x20000034
  43              		.equ jianbo,			0x20000038
  44              		.equ dianyabiao,		0x20000040
  45              		.equ dianyabiao1,		0x20000110
  46              		.equ dianyabiao2,		0x200001e0
  47              		.equ lvboqizhizhen,		0x20000600
  48              		.equ lvboqihuanchong,		0x20000604
  49              		.equ lvboqizhizhen1,		0x20000700
  50              		.equ lvboqihuanchong1,		0x20000704
  51              		.equ lvboqizhizhen2,		0x20000800
  52              		.equ lvboqihuanchong2,		0x20000804
  53              		.equ lvboqizhizhen3,		0x20000900
  54              		.equ lvboqihuanchong3,		0x20000904
  55              		.equ xia_bi_shi_bu,		0x20000a00
  56              		.equ shang_bi_shi_bu,		0x20000a04
  57              		.equ xia_bi_xu_bu,		0x20000a08
  58              		.equ shang_bi_xu_bu,		0x20000a0c
  59              		.equ bu_chang_100r,		0x20000a10
  60              		.equ zidongliangchengyanshi,	0x20000a14
  61              		.equ dianzuzhi,			0x20000a18
  62              		.equ dianrongzhi,		0x20000a1c
  63              		.section .text
  64              	vectors:
  65 0000 00100020 		.word STACKINIT
  66 0004 B1000000 		.word _start + 1
  67 0008 21080000 		.word _nmi_handler + 1
  68 000c 23080000 		.word _hard_fault  + 1
  69 0010 00000000 		.word 0
  70 0014 00000000 		.word 0
  71 0018 00000000 		.word 0
  72 001c 00000000 		.word 0
  73 0020 00000000 		.word 0
  74 0024 00000000 		.word 0
  75 0028 00000000 		.word 0
  76 002c 25080000 		.word _svc_handler +1
  77 0030 00000000 		.word 0
  78 0034 00000000 		.word 0
  79 0038 27080000 		.word _pendsv_handler +1
  80 003c 29080000 		.word _systickzhongduan +1               @ 15
  81 0040 37080000 		.word aaa +1     @ _wwdg +1          @ 0
  82 0044 37080000 		.word aaa +1     @_pvd +1            @ 1
  83 0048 37080000 		.word aaa +1     @_rtc +1            @ 2
  84 004c 37080000 		.word aaa +1     @_flash +1          @ 3
  85 0050 37080000 		.word aaa +1	@ _rcc + 1          @ 4
  86 0054 37080000 		.word aaa +1      @_exti0_1  +1      @ 5
  87 0058 37080000 		.word aaa +1      @ _exti2_3 +1      @ 6
  88 005c 37080000 		.word aaa +1       @_exti4_15 +1     @ 7
  89 0060 37080000 		.word aaa +1                         @ 8
  90 0064 37080000 		.word aaa +1 	@_dma1_1  +1    @ 9
  91 0068 37080000 		.word aaa +1    @_dma1_2_3 +1        @ 10
  92 006c 37080000 		.word aaa +1       @_dma1_4_5 +1     @ 11
  93 0070 37080000 		.word aaa +1	 @_adc1 +1          @ 12
  94 0074 37080000 		.word aaa +1       @_tim1_brk_up +1  @ 13
  95 0078 37080000 		.word aaa +1        @ _tim1_cc +1    @ 14
  96 007c 37080000 		.word aaa +1         @_tim2 +1       @ 15
  97 0080 37080000 		.word aaa +1          @_tim3 +1      @ 16
  98 0084 37080000 		.word aaa +1                         @ 17
ARM GAS  1.s 			page 3


  99 0088 37080000 		.word aaa +1		                @ 18
 100 008c 37080000 		.word aaa +1	@_tim14 +1    @ 19
 101 0090 37080000 		.word aaa +1                         @ 20
 102 0094 37080000 		.word aaa +1         @_tim16 +1      @ 21
 103 0098 37080000 		.word aaa +1         @_tim17 +1      @ 22
 104 009c 37080000 		.word aaa +1          @_i2c   +1     @ 23
 105 00a0 37080000 		.word aaa +1                         @ 24
 106 00a4 37080000 		.word aaa +1           @_spi   +1    @ 25
 107 00a8 37080000 		.word aaa +1                         @ 26
 108 00ac 37080000 		.word aaa +1         @_usart1 +1     @ 27
 109              		.align 2
 110              	
 111              	_start:
 112 00b0 9348     		ldr r0, = 0xffff
 113              	yanshi111:
 114 00b2 0138     		subs r0, r0, # 1
 115 00b4 FDD1     		bne yanshi111
 116              		
 117              	shizhong:
 118 00b6 934A     		ldr r2, = 0x40022000   @FLASH访问控制
 119 00b8 3221     		movs r1, # 0x32
 120 00ba 1160     		str r1, [r2]           @FLASH缓冲 缓冲开启
 121 00bc 9248     		ldr r0, = 0x40021000 @ rcc
 122 00be 9349     		ldr r1, = 0x10001
 123 00c0 0160     		str r1, [r0]
 124              	denghse:
 125 00c2 0168     		ldr r1, [r0]
 126 00c4 8903     		lsls r1, r1, # 14
 127 00c6 FCD5     		bpl denghse
 128              	dengpllguan:
 129 00c8 0168     		ldr r1, [r0]
 130 00ca 8901     		lsls r1, r1, # 6
 131 00cc FCD4     		bmi dengpllguan
 132 00ce 9049     	        ldr r1, = 0x110002
 133 00d0 4160     	        str r1, [r0, # 0x04]
 134 00d2 9049     		ldr r1, = 0x1010001
 135 00d4 0160     		str r1, [r0]
 136              	dengpll:
 137 00d6 0168     		ldr r1, [r0]
 138 00d8 8901     		lsls r1, # 6
 139 00da FCD5     		bpl dengpll
 140              		@0x34时钟控制寄存器 2 (RCC_CR2)
 141 00dc 0121     		movs r1, # 0x01
 142 00de 4163     		str r1, [r0, # 0x34]  @ HSI开14M时钟
 143              	dengdai14mshizhongwending:
 144 00e0 416B     		ldr r1, [r0, # 0x34]
 145 00e2 8907     		lsls r1, r1, # 30     @ 左移30位
 146 00e4 FCD5     		bpl dengdai14mshizhongwending  @ 等待14M时钟稳定
 147              	
 148              	_neicunqingling:
 149 00e6 8C48     		ldr r0, = 0x20000000
 150 00e8 0021     		movs r1, # 0
 151 00ea 8C4B     		ldr r3, = 0x1000
 152              	_neicunqinglingxunhuan:
 153 00ec 043B     		subs r3, # 4
 154 00ee C150     		str r1, [r0, r3]
 155 00f0 FCD1     		bne _neicunqinglingxunhuan
ARM GAS  1.s 			page 4


 156              	
 157              	_waisheshizhong:			 @ 外设时钟
 158              		@+0x14=RCC_AHBENR
 159              		@0=DMA @2=SRAM @4=FLITF@6=CRC @17=PA @18=PB @19=PC @20=PD @22=PF
 160 00f2 8548     		ldr r0, = 0x40021000
 161 00f4 8A49     		ldr r1, = 0x460005
 162 00f6 4161     		str r1, [r0, # 0x14]
 163              	
 164              		@+0x18外设时钟使能寄存器 (RCC_APB2ENR)
 165              		@0=SYSCFG @5=USART6EN @9=ADC @11=TIM1 @12=SPI1 @14=USART1 @16=TIM15 @17=TIM16 @18=TIM17 @22=DBGMCU
 166 00f8 8A49     		ldr r1, = 0xa00
 167 00fa 8161     		str r1, [r0, # 0x18]
 168              		@+0X1C=RCC_APB1ENR
 169              		@1=TIM3 @4=TIM6 @5=TIM7 @8=TIM14 @11=WWDG @14=SPI @17=USRT2 @18=USART3 @20=USART5 @21=I2C1
 170              		@22=I2C2 @23=USB @28=PWR
 171              	
 172              	_waishezhongduan:				@外设中断
 173              		@0xE000E100    0-31  写1开，写0没效
 174              		@0XE000E180    0-31 写1关，写0没效
 175              		@0XE000E200    0-31 挂起，写0没效
 176              		@0XE000E280    0-31 清除， 写0没效
 177              	
 178              	@_systick:				@ systick定时器初始化
 179              	
 180              	@	ldr r0, = 0xe000e010
 181              	@	ldr r1, = 0xffffff
 182              	@	str r1, [r0, # 4]
 183              	@	str r1, [r0, # 8]
 184              	@	movs r1, # 0x07
 185              	@	str r1, [r0]
 186              		
 187              	io_she_zhi:
 188              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 189              		@a(0x48000000)b(0x48000400)c(0x48000800)d(0x48000c00)f(0x48001400)
 190              		@ 输入（00），通用输出（01），复用功能（10），模拟（11）
 191              		@偏移0x4 = 端口输出类型 @ （0 推挽），（ 1 开漏）
 192              		@偏移0x8 = 输出速度  00低速， 01中速， 11高速
 193              		@偏移0xC = 上拉下拉 (00无上下拉，  01 上拉， 10下拉)
 194              		@偏移0x10 = 输入数据寄存器
 195              		@偏移0x14 = 输出数据寄存器
 196              		@偏移0x18 = 端口开  0-15置位
 197              		@偏移0x28 = 端口关
 198              		@0X20 = 复用低
 199              		@GPIO口0（0-3位）每个IO口占用4位
 200              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 201              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 202              		@0x24 = 复用高
 203              		@GPIO口8 （0-3位）每个IO口占用4位
 204              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 205              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 206              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 207              	
 208 00fc 8A48     		ldr r0, = 0x48000000
 209 00fe 8B49     		ldr r1, = 0x2824540f
 210 0100 0160     		str r1, [r0]
 211 0102 8B49     		ldr r1, = 0x200
 212 0104 4162     		str r1, [r0, # 0x24]
ARM GAS  1.s 			page 5


 213              	
 214              	
 215              	
 216              	_adcchushihua:
 217 0106 8B48     	        ldr r0, = 0x40012400  @ adc基地址
 218 0108 8B49     	        ldr r1, = 0x80000000
 219 010a 8160     	        str r1, [r0, # 0x08]  @ ADC 控制寄存器 (ADC_CR)  @adc校准
 220              	_dengadcjiaozhun:
 221 010c 8168     	        ldr r1, [r0, # 0x08]
 222 010e 0900     	        movs r1, r1
 223 0110 FCD4     	        bmi _dengadcjiaozhun   @ 等ADC校准
 224              	_kaiadc:
 225 0112 8168     		ldr r1, [r0, # 0x08]
 226 0114 0122     	        movs r2, # 0x01
 227 0116 1143     		orrs r1, r1, r2
 228 0118 8160     	        str r1, [r0, # 0x08]
 229              	_dengdaiadcwending:
 230 011a 0168     		ldr r1, [r0]
 231 011c C907     		lsls r1, r1, # 31
 232 011e FCD5     		bpl _dengdaiadcwending @ 等ADC稳定
 233              	_tongdaoxuanze:
 234 0120 8649     		ldr r1, = 2
 235 0122 8162     	        str r1, [r0, # 0x28]    @ 通道选择寄存器 (ADC_CHSELR)
 236 0124 8649     	        ldr r1, = 0x803
 237 0126 C160     	        str r1, [r0, # 0x0c]    @ 配置寄存器 1 (ADC_CFGR1)
 238 0128 0021     		movs r1, # 0
 239 012a 4161     	        str r1, [r0, # 0x14]    @ ADC 采样时间寄存器 (ADC_SMPR)
 240 012c 8168     		ldr r1, [r0, # 0x08]
 241 012e 854A     	        ldr r2, = 0x04         @ 开始转换
 242 0130 1143     	        orrs r1, r1, r2
 243 0132 8160     		str r1, [r0, # 0x08]    @ 控制寄存器 (ADC_CR)
 244              	
 245              	
 246              		
 247              	dmachushihua:
 248              	        @+0=LSR,+4=IFCR,
 249              	        @+8=CCR1,+c=CNDTR1,+10=CPAR1+14=CMAR1,
 250              	        @+1c=CCR2,+20=CNDTR2,+24=CPAR2,+28=CMAR2
 251              	        @+30=CCR3,+34=CNDTR3,+38=CPAR2,+3c=CMAR3
 252              	        @+44=CCR4,+48=CNDTR4,+4c=CPAR4,+50=CMAR4
 253              	        @+58=CCR5,+5c=CNDTR5,+60=CPAR5,+64=CMAR5
 254              	        @+6C=CCR6,+70=CNDTR6,+74=CPAR6,+78=CMAR6
 255              	        @+80=CCR7,+84=CNDTR7,+88=CPAR7,+8c=CMAR7
 256              	
 257              	        @tim1ch3DMA
 258 0134 8448     	        ldr r0, = 0x40020000
 259 0136 8549     	        ldr r1, = 0x40012c3c @ 外设地址
 260 0138 0166     	        str r1, [r0, # 0x60]
 261 013a 8549     	        ldr r1, = zheng_xian_biao @ 储存器地址
 262 013c 4166     	        str r1, [r0, # 0x64]
 263 013e 8549     	        ldr r1, = 100             @点数
 264 0140 C165     	        str r1, [r0, # 0x5c]
 265 0142 8549     	        ldr r1, = 0x35b1         @ 储存到外设
 266 0144 8165     	        str r1, [r0, # 0x58]
 267              		@ adc dma
 268 0146 8048     		ldr r0, = 0x40020000
 269 0148 8449     		ldr r1, = 0x40012440
ARM GAS  1.s 			page 6


 270 014a 0161     		str r1, [r0, # 0x10]
 271 014c 8449     		ldr r1, = dianyabiao
 272 014e 4161     		str r1, [r0, # 0x14]
 273 0150 8049     		ldr r1, =  100
 274 0152 C160     		str r1, [r0, # 0x0c]
 275 0154 8349     		ldr r1, = 0x5a1		@ 5a1
 276 0156 8160     		str r1, [r0, # 0x08]
 277              	
 278              		
 279              	tim1chushiha:
 280 0158 8348     	        ldr r0, = 0x40012c00 @ tim1_cr1
 281 015a 0021     	        movs r1, # 0
 282 015c 8162     	        str r1, [r0, # 0x28] @ psc
 283 015e 8349     	        ldr r1, = 47
 284 0160 C162     	        str r1, [r0, # 0x2c] @ ARR
 285              		@	movs r1, # 0x40
 286 0162 2021     		movs r1, # 0x20
 287 0164 4160     		str r1, [r0, # 0x04] @ TRGO
 288 0166 3821     		movs r1, # 0x38
 289 0168 8161     		str r1, [r0, # 0x18] @ ccmr1 cc1
 290 016a 2F21     		movs r1, # 47
 291 016c 4163     		str r1, [r0, # 0x34]
 292 016e 8049     	        ldr r1, = 0x68
 293 0170 C161     	        str r1, [r0, # 0x1c] @ ccmr2  CC3
 294 0172 8049     	        ldr r1, = 0x100    @  CC3
 295 0174 0162     	        str r1, [r0, # 0x20] @ ccer
 296 0176 8049     	        ldr r1, = 0x8000
 297 0178 4164     	        str r1, [r0, # 0x44] @ BDTR
 298 017a 8049     	        ldr r1, = 0x800 @ CC3 DMA
 299 017c C160     	        str r1, [r0, # 0x0c] @ DIER
 300 017e 8049     	        ldr r1, = 0x81
 301 0180 0160     	        str r1, [r0]
 302              	
 303              	
 304              	
 305              	_lcdchushihua:
 306 0182 3320     		movs r0, # 0x33
 307 0184 0021     		movs r1, # 0
 308 0186 00F0DAFA 		bl _xielcd
 309 018a 00F0D3FA 		bl _lcdyanshi
 310 018e 3220     		movs r0, # 0x32
 311 0190 0021     		movs r1, # 0
 312 0192 00F0D4FA 		bl _xielcd
 313 0196 00F0CDFA 		bl _lcdyanshi
 314 019a 2820     		movs r0, # 0x28
 315 019c 0021     		movs r1, # 0
 316 019e 00F0CEFA 		bl _xielcd
 317 01a2 00F0C7FA 		bl _lcdyanshi
 318 01a6 0C20     		movs r0, # 0x0c
 319 01a8 0021     		movs r1, # 0
 320 01aa 00F0C8FA 		bl _xielcd
 321 01ae 00F0C1FA 		bl _lcdyanshi
 322 01b2 0120     		movs r0, # 0x01
 323 01b4 0021     		movs r1, # 0
 324 01b6 00F0C2FA 		bl _xielcd
 325 01ba 00F0BBFA 		bl _lcdyanshi
 326              	
ARM GAS  1.s 			page 7


 327              	@	movs r0, # 0x80
 328              	@	ldr r1, = lcdshuju
 329              	@	movs r2, # 16
 330              	@	movs r3, # 0xff
 331              	@	bl _lcdxianshi
 332              		
 333 01be 7148     		ldr r0, = liangcheng
 334 01c0 0021     		movs r1, # 0x00
 335 01c2 0160     		str r1, [r0]
 336              	
 337              	
 338              	ting:
 339 01c4 00F0ECF9 		bl __zi_dong_liang_cheng
 340 01c8 00F00BFA 	        bl _jianbo
 341 01cc 00F0C6F9 		bl __zhen_fu_lv_bo
 342 01d0 00F027F9 		bl __zu_kang_ji_suan
 343 01d4 6C48     		ldr r0, = dianrongzhi
 344 01d6 0821     	        movs r1, # 8
 345 01d8 0068     		ldr r0, [r0]
 346 01da 4F4A     	        ldr r2, = asciimabiao
 347 01dc FF23     	        movs r3, # 0xff
 348 01de 00F0EAFA 	        bl _zhuanascii
 349 01e2 8520     	        movs r0, # 0x85
 350 01e4 4C49     	        ldr r1, = asciimabiao
 351 01e6 0822     	        movs r2, # 8
 352 01e8 00F096FA 	        bl _lcdxianshi
 353 01ec 6548     		ldr r0, = liangcheng
 354 01ee 0168     		ldr r1, [r0]
 355              	__liangcheng100k:
 356 01f0 0029     		cmp r1, # 0x00
 357 01f2 19D1     		bne __liangcheng10k
 358 01f4 6548     	        ldr r0, = dianzuzhi
 359 01f6 6649     	        ldr r1, = 1000
 360 01f8 0068     	        ldr r0, [r0]
 361 01fa 00F0F7FA 		bl _chufa
 362 01fe 0421     		movs r1, # 4
 363 0200 454A     		ldr r2, = asciimabiao
 364 0202 FF23     		movs r3, # 0xff
 365 0204 00F0D7FA 	        bl _zhuanascii
 366 0208 C320     		movs r0, # 0xc3
 367 020a 4349     		ldr r1, = asciimabiao
 368 020c 0422     		movs r2, # 4
 369 020e 00F083FA 	        bl _lcdxianshi
 370 0212 C720     		movs r0, # 0xc7
 371 0214 5F49     	        ldr r1, = qianou
 372 0216 0222     	        movs r2, # 2
 373 0218 00F07EFA 	        bl _lcdxianshi
 374 021c C920     		movs r0, # 0xc9
 375 021e 5E49     	        ldr r1, = kong
 376 0220 0122     	        movs r2, # 1
 377 0222 00F079FA 	        bl _lcdxianshi
 378 0226 48E0     		b __xian_shi_qi_ta
 379              	__liangcheng10k:
 380 0228 5648     	        ldr r0, = liangcheng
 381 022a 0168     	        ldr r1, [r0]
 382 022c 4029     		cmp r1, # 0x40
 383 022e 14D1     		bne __liangcheng1k
ARM GAS  1.s 			page 8


 384 0230 5648     	        ldr r0, = dianzuzhi
 385 0232 4849     	        ldr r1, = 100
 386 0234 0068     	        ldr r0, [r0]
 387 0236 00F0D9FA 	        bl _chufa
 388 023a 0521     	        movs r1, # 5
 389 023c 364A     	        ldr r2, = asciimabiao
 390 023e 0323     		movs r3, # 3
 391 0240 00F0B9FA 	        bl _zhuanascii
 392 0244 C320     	        movs r0, # 0xc3
 393 0246 3449     	        ldr r1, = asciimabiao
 394 0248 0522     	        movs r2, # 5
 395 024a 00F065FA 	        bl _lcdxianshi
 396 024e C820     	        movs r0, # 0xc8
 397 0250 5049     	        ldr r1, = qianou
 398 0252 0222     	        movs r2, # 2
 399 0254 00F060FA 	        bl _lcdxianshi
 400 0258 2FE0     		b __xian_shi_qi_ta
 401              	__liangcheng1k:
 402 025a 4A48     	        ldr r0, = liangcheng
 403 025c 0168     	        ldr r1, [r0]
 404 025e 8029     	        cmp r1, # 0x80
 405 0260 14D1     	        bne __liangcheng100r
 406 0262 4A48     		ldr r0, = dianzuzhi
 407 0264 4D49     	        ldr r1, = 10
 408 0266 0068     	        ldr r0, [r0]
 409 0268 00F0C0FA 	        bl _chufa
 410 026c 0521     	        movs r1, # 5
 411 026e 2A4A     	        ldr r2, = asciimabiao
 412 0270 0223     	        movs r3, # 2
 413 0272 00F0A0FA 	        bl _zhuanascii
 414 0276 C320     	        movs r0, # 0xc3
 415 0278 2749     	        ldr r1, = asciimabiao
 416 027a 0522     	        movs r2, # 5
 417 027c 00F04CFA 	        bl _lcdxianshi
 418 0280 C820     	        movs r0, # 0xc8
 419 0282 4449     	        ldr r1, = qianou
 420 0284 0222     	        movs r2, # 2
 421 0286 00F047FA 	        bl _lcdxianshi
 422 028a 16E0     		b __xian_shi_qi_ta
 423              	__liangcheng100r:
 424 028c 3F48     	        ldr r0, = dianzuzhi
 425 028e 0421     		movs r1, # 4
 426 0290 0068     	        ldr r0, [r0]
 427 0292 214A     	        ldr r2, = asciimabiao
 428 0294 FF23     	        movs r3, # 0xff
 429 0296 00F08EFA 	        bl _zhuanascii
 430 029a C320     	        movs r0, # 0xc3
 431 029c 1E49     	        ldr r1, = asciimabiao
 432 029e 0422     	        movs r2, # 4
 433 02a0 00F03AFA 	        bl _lcdxianshi
 434 02a4 C720     	        movs r0, # 0xc7
 435 02a6 3E49     	        ldr r1, = ou
 436 02a8 0122     	        movs r2, # 1
 437 02aa 00F035FA 	        bl _lcdxianshi
 438 02ae C820     	        movs r0, # 0xc8
 439 02b0 3949     	        ldr r1, = kong
 440 02b2 0222     	        movs r2, # 2
ARM GAS  1.s 			page 9


 441 02b4 00F030FA 	        bl _lcdxianshi
 442 02b8 FFE7     	        b __xian_shi_qi_ta
 443              	
 444              	__xian_shi_qi_ta:
 445 02ba 3248     		ldr r0, = liangcheng
 446 02bc 0068     		ldr r0, [r0]
 447 02be 8009     		lsrs r0, r0, # 6
 448 02c0 0121     		movs r1, # 1
 449 02c2 154A     	        ldr r2, = asciimabiao
 450 02c4 FF23     	        movs r3, # 0xff
 451 02c6 00F076FA 	        bl _zhuanascii
 452 02ca 8020     	        movs r0, # 0x80
 453 02cc 1249     	        ldr r1, = asciimabiao
 454 02ce 0122     	        movs r2, # 1
 455 02d0 00F022FA 	        bl _lcdxianshi
 456              	
 457 02d4 C120     	        movs r0, # 0xc1
 458 02d6 3349     	        ldr r1, = dianzu
 459 02d8 0222     	        movs r2, # 2
 460 02da 00F01DFA 	        bl _lcdxianshi
 461 02de CB20     	        movs r0, # 0xcb
 462 02e0 3149     	        ldr r1, = pinlv
 463 02e2 0522     	        movs r2, # 5
 464 02e4 00F018FA 	        bl _lcdxianshi
 465              	__xian_shi_dian_rong:
 466 02e8 8320     		movs r0, # 0x83
 467 02ea 3049     		ldr r1, = dianrong
 468 02ec 0222     		movs r2, # 2
 469 02ee 00F013FA 		bl _lcdxianshi
 470 02f2 8E20     	        movs r0, # 0x8e
 471 02f4 2E49     	        ldr r1, = pifa
 472 02f6 0222     	        movs r2, # 2
 473 02f8 00F00EFA 		bl _lcdxianshi
 474              	
 475 02fc 62E7     		b ting
 476              	
 477 02fe 0000FFFF 		.ltorg
 477      00000020 
 477      02400010 
 477      02400100 
 477      01000200 
 478              	
 479              	dd:
 480 03b4 00F0F4F8 	   	bl __zi_dong_liang_cheng
 481 03b8 B448     		ldr r0, = liangcheng
 482 03ba 0068     	        ldr r0, [r0]
 483 03bc 0421     	        movs r1, # 4
 484 03be B44A     	        ldr r2, = asciimabiao
 485 03c0 FF23     	        movs r3, # 0xff
 486 03c2 00F0F8F9 	        bl _zhuanascii
 487 03c6 C620     	        movs r0, # 0xc6
 488 03c8 B149     	        ldr r1, = asciimabiao
 489 03ca 0422     		movs r2, # 0x04
 490 03cc 00F0A4F9 		bl _lcdxianshi
 491 03d0 00F007F9 	        bl _jianbo
 492 03d4 00F0C2F8 	        bl __zhen_fu_lv_bo
 493 03d8 00F084F8 	        bl __xian_shi_shang_xia_bi
ARM GAS  1.s 			page 10


 494 03dc EAE7     		b dd
 495              	
 496              	__ji_suan_fu_du:    @ 计算幅度
 497              	                @ 入r0= 实部，r1= 虚部
 498              	                @ 出r0 = 幅度
 499              	                @ Mag ~=Alpha * max(|I|, |Q|) + Beta * min(|I|, |Q|)
 500              	                @ Alpha * Max + Beta * Min
 501 03de 0EB5     	        push {r1-r3,lr}
 502 03e0 0000     	        movs r0, r0
 503 03e2 01D5     	        bpl _shibubushifushu
 504 03e4 C043     	        mvns r0, r0                             @ 是负数转成正数
 505 03e6 0130     	        adds r0, r0, # 1
 506              	_shibubushifushu:                               @ 实部不是负数
 507 03e8 0900     	        movs r1, r1
 508 03ea 01D5     	        bpl _xububushifushu
 509 03ec C943     	        mvns r1, r1                             @ 是负数转成正数
 510 03ee 0131     	        adds r1, r1, # 1
 511              	_xububushifushu:                                @ 虚部不是负数
 512 03f0 0028     	        cmp r0, # 0
 513 03f2 01D1     	        bne _panduanxubushibushi0
 514 03f4 0846     	        mov r0, r1
 515 03f6 0EBD     	        pop {r1-r3,pc}
 516              	_panduanxubushibushi0:	
 517 03f8 0029     		cmp r1, # 0
 518 03fa 00D1     		bne _jisuanfudu1
 519 03fc 0EBD     		pop {r1-r3,pc}
 520              	_jisuanfudu1:
 521 03fe A54A     		ldr r2, = 31066		@ Alpha q15 0.948059448969
 522 0400 A54B     		ldr r3, = 12867		@ Beta q15 0.392699081699
 523 0402 8142     		cmp r1, r0
 524 0404 06D8     		bhi _alpha_min_beta_max
 525              	_alpha_max_beta_min:
 526 0406 5043     		muls r0, r0, r2
 527 0408 5943     		muls r1, r1, r3
 528 040a C013     		asrs r0, r0, # 15
 529 040c C913     		asrs r1, r1, # 15
 530 040e 4018     		adds r0, r0, r1
 531 0410 0121     		movs r1, # 1
 532 0412 0EBD     		pop {r1-r3,pc}
 533              	_alpha_min_beta_max:
 534 0414 5843     		muls r0, r0, r3
 535 0416 5143     		muls r1, r1, r2
 536 0418 C013     		asrs r0, r0, # 15
 537 041a C913     		asrs r1, r1, # 15
 538 041c 4018     		adds r0, r0, r1
 539 041e 0021     		movs r1, # 0
 540 0420 0EBD     		pop {r1-r3,pc}
 541              		
 542              	__zu_kang_ji_suan:
 543 0422 FFB5     		push {r0-r7,lr}
 544 0424 9D48     		ldr r0, = shang_bi_shi_bu
 545 0426 9E49     		ldr r1, = shang_bi_xu_bu
 546 0428 9E4A     		ldr r2, = xia_bi_shi_bu
 547 042a 9F4B     		ldr r3, = xia_bi_xu_bu
 548 042c 974C     		ldr r4, = liangcheng
 549 042e 0068     		ldr r0, [r0]
 550 0430 0968     		ldr r1, [r1]
ARM GAS  1.s 			page 11


 551 0432 1268     		ldr r2, [r2]
 552 0434 1B68     		ldr r3, [r3]
 553 0436 2568     		ldr r5, [r4]
 554              	__c_liang_cheng_100k:
 555 0438 002D     	        cmp r5, # 0x00
 556 043a 01D1     		bne __c_liang_cheng10k
 557 043c 9B4C     	        ldr r4, = 100000
 558 043e 08E0     		b __ji_suan_dian_rong
 559              	__c_liang_cheng10k:
 560 0440 402D     	        cmp r5, # 0x40
 561 0442 01D1     	        bne __c_liang_cheng1k
 562 0444 9A4C     	        ldr r4, = 10000
 563 0446 04E0     	        b __ji_suan_dian_rong
 564              	__c_liang_cheng1k:
 565 0448 802D     	        cmp r5, # 0x80
 566 044a 01D1     		bne __c_liang_cheng100ou
 567 044c 994C     	        ldr r4, = 1000
 568 044e 00E0     	        b __ji_suan_dian_rong
 569              	__c_liang_cheng100ou:
 570 0450 6424     		movs r4, # 100
 571              	__ji_suan_dian_rong:
 572              	@ Z=R+jx
 573              	@ Z=R*[(a+bi)/(c+di)]=R*[(ac+bd)/(c*c+d*d)+(bc-ad)/(c*c+d*d)]
 574              	@c=1/[(2*pi*f)*xc]
 575 0452 10B4     		push {r4}
 576 0454 0446     		mov r4, r0
 577 0456 0D46     		mov r5, r1
 578 0458 1646     		mov r6, r2
 579 045a 1F46     		mov r7, r3
 580 045c 5043     		muls r0, r0, r2		@ac
 581 045e 5943     		muls r1, r1, r3		@bd
 582 0460 4018     		adds r0, r0, r1		@ac+bd
 583 0462 5243     		muls r2, r2, r2		@c*c
 584 0464 5B43     		muls r3, r3, r3		@d*d
 585 0466 D218     		adds r2, r2, r3		@c*c+d*d
 586 0468 1146     		mov r1, r2
 587 046a 8002     		lsls r0, r0, # 10
 588 046c 00F0BEF9 		bl _chufa		@(ac+bd)/(c*c+d*d)
 589 0470 01B4     		push {r0}
 590 0472 7543     		muls r5, r5, r6		@ bc
 591 0474 7C43     		muls r4, r4, r7		@ ad
 592 0476 2D1B     		subs r5, r5, r4		@ bc-ad
 593 0478 1146     		mov r1, r2
 594 047a 2846     		mov r0, r5
 595 047c 8002     		lsls r0, r0, # 10
 596 047e 00F0B5F9 		bl _chufa
 597 0482 0146     		mov r1, r0		@ R1=结果虚部
 598 0484 01BC     		pop {r0}		@ R0=结果实部
 599 0486 04BC     		pop {r2}		@ R2=R（量程）
 600 0488 5043     		muls r0, r0, r2		@ 
 601 048a 5143     		muls r1, r1, r2		@
 602 048c 8012     		asrs r0, r0, # 10
 603 048e 8A4A     		ldr r2, = dianzuzhi
 604 0490 8912     		asrs r1, r1, # 10
 605 0492 1060     		str r0, [r2]
 606 0494 FFF7A3FF 		bl __ji_suan_fu_du
 607 0498 884B     		ldr r3, = 62831		@ 2pi*10khz
ARM GAS  1.s 			page 12


 608 049a 0146     		mov r1, r0
 609 049c 5943     		muls r1, r1, r3
 610 049e 0C46     		mov r4, r1
 611 04a0 8748     		ldr r0, = 1000000000
 612 04a2 8142     		cmp r1, r0
 613 04a4 0DD8     		bhi __shu_tai_da
 614 04a6 00F0A1F9 		bl _chufa
 615 04aa 0346     		mov r3, r0
 616 04ac 814A     		ldr r2, = 1000
 617 04ae 0846     		mov r0, r1
 618 04b0 5043     		muls r0, r0, r2
 619 04b2 5343     		muls r3, r3, r2
 620 04b4 2146     		mov r1, r4
 621 04b6 00F099F9 		bl _chufa
 622 04ba 824A     		ldr r2, = dianrongzhi
 623 04bc 1B18     		adds r3, r3, r0
 624 04be 1360     		str r3, [r2]
 625 04c0 FFBD     		pop {r0-r7,pc}
 626              	__shu_tai_da:
 627 04c2 890A     		lsrs r1, r1, # 10
 628 04c4 00F092F9 		bl _chufa
 629 04c8 7A49     		ldr r1, = 1000
 630 04ca 8002     		lsls r0, r0, # 10
 631 04cc 00F08EF9 		bl _chufa
 632 04d0 7C4A     		ldr r2, = dianrongzhi
 633 04d2 1060     		str r0, [r2]
 634 04d4 FFBD     		pop {r0-r7,pc}
 635              	__fu_zhi_nei_cun:
 636              		@ 入口 R0 = 要复制的地址，R1=目标地址，R2=复制的数量
 637 04d6 00B5     		push {lr}
 638 04d8 5200     		lsls r2, r2, # 1
 639              	__fu_zhi_xun_huan:	
 640 04da 835A     		ldrh r3, [r0, r2]
 641 04dc 8B52     		strh r3, [r1, r2]
 642 04de 023A     		subs r2, r2, # 2
 643 04e0 FBD1     		bne __fu_zhi_xun_huan
 644 04e2 00BD     		pop {pc}
 645              	__xian_shi_shang_xia_bi:
 646 04e4 0FB5     		push {r0-r3,lr}
 647 04e6 C420     	        movs r0, # 0xc4
 648 04e8 7749     	        ldr r1, = xushu
 649 04ea 0122     	        movs r2, # 1
 650 04ec 00F014F9 	        bl _lcdxianshi
 651 04f0 CF20     		movs r0, # 0xcf
 652 04f2 7549     	        ldr r1, = xushu
 653 04f4 0122     		movs r2, # 1
 654 04f6 00F00FF9 		bl _lcdxianshi
 655 04fa 6A48     		ldr r0, = xia_bi_shi_bu
 656 04fc 0421     		movs r1, # 4
 657 04fe 0068     		ldr r0, [r0]
 658 0500 634A     		ldr r2, = asciimabiao
 659 0502 FF23     		movs r3, # 0xff
 660 0504 00F057F9 		bl _zhuanascii
 661 0508 8B20     		movs r0, # 0x8b
 662 050a 6149     		ldr r1, = asciimabiao
 663 050c 0422     		movs r2, # 0x04
 664 050e 00F003F9 		bl _lcdxianshi
ARM GAS  1.s 			page 13


 665 0512 6248     	        ldr r0, = shang_bi_shi_bu
 666 0514 0421     	        movs r1, # 4
 667 0516 0068     	        ldr r0, [r0]
 668 0518 5D4A     	        ldr r2, = asciimabiao
 669 051a FF23     	        movs r3, # 0xff
 670 051c 00F04BF9 	        bl _zhuanascii
 671 0520 8020     	        movs r0, # 0x80
 672 0522 5B49     	        ldr r1, = asciimabiao
 673 0524 0422     	        movs r2, # 0x04
 674 0526 00F0F7F8 	        bl _lcdxianshi
 675 052a 5F48     	        ldr r0, = xia_bi_xu_bu
 676 052c 0421     	        movs r1, # 4
 677 052e 0068     	        ldr r0, [r0]
 678 0530 574A     	        ldr r2, = asciimabiao
 679 0532 FF23     	        movs r3, # 0xff
 680 0534 00F03FF9 	        bl _zhuanascii
 681 0538 CB20     	        movs r0, # 0xcb
 682 053a 5549     	        ldr r1, = asciimabiao
 683 053c 0422     	        movs r2, # 0x04
 684 053e 00F0EBF8 	        bl _lcdxianshi
 685 0542 5748     	        ldr r0, = shang_bi_xu_bu
 686 0544 0421     	        movs r1, # 4
 687 0546 0068     	        ldr r0, [r0]
 688 0548 514A     	        ldr r2, = asciimabiao
 689 054a FF23     	        movs r3, # 0xff
 690 054c 00F033F9 	        bl _zhuanascii
 691 0550 C020     	        movs r0, # 0xc0
 692 0552 4F49     	        ldr r1, = asciimabiao
 693 0554 0422     	        movs r2, # 0x04
 694 0556 00F0DFF8 	        bl _lcdxianshi
 695 055a 0FBD     		pop {r0-r3,pc}
 696              	
 697              	
 698              	__zhen_fu_lv_bo:
 699              		@ 入口 R0= 下臂实部，R1=上臂实部，R2=下臂虚部，R3=上臂虚部
 700 055c FFB5     		push {r0-r7,lr}
 701 055e 514F     		ldr r7, = xia_bi_shi_bu
 702 0560 1546     		mov r5, r2
 703 0562 1E46     		mov r6, r3
 704 0564 0C46     		mov r4, r1
 705 0566 0346     		mov r3, r0
 706 0568 5848     		ldr r0, = lvboqihuanchong
 707 056a 5949     		ldr r1, = 32
 708 056c 594A     		ldr r2, = lvboqizhizhen
 709 056e 00F079F8 		bl _lvboqi
 710 0572 3860     		str r0, [r7]			@保存下臂实部
 711 0574 2346     	        mov r3, r4
 712 0576 5848     	        ldr r0, = lvboqihuanchong1
 713 0578 5549     		ldr r1, = 32
 714 057a 584A     		ldr r2, = lvboqizhizhen1
 715 057c 00F072F8 	        bl _lvboqi
 716 0580 7860     	        str r0, [r7, # 0x04]		@保存上臂实部
 717 0582 2B46     		mov r3, r5
 718 0584 5648     		ldr r0, = lvboqihuanchong2
 719 0586 5249     	        ldr r1, = 32
 720 0588 564A     	        ldr r2, = lvboqizhizhen2
 721 058a 00F06BF8 		bl _lvboqi
ARM GAS  1.s 			page 14


 722 058e B860     		str r0, [r7, # 0x08]		@保存下臂虚部
 723              	
 724 0590 3346     	        mov r3, r6
 725 0592 5548     		ldr r0, = lvboqihuanchong3
 726 0594 4E49     		ldr r1, = 32
 727 0596 554A     		ldr r2, = lvboqizhizhen3
 728 0598 00F064F8 	        bl _lvboqi
 729 059c F860     		str r0, [r7, # 0x0c]		@保存上臂虚部
 730 059e FFBD     		pop {r0-r7,pc}
 731              		
 732              	
 733              	__zi_dong_liang_cheng:
 734              		@ 0xc0=100,0x80=1k
 735              		@0x40=10k,0x00=100k
 736 05a0 7FB5     		push {r0-r6,lr}
 737 05a2 5348     		ldr r0, = zidongliangchengyanshi
 738 05a4 1E22     		movs r2, # 30
 739 05a6 0168     		ldr r1, [r0]
 740 05a8 0131     		adds r1, r1, # 1
 741 05aa 0160     		str r1, [r0]
 742 05ac 9142     		cmp r1, r2
 743 05ae 17D3     		bcc __liang_cheng_fan_hui
 744 05b0 0021     		movs r1, # 0
 745 05b2 0160     		str r1, [r0]
 746 05b4 3948     		ldr r0, = shang_bi_shi_bu
 747 05b6 3B4D     		ldr r5, = xia_bi_shi_bu
 748 05b8 3449     		ldr r1, = liangcheng
 749 05ba 0A68     		ldr r2, [r1]
 750 05bc 4D4E     		ldr r6, = 2200
 751 05be 4E4B     		ldr r3, = 20
 752 05c0 C02A     		cmp r2, # 0xc0
 753 05c2 07D0     		beq __xuan_kong
 754              	__pan_duan_liang_cheng:
 755 05c4 2C68     		ldr r4, [r5]
 756 05c6 B442     		cmp r4, r6
 757 05c8 02D2     		bcs __gai_liang_cheng
 758 05ca 0468     		ldr r4, [r0]
 759 05cc 9C42     		cmp r4,	r3
 760 05ce 00D2     		bcs __bao_cun_liang_cheng
 761              	__gai_liang_cheng:
 762 05d0 4032     		adds r2, r2, # 0x40
 763              	__bao_cun_liang_cheng:
 764 05d2 0A60     		str r2, [r1]
 765              	__xuan_kong:
 766 05d4 3348     		ldr r0, = xia_bi_shi_bu
 767 05d6 0468     		ldr r4, [r0]
 768 05d8 142C     		cmp r4, # 20
 769 05da 01D2     		bcs __liang_cheng_fan_hui
 770              	__liang_cheng_chong_zhi:
 771 05dc 0022     		movs r2, # 0
 772 05de 0A60     		str r2, [r1]
 773              	__liang_cheng_fan_hui:	
 774 05e0 7FBD     		pop {r0-r6,pc}
 775              		
 776              	_jianbo:
 777              		@ 入口 R0=采样表首地址，R1=0度90度相差多少
 778              		@ 出口R0=下臂90度，R1=上臂90度，R2=下臂180度，R3=上臂180度
ARM GAS  1.s 			page 15


 779 05e2 F0B5     		push {r4-r7,lr}
 780 05e4 454F     	        ldr r7, = 0x48000000
 781 05e6 464E     	        ldr r6, = 0x200
 782 05e8 BE62     		str r6, [r7, # 0x28]
 783 05ea 464D     	        ldr r5, = 0x40012428
 784 05ec 0224     	        movs r4, # 2
 785 05ee 2C60     	        str r4, [r5]
 786 05f0 00F023F8 		bl _jianboyanshi
 787 05f4 05BE     		bkpt # 5
 788 05f6 4448     		ldr r0, = dianyabiao
 789 05f8 4449     		ldr r1, = dianyabiao1
 790 05fa 6422     		movs r2, # 100
 791 05fc FFF76BFF 		bl __fu_zhi_nei_cun
 792 0600 01BE     		bkpt # 1
 793 0602 BE61     		str r6, [r7, # 0x18]
 794 0604 00F019F8 		bl _jianboyanshi
 795 0608 3F48     	        ldr r0, = dianyabiao
 796 060a 4149     		ldr r1, = dianyabiao2
 797 060c 6422     		movs r2, # 100
 798 060e FFF762FF 		bl __fu_zhi_nei_cun
 799 0612 02BE     		bkpt # 2
 800 0614 0124     		movs r4, # 1
 801 0616 2C60     		str r4, [r5]
 802 0618 BE62     		str r6, [r7, # 0x28]
 803 061a 00F00EF8 		bl _jianboyanshi
 804 061e 00F011F8 	        bl __zhao_zui_da_shu
 805 0622 8A89     		ldrh r2, [r1, # 0x0c]
 806 0624 03BE     		bkpt # 3
 807 0626 BE61     		str r6, [r7, # 0x18]
 808 0628 00F007F8 		bl _jianboyanshi
 809 062c 00F00AF8 	        bl __zhao_zui_da_shu
 810 0630 8B89     		ldrh r3, [r1, # 0x0c]
 811 0632 04BE     		bkpt # 4
 812 0634 02BC     		pop {r1}
 813 0636 01BC     		pop {r0}
 814 0638 F0BD     		pop {r4-r7,pc}
 815              	_jianboyanshi:
 816 063a 80B5     		push {r7,lr}
 817 063c 354F     		ldr r7, = 0xffff
 818              	_jianboyanshixunhuan:
 819 063e 013F     		subs r7, r7, # 1
 820 0640 FDD1     		bne _jianboyanshixunhuan
 821 0642 80BD     		pop {r7,pc}
 822              	
 823              	__zhao_zui_da_shu:
 824 0644 1CB5     		push {r2-r4,lr}
 825 0646 3048     		ldr r0, = dianyabiao
 826 0648 6522     		movs r2, # 101
 827 064a 5200     		lsls r2, r2, # 1
 828 064c 0023     		movs r3, # 0
 829              	__zhao:
 830 064e 815A     		ldrh r1, [r0, r2]
 831 0650 9942     		cmp r1, r3
 832 0652 01D3     		bcc __di_zhi_jian
 833 0654 0B46     		mov r3, r1
 834 0656 1446     		mov r4, r2
 835              	__di_zhi_jian:	
ARM GAS  1.s 			page 16


 836 0658 023A     		subs r2, r2, # 2
 837 065a F8D1     		bne __zhao
 838 065c 0146     		mov r1, r0
 839 065e 1846     		mov r0, r3
 840 0660 0919     		adds r1, r1, r4
 841 0662 1CBD     		pop {r2-r4,pc}
 842              		
 843              	_lvboqi:
 844              				@滤波器
 845              				@R0=地址，R1=长度,r2=表指针地址,r3=ADC数值
 846              				@出R0=结果
 847 0664 FEB5     		push {r1-r7,lr}	
 848 0666 1568     		ldr r5, [r2]		@读出表指针
 849 0668 4E00     		lsls r6, r1, # 1	
 850 066a 4353     		strh r3, [r0, r5]	@数值写到滤波器缓冲区
 851 066c 0235     		adds r5, r5, # 2
 852 066e B542     		cmp r5, r6
 853 0670 00D1     		bne _lvboqimeidaohuanchongquding
 854 0672 0025     		movs r5, # 0
 855              	_lvboqimeidaohuanchongquding:
 856 0674 1560     		str r5, [r2]
 857 0676 0027     		movs r7, # 0
 858              	_lvboqixunhuan:
 859 0678 B542     		cmp r5, r6
 860 067a 00D1     		bne _lvbozonghe
 861 067c 0025     		movs r5, # 0
 862              	_lvbozonghe:
 863 067e 445B     		ldrh r4, [r0, r5]
 864 0680 0235     		adds r5, r5, # 2
 865 0682 3F19     		adds r7, r7, r4
 866 0684 0139     		subs r1, r1, # 1
 867 0686 F7D1     		bne _lvboqixunhuan
 868 0688 7811     		asrs r0, r7, # 5	@修改
 869 068a FEBD     		pop {r1-r7,pc}
 870 068c 30000020 		.ltorg
 870      00000020 
 870      5A790000 
 870      43320000 
 870      040A0020 
 871              	
 872              		
 873              	_lcdxianshi:	  		@r0=LCD位置，r1=数据地址，r2=长度
 874 0718 1FB5     		push {r0-r4,lr}
 875 071a 0C46     		mov r4, r1
 876              	
 877 071c 0021     		movs r1, # 0
 878 071e 00F00EF8 		bl _xielcd
 879              	
 880 0722 0121     		movs r1, # 1
 881 0724 0023     		movs r3, # 0
 882              	_lcdxianshixunhuan:
 883 0726 E05C     		ldrb r0, [r4,r3]
 884 0728 00F009F8 		bl _xielcd
 885 072c 0133     		adds r3, r3, # 1
 886 072e 9342     		cmp r3, r2
 887 0730 F9D1     		bne _lcdxianshixunhuan
 888 0732 1FBD     		pop {r0-r4,pc}
ARM GAS  1.s 			page 17


 889              	
 890              	_lcdyanshi:
 891 0734 20B5     		push {r5,lr}
 892 0736 374D     		ldr r5, = 0x2000
 893              	_lcdyanshixunhuan:
 894 0738 013D     		subs r5, r5, # 1
 895 073a FDD1     		bne _lcdyanshixunhuan
 896 073c 20BD     		pop {r5,pc}
 897              	
 898              	_xielcd:			@入R0=8位,r1=0命令,r1=1数据
 899 073e 3FB5     		push {r0-r5,lr}
 900 0740 354C     		ldr r4, = liangcheng  @ 量程开关 (第6位和第7位)
 901 0742 0246     		mov r2, r0
 902 0744 2568     		ldr r5, [r4]
 903 0746 1209     		lsrs r2, r2, # 4
 904 0748 9200     		lsls r2, r2, # 2	@ 高四位
 905 074a 0007     		lsls r0, r0, # 28
 906 074c 800E     		lsrs r0, r0, # 26	@ 低四位
 907 074e C907     		lsls r1, r1, # 31
 908 0750 01D5     		bpl __lcd_ming_ling
 909              	__lcd_shu_ju:
 910 0752 0323     		movs r3, # 0x03		@ RS = 1 E = 1
 911 0754 00E0     		b __xie_lcd_shu_ju
 912              	__lcd_ming_ling:
 913 0756 0223     		movs r3, # 0x02		@ RS = 0 E = 1
 914              	__xie_lcd_shu_ju:
 915 0758 5B19     		adds r3, r3, r5
 916 075a 0146     		mov r1, r0
 917 075c D218     		adds r2, r2, r3
 918 075e 1000     		movs r0, r2
 919 0760 00F00BF8 		bl __74hc595
 920 0764 0238     		subs r0, r0, # 0x02
 921 0766 00F008F8 		bl __74hc595
 922 076a 0846     		mov r0, r1
 923 076c C018     		adds r0, r0, r3
 924 076e 00F004F8 		bl __74hc595
 925 0772 0238     		subs r0, r0, # 0x02
 926 0774 00F001F8 		bl __74hc595
 927 0778 3FBD     		pop {r0-r5,pc}
 928              		
 929              	__74hc595:			@ 入R0=8位
 930 077a FFB5     		push {r0-r7,lr}
 931 077c 274E     		ldr r6, = 0x48000000
 932 077e 2025     		movs r5, # 0x20		@ SRCLK
 933 0780 4022     		movs r2, # 0x40		@ RCLK
 934 0782 8023     		movs r3, # 0x80		@ SER
 935 0784 1824     		movs r4, # 24
 936              	__595_yiweixunhuan:
 937 0786 B261     		str r2, [r6, # 0x18]	@ rclk=0
 938 0788 B561     		str r5, [r6, # 0x18]	@ srclk=0
 939 078a FF27     		movs r7, # 0xff
 940              	__595_yanshi:
 941 078c 013F     		subs r7, r7, # 1
 942 078e FDD1     		bne __595_yanshi
 943 0790 0146     		mov r1, r0
 944 0792 A140     		lsls r1, r1, r4
 945 0794 01D5     		bpl __ser_0
ARM GAS  1.s 			page 18


 946              	__ser_1:
 947 0796 B362     		str r3, [r6, # 0x28]	@ ser=1
 948 0798 00E0     		b __595_yiwei
 949              	__ser_0:
 950 079a B361     		str r3, [r6, # 0x18]	@ ser=0
 951              	__595_yiwei:
 952 079c B562     		str r5, [r6, # 0x28]
 953 079e FF27     		movs r7, # 0xff
 954              	__595_yanshi1:
 955 07a0 013F     		subs r7, r7, # 1
 956 07a2 FDD1     		bne __595_yanshi1
 957 07a4 0134     		adds r4, r4, # 1
 958 07a6 202C     		cmp r4, # 32
 959 07a8 EDD1     		bne __595_yiweixunhuan
 960 07aa B262     		str r2, [r6, # 0x28]	@ rclk=1
 961 07ac FF27     		movs r7, # 0xff
 962              	__595_yanshi2:
 963 07ae 013F     		subs r7, r7, # 1
 964 07b0 FDD1     		bne __595_yanshi2
 965 07b2 B261     		str r2, [r6, # 0x18]	@ rclk = 0
 966 07b4 FFBD     		pop {r0-r7,pc}
 967              	
 968              	
 969              	
 970              	_zhuanascii:					@ 16进制转ASCII
 971              			@ R0要转的数据， R1长度，R2结果表首地址, r3=小数点位置
 972 07b6 FFB5     		push {r0-r7,lr}
 973 07b8 1F46     		mov r7, r3
 974 07ba 0546     		mov r5, r0
 975 07bc 0E46     		mov r6, r1
 976 07be 0A21     		movs r1, # 10
 977              	_xunhuanqiuma:
 978 07c0 02B4     		push {r1}
 979 07c2 00F013F8 		bl _chufa
 980 07c6 02BC     		pop {r1}
 981 07c8 0446     		mov r4, r0
 982 07ca 4C43     		muls r4, r1
 983 07cc 2B1B     		subs r3, r5, r4
 984 07ce 3033     		adds r3, r3, # 0x30
 985 07d0 0546     		mov r5, r0
 986 07d2 013E     		subs r6, r6, # 1
 987 07d4 08D0     		beq _qiumafanhui
 988 07d6 BE42     		cmp r6, r7
 989 07d8 02D1     		bne _meidaoxiaoshudian
 990 07da 2E24     		movs r4, # 0x2e		@小数点
 991 07dc 9455     		strb r4, [r2,r6]	@插入小数点
 992 07de 013E     		subs r6, r6, # 1
 993              	_meidaoxiaoshudian:
 994 07e0 9355     		strb r3, [r2,r6]
 995 07e2 3600     		movs r6, r6
 996 07e4 ECD1     		bne _xunhuanqiuma
 997 07e6 FFBD     		pop {r0-r7,pc}
 998              	_qiumafanhui:
 999 07e8 9355     		strb r3, [r2, r6]
 1000 07ea FFBD     		pop {r0-r7,pc}
 1001              	
 1002              	
ARM GAS  1.s 			page 19


 1003              		
 1004              	_chufa:				@软件除法
 1005              		@ r0 除以 r1 等于 商(r0)余数R1
 1006 07ec 1CB5     		push {r2-r4,lr}
 1007 07ee 0028     		cmp r0, # 0
 1008 07f0 0FD0     		beq _chufafanhui
 1009 07f2 0029     		cmp r1, # 0
 1010 07f4 0DD0     		beq _chufafanhui
 1011 07f6 0246     		mov r2, r0
 1012 07f8 0123     		movs r3, # 1
 1013 07fa DB07     		lsls r3, r3, # 31
 1014 07fc 0020     		movs r0, # 0
 1015 07fe 0446     		mov r4, r0
 1016              	_chufaxunhuan:
 1017 0800 5200     		lsls r2, r2, # 1
 1018 0802 6441     		adcs r4, r4, r4
 1019 0804 8C42     		cmp r4, r1
 1020 0806 01D3     		bcc _chufaweishubudao0
 1021 0808 C018     		adds r0, r0, r3
 1022 080a 641A     		subs r4, r4, r1
 1023              	_chufaweishubudao0:
 1024 080c 5B08     		lsrs r3, r3, # 1
 1025 080e F7D1     		bne _chufaxunhuan
 1026 0810 2146     		mov r1, r4
 1027              	_chufafanhui:
 1028 0812 1CBD     		pop {r2-r4,pc}
 1029 0814 00200000 		.ltorg
 1029      30000020 
 1029      00000048 
 1030              	
 1031              	
 1032              	_nmi_handler:
 1033 0820 7047     		bx lr
 1034              	_hard_fault:
 1035 0822 7047     		bx lr
 1036              	_svc_handler:
 1037 0824 7047     		bx lr
 1038              	_pendsv_handler:
 1039 0826 7047     		bx lr
 1040              	_systickzhongduan:
 1041 0828 034A     		ldr r2, = jishu
 1042 082a 0448     		ldr r0, = 0xe0000d04
 1043 082c 1368     		ldr r3, [r2]
 1044 082e 0449     		ldr r1, = 0x02000000
 1045 0830 0133     		adds r3, r3, # 1
 1046 0832 1360     		str r3, [r2]
 1047 0834 0160     		str r1, [r0]                 @ 清除SYSTICK中断
 1048              	aaa:
 1049 0836 70473400 		bx lr
 1049      0020040D 
 1049      00E00000 
 1049      0002
ARM GAS  1.s 			page 20


DEFINED SYMBOLS
                 1.s:9      .data:0000000000000000 zheng_xian_biao
                 1.s:11     .data:00000000000000ca lcdshuju
                 1.s:13     .data:00000000000000da dianhua
                 1.s:15     .data:00000000000000ea qq
                 1.s:17     .data:00000000000000fa xushu
                 1.s:19     .data:00000000000000fb fu
                 1.s:21     .data:00000000000000fc zheng
                 1.s:23     .data:00000000000000fd dianzu
                 1.s:25     .data:00000000000000ff dianrong
                 1.s:27     .data:0000000000000101 pinlv
                 1.s:29     .data:0000000000000106 qianou
                 1.s:31     .data:0000000000000107 ou
                 1.s:33     .data:000000000000010b kong
                 1.s:35     .data:000000000000010f pifa
                 1.s:37     .data:0000000000000111 xiaomai
                 1.s:39     *ABS*:0000000020001000 STACKINIT
                 1.s:40     *ABS*:0000000020000000 asciimabiao
                 1.s:41     *ABS*:0000000020000030 liangcheng
                 1.s:42     *ABS*:0000000020000034 jishu
                 1.s:43     *ABS*:0000000020000038 jianbo
                 1.s:44     *ABS*:0000000020000040 dianyabiao
                 1.s:45     *ABS*:0000000020000110 dianyabiao1
                 1.s:46     *ABS*:00000000200001e0 dianyabiao2
                 1.s:47     *ABS*:0000000020000600 lvboqizhizhen
                 1.s:48     *ABS*:0000000020000604 lvboqihuanchong
                 1.s:49     *ABS*:0000000020000700 lvboqizhizhen1
                 1.s:50     *ABS*:0000000020000704 lvboqihuanchong1
                 1.s:51     *ABS*:0000000020000800 lvboqizhizhen2
                 1.s:52     *ABS*:0000000020000804 lvboqihuanchong2
                 1.s:53     *ABS*:0000000020000900 lvboqizhizhen3
                 1.s:54     *ABS*:0000000020000904 lvboqihuanchong3
                 1.s:55     *ABS*:0000000020000a00 xia_bi_shi_bu
                 1.s:56     *ABS*:0000000020000a04 shang_bi_shi_bu
                 1.s:57     *ABS*:0000000020000a08 xia_bi_xu_bu
                 1.s:58     *ABS*:0000000020000a0c shang_bi_xu_bu
                 1.s:59     *ABS*:0000000020000a10 bu_chang_100r
                 1.s:60     *ABS*:0000000020000a14 zidongliangchengyanshi
                 1.s:61     *ABS*:0000000020000a18 dianzuzhi
                 1.s:62     *ABS*:0000000020000a1c dianrongzhi
                 1.s:64     .text:0000000000000000 vectors
                 1.s:111    .text:00000000000000b0 _start
                 1.s:1032   .text:0000000000000820 _nmi_handler
                 1.s:1034   .text:0000000000000822 _hard_fault
                 1.s:1036   .text:0000000000000824 _svc_handler
                 1.s:1038   .text:0000000000000826 _pendsv_handler
                 1.s:1040   .text:0000000000000828 _systickzhongduan
                 1.s:1048   .text:0000000000000836 aaa
                            .text:0000000000000000 $d
                 1.s:109    .text:00000000000000b0 $t
                 1.s:113    .text:00000000000000b2 yanshi111
                 1.s:117    .text:00000000000000b6 shizhong
                 1.s:124    .text:00000000000000c2 denghse
                 1.s:128    .text:00000000000000c8 dengpllguan
                 1.s:136    .text:00000000000000d6 dengpll
                 1.s:143    .text:00000000000000e0 dengdai14mshizhongwending
                 1.s:148    .text:00000000000000e6 _neicunqingling
ARM GAS  1.s 			page 21


                 1.s:152    .text:00000000000000ec _neicunqinglingxunhuan
                 1.s:157    .text:00000000000000f2 _waisheshizhong
                 1.s:172    .text:00000000000000fc _waishezhongduan
                 1.s:187    .text:00000000000000fc io_she_zhi
                 1.s:216    .text:0000000000000106 _adcchushihua
                 1.s:220    .text:000000000000010c _dengadcjiaozhun
                 1.s:224    .text:0000000000000112 _kaiadc
                 1.s:229    .text:000000000000011a _dengdaiadcwending
                 1.s:233    .text:0000000000000120 _tongdaoxuanze
                 1.s:247    .text:0000000000000134 dmachushihua
                 1.s:279    .text:0000000000000158 tim1chushiha
                 1.s:305    .text:0000000000000182 _lcdchushihua
                 1.s:898    .text:000000000000073e _xielcd
                 1.s:890    .text:0000000000000734 _lcdyanshi
                 1.s:338    .text:00000000000001c4 ting
                 1.s:733    .text:00000000000005a0 __zi_dong_liang_cheng
                 1.s:776    .text:00000000000005e2 _jianbo
                 1.s:698    .text:000000000000055c __zhen_fu_lv_bo
                 1.s:542    .text:0000000000000422 __zu_kang_ji_suan
                 1.s:970    .text:00000000000007b6 _zhuanascii
                 1.s:873    .text:0000000000000718 _lcdxianshi
                 1.s:355    .text:00000000000001f0 __liangcheng100k
                 1.s:379    .text:0000000000000228 __liangcheng10k
                 1.s:1004   .text:00000000000007ec _chufa
                 1.s:444    .text:00000000000002ba __xian_shi_qi_ta
                 1.s:401    .text:000000000000025a __liangcheng1k
                 1.s:423    .text:000000000000028c __liangcheng100r
                 1.s:465    .text:00000000000002e8 __xian_shi_dian_rong
                 1.s:477    .text:00000000000002fe $d
                 1.s:477    .text:0000000000000300 $d
                 1.s:479    .text:00000000000003b4 dd
                 1.s:480    .text:00000000000003b4 $t
                 1.s:645    .text:00000000000004e4 __xian_shi_shang_xia_bi
                 1.s:496    .text:00000000000003de __ji_suan_fu_du
                 1.s:506    .text:00000000000003e8 _shibubushifushu
                 1.s:511    .text:00000000000003f0 _xububushifushu
                 1.s:516    .text:00000000000003f8 _panduanxubushibushi0
                 1.s:520    .text:00000000000003fe _jisuanfudu1
                 1.s:533    .text:0000000000000414 _alpha_min_beta_max
                 1.s:525    .text:0000000000000406 _alpha_max_beta_min
                 1.s:554    .text:0000000000000438 __c_liang_cheng_100k
                 1.s:559    .text:0000000000000440 __c_liang_cheng10k
                 1.s:571    .text:0000000000000452 __ji_suan_dian_rong
                 1.s:564    .text:0000000000000448 __c_liang_cheng1k
                 1.s:569    .text:0000000000000450 __c_liang_cheng100ou
                 1.s:626    .text:00000000000004c2 __shu_tai_da
                 1.s:635    .text:00000000000004d6 __fu_zhi_nei_cun
                 1.s:639    .text:00000000000004da __fu_zhi_xun_huan
                 1.s:843    .text:0000000000000664 _lvboqi
                 1.s:773    .text:00000000000005e0 __liang_cheng_fan_hui
                 1.s:765    .text:00000000000005d4 __xuan_kong
                 1.s:754    .text:00000000000005c4 __pan_duan_liang_cheng
                 1.s:761    .text:00000000000005d0 __gai_liang_cheng
                 1.s:763    .text:00000000000005d2 __bao_cun_liang_cheng
                 1.s:770    .text:00000000000005dc __liang_cheng_chong_zhi
                 1.s:815    .text:000000000000063a _jianboyanshi
                 1.s:823    .text:0000000000000644 __zhao_zui_da_shu
ARM GAS  1.s 			page 22


                 1.s:818    .text:000000000000063e _jianboyanshixunhuan
                 1.s:829    .text:000000000000064e __zhao
                 1.s:835    .text:0000000000000658 __di_zhi_jian
                 1.s:855    .text:0000000000000674 _lvboqimeidaohuanchongquding
                 1.s:858    .text:0000000000000678 _lvboqixunhuan
                 1.s:862    .text:000000000000067e _lvbozonghe
                 1.s:870    .text:000000000000068c $d
                 1.s:874    .text:0000000000000718 $t
                 1.s:882    .text:0000000000000726 _lcdxianshixunhuan
                 1.s:893    .text:0000000000000738 _lcdyanshixunhuan
                 1.s:912    .text:0000000000000756 __lcd_ming_ling
                 1.s:909    .text:0000000000000752 __lcd_shu_ju
                 1.s:914    .text:0000000000000758 __xie_lcd_shu_ju
                 1.s:929    .text:000000000000077a __74hc595
                 1.s:936    .text:0000000000000786 __595_yiweixunhuan
                 1.s:940    .text:000000000000078c __595_yanshi
                 1.s:949    .text:000000000000079a __ser_0
                 1.s:946    .text:0000000000000796 __ser_1
                 1.s:951    .text:000000000000079c __595_yiwei
                 1.s:954    .text:00000000000007a0 __595_yanshi1
                 1.s:962    .text:00000000000007ae __595_yanshi2
                 1.s:977    .text:00000000000007c0 _xunhuanqiuma
                 1.s:998    .text:00000000000007e8 _qiumafanhui
                 1.s:993    .text:00000000000007e0 _meidaoxiaoshudian
                 1.s:1027   .text:0000000000000812 _chufafanhui
                 1.s:1016   .text:0000000000000800 _chufaxunhuan
                 1.s:1023   .text:000000000000080c _chufaweishubudao0
                 1.s:1029   .text:0000000000000814 $d
                 1.s:1033   .text:0000000000000820 $t
                 1.s:1049   .text:0000000000000838 $d

NO UNDEFINED SYMBOLS
