ARM GAS  1.s 			page 1


   1              		@@ 单片机stm32f030f4p6
   2              		@@ 阻抗桥
   3              		@作者：yjmwxwx
   4              		@时间：2019-08-12
   5              		@编译器：ARM-NONE-EABI
   6              		 .thumb
   7              		         .syntax unified
   8              	.section .data
   9              	zheng_xian_biao:
  10 0000 18001900 		.short 24,25,26,28,29,31,32,34,35,36,37,38,40,41,42,43,43,44,45,45,46,46,47,47,47,47,47,47,47,46,4
  10      1A001C00 
  10      1D001F00 
  10      20002200 
  10      23002400 
  11              	lcdshuju:
  12 00ca 796A6D77 		.ascii  "yjmwxwx-20190812"
  12      7877782D 
  12      32303139 
  12      30383132 
  13              	dianhua:	
  14 00da 20202020 		.ascii	"     15552208295"
  14      20313535 
  14      35323230 
  14      38323935 
  15              	qq:
  16 00ea 20202051 		.ascii	"   QQ:3341656346"
  16      513A3333 
  16      34313635 
  16      36333436 
  17              	xushu:
  18 00fa 6A       		.ascii "j"
  19              	fu:
  20 00fb 2D       		.ascii "-"
  21              	zheng:
  22 00fc 2B       		.ascii "+"
  23              	xiaomai:
  24 00fd 7869616F 		.ascii "xiaomai ="
  24      6D616920 
  24      3D
  25              		.equ STACKINIT,        	        0x20001000
  26              		.equ asciimabiao,		0x20000000
  27              		.equ xiangminkaiguan,		0x20000030
  28              		.equ jishu,			0x20000034
  29              		.equ jianbo,			0x20000038
  30              		.equ dianyabiao,		0x20000040
  31              		.equ lvboqizhizhen,		0x20000050
  32              		.equ lvboqihuanchong,		0x20000054
  33              		.equ lvboqizhizhen1,		0x20000550
  34              		.equ lvboqihuanchong1,		0x20000554
  35              		.section .text
  36              	vectors:
  37 0000 00100020 		.word STACKINIT
  38 0004 B1000000 		.word _start + 1
  39 0008 E1030000 		.word _nmi_handler + 1
  40 000c E3030000 		.word _hard_fault  + 1
  41 0010 00000000 		.word 0
  42 0014 00000000 		.word 0
ARM GAS  1.s 			page 2


  43 0018 00000000 		.word 0
  44 001c 00000000 		.word 0
  45 0020 00000000 		.word 0
  46 0024 00000000 		.word 0
  47 0028 00000000 		.word 0
  48 002c E5030000 		.word _svc_handler +1
  49 0030 00000000 		.word 0
  50 0034 00000000 		.word 0
  51 0038 E7030000 		.word _pendsv_handler +1
  52 003c E9030000 		.word _systickzhongduan +1               @ 15
  53 0040 F7030000 		.word aaa +1     @ _wwdg +1          @ 0
  54 0044 F7030000 		.word aaa +1     @_pvd +1            @ 1
  55 0048 F7030000 		.word aaa +1     @_rtc +1            @ 2
  56 004c F7030000 		.word aaa +1     @_flash +1          @ 3
  57 0050 F7030000 		.word aaa +1	@ _rcc + 1          @ 4
  58 0054 F7030000 		.word aaa +1      @_exti0_1  +1      @ 5
  59 0058 F7030000 		.word aaa +1      @ _exti2_3 +1      @ 6
  60 005c F7030000 		.word aaa +1       @_exti4_15 +1     @ 7
  61 0060 F7030000 		.word aaa +1                         @ 8
  62 0064 F7030000 		.word aaa +1 	@_dma1_1  +1    @ 9
  63 0068 F7030000 		.word aaa +1    @_dma1_2_3 +1        @ 10
  64 006c F7030000 		.word aaa +1       @_dma1_4_5 +1     @ 11
  65 0070 F7030000 		.word aaa +1	 @_adc1 +1          @ 12
  66 0074 F7030000 		.word aaa +1       @_tim1_brk_up +1  @ 13
  67 0078 F7030000 		.word aaa +1        @ _tim1_cc +1    @ 14
  68 007c F7030000 		.word aaa +1         @_tim2 +1       @ 15
  69 0080 F7030000 		.word aaa +1          @_tim3 +1      @ 16
  70 0084 F7030000 		.word aaa +1                         @ 17
  71 0088 F7030000 		.word aaa +1		                @ 18
  72 008c F7030000 		.word aaa +1	@_tim14 +1    @ 19
  73 0090 F7030000 		.word aaa +1                         @ 20
  74 0094 F7030000 		.word aaa +1         @_tim16 +1      @ 21
  75 0098 F7030000 		.word aaa +1         @_tim17 +1      @ 22
  76 009c F7030000 		.word aaa +1          @_i2c   +1     @ 23
  77 00a0 F7030000 		.word aaa +1                         @ 24
  78 00a4 F7030000 		.word aaa +1           @_spi   +1    @ 25
  79 00a8 F7030000 		.word aaa +1                         @ 26
  80 00ac F7030000 		.word aaa +1         @_usart1 +1     @ 27
  81              		.align 2
  82              	
  83              	_start:
  84              	shizhong:
  85 00b0 A34A     		ldr r2, = 0x40022000   @FLASH访问控制
  86 00b2 3221     		movs r1, # 0x32
  87 00b4 1160     		str r1, [r2]           @FLASH缓冲 缓冲开启
  88 00b6 A348     		ldr r0, = 0x40021000 @ rcc
  89 00b8 A349     		ldr r1, = 0x10001
  90 00ba 0160     		str r1, [r0]
  91              	denghse:
  92 00bc 0168     		ldr r1, [r0]
  93 00be 8903     		lsls r1, r1, # 14
  94 00c0 FCD5     		bpl denghse
  95              	dengpllguan:
  96 00c2 0168     		ldr r1, [r0]
  97 00c4 8901     		lsls r1, r1, # 6
  98 00c6 FCD4     		bmi dengpllguan
  99 00c8 A049     	        ldr r1, = 0x110002
ARM GAS  1.s 			page 3


 100 00ca 4160     	        str r1, [r0, # 0x04]
 101 00cc A049     		ldr r1, = 0x1010001
 102 00ce 0160     		str r1, [r0]
 103              	dengpll:
 104 00d0 0168     		ldr r1, [r0]
 105 00d2 8901     		lsls r1, # 6
 106 00d4 FCD5     		bpl dengpll
 107              		@0x34时钟控制寄存器 2 (RCC_CR2)
 108 00d6 0121     		movs r1, # 0x01
 109 00d8 4163     		str r1, [r0, # 0x34]  @ HSI开14M时钟
 110              	dengdai14mshizhongwending:
 111 00da 416B     		ldr r1, [r0, # 0x34]
 112 00dc 8907     		lsls r1, r1, # 30     @ 左移30位
 113 00de FCD5     		bpl dengdai14mshizhongwending  @ 等待14M时钟稳定
 114              	
 115              	_neicunqingling:
 116 00e0 9C48     		ldr r0, = 0x20000000
 117 00e2 0021     		movs r1, # 0
 118 00e4 9C4B     		ldr r3, = 0x1000
 119              	_neicunqinglingxunhuan:
 120 00e6 043B     		subs r3, # 4
 121 00e8 C150     		str r1, [r0, r3]
 122 00ea FCD1     		bne _neicunqinglingxunhuan
 123              	
 124              	_waisheshizhong:			 @ 外设时钟
 125              		@+0x14=RCC_AHBENR
 126              		@0=DMA @2=SRAM @4=FLITF@6=CRC @17=PA @18=PB @19=PC @20=PD @22=PF
 127 00ec 9548     		ldr r0, = 0x40021000
 128 00ee 9B49     		ldr r1, = 0x460005
 129 00f0 4161     		str r1, [r0, # 0x14]
 130              	
 131              		@+0x18外设时钟使能寄存器 (RCC_APB2ENR)
 132              		@0=SYSCFG @5=USART6EN @9=ADC @11=TIM1 @12=SPI1 @14=USART1 @16=TIM15 @17=TIM16 @18=TIM17 @22=DBGMCU
 133 00f2 9B49     		ldr r1, = 0xa00
 134 00f4 8161     		str r1, [r0, # 0x18]
 135              		@+0X1C=RCC_APB1ENR
 136              		@1=TIM3 @4=TIM6 @5=TIM7 @8=TIM14 @11=WWDG @14=SPI @17=USRT2 @18=USART3 @20=USART5 @21=I2C1
 137              		@22=I2C2 @23=USB @28=PWR
 138              	
 139              	
 140              	
 141              	_waishezhongduan:				@外设中断
 142              		@0xE000E100    0-31  写1开，写0没效
 143              		@0XE000E180    0-31 写1关，写0没效
 144              		@0XE000E200    0-31 挂起，写0没效
 145              		@0XE000E280    0-31 清除， 写0没效
 146              	
 147              	@_systick:				@ systick定时器初始化
 148              	
 149              	@	ldr r0, = 0xe000e010
 150              	@	ldr r1, = 0xffffff
 151              	@	str r1, [r0, # 4]
 152              	@	str r1, [r0, # 8]
 153              	@	movs r1, # 0x07
 154              	@	str r1, [r0]
 155              		
 156              	io_she_zhi:
ARM GAS  1.s 			page 4


 157              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 158              		@a(0x48000000)b(0x48000400)c(0x48000800)d(0x48000c00)f(0x48001400)
 159              		@ 输入（00），通用输出（01），复用功能（10），模拟（11）
 160              		@偏移0x4 = 端口输出类型 @ （0 推挽），（ 1 开漏）
 161              		@偏移0x8 = 输出速度  00低速， 01中速， 11高速
 162              		@偏移0xC = 上拉下拉 (00无上下拉，  01 上拉， 10下拉)
 163              		@偏移0x10 = 输入数据寄存器
 164              		@偏移0x14 = 输出数据寄存器
 165              		@偏移0x18 = 端口开  0-15置位
 166              		@偏移0x28 = 端口关
 167              		@0X20 = 复用低
 168              		@GPIO口0（0-3位）每个IO口占用4位
 169              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 170              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 171              		@0x24 = 复用高
 172              		@GPIO口8 （0-3位）每个IO口占用4位
 173              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 174              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 175              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 176              	
 177 00f6 9B48     		ldr r0, = 0x48000000
 178 00f8 9B49     		ldr r1, = 0x2820540f
 179 00fa 0160     		str r1, [r0]
 180 00fc 9B49     		ldr r1, = 0x200
 181 00fe 4162     		str r1, [r0, # 0x24]
 182              	
 183              		
 184              	dmachushihua:
 185              	        @+0=LSR,+4=IFCR,
 186              	        @+8=CCR1,+c=CNDTR1,+10=CPAR1+14=CMAR1,
 187              	        @+1c=CCR2,+20=CNDTR2,+24=CPAR2,+28=CMAR2
 188              	        @+30=CCR3,+34=CNDTR3,+38=CPAR2,+3c=CMAR3
 189              	        @+44=CCR4,+48=CNDTR4,+4c=CPAR4,+50=CMAR4
 190              	        @+58=CCR5,+5c=CNDTR5,+60=CPAR5,+64=CMAR5
 191              	        @+6C=CCR6,+70=CNDTR6,+74=CPAR6,+78=CMAR6
 192              	        @+80=CCR7,+84=CNDTR7,+88=CPAR7,+8c=CMAR7
 193              	
 194              	        @tim1ch3DMA
 195 0100 9B48     	        ldr r0, = 0x40020000
 196 0102 9C49     	        ldr r1, = 0x40012c3c @ 外设地址
 197 0104 0166     	        str r1, [r0, # 0x60]
 198 0106 9C49     	        ldr r1, = zheng_xian_biao @ 储存器地址
 199 0108 4166     	        str r1, [r0, # 0x64]
 200 010a 9C49     	        ldr r1, = 100             @点数
 201 010c C165     	        str r1, [r0, # 0x5c]
 202 010e 9C49     	        ldr r1, = 0x35b1         @ 储存到外设
 203 0110 8165     	        str r1, [r0, # 0x58]
 204              	
 205              	tim1chushiha:
 206 0112 9C48     	        ldr r0, = 0x40012c00 @ tim1_cr1
 207 0114 0021     	        movs r1, # 0
 208 0116 8162     	        str r1, [r0, # 0x28] @ psc
 209 0118 9B49     	        ldr r1, = 47
 210 011a C162     	        str r1, [r0, # 0x2c] @ ARR
 211 011c 9B49     	        ldr r1, = 0x68
 212 011e C161     	        str r1, [r0, # 0x1c] @ ccmr2  CC3
 213 0120 9B49     	        ldr r1, = 0x100    @  CC3
ARM GAS  1.s 			page 5


 214 0122 0162     	        str r1, [r0, # 0x20] @ ccer
 215 0124 9B49     	        ldr r1, = 0x8000
 216 0126 4164     	        str r1, [r0, # 0x44] @ BDTR
 217 0128 9B49     	        ldr r1, = 0x800 @ CC3 DMA
 218 012a C160     	        str r1, [r0, # 0x0c] @ DIER
 219 012c 9B49     	        ldr r1, = 0xe1
 220 012e 0160     	        str r1, [r0]
 221              	
 222              	_adcchushihua:
 223 0130 9B48     	        ldr r0, = 0x40012400  @ adc基地址
 224 0132 9C49     		ldr r1, = 0x80000000
 225 0134 8160     	        str r1, [r0, # 0x08]  @ ADC 控制寄存器 (ADC_CR)  @adc校准
 226              	_dengadcjiaozhun:
 227 0136 8168     	        ldr r1, [r0, # 0x08]
 228 0138 0900     	         movs r1, r1
 229 013a FCD4     	        bmi _dengadcjiaozhun   @ 等ADC校准
 230              	_kaiadc:
 231 013c 8168     	        ldr r1, [r0, # 0x08]
 232 013e 0122     	        movs r2, # 0x01
 233 0140 1143     	        orrs r1, r1, r2
 234 0142 8160     	        str r1, [r0, # 0x08]
 235              	_dengdaiadcwending:
 236 0144 0168     	        ldr r1, [r0]
 237 0146 C907     	        lsls r1, r1, # 31
 238 0148 FCD5     	        bpl _dengdaiadcwending @ 等ADC稳定
 239              	_tongdaoxuanze:
 240 014a 9749     	        ldr r1, = 1
 241 014c 8162     	        str r1, [r0, # 0x28]    @ 通道选择寄存器 (ADC_CHSELR)
 242 014e 9749     	        ldr r1, = 0x3000
 243 0150 C160     	        str r1, [r0, # 0x0c]    @ 配置寄存器 1 (ADC_CFGR1)
 244 0152 0021     	        movs r1, # 0
 245 0154 4161     	        str r1, [r0, # 0x14]    @ ADC 采样时间寄存器 (ADC_SMPR)
 246 0156 8168     	        ldr r1, [r0, # 0x08]
 247 0158 954A     	        ldr r2, = 0x04         @ 开始转换
 248 015a 1143     	        orrs r1, r1, r2
 249 015c 8160     	        str r1, [r0, # 0x08]    @ 控制寄存器 (ADC_CR)
 250              	
 251              	
 252              	_lcdchushihua:
 253 015e 3320     		movs r0, # 0x33
 254 0160 0021     		movs r1, # 0
 255 0162 00F07EF8 		bl _xielcd
 256 0166 00F077F8 		bl _lcdyanshi
 257 016a 3220     		movs r0, # 0x32
 258 016c 0021     		movs r1, # 0
 259 016e 00F078F8 		bl _xielcd
 260 0172 00F071F8 		bl _lcdyanshi
 261 0176 2820     		movs r0, # 0x28
 262 0178 0021     		movs r1, # 0
 263 017a 00F072F8 		bl _xielcd
 264 017e 00F06BF8 		bl _lcdyanshi
 265 0182 0C20     		movs r0, # 0x0c
 266 0184 0021     		movs r1, # 0
 267 0186 00F06CF8 		bl _xielcd
 268 018a 00F065F8 		bl _lcdyanshi
 269 018e 0120     		movs r0, # 0x01
 270 0190 0021     		movs r1, # 0
ARM GAS  1.s 			page 6


 271 0192 00F066F8 		bl _xielcd
 272 0196 00F05FF8 		bl _lcdyanshi
 273              	
 274              	
 275 019a C420     		movs r0, # 0xc4
 276 019c 8549     		ldr r1, = xushu
 277 019e 0122     		movs r2, # 1
 278 01a0 FF23     		movs r3, # 0xff
 279 01a2 00F04BF8 		bl _lcdxianshi
 280              	ting:
 281 01a6 8448     		ldr r0, = 0x40012428
 282 01a8 0121     		movs r1, # 1
 283 01aa 0160     		str r1, [r0]
 284 01ac 1920     		movs r0, # 25
 285 01ae 00F027F8 		bl _jianbo
 286 01b2 0346     		mov r3, r0
 287 01b4 8148     	        ldr r0, = lvboqihuanchong
 288 01b6 8249     	        ldr r1, = 16
 289 01b8 824A     	        ldr r2, = lvboqizhizhen
 290 01ba 00F02BF8 	        bl _lvboqi
 291 01be 0421     		movs r1, # 4
 292 01c0 644A     		ldr r2, = asciimabiao
 293 01c2 FF23     		movs r3, # 0xff
 294 01c4 00F08FF8 		bl _zhuanascii
 295 01c8 C020     		movs r0, # 0xc0
 296 01ca 6249     		ldr r1, = asciimabiao
 297 01cc 0422     		movs r2, # 4
 298 01ce 00F035F8 		bl _lcdxianshi
 299              	
 300 01d2 7948     	        ldr r0, = 0x40012428
 301 01d4 0221     	        movs r1, # 2
 302 01d6 0160     	        str r1, [r0]
 303 01d8 3220     	        movs r0, # 50
 304 01da 00F011F8 		bl _jianbo
 305 01de 0346     	        mov r3,	r0
 306 01e0 7948     	        ldr r0, = lvboqihuanchong1
 307 01e2 7749     	        ldr r1, = 16
 308 01e4 794A     		ldr r2, = lvboqizhizhen1
 309 01e6 00F015F8 		bl _lvboqi
 310 01ea 0421     	        movs r1, # 4
 311 01ec 594A     		ldr r2, = asciimabiao
 312 01ee FF23     	        movs r3, # 0xff
 313 01f0 00F079F8 	        bl _zhuanascii
 314 01f4 8020     	        movs r0, # 0x80
 315 01f6 5749     	        ldr r1, = asciimabiao
 316 01f8 0422     	        movs r2, # 4
 317 01fa 00F01FF8 	        bl _lcdxianshi
 318              	
 319 01fe D2E7     		b ting
 320              		
 321              	
 322              	_jianbo:				@ 检波 @ 入口 R0=度数
 323 0200 0EB5     		push {r1-r3,lr}
 324 0202 7349     		ldr r1, = 0x4002005c
 325 0204 734A     		ldr r2, = 0x40012440
 326 0206 72B6     		cpsid i
 327              	_jianbo90du:
ARM GAS  1.s 			page 7


 328 0208 0B68     		ldr r3, [r1]
 329 020a 8342     		cmp r3, r0 
 330 020c FCD1     		bne _jianbo90du
 331 020e 1068     		ldr r0, [r2]
 332 0210 62B6     		cpsie i
 333 0212 1CBD     		pop {r2-r4,pc}
 334              	
 335              	_lvboqi:
 336              				@滤波器
 337              				@R0=地址，R1=长度,r2=表指针地址,r3=ADC数值
 338              				@出R0=结果
 339 0214 FEB5     		push {r1-r7,lr}	
 340 0216 1568     		ldr r5, [r2]		@读出表指针
 341 0218 4E00     		lsls r6, r1, # 1	
 342 021a 4353     		strh r3, [r0, r5]	@数值写到滤波器缓冲区
 343 021c 0235     		adds r5, r5, # 2
 344 021e B542     		cmp r5, r6
 345 0220 00D1     		bne _lvboqimeidaohuanchongquding
 346 0222 0025     		movs r5, # 0
 347              	_lvboqimeidaohuanchongquding:
 348 0224 1560     		str r5, [r2]
 349 0226 0027     		movs r7, # 0
 350              	_lvboqixunhuan:
 351 0228 B542     		cmp r5, r6
 352 022a 00D1     		bne _lvbozonghe
 353 022c 0025     		movs r5, # 0
 354              	_lvbozonghe:
 355 022e 445B     		ldrh r4, [r0, r5]
 356 0230 0235     		adds r5, r5, # 2
 357 0232 3F19     		adds r7, r7, r4
 358 0234 0139     		subs r1, r1, # 1
 359 0236 F7D1     		bne _lvboqixunhuan
 360 0238 3811     		asrs r0, r7, # 4	@修改
 361 023a FEBD     		pop {r1-r7,pc}
 362              	
 363              	
 364              		
 365              	_lcdxianshi:	  		@r0=LCD位置，r1=数据地址，r2=长度
 366 023c 1FB5     		push {r0-r4,lr}
 367 023e 0C46     		mov r4, r1
 368              	
 369 0240 0021     		movs r1, # 0
 370 0242 00F00EF8 		bl _xielcd
 371              	
 372 0246 0121     		movs r1, # 1
 373 0248 0023     		movs r3, # 0
 374              	_lcdxianshixunhuan:
 375 024a E05C     		ldrb r0, [r4,r3]
 376 024c 00F009F8 		bl _xielcd
 377 0250 0133     		adds r3, r3, # 1
 378 0252 9342     		cmp r3, r2
 379 0254 F9D1     		bne _lcdxianshixunhuan
 380 0256 1FBD     		pop {r0-r4,pc}
 381              	
 382              	_lcdyanshi:
 383 0258 20B5     		push {r5,lr}
 384 025a 5F4D     		ldr r5, = 0x2000
ARM GAS  1.s 			page 8


 385              	_lcdyanshixunhuan:
 386 025c 013D     		subs r5, r5, # 1
 387 025e FDD1     		bne _lcdyanshixunhuan
 388 0260 20BD     		pop {r5,pc}
 389              	
 390              	_xielcd:			@入R0=8位,r1=0命令,r1=1数据
 391 0262 3FB5     		push {r0-r5,lr}
 392 0264 5D4C     		ldr r4, = xiangminkaiguan  @ 相敏开关
 393 0266 0246     		mov r2, r0
 394 0268 2568     		ldr r5, [r4]
 395 026a 1209     		lsrs r2, r2, # 4
 396 026c 9200     		lsls r2, r2, # 2	@ 高四位
 397 026e 0007     		lsls r0, r0, # 28
 398 0270 800E     		lsrs r0, r0, # 26	@ 低四位
 399 0272 C907     		lsls r1, r1, # 31
 400 0274 01D5     		bpl __lcd_ming_ling
 401              	__lcd_shu_ju:
 402 0276 0323     		movs r3, # 0x03		@ RS = 1 E = 1
 403 0278 00E0     		b __xiang_min_kai_guan
 404              	__lcd_ming_ling:
 405 027a 0223     		movs r3, # 0x02		@ RS = 0 E = 1
 406              	__xiang_min_kai_guan:
 407 027c 402D     		cmp r5, # 0x40
 408 027e 01D1     		bne __kai_zheng_xiang_wei
 409 0280 8025     		movs r5, # 0x80
 410 0282 00E0     		b __xie_lcd_shu_ju
 411              	__kai_zheng_xiang_wei:	
 412 0284 4025     		movs r5, # 0x40
 413              	__xie_lcd_shu_ju:
 414 0286 2560     		str r5, [r4]
 415 0288 5B19     		adds r3, r3, r5
 416 028a 0146     		mov r1, r0
 417 028c D218     		adds r2, r2, r3
 418 028e 1000     		movs r0, r2
 419 0290 00F00BF8 		bl __74hc595
 420 0294 0238     		subs r0, r0, # 0x02
 421 0296 00F008F8 		bl __74hc595
 422 029a 0846     		mov r0, r1
 423 029c C018     		adds r0, r0, r3
 424 029e 00F004F8 		bl __74hc595
 425 02a2 0238     		subs r0, r0, # 0x02
 426 02a4 00F001F8 		bl __74hc595
 427 02a8 3FBD     		pop {r0-r5,pc}
 428              		
 429              	__74hc595:			@ 入R0=8位
 430 02aa FFB5     		push {r0-r7,lr}
 431 02ac 2D4E     		ldr r6, = 0x48000000
 432 02ae 2025     		movs r5, # 0x20		@ SRCLK
 433 02b0 4022     		movs r2, # 0x40		@ RCLK
 434 02b2 8023     		movs r3, # 0x80		@ SER
 435 02b4 1824     		movs r4, # 24
 436              	__595_yiweixunhuan:
 437 02b6 B261     		str r2, [r6, # 0x18]	@ rclk=0
 438 02b8 B561     		str r5, [r6, # 0x18]	@ srclk=0
 439 02ba FF27     		movs r7, # 0xff
 440              	__595_yanshi:
 441 02bc 013F     		subs r7, r7, # 1
ARM GAS  1.s 			page 9


 442 02be FDD1     		bne __595_yanshi
 443 02c0 0146     		mov r1, r0
 444 02c2 A140     		lsls r1, r1, r4
 445 02c4 01D5     		bpl __ser_0
 446              	__ser_1:
 447 02c6 B362     		str r3, [r6, # 0x28]	@ ser=1
 448 02c8 00E0     		b __595_yiwei
 449              	__ser_0:
 450 02ca B361     		str r3, [r6, # 0x18]	@ ser=0
 451              	__595_yiwei:
 452 02cc B562     		str r5, [r6, # 0x28]
 453 02ce FF27     		movs r7, # 0xff
 454              	__595_yanshi1:
 455 02d0 013F     		subs r7, r7, # 1
 456 02d2 FDD1     		bne __595_yanshi1
 457 02d4 0134     		adds r4, r4, # 1
 458 02d6 202C     		cmp r4, # 32
 459 02d8 EDD1     		bne __595_yiweixunhuan
 460 02da B262     		str r2, [r6, # 0x28]	@ rclk=1
 461 02dc FF27     		movs r7, # 0xff
 462              	__595_yanshi2:
 463 02de 013F     		subs r7, r7, # 1
 464 02e0 FDD1     		bne __595_yanshi2
 465 02e2 B261     		str r2, [r6, # 0x18]	@ rclk = 0
 466 02e4 FFBD     		pop {r0-r7,pc}
 467              	
 468              	
 469              	
 470              	_zhuanascii:					@ 16进制转ASCII
 471              			@ R0要转的数据， R1长度，R2结果表首地址, r3=小数点位置
 472 02e6 FFB5     		push {r0-r7,lr}
 473 02e8 1F46     		mov r7, r3
 474 02ea 0546     		mov r5, r0
 475 02ec 0E46     		mov r6, r1
 476 02ee 0A21     		movs r1, # 10
 477              	_xunhuanqiuma:
 478 02f0 00F012F8 		bl _chufa
 479 02f4 0446     		mov r4, r0
 480 02f6 4C43     		muls r4, r1
 481 02f8 2B1B     		subs r3, r5, r4
 482 02fa 3033     		adds r3, r3, # 0x30
 483 02fc 0546     		mov r5, r0
 484 02fe 013E     		subs r6, r6, # 1
 485 0300 08D0     		beq _qiumafanhui
 486 0302 BE42     		cmp r6, r7
 487 0304 02D1     		bne _meidaoxiaoshudian
 488 0306 2E24     		movs r4, # 0x2e		@小数点
 489 0308 9455     		strb r4, [r2,r6]	@插入小数点
 490 030a 013E     		subs r6, r6, # 1
 491              	_meidaoxiaoshudian:
 492 030c 9355     		strb r3, [r2,r6]
 493 030e 3600     		movs r6, r6
 494 0310 EED1     		bne _xunhuanqiuma
 495 0312 FFBD     		pop {r0-r7,pc}
 496              	_qiumafanhui:
 497 0314 9355     		strb r3, [r2, r6]
 498 0316 FFBD     		pop {r0-r7,pc}
ARM GAS  1.s 			page 10


 499              	
 500              		
 501              	_chufa:				@软件除法
 502              		@ r0 除以 r1 等于 商(r0)余数R1
 503 0318 1EB5     		push {r1-r4,lr}
 504 031a 0028     		cmp r0, # 0
 505 031c 0ED0     		beq _chufafanhui
 506 031e 0029     		cmp r1, # 0
 507 0320 0CD0     		beq _chufafanhui
 508 0322 0246     		mov r2, r0
 509 0324 0123     		movs r3, # 1
 510 0326 DB07     		lsls r3, r3, # 31
 511 0328 0020     		movs r0, # 0
 512 032a 0446     		mov r4, r0
 513              	_chufaxunhuan:
 514 032c 5200     		lsls r2, r2, # 1
 515 032e 6441     		adcs r4, r4, r4
 516 0330 8C42     		cmp r4, r1
 517 0332 01D3     		bcc _chufaweishubudao0
 518 0334 C018     		adds r0, r0, r3
 519 0336 641A     		subs r4, r4, r1
 520              	_chufaweishubudao0:
 521 0338 5B08     		lsrs r3, r3, # 1
 522 033a F7D1     		bne _chufaxunhuan
 523              	_chufafanhui:
 524 033c 1EBD     		pop {r1-r4,pc}
 525 033e 00000020 		.ltorg
 525      02400010 
 525      02400100 
 525      01000200 
 525      11000100 
 526              	
 527              	
 528              	_nmi_handler:
 529 03e0 7047     		bx lr
 530              	_hard_fault:
 531 03e2 7047     		bx lr
 532              	_svc_handler:
 533 03e4 7047     		bx lr
 534              	_pendsv_handler:
 535 03e6 7047     		bx lr
 536              	_systickzhongduan:
 537 03e8 034A     		ldr r2, = jishu
 538 03ea 0448     		ldr r0, = 0xe0000d04
 539 03ec 1368     		ldr r3, [r2]
 540 03ee 0449     		ldr r1, = 0x02000000
 541 03f0 0133     		adds r3, r3, # 1
 542 03f2 1360     		str r3, [r2]
 543 03f4 0160     		str r1, [r0]                 @ 清除SYSTICK中断
 544              	aaa:
 545 03f6 70473400 		bx lr
 545      0020040D 
 545      00E00000 
 545      0002
ARM GAS  1.s 			page 11


DEFINED SYMBOLS
                 1.s:9      .data:0000000000000000 zheng_xian_biao
                 1.s:11     .data:00000000000000ca lcdshuju
                 1.s:13     .data:00000000000000da dianhua
                 1.s:15     .data:00000000000000ea qq
                 1.s:17     .data:00000000000000fa xushu
                 1.s:19     .data:00000000000000fb fu
                 1.s:21     .data:00000000000000fc zheng
                 1.s:23     .data:00000000000000fd xiaomai
                 1.s:25     *ABS*:0000000020001000 STACKINIT
                 1.s:26     *ABS*:0000000020000000 asciimabiao
                 1.s:27     *ABS*:0000000020000030 xiangminkaiguan
                 1.s:28     *ABS*:0000000020000034 jishu
                 1.s:29     *ABS*:0000000020000038 jianbo
                 1.s:30     *ABS*:0000000020000040 dianyabiao
                 1.s:31     *ABS*:0000000020000050 lvboqizhizhen
                 1.s:32     *ABS*:0000000020000054 lvboqihuanchong
                 1.s:33     *ABS*:0000000020000550 lvboqizhizhen1
                 1.s:34     *ABS*:0000000020000554 lvboqihuanchong1
                 1.s:36     .text:0000000000000000 vectors
                 1.s:83     .text:00000000000000b0 _start
                 1.s:528    .text:00000000000003e0 _nmi_handler
                 1.s:530    .text:00000000000003e2 _hard_fault
                 1.s:532    .text:00000000000003e4 _svc_handler
                 1.s:534    .text:00000000000003e6 _pendsv_handler
                 1.s:536    .text:00000000000003e8 _systickzhongduan
                 1.s:544    .text:00000000000003f6 aaa
                            .text:0000000000000000 $d
                 1.s:81     .text:00000000000000b0 $t
                 1.s:84     .text:00000000000000b0 shizhong
                 1.s:91     .text:00000000000000bc denghse
                 1.s:95     .text:00000000000000c2 dengpllguan
                 1.s:103    .text:00000000000000d0 dengpll
                 1.s:110    .text:00000000000000da dengdai14mshizhongwending
                 1.s:115    .text:00000000000000e0 _neicunqingling
                 1.s:119    .text:00000000000000e6 _neicunqinglingxunhuan
                 1.s:124    .text:00000000000000ec _waisheshizhong
                 1.s:141    .text:00000000000000f6 _waishezhongduan
                 1.s:156    .text:00000000000000f6 io_she_zhi
                 1.s:184    .text:0000000000000100 dmachushihua
                 1.s:205    .text:0000000000000112 tim1chushiha
                 1.s:222    .text:0000000000000130 _adcchushihua
                 1.s:226    .text:0000000000000136 _dengadcjiaozhun
                 1.s:230    .text:000000000000013c _kaiadc
                 1.s:235    .text:0000000000000144 _dengdaiadcwending
                 1.s:239    .text:000000000000014a _tongdaoxuanze
                 1.s:252    .text:000000000000015e _lcdchushihua
                 1.s:390    .text:0000000000000262 _xielcd
                 1.s:382    .text:0000000000000258 _lcdyanshi
                 1.s:365    .text:000000000000023c _lcdxianshi
                 1.s:280    .text:00000000000001a6 ting
                 1.s:322    .text:0000000000000200 _jianbo
                 1.s:335    .text:0000000000000214 _lvboqi
                 1.s:470    .text:00000000000002e6 _zhuanascii
                 1.s:327    .text:0000000000000208 _jianbo90du
                 1.s:347    .text:0000000000000224 _lvboqimeidaohuanchongquding
                 1.s:350    .text:0000000000000228 _lvboqixunhuan
ARM GAS  1.s 			page 12


                 1.s:354    .text:000000000000022e _lvbozonghe
                 1.s:374    .text:000000000000024a _lcdxianshixunhuan
                 1.s:385    .text:000000000000025c _lcdyanshixunhuan
                 1.s:404    .text:000000000000027a __lcd_ming_ling
                 1.s:401    .text:0000000000000276 __lcd_shu_ju
                 1.s:406    .text:000000000000027c __xiang_min_kai_guan
                 1.s:411    .text:0000000000000284 __kai_zheng_xiang_wei
                 1.s:413    .text:0000000000000286 __xie_lcd_shu_ju
                 1.s:429    .text:00000000000002aa __74hc595
                 1.s:436    .text:00000000000002b6 __595_yiweixunhuan
                 1.s:440    .text:00000000000002bc __595_yanshi
                 1.s:449    .text:00000000000002ca __ser_0
                 1.s:446    .text:00000000000002c6 __ser_1
                 1.s:451    .text:00000000000002cc __595_yiwei
                 1.s:454    .text:00000000000002d0 __595_yanshi1
                 1.s:462    .text:00000000000002de __595_yanshi2
                 1.s:477    .text:00000000000002f0 _xunhuanqiuma
                 1.s:501    .text:0000000000000318 _chufa
                 1.s:496    .text:0000000000000314 _qiumafanhui
                 1.s:491    .text:000000000000030c _meidaoxiaoshudian
                 1.s:523    .text:000000000000033c _chufafanhui
                 1.s:513    .text:000000000000032c _chufaxunhuan
                 1.s:520    .text:0000000000000338 _chufaweishubudao0
                 1.s:525    .text:000000000000033e $d
                 1.s:525    .text:0000000000000340 $d
                 1.s:529    .text:00000000000003e0 $t
                 1.s:545    .text:00000000000003f8 $d

NO UNDEFINED SYMBOLS
