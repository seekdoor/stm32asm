ARM GAS  1.s 			page 1


   1              		@@ 单片机stm32f030f4p6
   2              		@@ 阻抗桥
   3              		@作者：yjmwxwx
   4              		@时间：2019-08-12
   5              		@编译器：ARM-NONE-EABI
   6              		 .thumb
   7              		         .syntax unified
   8              	.section .data
   9              	zheng_xian_biao:
  10 0000 18001900 		.short 0x18,0x19,0x1a,0x1c,0x1d,0x1f,0x20,0x22,0x23,0x24,0x25,0x26,0x28,0x29,0x2a,0x2b,0x2b,0x2c,0
  10      1A001C00 
  10      1D001F00 
  10      20002200 
  10      23002400 
  11 00ca 00000000 		.align 4
  11      0000
  12              	xuan_zhuan_yin_zi:
  13 00d0 00800000 		.int 0x8000,0x0000,0x7EFD,0xFFFFEFF6,0x7BFA,0xFFFFE02B,0x7702,0xFFFFD0E2,0x702A,0xFFFFC256,0x678D,
  13      00000000 
  13      FD7E0000 
  13      F6EFFFFF 
  13      FA7B0000 
  14              	lcdshuju:
  15 03f0 796A6D77 		.ascii  "yjmwxwx-20190812"
  15      7877782D 
  15      32303139 
  15      30383132 
  16              	dianhua:	
  17 0400 20202020 		.ascii	"     15552208295"
  17      20313535 
  17      35323230 
  17      38323935 
  18              	qq:
  19 0410 20202051 		.ascii	"   QQ:3341656346"
  19      513A3333 
  19      34313635 
  19      36333436 
  20              	xushu:
  21 0420 69       		.ascii "i"
  22              	fu:
  23 0421 2D       		.ascii "-"
  24              	zheng:
  25 0422 2B       		.ascii "+"
  26              	dianzu:
  27 0423 5A3D     		.ascii	"Z="
  28              	dianrong:
  29 0425 433D     		.ascii	"C="
  30              	pinlv:
  31 0427 31304B48 		.ascii	"10KHZ"
  31      5A
  32              	qianou:
  33 042c 4B       		.ascii	"K"
  34              	ou:
  35 042d F4000000 	        .int    0xf4
  36              	kong:
  37 0431 20202020 		.int 0x20202020
  38              	pifa:
ARM GAS  1.s 			page 2


  39 0435 5046     		.ascii "PF"
  40              	_fu:	
  41 0437 2D       		.ascii "-"
  42              		
  43              		.equ STACKINIT,        	        0x20001000
  44              		.equ asciimabiao,		0x20000000
  45              		.equ liangcheng,		0x20000030
  46              		.equ jishu,			0x20000034
  47              		.equ jianbo,			0x20000038
  48              		.equ dianyabiao,		0x20000040
  49              		.equ zhengxiangbiao,		0x20000110
  50              		.equ fanxiangbiao,		0x200001e0
  51              		.equ lvboqizhizhen,		0x20000600
  52              		.equ lvboqihuanchong,		0x20000604
  53              		.equ lvboqizhizhen1,		0x20000700
  54              		.equ lvboqihuanchong1,		0x20000704
  55              		.equ lvboqizhizhen2,		0x20000800
  56              		.equ lvboqihuanchong2,		0x20000804
  57              		.equ lvboqizhizhen3,		0x20000900
  58              		.equ lvboqihuanchong3,		0x20000904
  59              		.equ xia_bi_shi_bu,		0x20000a00
  60              		.equ shang_bi_shi_bu,		0x20000a04
  61              		.equ xia_bi_xu_bu,		0x20000a08
  62              		.equ shang_bi_xu_bu,		0x20000a0c
  63              		.equ bu_chang_100r,		0x20000a10
  64              		.equ zidongliangchengyanshi,	0x20000a14
  65              		.equ dianzuzhi,			0x20000a18
  66              		.equ dianrongzhi,		0x20000a1c
  67              		.section .text
  68              	vectors:
  69 0000 00100020 		.word STACKINIT
  70 0004 B1000000 		.word _start + 1
  71 0008 59080000 		.word _nmi_handler + 1
  72 000c 5B080000 		.word _hard_fault  + 1
  73 0010 00000000 		.word 0
  74 0014 00000000 		.word 0
  75 0018 00000000 		.word 0
  76 001c 00000000 		.word 0
  77 0020 00000000 		.word 0
  78 0024 00000000 		.word 0
  79 0028 00000000 		.word 0
  80 002c 5D080000 		.word _svc_handler +1
  81 0030 00000000 		.word 0
  82 0034 00000000 		.word 0
  83 0038 5F080000 		.word _pendsv_handler +1
  84 003c 61080000 		.word _systickzhongduan +1               @ 15
  85 0040 6F080000 		.word aaa +1     @ _wwdg +1          @ 0
  86 0044 6F080000 		.word aaa +1     @_pvd +1            @ 1
  87 0048 6F080000 		.word aaa +1     @_rtc +1            @ 2
  88 004c 6F080000 		.word aaa +1     @_flash +1          @ 3
  89 0050 6F080000 		.word aaa +1	@ _rcc + 1          @ 4
  90 0054 6F080000 		.word aaa +1      @_exti0_1  +1      @ 5
  91 0058 6F080000 		.word aaa +1      @ _exti2_3 +1      @ 6
  92 005c 6F080000 		.word aaa +1       @_exti4_15 +1     @ 7
  93 0060 6F080000 		.word aaa +1                         @ 8
  94 0064 6F080000 		.word aaa +1 	@_dma1_1  +1    @ 9
  95 0068 6F080000 		.word aaa +1    @_dma1_2_3 +1        @ 10
ARM GAS  1.s 			page 3


  96 006c 6F080000 		.word aaa +1       @_dma1_4_5 +1     @ 11
  97 0070 6F080000 		.word aaa +1	 @_adc1 +1          @ 12
  98 0074 6F080000 		.word aaa +1       @_tim1_brk_up +1  @ 13
  99 0078 6F080000 		.word aaa +1        @ _tim1_cc +1    @ 14
 100 007c 6F080000 		.word aaa +1         @_tim2 +1       @ 15
 101 0080 6F080000 		.word aaa +1          @_tim3 +1      @ 16
 102 0084 6F080000 		.word aaa +1                         @ 17
 103 0088 6F080000 		.word aaa +1		                @ 18
 104 008c 6F080000 		.word aaa +1	@_tim14 +1    @ 19
 105 0090 6F080000 		.word aaa +1                         @ 20
 106 0094 6F080000 		.word aaa +1         @_tim16 +1      @ 21
 107 0098 6F080000 		.word aaa +1         @_tim17 +1      @ 22
 108 009c 6F080000 		.word aaa +1          @_i2c   +1     @ 23
 109 00a0 6F080000 		.word aaa +1                         @ 24
 110 00a4 6F080000 		.word aaa +1           @_spi   +1    @ 25
 111 00a8 6F080000 		.word aaa +1                         @ 26
 112 00ac 6F080000 		.word aaa +1         @_usart1 +1     @ 27
 113              		.align 2
 114              	
 115              	_start:
 116 00b0 6648     		ldr r0, = 0xffff
 117              	yanshi111:
 118 00b2 0138     		subs r0, r0, # 1
 119 00b4 FDD1     		bne yanshi111
 120              		
 121              	shizhong:
 122 00b6 664A     		ldr r2, = 0x40022000   @FLASH访问控制
 123 00b8 3221     		movs r1, # 0x32
 124 00ba 1160     		str r1, [r2]           @FLASH缓冲 缓冲开启
 125 00bc 6548     		ldr r0, = 0x40021000 @ rcc
 126 00be 6649     		ldr r1, = 0x10001
 127 00c0 0160     		str r1, [r0]
 128              	denghse:
 129 00c2 0168     		ldr r1, [r0]
 130 00c4 8903     		lsls r1, r1, # 14
 131 00c6 FCD5     		bpl denghse
 132              	dengpllguan:
 133 00c8 0168     		ldr r1, [r0]
 134 00ca 8901     		lsls r1, r1, # 6
 135 00cc FCD4     		bmi dengpllguan
 136 00ce 6349     	        ldr r1, = 0x110002
 137 00d0 4160     	        str r1, [r0, # 0x04]
 138 00d2 6349     		ldr r1, = 0x1010001
 139 00d4 0160     		str r1, [r0]
 140              	dengpll:
 141 00d6 0168     		ldr r1, [r0]
 142 00d8 8901     		lsls r1, # 6
 143 00da FCD5     		bpl dengpll
 144              		@0x34时钟控制寄存器 2 (RCC_CR2)
 145 00dc 0121     		movs r1, # 0x01
 146 00de 4163     		str r1, [r0, # 0x34]  @ HSI开14M时钟
 147              	dengdai14mshizhongwending:
 148 00e0 416B     		ldr r1, [r0, # 0x34]
 149 00e2 8907     		lsls r1, r1, # 30     @ 左移30位
 150 00e4 FCD5     		bpl dengdai14mshizhongwending  @ 等待14M时钟稳定
 151              	
 152              	_neicunqingling:
ARM GAS  1.s 			page 4


 153 00e6 5F48     		ldr r0, = 0x20000000
 154 00e8 0021     		movs r1, # 0
 155 00ea 5F4B     		ldr r3, = 0x1000
 156              	_neicunqinglingxunhuan:
 157 00ec 043B     		subs r3, # 4
 158 00ee C150     		str r1, [r0, r3]
 159 00f0 FCD1     		bne _neicunqinglingxunhuan
 160              	
 161              	_waisheshizhong:			 @ 外设时钟
 162              		@+0x14=RCC_AHBENR
 163              		@0=DMA @2=SRAM @4=FLITF@6=CRC @17=PA @18=PB @19=PC @20=PD @22=PF
 164 00f2 5848     		ldr r0, = 0x40021000
 165 00f4 5D49     		ldr r1, = 0x460005
 166 00f6 4161     		str r1, [r0, # 0x14]
 167              	
 168              		@+0x18外设时钟使能寄存器 (RCC_APB2ENR)
 169              		@0=SYSCFG @5=USART6EN @9=ADC @11=TIM1 @12=SPI1 @14=USART1 @16=TIM15 @17=TIM16 @18=TIM17 @22=DBGMCU
 170 00f8 5D49     		ldr r1, = 0xa00
 171 00fa 8161     		str r1, [r0, # 0x18]
 172              		@+0X1C=RCC_APB1ENR
 173              		@1=TIM3 @4=TIM6 @5=TIM7 @8=TIM14 @11=WWDG @14=SPI @17=USRT2 @18=USART3 @20=USART5 @21=I2C1
 174              		@22=I2C2 @23=USB @28=PWR
 175              	
 176              	_waishezhongduan:				@外设中断
 177              		@0xE000E100    0-31  写1开，写0没效
 178              		@0XE000E180    0-31 写1关，写0没效
 179              		@0XE000E200    0-31 挂起，写0没效
 180              		@0XE000E280    0-31 清除， 写0没效
 181              	
 182              	@_systick:				@ systick定时器初始化
 183              	
 184              	@	ldr r0, = 0xe000e010
 185              	@	ldr r1, = 0xffffff
 186              	@	str r1, [r0, # 4]
 187              	@	str r1, [r0, # 8]
 188              	@	movs r1, # 0x07
 189              	@	str r1, [r0]
 190              		
 191              	io_she_zhi:
 192              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 193              		@a(0x48000000)b(0x48000400)c(0x48000800)d(0x48000c00)f(0x48001400)
 194              		@ 输入（00），通用输出（01），复用功能（10），模拟（11）
 195              		@偏移0x4 = 端口输出类型 @ （0 推挽），（ 1 开漏）
 196              		@偏移0x8 = 输出速度  00低速， 01中速， 11高速
 197              		@偏移0xC = 上拉下拉 (00无上下拉，  01 上拉， 10下拉)
 198              		@偏移0x10 = 输入数据寄存器
 199              		@偏移0x14 = 输出数据寄存器
 200              		@偏移0x18 = 端口开  0-15置位
 201              		@偏移0x28 = 端口关
 202              		@0X20 = 复用低
 203              		@GPIO口0（0-3位）每个IO口占用4位
 204              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 205              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 206              		@0x24 = 复用高
 207              		@GPIO口8 （0-3位）每个IO口占用4位
 208              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 209              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
ARM GAS  1.s 			page 5


 210              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 211              	
 212 00fc 5D48     		ldr r0, = 0x48000000
 213 00fe 5E49     		ldr r1, = 0x2824540f
 214 0100 0160     		str r1, [r0]
 215 0102 5E49     		ldr r1, = 0x200
 216 0104 4162     		str r1, [r0, # 0x24]
 217              	
 218              	
 219              	
 220              	_adcchushihua:
 221 0106 5E48     	        ldr r0, = 0x40012400  @ adc基地址
 222 0108 5E49     	        ldr r1, = 0x80000000
 223 010a 8160     	        str r1, [r0, # 0x08]  @ ADC 控制寄存器 (ADC_CR)  @adc校准
 224              	_dengadcjiaozhun:
 225 010c 8168     	        ldr r1, [r0, # 0x08]
 226 010e 0900     	        movs r1, r1
 227 0110 FCD4     	        bmi _dengadcjiaozhun   @ 等ADC校准
 228              	_kaiadc:
 229 0112 8168     		ldr r1, [r0, # 0x08]
 230 0114 0122     	        movs r2, # 0x01
 231 0116 1143     		orrs r1, r1, r2
 232 0118 8160     	        str r1, [r0, # 0x08]
 233              	_dengdaiadcwending:
 234 011a 0168     		ldr r1, [r0]
 235 011c C907     		lsls r1, r1, # 31
 236 011e FCD5     		bpl _dengdaiadcwending @ 等ADC稳定
 237              	_tongdaoxuanze:
 238 0120 5949     		ldr r1, = 2
 239 0122 8162     	        str r1, [r0, # 0x28]    @ 通道选择寄存器 (ADC_CHSELR)
 240 0124 5949     	        ldr r1, = 0x803
 241 0126 C160     	        str r1, [r0, # 0x0c]    @ 配置寄存器 1 (ADC_CFGR1)
 242 0128 0021     		movs r1, # 0
 243 012a 4161     	        str r1, [r0, # 0x14]    @ ADC 采样时间寄存器 (ADC_SMPR)
 244 012c 8168     		ldr r1, [r0, # 0x08]
 245 012e 584A     	        ldr r2, = 0x04         @ 开始转换
 246 0130 1143     	        orrs r1, r1, r2
 247 0132 8160     		str r1, [r0, # 0x08]    @ 控制寄存器 (ADC_CR)
 248              	
 249              	
 250              		
 251              	dmachushihua:
 252              	        @+0=LSR,+4=IFCR,
 253              	        @+8=CCR1,+c=CNDTR1,+10=CPAR1+14=CMAR1,
 254              	        @+1c=CCR2,+20=CNDTR2,+24=CPAR2,+28=CMAR2
 255              	        @+30=CCR3,+34=CNDTR3,+38=CPAR2,+3c=CMAR3
 256              	        @+44=CCR4,+48=CNDTR4,+4c=CPAR4,+50=CMAR4
 257              	        @+58=CCR5,+5c=CNDTR5,+60=CPAR5,+64=CMAR5
 258              	        @+6C=CCR6,+70=CNDTR6,+74=CPAR6,+78=CMAR6
 259              	        @+80=CCR7,+84=CNDTR7,+88=CPAR7,+8c=CMAR7
 260              	
 261              	        @tim1ch3DMA
 262 0134 5748     	        ldr r0, = 0x40020000
 263 0136 5849     	        ldr r1, = 0x40012c3c @ 外设地址
 264 0138 0166     	        str r1, [r0, # 0x60]
 265 013a 5849     	        ldr r1, = zheng_xian_biao @ 储存器地址
 266 013c 4166     	        str r1, [r0, # 0x64]
ARM GAS  1.s 			page 6


 267 013e 5849     	        ldr r1, = 100             @点数
 268 0140 C165     	        str r1, [r0, # 0x5c]
 269 0142 5849     	        ldr r1, = 0x35b1         @ 储存到外设
 270 0144 8165     	        str r1, [r0, # 0x58]
 271              		@ adc dma
 272 0146 5348     		ldr r0, = 0x40020000
 273 0148 5749     		ldr r1, = 0x40012440
 274 014a 0161     		str r1, [r0, # 0x10]
 275 014c 5749     		ldr r1, = dianyabiao
 276 014e 4161     		str r1, [r0, # 0x14]
 277 0150 5349     		ldr r1, =  100
 278 0152 C160     		str r1, [r0, # 0x0c]
 279 0154 5649     		ldr r1, = 0x5a1		@ 5a1
 280 0156 8160     		str r1, [r0, # 0x08]
 281              	
 282              		
 283              	tim1chushiha:
 284 0158 5648     	        ldr r0, = 0x40012c00 @ tim1_cr1
 285 015a 0021     	        movs r1, # 0
 286 015c 8162     	        str r1, [r0, # 0x28] @ psc
 287 015e 5649     	        ldr r1, = 47
 288 0160 C162     	        str r1, [r0, # 0x2c] @ ARR
 289              		@	movs r1, # 0x40
 290 0162 2021     		movs r1, # 0x20
 291 0164 4160     		str r1, [r0, # 0x04] @ TRGO
 292 0166 3821     		movs r1, # 0x38
 293 0168 8161     		str r1, [r0, # 0x18] @ ccmr1 cc1
 294 016a 2F21     		movs r1, # 47
 295 016c 4163     		str r1, [r0, # 0x34]
 296 016e 5349     	        ldr r1, = 0x68
 297 0170 C161     	        str r1, [r0, # 0x1c] @ ccmr2  CC3
 298 0172 5349     	        ldr r1, = 0x100    @  CC3
 299 0174 0162     	        str r1, [r0, # 0x20] @ ccer
 300 0176 5349     	        ldr r1, = 0x8000
 301 0178 4164     	        str r1, [r0, # 0x44] @ BDTR
 302 017a 5349     	        ldr r1, = 0x800 @ CC3 DMA
 303 017c C160     	        str r1, [r0, # 0x0c] @ DIER
 304 017e 5349     	        ldr r1, = 0x81
 305 0180 0160     	        str r1, [r0]
 306              	
 307              	
 308              	
 309              	_lcdchushihua:
 310 0182 3320     		movs r0, # 0x33
 311 0184 0021     		movs r1, # 0
 312 0186 00F0F6FA 		bl _xielcd
 313 018a 00F0EFFA 		bl _lcdyanshi
 314 018e 3220     		movs r0, # 0x32
 315 0190 0021     		movs r1, # 0
 316 0192 00F0F0FA 		bl _xielcd
 317 0196 00F0E9FA 		bl _lcdyanshi
 318 019a 2820     		movs r0, # 0x28
 319 019c 0021     		movs r1, # 0
 320 019e 00F0EAFA 		bl _xielcd
 321 01a2 00F0E3FA 		bl _lcdyanshi
 322 01a6 0C20     		movs r0, # 0x0c
 323 01a8 0021     		movs r1, # 0
ARM GAS  1.s 			page 7


 324 01aa 00F0E4FA 		bl _xielcd
 325 01ae 00F0DDFA 		bl _lcdyanshi
 326 01b2 0120     		movs r0, # 0x01
 327 01b4 0021     		movs r1, # 0
 328 01b6 00F0DEFA 		bl _xielcd
 329 01ba 00F0D7FA 		bl _lcdyanshi
 330              	
 331              	@	movs r0, # 0x80
 332              	@	ldr r1, = lcdshuju
 333              	@	movs r2, # 16
 334              	@	movs r3, # 0xff
 335              	@	bl _lcdxianshi
 336              		
 337 01be 4448     		ldr r0, = liangcheng
 338 01c0 0021     		movs r1, # 0x00
 339 01c2 0160     		str r1, [r0]
 340              	
 341 01c4 92E0     		b dd
 342              	ting:
 343 01c6 00F0C6F9 		bl __zi_dong_liang_cheng
 344 01ca 00F03BFA 	        bl _jianbo
 345 01ce 00F0A0F9 		bl __zhen_fu_lv_bo
 346 01d2 00F0CBF8 		bl __zu_kang_ji_suan
 347 01d6 3F48     		ldr r0, = dianrongzhi
 348 01d8 0821     	        movs r1, # 8
 349 01da 0068     		ldr r0, [r0]
 350 01dc 214A     	        ldr r2, = asciimabiao
 351 01de FF23     	        movs r3, # 0xff
 352 01e0 00F005FB 	        bl _zhuanascii
 353 01e4 8520     	        movs r0, # 0x85
 354 01e6 1F49     	        ldr r1, = asciimabiao
 355 01e8 0822     	        movs r2, # 8
 356 01ea 00F0B1FA 	        bl _lcdxianshi
 357              	__liangcheng100k:
 358 01ee 3A48     	        ldr r0, = dianzuzhi
 359 01f0 0068     	        ldr r0, [r0]
 360 01f2 0621     		movs r1, # 6
 361 01f4 1B4A     		ldr r2, = asciimabiao
 362 01f6 FF23     		movs r3, # 0xff
 363 01f8 00F0F9FA 	        bl _zhuanascii
 364 01fc C220     		movs r0, # 0xc2
 365 01fe 1949     		ldr r1, = asciimabiao
 366 0200 0622     		movs r2, # 6
 367 0202 00F0A5FA 	        bl _lcdxianshi
 368              	__xian_shi_qi_ta:
 369 0206 3248     		ldr r0, = liangcheng
 370 0208 0068     		ldr r0, [r0]
 371 020a 8009     		lsrs r0, r0, # 6
 372 020c 0121     		movs r1, # 1
 373 020e 154A     	        ldr r2, = asciimabiao
 374 0210 FF23     	        movs r3, # 0xff
 375 0212 00F0ECFA 	        bl _zhuanascii
 376 0216 8020     	        movs r0, # 0x80
 377 0218 1249     	        ldr r1, = asciimabiao
 378 021a 0122     	        movs r2, # 1
 379 021c 00F098FA 	        bl _lcdxianshi
 380              	
ARM GAS  1.s 			page 8


 381 0220 C020     	        movs r0, # 0xc0
 382 0222 2E49     	        ldr r1, = dianzu
 383 0224 0222     	        movs r2, # 2
 384 0226 00F093FA 	        bl _lcdxianshi
 385 022a CB20     	        movs r0, # 0xcb
 386 022c 2C49     	        ldr r1, = pinlv
 387 022e 0522     	        movs r2, # 5
 388 0230 00F08EFA 	        bl _lcdxianshi
 389              	__xian_shi_dian_rong:
 390 0234 8320     		movs r0, # 0x83
 391 0236 2B49     		ldr r1, = dianrong
 392 0238 0222     		movs r2, # 2
 393 023a 00F089FA 		bl _lcdxianshi
 394 023e 8E20     	        movs r0, # 0x8e
 395 0240 2949     	        ldr r1, = pifa
 396 0242 0222     	        movs r2, # 2
 397 0244 00F084FA 		bl _lcdxianshi
 398              	
 399 0248 BDE7     		b ting
 400              	
 401 024a 0000FFFF 		.ltorg
 401      00000020 
 401      02400010 
 401      02400100 
 401      01000200 
 402              	
 403              	dd:
 404 02ec 00F033F9 		bl __zi_dong_liang_cheng
 405 02f0 F348     		ldr r0, = liangcheng
 406 02f2 0068     	        ldr r0, [r0]
 407 02f4 8009     		lsrs r0, r0, # 6
 408 02f6 0121     	        movs r1, # 1
 409 02f8 F24A     	        ldr r2, = asciimabiao
 410 02fa FF23     	        movs r3, # 0xff
 411 02fc 00F077FA 	        bl _zhuanascii
 412 0300 C720     	        movs r0, # 0xc7
 413 0302 F049     	        ldr r1, = asciimabiao
 414 0304 0122     		movs r2, # 1
 415 0306 00F023FA 		bl _lcdxianshi
 416 030a 00F09BF9 		bl _jianbo
 417 030e 00F000F9 		bl __zhen_fu_lv_bo
 418 0312 ED48     		ldr r0, = xia_bi_shi_bu
 419 0314 ED49     		ldr r1, = shang_bi_shi_bu
 420 0316 EE4A     		ldr r2, = xia_bi_xu_bu
 421 0318 EE4B     		ldr r3, = shang_bi_xu_bu
 422 031a 0068     		ldr r0, [r0]
 423 031c 0968     		ldr r1, [r1]
 424 031e 1268     		ldr r2, [r2]
 425 0320 1B68     		ldr r3, [r3]
 426 0322 00F085F8 		bl __xian_shi_shang_xia_bi
 427 0326 E1E7     		b dd
 428              	
 429              	__ji_suan_fu_du:    @ 计算幅度
 430              	                @ 入r0= 实部，r1= 虚部
 431              	                @ 出r0 = 幅度
 432              	                @ Mag ~=Alpha * max(|I|, |Q|) + Beta * min(|I|, |Q|)
 433              	                @ Alpha * Max + Beta * Min
ARM GAS  1.s 			page 9


 434 0328 0EB5     	        push {r1-r3,lr}
 435 032a 0000     	        movs r0, r0
 436 032c 01D5     	        bpl _shibubushifushu
 437 032e C043     	        mvns r0, r0                             @ 是负数转成正数
 438 0330 0130     	        adds r0, r0, # 1
 439              	_shibubushifushu:                               @ 实部不是负数
 440 0332 0900     	        movs r1, r1
 441 0334 01D5     	        bpl _xububushifushu
 442 0336 C943     	        mvns r1, r1                             @ 是负数转成正数
 443 0338 0131     	        adds r1, r1, # 1
 444              	_xububushifushu:                                @ 虚部不是负数
 445 033a 0028     	        cmp r0, # 0
 446 033c 01D1     	        bne _panduanxubushibushi0
 447 033e 0846     	        mov r0, r1
 448 0340 0EBD     	        pop {r1-r3,pc}
 449              	_panduanxubushibushi0:	
 450 0342 0029     		cmp r1, # 0
 451 0344 00D1     		bne _jisuanfudu1
 452 0346 0EBD     		pop {r1-r3,pc}
 453              	_jisuanfudu1:
 454 0348 E34A     		ldr r2, = 31066		@ Alpha q15 0.948059448969
 455 034a E44B     		ldr r3, = 12867		@ Beta q15 0.392699081699
 456 034c 8142     		cmp r1, r0
 457 034e 06D8     		bhi _alpha_min_beta_max
 458              	_alpha_max_beta_min:
 459 0350 5043     		muls r0, r0, r2
 460 0352 5943     		muls r1, r1, r3
 461 0354 C013     		asrs r0, r0, # 15
 462 0356 C913     		asrs r1, r1, # 15
 463 0358 4018     		adds r0, r0, r1
 464 035a 0121     		movs r1, # 1
 465 035c 0EBD     		pop {r1-r3,pc}
 466              	_alpha_min_beta_max:
 467 035e 5843     		muls r0, r0, r3
 468 0360 5143     		muls r1, r1, r2
 469 0362 C013     		asrs r0, r0, # 15
 470 0364 C913     		asrs r1, r1, # 15
 471 0366 4018     		adds r0, r0, r1
 472 0368 0021     		movs r1, # 0
 473 036a 0EBD     		pop {r1-r3,pc}
 474              		
 475              	__zu_kang_ji_suan:
 476 036c FFB5     		push {r0-r7,lr}
 477 036e D748     		ldr r0, = shang_bi_shi_bu
 478 0370 D849     		ldr r1, = shang_bi_xu_bu
 479 0372 D54A     		ldr r2, = xia_bi_shi_bu
 480 0374 D64B     		ldr r3, = xia_bi_xu_bu
 481 0376 D24C     		ldr r4, = liangcheng
 482 0378 0068     		ldr r0, [r0]
 483 037a 0968     		ldr r1, [r1]
 484 037c 1268     		ldr r2, [r2]
 485 037e 1B68     		ldr r3, [r3]
 486 0380 2568     		ldr r5, [r4]
 487              	__c_liang_cheng_100k:
 488 0382 002D     	        cmp r5, # 0x00
 489 0384 01D1     		bne __c_liang_cheng10k
 490 0386 D64C     	        ldr r4, = 100000
ARM GAS  1.s 			page 10


 491 0388 08E0     		b __ji_suan_dian_rong
 492              	__c_liang_cheng10k:
 493 038a 402D     	        cmp r5, # 0x40
 494 038c 01D1     	        bne __c_liang_cheng1k
 495 038e D54C     	        ldr r4, = 10000
 496 0390 04E0     	        b __ji_suan_dian_rong
 497              	__c_liang_cheng1k:
 498 0392 802D     	        cmp r5, # 0x80
 499 0394 01D1     		bne __c_liang_cheng100ou
 500 0396 D44C     	        ldr r4, = 1000
 501 0398 00E0     	        b __ji_suan_dian_rong
 502              	__c_liang_cheng100ou:
 503 039a 6424     		movs r4, # 100
 504              	__ji_suan_dian_rong:
 505              	@ Z=R+jx
 506              	@ Z=R*[(a+bi)/(c+di)]=R*[(ac+bd)/(c*c+d*d)+(bc-ad)/(c*c+d*d)]
 507              	@c=1/[(2*pi*f)*xc]
 508 039c 10B4     		push {r4}
 509 039e 0446     		mov r4, r0
 510 03a0 0D46     		mov r5, r1
 511 03a2 1646     		mov r6, r2
 512 03a4 1F46     		mov r7, r3
 513 03a6 5043     		muls r0, r0, r2		@ac
 514 03a8 5943     		muls r1, r1, r3		@bd
 515 03aa 4018     		adds r0, r0, r1		@ac+bd
 516 03ac 5243     		muls r2, r2, r2		@c*c
 517 03ae 5B43     		muls r3, r3, r3		@d*d
 518 03b0 D218     		adds r2, r2, r3		@c*c+d*d
 519 03b2 1146     		mov r1, r2
 520 03b4 8002     		lsls r0, r0, # 10
 521 03b6 00F035FA 		bl _chufa		@(ac+bd)/(c*c+d*d)
 522 03ba 01B4     		push {r0}
 523 03bc 7543     		muls r5, r5, r6		@ bc
 524 03be 7C43     		muls r4, r4, r7		@ ad
 525 03c0 2D1B     		subs r5, r5, r4		@ bc-ad
 526 03c2 1146     		mov r1, r2
 527 03c4 2846     		mov r0, r5
 528 03c6 8002     		lsls r0, r0, # 10
 529 03c8 00F02CFA 		bl _chufa
 530 03cc 0146     		mov r1, r0		@ R1=结果虚部
 531 03ce 01BC     		pop {r0}		@ R0=结果实部
 532 03d0 04BC     		pop {r2}		@ R2=R（量程）
 533 03d2 5043     		muls r0, r0, r2		@ 
 534 03d4 5143     		muls r1, r1, r2		@
 535 03d6 C54A     		ldr r2, = dianzuzhi
 536 03d8 8012     		asrs r0, r0, # 10
 537 03da 8912     		asrs r1, r1, # 10
 538 03dc FFF7A4FF 		bl __ji_suan_fu_du
 539 03e0 1060     		str r0, [r2]
 540 03e2 C34B     		ldr r3, = 62831		@ 2pi*10khz
 541 03e4 0146     		mov r1, r0
 542 03e6 5943     		muls r1, r1, r3
 543 03e8 0C46     		mov r4, r1
 544 03ea C248     		ldr r0, = 1000000000
 545 03ec 8142     		cmp r1, r0
 546 03ee 0DD8     		bhi __shu_tai_da
 547 03f0 00F018FA 		bl _chufa
ARM GAS  1.s 			page 11


 548 03f4 0346     		mov r3, r0
 549 03f6 BC4A     		ldr r2, = 1000
 550 03f8 0846     		mov r0, r1
 551 03fa 5043     		muls r0, r0, r2
 552 03fc 5343     		muls r3, r3, r2
 553 03fe 2146     		mov r1, r4
 554 0400 00F010FA 		bl _chufa
 555 0404 BC4A     		ldr r2, = dianrongzhi
 556 0406 1B18     		adds r3, r3, r0
 557 0408 1360     		str r3, [r2]
 558 040a FFBD     		pop {r0-r7,pc}
 559              	__shu_tai_da:
 560 040c 890A     		lsrs r1, r1, # 10
 561 040e 00F009FA 		bl _chufa
 562 0412 B549     		ldr r1, = 1000
 563 0414 8002     		lsls r0, r0, # 10
 564 0416 00F005FA 		bl _chufa
 565 041a B74A     		ldr r2, = dianrongzhi
 566 041c 1060     		str r0, [r2]
 567 041e FFBD     		pop {r0-r7,pc}
 568              	__fu_zhi_nei_cun:
 569              		@ 入口 R0 = 要复制的地址，R1=目标地址，R2=复制的数量
 570 0420 10B5     		push {r4,lr}
 571 0422 0024     		movs r4, # 0
 572              	__fu_zhi_xun_huan:	
 573 0424 035B     		ldrh r3, [r0, r4]
 574 0426 0B53     		strh r3, [r1, r4]
 575 0428 0234     		adds r4, r4, # 2
 576 042a 013A     		subs r2, r2, # 1
 577 042c FAD1     		bne __fu_zhi_xun_huan
 578 042e 10BD     		pop {r4,pc}
 579              	
 580              		
 581              	__xian_shi_shang_xia_bi:
 582              	@入口 R0= 下臂实部，R1=上臂实部，R2=下臂虚部，R3=上臂虚部
 583 0430 FFB5     		push {r0-r7,lr}
 584 0432 8046     		mov r8, r0
 585 0434 8946     		mov r9, r1
 586 0436 9246     		mov r10, r2
 587 0438 9B46     		mov r11, r3
 588              	@显示上臂实部
 589 043a 0C00     		movs r4, r1
 590 043c 07D5     		bpl __shang_bi_shi_bu_zheng
 591 043e 8020     	        movs r0, # 0x80
 592 0440 AE49     	        ldr r1, = _fu
 593 0442 0122     	        movs r2, # 1
 594 0444 00F084F9 	        bl _lcdxianshi
 595 0448 E443     		mvns r4, r4
 596 044a 0134     		adds r4, r4, # 1
 597 044c 04E0     		b __xian_shi_shang_bi_shi_bu
 598              	__shang_bi_shi_bu_zheng:	
 599 044e 8020     	        movs r0, # 0x80
 600 0450 AB49     		ldr r1, = kong
 601 0452 0122     	        movs r2, # 1
 602 0454 00F07CF9 	        bl _lcdxianshi
 603              	__xian_shi_shang_bi_shi_bu:
 604 0458 2046     		mov r0, r4
ARM GAS  1.s 			page 12


 605 045a 0521     		movs r1, # 5
 606 045c 994A     		ldr r2, = asciimabiao
 607 045e FF23     		movs r3, # 0xff
 608 0460 00F0C5F9 		bl _zhuanascii
 609 0464 8120     		movs r0, # 0x81
 610 0466 9749     		ldr r1, = asciimabiao
 611 0468 0522     		movs r2, # 5
 612 046a 00F071F9 		bl _lcdxianshi
 613              	@显示上臂虚部
 614 046e 5C46     	        mov r4, r11
 615 0470 2400     		movs r4, r4
 616 0472 07D5     	        bpl __shang_bi_xu_bu_zheng
 617 0474 C020     	        movs r0, # 0xc0
 618 0476 A149     	        ldr r1, = _fu
 619 0478 0122     	        movs r2, # 1
 620 047a 00F069F9 	        bl _lcdxianshi
 621 047e E443     	        mvns r4, r4
 622 0480 0134     	        adds r4, r4, # 1
 623 0482 04E0     	        b __xian_shi_shang_bi_xu_bu
 624              	__shang_bi_xu_bu_zheng:
 625 0484 C020     	        movs r0, # 0xc0
 626 0486 9E49     		ldr r1, = kong
 627 0488 0122     	        movs r2, # 1
 628 048a 00F061F9 	        bl _lcdxianshi
 629              	__xian_shi_shang_bi_xu_bu:
 630 048e 2046     	        mov r0, r4
 631 0490 0521     	        movs r1, # 5
 632 0492 8C4A     	        ldr r2, = asciimabiao
 633 0494 FF23     	        movs r3, # 0xff
 634 0496 00F0AAF9 		bl _zhuanascii
 635 049a C120     		movs r0, # 0xc1
 636 049c 8949     	        ldr r1, = asciimabiao
 637 049e 0522     	        movs r2, # 5
 638 04a0 00F056F9 		bl _lcdxianshi
 639              	@显示下臂实部：
 640 04a4 4446     	        mov r4, r8
 641 04a6 2400     		movs r4, r4
 642 04a8 07D5     	        bpl __xia_bi_shi_bu_zheng
 643 04aa 8A20     	        movs r0, # 0x8a
 644 04ac 9349     	        ldr r1, = _fu
 645 04ae 0122     	        movs r2, # 1
 646 04b0 00F04EF9 	        bl _lcdxianshi
 647 04b4 E443     	        mvns r4, r4
 648 04b6 0134     		adds r4, r4, # 1
 649 04b8 04E0     		b __xian_shi_xia_bi_shi_bu
 650              	__xia_bi_shi_bu_zheng:
 651 04ba 8A20     	        movs r0, # 0x8a
 652 04bc 9049     	        ldr r1, = kong
 653 04be 0122     	        movs r2, # 1
 654 04c0 00F046F9 		bl _lcdxianshi
 655              	__xian_shi_xia_bi_shi_bu:
 656 04c4 2046     		mov r0, r4
 657 04c6 0521     		movs r1, # 5
 658 04c8 7E4A     		ldr r2, = asciimabiao
 659 04ca FF23     		movs r3, # 0xff
 660 04cc 00F08FF9 		bl _zhuanascii
 661 04d0 8B20     	        movs r0, # 0x8b
ARM GAS  1.s 			page 13


 662 04d2 7C49     	        ldr r1, = asciimabiao
 663 04d4 0522     	        movs r2, # 5
 664 04d6 00F03BF9 	        bl _lcdxianshi
 665              	
 666              	@显示下臂虚部
 667 04da 5446     		mov r4, r10
 668 04dc 2400     		movs r4, r4
 669 04de 07D5     	        bpl __xia_bi_xu_bu_zheng
 670 04e0 CA20     	        movs r0, # 0xca
 671 04e2 8649     	        ldr r1, = _fu
 672 04e4 0122     	        movs r2, # 1
 673 04e6 00F033F9 	        bl _lcdxianshi
 674 04ea E443     	        mvns r4, r4
 675 04ec 0134     	        adds r4, r4, # 1
 676 04ee 04E0     	        b __xian_shi_xia_bi_xu_bu
 677              	__xia_bi_xu_bu_zheng:
 678 04f0 CA20     	        movs r0, # 0xca
 679 04f2 8349     	        ldr r1, = kong
 680 04f4 0122     	        movs r2, # 1
 681 04f6 00F02BF9 	        bl _lcdxianshi
 682              	__xian_shi_xia_bi_xu_bu:
 683 04fa 2046     	        mov r0, r4
 684 04fc 0521     	        movs r1, # 5
 685 04fe 714A     	        ldr r2, = asciimabiao
 686 0500 FF23     	        movs r3, # 0xff
 687 0502 00F074F9 	        bl _zhuanascii
 688 0506 CB20     	        movs r0, # 0xcb
 689 0508 6E49     	        ldr r1, = asciimabiao
 690 050a 0522     	        movs r2, # 5
 691 050c 00F020F9 	        bl _lcdxianshi
 692 0510 FFBD     		pop {r0-r7,pc}
 693              	
 694              	
 695              	__zhen_fu_lv_bo:
 696              		@ 入口 R0= 下臂实部，R1=上臂实部，R2=下臂虚部，R3=上臂虚部
 697 0512 FFB5     		push {r0-r7,lr}
 698 0514 6C4F     		ldr r7, = xia_bi_shi_bu
 699 0516 1546     		mov r5, r2
 700 0518 1E46     		mov r6, r3
 701 051a 0C46     		mov r4, r1
 702 051c 0346     		mov r3, r0
 703 051e 7948     		ldr r0, = lvboqihuanchong
 704 0520 7949     		ldr r1, = 32
 705 0522 7A4A     		ldr r2, = lvboqizhizhen
 706 0524 00F0B8F8 		bl _lvboqi
 707 0528 3860     		str r0, [r7]			@保存下臂实部
 708 052a 2346     	        mov r3, r4
 709 052c 7848     	        ldr r0, = lvboqihuanchong1
 710 052e 7649     		ldr r1, = 32
 711 0530 784A     		ldr r2, = lvboqizhizhen1
 712 0532 00F0B1F8 	        bl _lvboqi
 713 0536 7860     	        str r0, [r7, # 0x04]		@保存上臂实部
 714 0538 2B46     		mov r3, r5
 715 053a 7748     		ldr r0, = lvboqihuanchong2
 716 053c 7249     	        ldr r1, = 32
 717 053e 774A     	        ldr r2, = lvboqizhizhen2
 718 0540 00F0AAF8 		bl _lvboqi
ARM GAS  1.s 			page 14


 719 0544 B860     		str r0, [r7, # 0x08]		@保存下臂虚部
 720              	
 721 0546 3346     	        mov r3, r6
 722 0548 7548     		ldr r0, = lvboqihuanchong3
 723 054a 6F49     		ldr r1, = 32
 724 054c 754A     		ldr r2, = lvboqizhizhen3
 725 054e 00F0A3F8 	        bl _lvboqi
 726 0552 F860     		str r0, [r7, # 0x0c]		@保存上臂虚部
 727 0554 FFBD     		pop {r0-r7,pc}
 728              		
 729              	
 730              	__zi_dong_liang_cheng:
 731              		@ 0xc0=100,0x80=1k
 732              		@0x40=10k,0x00=100k
 733 0556 7FB5     		push {r0-r6,lr}
 734 0558 7348     		ldr r0, = zidongliangchengyanshi
 735 055a 1422     		movs r2, # 20
 736 055c 0168     		ldr r1, [r0]
 737 055e 0131     		adds r1, r1, # 1
 738 0560 0160     		str r1, [r0]
 739 0562 9142     		cmp r1, r2
 740 0564 1ED3     		bcc __liang_cheng_fan_hui
 741 0566 0021     		movs r1, # 0
 742 0568 0160     		str r1, [r0]
 743 056a 5748     		ldr r0, = xia_bi_shi_bu
 744 056c 5449     		ldr r1, = liangcheng
 745 056e 0468     		ldr r4, [r0]
 746 0570 2400     		movs r4, r4
 747 0572 01D5     		bpl __tiao_guo_zhuan_zheng_shu
 748 0574 E443     		mvns r4, r4
 749 0576 0134     		adds r4, r4, # 1
 750              	__tiao_guo_zhuan_zheng_shu:
 751 0578 5548     		ldr r0, = xia_bi_xu_bu
 752 057a 0568     		ldr r5, [r0]
 753 057c 2D00     		movs r5, r5
 754 057e 01D5     		bpl __tiao_guo_zhuan_zheng_shu1
 755 0580 ED43     		mvns r5, r5
 756 0582 0135     		adds r5, r5, # 1
 757              	__tiao_guo_zhuan_zheng_shu1:	
 758 0584 694B     		ldr r3, = 4000
 759 0586 0A68     		ldr r2, [r1]
 760 0588 C02A     		cmp r2, # 0xc0
 761 058a 05D0     		beq __xuan_kong
 762              	__pan_duan_liang_cheng:
 763 058c 9D42     		cmp r5, r3
 764 058e 01D2     		bcs __gai_liang_cheng
 765              	__jian_ce_shang_bi:	
 766 0590 9C42     		cmp r4,	r3
 767 0592 00D3     		bcc __bao_cun_liang_cheng
 768              	__gai_liang_cheng:
 769 0594 4032     		adds r2, r2, # 0x40
 770              	__bao_cun_liang_cheng:
 771 0596 0A60     		str r2, [r1]
 772              	__xuan_kong:
 773 0598 4B48     		ldr r0, = xia_bi_shi_bu
 774 059a 0468     		ldr r4, [r0]
 775 059c 462C     		cmp r4, # 70
ARM GAS  1.s 			page 15


 776 059e 01D2     		bcs __liang_cheng_fan_hui
 777              	__liang_cheng_chong_zhi:
 778 05a0 0022     		movs r2, # 0
 779 05a2 0A60     		str r2, [r1]
 780              	__liang_cheng_fan_hui:	
 781 05a4 7FBD     		pop {r0-r6,pc}
 782              	__jianbo:
 783              		@入口R0=0（上臂）1（下臂）
 784              		@出口R0=实部 R1=虚部
 785 05a6 FCB5     		push {r2-r7,lr}
 786 05a8 614C     		ldr r4, = 0x48000000
 787 05aa 624D     		ldr r5, = 0x200
 788 05ac 624E     		ldr r6, = 0x40012428
 789 05ae 0028     		cmp r0, # 0
 790 05b0 01D1     		bne __xia_bi_kai
 791 05b2 A561     		str r5, [r4, # 0x18]	@上臂开
 792 05b4 00E0     		b __tong_dao_xuan_ze
 793              	__xia_bi_kai:
 794 05b6 A562     		str r5, [r4, # 0x28]	@ 下臂开
 795              	__tong_dao_xuan_ze:
 796 05b8 0124     		movs r4, # 1
 797 05ba 3460     		str r4, [r6]		@ 反相通道开
 798 05bc 00F057F8 		bl _jianboyanshi
 799 05c0 5E48     		ldr r0, = dianyabiao
 800 05c2 5F49     		ldr r1, = fanxiangbiao
 801 05c4 6422     		movs r2, # 100
 802 05c6 FFF72BFF 		bl __fu_zhi_nei_cun
 803 05ca 0224     		movs r4, # 2
 804 05cc 3460     		str r4, [r6]		@ 正相通道开
 805 05ce 00F04EF8 		bl _jianboyanshi
 806 05d2 5A48     		ldr r0, = dianyabiao
 807 05d4 5B49     		ldr r1, = zhengxiangbiao
 808 05d6 6422     		movs r2, # 100
 809 05d8 FFF722FF 		bl __fu_zhi_nei_cun
 810 05dc 5948     		ldr r0, = zhengxiangbiao
 811 05de 5849     		ldr r1, = fanxiangbiao
 812 05e0 00F001F8 		bl __DFT_ji_suan
 813 05e4 FCBD     		pop {r2-r7,pc}
 814              	
 815              	__DFT_ji_suan:
 816              		@入口R0=正相表，R1=反相表
 817 05e6 FCB5     		push {r2-r7,lr}
 818 05e8 4446     		mov r4, r8
 819 05ea 4D46     		mov r5, r9
 820 05ec 5646     		mov r6, r10
 821 05ee 70B4     		push {r4-r6}
 822 05f0 0026     		movs r6, # 0
 823 05f2 B046     		mov r8, r6
 824 05f4 B146     		mov r9, r6
 825 05f6 C822     		movs r2, # 200
 826 05f8 9246     		mov r10, r2
 827 05fa 3246     		mov r2, r6
 828              	__ji_suan_dft_xun_huan:
 829 05fc 835A     		ldrh r3, [r0, r2]
 830 05fe 8C5A     		ldrh r4, [r1, r2]
 831 0600 002B     		cmp r3, # 0
 832 0602 00D0     		beq __qu_fan_r4
ARM GAS  1.s 			page 16


 833 0604 02E0     		b __ji_suan_dft
 834              	__qu_fan_r4:
 835 0606 E443     		mvns r4, r4
 836 0608 0134     		adds r4, r4, # 1
 837 060a 2346     		mov r3, r4
 838              	__ji_suan_dft:
 839 060c 4E4D     		ldr r5, = xuan_zhuan_yin_zi
 840 060e AF59     		ldr r7, [r5, r6]
 841 0610 0436     		adds r6, r6, # 4
 842 0612 5F43     		muls r7, r7, r3		@ 实部
 843 0614 FF13     		asrs r7, r7, # 15
 844 0616 4446     		mov r4, r8
 845 0618 E419     		adds r4, r4, r7
 846 061a A046     		mov r8, r4
 847 061c AF59     		ldr r7, [r5, r6]
 848 061e 0436     		adds r6, r6, # 4
 849 0620 5F43     		muls r7, r7, r3		@ 虚部
 850 0622 FF13     		asrs r7, r7, # 15
 851 0624 0024     		movs r4, # 0
 852 0626 013C     		subs r4, r4, # 1
 853 0628 6743     		muls r7, r7, r4
 854 062a 4C46     		mov r4, r9
 855 062c E419     		adds r4, r4, r7
 856 062e A146     		mov r9, r4
 857 0630 0232     		adds r2, r2, # 2
 858 0632 5245     		cmp r2, r10
 859 0634 E2D1     		bne __ji_suan_dft_xun_huan
 860 0636 4046     		mov r0, r8
 861 0638 4946     		mov r1, r9
 862 063a 70BC     		pop {r4-r6}
 863 063c A046     		mov r8, r4
 864 063e A946     		mov r9, r5
 865 0640 B246     		mov r10, r6
 866 0642 FCBD     		pop {r2-r7,pc}
 867              	_jianbo:
 868 0644 30B5     		push {r4-r5,lr}
 869 0646 0020     		movs r0, # 0
 870 0648 FFF7ADFF 		bl __jianbo
 871 064c 03B4     		push {r0,r1}
 872 064e 0120     		movs r0, # 1
 873 0650 FFF7A9FF 		bl __jianbo
 874 0654 30BC     		pop {r4,r5}	
 875 0656 2B00     		movs r3, r5
 876 0658 0A00     		movs r2, r1
 877 065a 2100     		movs r1, r4
 878 065c C043     		mvns r0, r0
 879 065e 0130     		adds r0, r0, # 1
 880 0660 D243     		mvns r2, r2
 881 0662 0132     		adds r2, r2, # 1
 882 0664 4011     		asrs r0, r0, # 5
 883 0666 4911     		asrs r1, r1, # 5
 884 0668 5211     		asrs r2, r2, # 5
 885 066a 5B11     		asrs r3, r3, # 5
 886 066c 30BD     		pop {r4-r5,pc}
 887              	_jianboyanshi:
 888 066e 80B5     		push {r7,lr}
 889 0670 364F     		ldr r7, = 0xffff
ARM GAS  1.s 			page 17


 890              	_jianboyanshixunhuan:
 891 0672 013F     		subs r7, r7, # 1
 892 0674 FDD1     		bne _jianboyanshixunhuan
 893 0676 80BD     		pop {r7,pc}
 894              	
 895              	__zhao_zui_da_shu:
 896 0678 1CB5     		push {r2-r4,lr}
 897 067a 3048     		ldr r0, = dianyabiao
 898 067c 6522     		movs r2, # 101
 899 067e 5200     		lsls r2, r2, # 1
 900 0680 0023     		movs r3, # 0
 901              	__zhao:
 902 0682 815A     		ldrh r1, [r0, r2]
 903 0684 9942     		cmp r1, r3
 904 0686 01D3     		bcc __di_zhi_jian
 905 0688 0B46     		mov r3, r1
 906 068a 1446     		mov r4, r2
 907              	__di_zhi_jian:	
 908 068c 023A     		subs r2, r2, # 2
 909 068e F8D1     		bne __zhao
 910 0690 0146     		mov r1, r0
 911 0692 1846     		mov r0, r3
 912 0694 0919     		adds r1, r1, r4
 913 0696 1CBD     		pop {r2-r4,pc}
 914              		
 915              	_lvboqi:
 916              				@滤波器
 917              				@R0=地址，R1=长度,r2=表指针地址,r3=ADC数值
 918              				@出R0=结果
 919 0698 FEB5     		push {r1-r7,lr}	
 920 069a 1568     		ldr r5, [r2]		@读出表指针
 921 069c 8E00     		lsls r6, r1, # 2	
 922 069e 4351     		str r3, [r0, r5]	@数值写到滤波器缓冲区
 923 06a0 0435     		adds r5, r5, # 4
 924 06a2 B542     		cmp r5, r6
 925 06a4 00D1     		bne _lvboqimeidaohuanchongquding
 926 06a6 0025     		movs r5, # 0
 927              	_lvboqimeidaohuanchongquding:
 928 06a8 1560     		str r5, [r2]
 929 06aa 0027     		movs r7, # 0
 930              	_lvboqixunhuan:
 931 06ac B542     		cmp r5, r6
 932 06ae 00D1     		bne _lvbozonghe
 933 06b0 0025     		movs r5, # 0
 934              	_lvbozonghe:
 935 06b2 4459     		ldr r4, [r0, r5]
 936 06b4 0435     		adds r5, r5, # 4
 937 06b6 3F19     		adds r7, r7, r4
 938 06b8 0139     		subs r1, r1, # 1
 939 06ba F7D1     		bne _lvboqixunhuan
 940 06bc 7811     		asrs r0, r7, # 5	@修改
 941 06be FEBD     		pop {r1-r7,pc}
 942 06c0 30000020 		.ltorg
 942      00000020 
 942      000A0020 
 942      040A0020 
 942      080A0020 
ARM GAS  1.s 			page 18


 943              	
 944              		
 945              	_lcdxianshi:	  		@r0=LCD位置，r1=数据地址，r2=长度
 946 0750 1FB5     		push {r0-r4,lr}
 947 0752 0C46     		mov r4, r1
 948              	
 949 0754 0021     		movs r1, # 0
 950 0756 00F00EF8 		bl _xielcd
 951              	
 952 075a 0121     		movs r1, # 1
 953 075c 0023     		movs r3, # 0
 954              	_lcdxianshixunhuan:
 955 075e E05C     		ldrb r0, [r4,r3]
 956 0760 00F009F8 		bl _xielcd
 957 0764 0133     		adds r3, r3, # 1
 958 0766 9342     		cmp r3, r2
 959 0768 F9D1     		bne _lcdxianshixunhuan
 960 076a 1FBD     		pop {r0-r4,pc}
 961              	
 962              	_lcdyanshi:
 963 076c 20B5     		push {r5,lr}
 964 076e 374D     		ldr r5, = 0x2000
 965              	_lcdyanshixunhuan:
 966 0770 013D     		subs r5, r5, # 1
 967 0772 FDD1     		bne _lcdyanshixunhuan
 968 0774 20BD     		pop {r5,pc}
 969              	
 970              	_xielcd:			@入R0=8位,r1=0命令,r1=1数据
 971 0776 3FB5     		push {r0-r5,lr}
 972 0778 354C     		ldr r4, = liangcheng  @ 量程开关 (第6位和第7位)
 973 077a 0246     		mov r2, r0
 974 077c 2568     		ldr r5, [r4]
 975 077e 1209     		lsrs r2, r2, # 4
 976 0780 9200     		lsls r2, r2, # 2	@ 高四位
 977 0782 0007     		lsls r0, r0, # 28
 978 0784 800E     		lsrs r0, r0, # 26	@ 低四位
 979 0786 C907     		lsls r1, r1, # 31
 980 0788 01D5     		bpl __lcd_ming_ling
 981              	__lcd_shu_ju:
 982 078a 0323     		movs r3, # 0x03		@ RS = 1 E = 1
 983 078c 00E0     		b __xie_lcd_shu_ju
 984              	__lcd_ming_ling:
 985 078e 0223     		movs r3, # 0x02		@ RS = 0 E = 1
 986              	__xie_lcd_shu_ju:
 987 0790 5B19     		adds r3, r3, r5
 988 0792 0146     		mov r1, r0
 989 0794 D218     		adds r2, r2, r3
 990 0796 1000     		movs r0, r2
 991 0798 00F00BF8 		bl __74hc595
 992 079c 0238     		subs r0, r0, # 0x02
 993 079e 00F008F8 		bl __74hc595
 994 07a2 0846     		mov r0, r1
 995 07a4 C018     		adds r0, r0, r3
 996 07a6 00F004F8 		bl __74hc595
 997 07aa 0238     		subs r0, r0, # 0x02
 998 07ac 00F001F8 		bl __74hc595
 999 07b0 3FBD     		pop {r0-r5,pc}
ARM GAS  1.s 			page 19


 1000              		
 1001              	__74hc595:			@ 入R0=8位
 1002 07b2 FFB5     		push {r0-r7,lr}
 1003 07b4 274E     		ldr r6, = 0x48000000
 1004 07b6 2025     		movs r5, # 0x20		@ SRCLK
 1005 07b8 4022     		movs r2, # 0x40		@ RCLK
 1006 07ba 8023     		movs r3, # 0x80		@ SER
 1007 07bc 1824     		movs r4, # 24
 1008              	__595_yiweixunhuan:
 1009 07be B261     		str r2, [r6, # 0x18]	@ rclk=0
 1010 07c0 B561     		str r5, [r6, # 0x18]	@ srclk=0
 1011 07c2 FF27     		movs r7, # 0xff
 1012              	__595_yanshi:
 1013 07c4 013F     		subs r7, r7, # 1
 1014 07c6 FDD1     		bne __595_yanshi
 1015 07c8 0146     		mov r1, r0
 1016 07ca A140     		lsls r1, r1, r4
 1017 07cc 01D5     		bpl __ser_0
 1018              	__ser_1:
 1019 07ce B362     		str r3, [r6, # 0x28]	@ ser=1
 1020 07d0 00E0     		b __595_yiwei
 1021              	__ser_0:
 1022 07d2 B361     		str r3, [r6, # 0x18]	@ ser=0
 1023              	__595_yiwei:
 1024 07d4 B562     		str r5, [r6, # 0x28]
 1025 07d6 FF27     		movs r7, # 0xff
 1026              	__595_yanshi1:
 1027 07d8 013F     		subs r7, r7, # 1
 1028 07da FDD1     		bne __595_yanshi1
 1029 07dc 0134     		adds r4, r4, # 1
 1030 07de 202C     		cmp r4, # 32
 1031 07e0 EDD1     		bne __595_yiweixunhuan
 1032 07e2 B262     		str r2, [r6, # 0x28]	@ rclk=1
 1033 07e4 FF27     		movs r7, # 0xff
 1034              	__595_yanshi2:
 1035 07e6 013F     		subs r7, r7, # 1
 1036 07e8 FDD1     		bne __595_yanshi2
 1037 07ea B261     		str r2, [r6, # 0x18]	@ rclk = 0
 1038 07ec FFBD     		pop {r0-r7,pc}
 1039              	
 1040              	
 1041              	
 1042              	_zhuanascii:					@ 16进制转ASCII
 1043              			@ R0要转的数据， R1长度，R2结果表首地址, r3=小数点位置
 1044 07ee FFB5     		push {r0-r7,lr}
 1045 07f0 1F46     		mov r7, r3
 1046 07f2 0546     		mov r5, r0
 1047 07f4 0E46     		mov r6, r1
 1048 07f6 0A21     		movs r1, # 10
 1049              	_xunhuanqiuma:
 1050 07f8 02B4     		push {r1}
 1051 07fa 00F013F8 		bl _chufa
 1052 07fe 02BC     		pop {r1}
 1053 0800 0446     		mov r4, r0
 1054 0802 4C43     		muls r4, r1
 1055 0804 2B1B     		subs r3, r5, r4
 1056 0806 3033     		adds r3, r3, # 0x30
ARM GAS  1.s 			page 20


 1057 0808 0546     		mov r5, r0
 1058 080a 013E     		subs r6, r6, # 1
 1059 080c 08D0     		beq _qiumafanhui
 1060 080e BE42     		cmp r6, r7
 1061 0810 02D1     		bne _meidaoxiaoshudian
 1062 0812 2E24     		movs r4, # 0x2e		@小数点
 1063 0814 9455     		strb r4, [r2,r6]	@插入小数点
 1064 0816 013E     		subs r6, r6, # 1
 1065              	_meidaoxiaoshudian:
 1066 0818 9355     		strb r3, [r2,r6]
 1067 081a 3600     		movs r6, r6
 1068 081c ECD1     		bne _xunhuanqiuma
 1069 081e FFBD     		pop {r0-r7,pc}
 1070              	_qiumafanhui:
 1071 0820 9355     		strb r3, [r2, r6]
 1072 0822 FFBD     		pop {r0-r7,pc}
 1073              	
 1074              	
 1075              		
 1076              	_chufa:				@软件除法
 1077              		@ r0 除以 r1 等于 商(r0)余数R1
 1078 0824 1CB5     		push {r2-r4,lr}
 1079 0826 0028     		cmp r0, # 0
 1080 0828 0FD0     		beq _chufafanhui
 1081 082a 0029     		cmp r1, # 0
 1082 082c 0DD0     		beq _chufafanhui
 1083 082e 0246     		mov r2, r0
 1084 0830 0123     		movs r3, # 1
 1085 0832 DB07     		lsls r3, r3, # 31
 1086 0834 0020     		movs r0, # 0
 1087 0836 0446     		mov r4, r0
 1088              	_chufaxunhuan:
 1089 0838 5200     		lsls r2, r2, # 1
 1090 083a 6441     		adcs r4, r4, r4
 1091 083c 8C42     		cmp r4, r1
 1092 083e 01D3     		bcc _chufaweishubudao0
 1093 0840 C018     		adds r0, r0, r3
 1094 0842 641A     		subs r4, r4, r1
 1095              	_chufaweishubudao0:
 1096 0844 5B08     		lsrs r3, r3, # 1
 1097 0846 F7D1     		bne _chufaxunhuan
 1098 0848 2146     		mov r1, r4
 1099              	_chufafanhui:
 1100 084a 1CBD     		pop {r2-r4,pc}
 1101 084c 00200000 		.ltorg
 1101      30000020 
 1101      00000048 
 1102              	
 1103              	
 1104              	_nmi_handler:
 1105 0858 7047     		bx lr
 1106              	_hard_fault:
 1107 085a 7047     		bx lr
 1108              	_svc_handler:
 1109 085c 7047     		bx lr
 1110              	_pendsv_handler:
 1111 085e 7047     		bx lr
ARM GAS  1.s 			page 21


 1112              	_systickzhongduan:
 1113 0860 034A     		ldr r2, = jishu
 1114 0862 0448     		ldr r0, = 0xe0000d04
 1115 0864 1368     		ldr r3, [r2]
 1116 0866 0449     		ldr r1, = 0x02000000
 1117 0868 0133     		adds r3, r3, # 1
 1118 086a 1360     		str r3, [r2]
 1119 086c 0160     		str r1, [r0]                 @ 清除SYSTICK中断
 1120              	aaa:
 1121 086e 70473400 		bx lr
 1121      0020040D 
 1121      00E00000 
 1121      0002
ARM GAS  1.s 			page 22


DEFINED SYMBOLS
                 1.s:9      .data:0000000000000000 zheng_xian_biao
                 1.s:11     .data:00000000000000ca $d
                 1.s:12     .data:00000000000000d0 xuan_zhuan_yin_zi
                 1.s:14     .data:00000000000003f0 lcdshuju
                 1.s:16     .data:0000000000000400 dianhua
                 1.s:18     .data:0000000000000410 qq
                 1.s:20     .data:0000000000000420 xushu
                 1.s:22     .data:0000000000000421 fu
                 1.s:24     .data:0000000000000422 zheng
                 1.s:26     .data:0000000000000423 dianzu
                 1.s:28     .data:0000000000000425 dianrong
                 1.s:30     .data:0000000000000427 pinlv
                 1.s:32     .data:000000000000042c qianou
                 1.s:34     .data:000000000000042d ou
                 1.s:36     .data:0000000000000431 kong
                 1.s:38     .data:0000000000000435 pifa
                 1.s:40     .data:0000000000000437 _fu
                 1.s:43     *ABS*:0000000020001000 STACKINIT
                 1.s:44     *ABS*:0000000020000000 asciimabiao
                 1.s:45     *ABS*:0000000020000030 liangcheng
                 1.s:46     *ABS*:0000000020000034 jishu
                 1.s:47     *ABS*:0000000020000038 jianbo
                 1.s:48     *ABS*:0000000020000040 dianyabiao
                 1.s:49     *ABS*:0000000020000110 zhengxiangbiao
                 1.s:50     *ABS*:00000000200001e0 fanxiangbiao
                 1.s:51     *ABS*:0000000020000600 lvboqizhizhen
                 1.s:52     *ABS*:0000000020000604 lvboqihuanchong
                 1.s:53     *ABS*:0000000020000700 lvboqizhizhen1
                 1.s:54     *ABS*:0000000020000704 lvboqihuanchong1
                 1.s:55     *ABS*:0000000020000800 lvboqizhizhen2
                 1.s:56     *ABS*:0000000020000804 lvboqihuanchong2
                 1.s:57     *ABS*:0000000020000900 lvboqizhizhen3
                 1.s:58     *ABS*:0000000020000904 lvboqihuanchong3
                 1.s:59     *ABS*:0000000020000a00 xia_bi_shi_bu
                 1.s:60     *ABS*:0000000020000a04 shang_bi_shi_bu
                 1.s:61     *ABS*:0000000020000a08 xia_bi_xu_bu
                 1.s:62     *ABS*:0000000020000a0c shang_bi_xu_bu
                 1.s:63     *ABS*:0000000020000a10 bu_chang_100r
                 1.s:64     *ABS*:0000000020000a14 zidongliangchengyanshi
                 1.s:65     *ABS*:0000000020000a18 dianzuzhi
                 1.s:66     *ABS*:0000000020000a1c dianrongzhi
                 1.s:68     .text:0000000000000000 vectors
                 1.s:115    .text:00000000000000b0 _start
                 1.s:1104   .text:0000000000000858 _nmi_handler
                 1.s:1106   .text:000000000000085a _hard_fault
                 1.s:1108   .text:000000000000085c _svc_handler
                 1.s:1110   .text:000000000000085e _pendsv_handler
                 1.s:1112   .text:0000000000000860 _systickzhongduan
                 1.s:1120   .text:000000000000086e aaa
                            .text:0000000000000000 $d
                 1.s:113    .text:00000000000000b0 $t
                 1.s:117    .text:00000000000000b2 yanshi111
                 1.s:121    .text:00000000000000b6 shizhong
                 1.s:128    .text:00000000000000c2 denghse
                 1.s:132    .text:00000000000000c8 dengpllguan
                 1.s:140    .text:00000000000000d6 dengpll
ARM GAS  1.s 			page 23


                 1.s:147    .text:00000000000000e0 dengdai14mshizhongwending
                 1.s:152    .text:00000000000000e6 _neicunqingling
                 1.s:156    .text:00000000000000ec _neicunqinglingxunhuan
                 1.s:161    .text:00000000000000f2 _waisheshizhong
                 1.s:176    .text:00000000000000fc _waishezhongduan
                 1.s:191    .text:00000000000000fc io_she_zhi
                 1.s:220    .text:0000000000000106 _adcchushihua
                 1.s:224    .text:000000000000010c _dengadcjiaozhun
                 1.s:228    .text:0000000000000112 _kaiadc
                 1.s:233    .text:000000000000011a _dengdaiadcwending
                 1.s:237    .text:0000000000000120 _tongdaoxuanze
                 1.s:251    .text:0000000000000134 dmachushihua
                 1.s:283    .text:0000000000000158 tim1chushiha
                 1.s:309    .text:0000000000000182 _lcdchushihua
                 1.s:970    .text:0000000000000776 _xielcd
                 1.s:962    .text:000000000000076c _lcdyanshi
                 1.s:403    .text:00000000000002ec dd
                 1.s:342    .text:00000000000001c6 ting
                 1.s:730    .text:0000000000000556 __zi_dong_liang_cheng
                 1.s:867    .text:0000000000000644 _jianbo
                 1.s:695    .text:0000000000000512 __zhen_fu_lv_bo
                 1.s:475    .text:000000000000036c __zu_kang_ji_suan
                 1.s:1042   .text:00000000000007ee _zhuanascii
                 1.s:945    .text:0000000000000750 _lcdxianshi
                 1.s:357    .text:00000000000001ee __liangcheng100k
                 1.s:368    .text:0000000000000206 __xian_shi_qi_ta
                 1.s:389    .text:0000000000000234 __xian_shi_dian_rong
                 1.s:401    .text:000000000000024a $d
                 1.s:401    .text:000000000000024c $d
                 1.s:404    .text:00000000000002ec $t
                 1.s:581    .text:0000000000000430 __xian_shi_shang_xia_bi
                 1.s:429    .text:0000000000000328 __ji_suan_fu_du
                 1.s:439    .text:0000000000000332 _shibubushifushu
                 1.s:444    .text:000000000000033a _xububushifushu
                 1.s:449    .text:0000000000000342 _panduanxubushibushi0
                 1.s:453    .text:0000000000000348 _jisuanfudu1
                 1.s:466    .text:000000000000035e _alpha_min_beta_max
                 1.s:458    .text:0000000000000350 _alpha_max_beta_min
                 1.s:487    .text:0000000000000382 __c_liang_cheng_100k
                 1.s:492    .text:000000000000038a __c_liang_cheng10k
                 1.s:504    .text:000000000000039c __ji_suan_dian_rong
                 1.s:497    .text:0000000000000392 __c_liang_cheng1k
                 1.s:502    .text:000000000000039a __c_liang_cheng100ou
                 1.s:1076   .text:0000000000000824 _chufa
                 1.s:559    .text:000000000000040c __shu_tai_da
                 1.s:568    .text:0000000000000420 __fu_zhi_nei_cun
                 1.s:572    .text:0000000000000424 __fu_zhi_xun_huan
                 1.s:598    .text:000000000000044e __shang_bi_shi_bu_zheng
                 1.s:603    .text:0000000000000458 __xian_shi_shang_bi_shi_bu
                 1.s:624    .text:0000000000000484 __shang_bi_xu_bu_zheng
                 1.s:629    .text:000000000000048e __xian_shi_shang_bi_xu_bu
                 1.s:650    .text:00000000000004ba __xia_bi_shi_bu_zheng
                 1.s:655    .text:00000000000004c4 __xian_shi_xia_bi_shi_bu
                 1.s:677    .text:00000000000004f0 __xia_bi_xu_bu_zheng
                 1.s:682    .text:00000000000004fa __xian_shi_xia_bi_xu_bu
                 1.s:915    .text:0000000000000698 _lvboqi
                 1.s:780    .text:00000000000005a4 __liang_cheng_fan_hui
ARM GAS  1.s 			page 24


                 1.s:750    .text:0000000000000578 __tiao_guo_zhuan_zheng_shu
                 1.s:757    .text:0000000000000584 __tiao_guo_zhuan_zheng_shu1
                 1.s:772    .text:0000000000000598 __xuan_kong
                 1.s:762    .text:000000000000058c __pan_duan_liang_cheng
                 1.s:768    .text:0000000000000594 __gai_liang_cheng
                 1.s:765    .text:0000000000000590 __jian_ce_shang_bi
                 1.s:770    .text:0000000000000596 __bao_cun_liang_cheng
                 1.s:777    .text:00000000000005a0 __liang_cheng_chong_zhi
                 1.s:782    .text:00000000000005a6 __jianbo
                 1.s:793    .text:00000000000005b6 __xia_bi_kai
                 1.s:795    .text:00000000000005b8 __tong_dao_xuan_ze
                 1.s:887    .text:000000000000066e _jianboyanshi
                 1.s:815    .text:00000000000005e6 __DFT_ji_suan
                 1.s:828    .text:00000000000005fc __ji_suan_dft_xun_huan
                 1.s:834    .text:0000000000000606 __qu_fan_r4
                 1.s:838    .text:000000000000060c __ji_suan_dft
                 1.s:890    .text:0000000000000672 _jianboyanshixunhuan
                 1.s:895    .text:0000000000000678 __zhao_zui_da_shu
                 1.s:901    .text:0000000000000682 __zhao
                 1.s:907    .text:000000000000068c __di_zhi_jian
                 1.s:927    .text:00000000000006a8 _lvboqimeidaohuanchongquding
                 1.s:930    .text:00000000000006ac _lvboqixunhuan
                 1.s:934    .text:00000000000006b2 _lvbozonghe
                 1.s:942    .text:00000000000006c0 $d
                 1.s:946    .text:0000000000000750 $t
                 1.s:954    .text:000000000000075e _lcdxianshixunhuan
                 1.s:965    .text:0000000000000770 _lcdyanshixunhuan
                 1.s:984    .text:000000000000078e __lcd_ming_ling
                 1.s:981    .text:000000000000078a __lcd_shu_ju
                 1.s:986    .text:0000000000000790 __xie_lcd_shu_ju
                 1.s:1001   .text:00000000000007b2 __74hc595
                 1.s:1008   .text:00000000000007be __595_yiweixunhuan
                 1.s:1012   .text:00000000000007c4 __595_yanshi
                 1.s:1021   .text:00000000000007d2 __ser_0
                 1.s:1018   .text:00000000000007ce __ser_1
                 1.s:1023   .text:00000000000007d4 __595_yiwei
                 1.s:1026   .text:00000000000007d8 __595_yanshi1
                 1.s:1034   .text:00000000000007e6 __595_yanshi2
                 1.s:1049   .text:00000000000007f8 _xunhuanqiuma
                 1.s:1070   .text:0000000000000820 _qiumafanhui
                 1.s:1065   .text:0000000000000818 _meidaoxiaoshudian
                 1.s:1099   .text:000000000000084a _chufafanhui
                 1.s:1088   .text:0000000000000838 _chufaxunhuan
                 1.s:1095   .text:0000000000000844 _chufaweishubudao0
                 1.s:1101   .text:000000000000084c $d
                 1.s:1105   .text:0000000000000858 $t
                 1.s:1121   .text:0000000000000870 $d

NO UNDEFINED SYMBOLS
