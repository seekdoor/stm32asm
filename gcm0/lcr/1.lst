ARM GAS  1.s 			page 1


   1              		@@ 单片机stm32f030f4p6
   2              		@@ 阻抗桥
   3              		@作者：yjmwxwx
   4              		@时间：2019-08-12
   5              		@编译器：ARM-NONE-EABI
   6              		 .thumb
   7              		         .syntax unified
   8              	.section .data
   9              	zheng_xian_biao:
  10 0000 17001800 		.short 23,24,26,27,29,30,31,33,34,35,36,38,39,40,41,41,42,43,44,44,45,45,46,46,46,46,46,46,46,45,4
  10      1A001B00 
  10      1D001E00 
  10      1F002100 
  10      22002300 
  11              	lcdshuju:
  12 00cc 796A6D77 		.ascii  "yjmwxwx-20190812"
  12      7877782D 
  12      32303139 
  12      30383132 
  13              	dianhua:	
  14 00dc 20202020 		.ascii	"     15552208295"
  14      20313535 
  14      35323230 
  14      38323935 
  15              	qq:
  16 00ec 20202051 		.ascii	"   QQ:3341656346"
  16      513A3333 
  16      34313635 
  16      36333436 
  17              	xushu:
  18 00fc 69       		.ascii "i"
  19              	fu:
  20 00fd 2D       		.ascii "-"
  21              	zheng:
  22 00fe 2B       		.ascii "+"
  23              	dianzu:
  24 00ff 523D     		.ascii	"R="
  25              	pinlv:
  26 0101 31304B48 		.ascii	"10KHZ"
  26      5A
  27              	xiaomai:
  28 0106 7869616F 		.ascii "xiaomai ="
  28      6D616920 
  28      3D
  29              		.equ STACKINIT,        	        0x20001000
  30              		.equ asciimabiao,		0x20000000
  31              		.equ liangcheng,		0x20000030
  32              		.equ jishu,			0x20000034
  33              		.equ jianbo,			0x20000038
  34              		.equ dianyabiao,		0x20000040
  35              		.equ lvboqizhizhen,		0x20000600
  36              		.equ lvboqihuanchong,		0x20000604
  37              		.equ lvboqizhizhen1,		0x20000700
  38              		.equ lvboqihuanchong1,		0x20000704
  39              		.equ lvboqizhizhen2,		0x20000800
  40              		.equ lvboqihuanchong2,		0x20000804
  41              		.equ lvboqizhizhen3,		0x20000900
ARM GAS  1.s 			page 2


  42              		.equ lvboqihuanchong3,		0x20000904
  43              		.equ xia_bi_shi_bu,		0x20000a00
  44              		.equ shang_bi_shi_bu,		0x20000a04
  45              		.equ xia_bi_xu_bu,		0x20000a08
  46              		.equ shang_bi_xu_bu,		0x20000a0c
  47              		.equ bu_chang_100r,		0x20000a10
  48              		.section .text
  49              	vectors:
  50 0000 00100020 		.word STACKINIT
  51 0004 B1000000 		.word _start + 1
  52 0008 49050000 		.word _nmi_handler + 1
  53 000c 4B050000 		.word _hard_fault  + 1
  54 0010 00000000 		.word 0
  55 0014 00000000 		.word 0
  56 0018 00000000 		.word 0
  57 001c 00000000 		.word 0
  58 0020 00000000 		.word 0
  59 0024 00000000 		.word 0
  60 0028 00000000 		.word 0
  61 002c 4D050000 		.word _svc_handler +1
  62 0030 00000000 		.word 0
  63 0034 00000000 		.word 0
  64 0038 4F050000 		.word _pendsv_handler +1
  65 003c 51050000 		.word _systickzhongduan +1               @ 15
  66 0040 5F050000 		.word aaa +1     @ _wwdg +1          @ 0
  67 0044 5F050000 		.word aaa +1     @_pvd +1            @ 1
  68 0048 5F050000 		.word aaa +1     @_rtc +1            @ 2
  69 004c 5F050000 		.word aaa +1     @_flash +1          @ 3
  70 0050 5F050000 		.word aaa +1	@ _rcc + 1          @ 4
  71 0054 5F050000 		.word aaa +1      @_exti0_1  +1      @ 5
  72 0058 5F050000 		.word aaa +1      @ _exti2_3 +1      @ 6
  73 005c 5F050000 		.word aaa +1       @_exti4_15 +1     @ 7
  74 0060 5F050000 		.word aaa +1                         @ 8
  75 0064 5F050000 		.word aaa +1 	@_dma1_1  +1    @ 9
  76 0068 5F050000 		.word aaa +1    @_dma1_2_3 +1        @ 10
  77 006c 5F050000 		.word aaa +1       @_dma1_4_5 +1     @ 11
  78 0070 5F050000 		.word aaa +1	 @_adc1 +1          @ 12
  79 0074 5F050000 		.word aaa +1       @_tim1_brk_up +1  @ 13
  80 0078 5F050000 		.word aaa +1        @ _tim1_cc +1    @ 14
  81 007c 5F050000 		.word aaa +1         @_tim2 +1       @ 15
  82 0080 5F050000 		.word aaa +1          @_tim3 +1      @ 16
  83 0084 5F050000 		.word aaa +1                         @ 17
  84 0088 5F050000 		.word aaa +1		                @ 18
  85 008c 5F050000 		.word aaa +1	@_tim14 +1    @ 19
  86 0090 5F050000 		.word aaa +1                         @ 20
  87 0094 5F050000 		.word aaa +1         @_tim16 +1      @ 21
  88 0098 5F050000 		.word aaa +1         @_tim17 +1      @ 22
  89 009c 5F050000 		.word aaa +1          @_i2c   +1     @ 23
  90 00a0 5F050000 		.word aaa +1                         @ 24
  91 00a4 5F050000 		.word aaa +1           @_spi   +1    @ 25
  92 00a8 5F050000 		.word aaa +1                         @ 26
  93 00ac 5F050000 		.word aaa +1         @_usart1 +1     @ 27
  94              		.align 2
  95              	
  96              	_start:
  97 00b0 ED48     		ldr r0, = 0xffff
  98              	yanshi111:
ARM GAS  1.s 			page 3


  99 00b2 0138     		subs r0, r0, # 1
 100 00b4 FDD1     		bne yanshi111
 101              		
 102              	shizhong:
 103 00b6 ED4A     		ldr r2, = 0x40022000   @FLASH访问控制
 104 00b8 3221     		movs r1, # 0x32
 105 00ba 1160     		str r1, [r2]           @FLASH缓冲 缓冲开启
 106 00bc EC48     		ldr r0, = 0x40021000 @ rcc
 107 00be ED49     		ldr r1, = 0x10001
 108 00c0 0160     		str r1, [r0]
 109              	denghse:
 110 00c2 0168     		ldr r1, [r0]
 111 00c4 8903     		lsls r1, r1, # 14
 112 00c6 FCD5     		bpl denghse
 113              	dengpllguan:
 114 00c8 0168     		ldr r1, [r0]
 115 00ca 8901     		lsls r1, r1, # 6
 116 00cc FCD4     		bmi dengpllguan
 117 00ce EA49     	        ldr r1, = 0x110002
 118 00d0 4160     	        str r1, [r0, # 0x04]
 119 00d2 EA49     		ldr r1, = 0x1010001
 120 00d4 0160     		str r1, [r0]
 121              	dengpll:
 122 00d6 0168     		ldr r1, [r0]
 123 00d8 8901     		lsls r1, # 6
 124 00da FCD5     		bpl dengpll
 125              		@0x34时钟控制寄存器 2 (RCC_CR2)
 126 00dc 0121     		movs r1, # 0x01
 127 00de 4163     		str r1, [r0, # 0x34]  @ HSI开14M时钟
 128              	dengdai14mshizhongwending:
 129 00e0 416B     		ldr r1, [r0, # 0x34]
 130 00e2 8907     		lsls r1, r1, # 30     @ 左移30位
 131 00e4 FCD5     		bpl dengdai14mshizhongwending  @ 等待14M时钟稳定
 132              	
 133              	_neicunqingling:
 134 00e6 E648     		ldr r0, = 0x20000000
 135 00e8 0021     		movs r1, # 0
 136 00ea E64B     		ldr r3, = 0x1000
 137              	_neicunqinglingxunhuan:
 138 00ec 043B     		subs r3, # 4
 139 00ee C150     		str r1, [r0, r3]
 140 00f0 FCD1     		bne _neicunqinglingxunhuan
 141              	
 142              	_waisheshizhong:			 @ 外设时钟
 143              		@+0x14=RCC_AHBENR
 144              		@0=DMA @2=SRAM @4=FLITF@6=CRC @17=PA @18=PB @19=PC @20=PD @22=PF
 145 00f2 DF48     		ldr r0, = 0x40021000
 146 00f4 E449     		ldr r1, = 0x460005
 147 00f6 4161     		str r1, [r0, # 0x14]
 148              	
 149              		@+0x18外设时钟使能寄存器 (RCC_APB2ENR)
 150              		@0=SYSCFG @5=USART6EN @9=ADC @11=TIM1 @12=SPI1 @14=USART1 @16=TIM15 @17=TIM16 @18=TIM17 @22=DBGMCU
 151 00f8 E449     		ldr r1, = 0xa00
 152 00fa 8161     		str r1, [r0, # 0x18]
 153              		@+0X1C=RCC_APB1ENR
 154              		@1=TIM3 @4=TIM6 @5=TIM7 @8=TIM14 @11=WWDG @14=SPI @17=USRT2 @18=USART3 @20=USART5 @21=I2C1
 155              		@22=I2C2 @23=USB @28=PWR
ARM GAS  1.s 			page 4


 156 00fc 0221     		movs r1, # 0x02
 157 00fe C161     		str r1, [r0, # 0x1c]
 158              	
 159              	
 160              	_waishezhongduan:				@外设中断
 161              		@0xE000E100    0-31  写1开，写0没效
 162              		@0XE000E180    0-31 写1关，写0没效
 163              		@0XE000E200    0-31 挂起，写0没效
 164              		@0XE000E280    0-31 清除， 写0没效
 165              	
 166              	@_systick:				@ systick定时器初始化
 167              	
 168              	@	ldr r0, = 0xe000e010
 169              	@	ldr r1, = 0xffffff
 170              	@	str r1, [r0, # 4]
 171              	@	str r1, [r0, # 8]
 172              	@	movs r1, # 0x07
 173              	@	str r1, [r0]
 174              		
 175              	io_she_zhi:
 176              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 177              		@a(0x48000000)b(0x48000400)c(0x48000800)d(0x48000c00)f(0x48001400)
 178              		@ 输入（00），通用输出（01），复用功能（10），模拟（11）
 179              		@偏移0x4 = 端口输出类型 @ （0 推挽），（ 1 开漏）
 180              		@偏移0x8 = 输出速度  00低速， 01中速， 11高速
 181              		@偏移0xC = 上拉下拉 (00无上下拉，  01 上拉， 10下拉)
 182              		@偏移0x10 = 输入数据寄存器
 183              		@偏移0x14 = 输出数据寄存器
 184              		@偏移0x18 = 端口开  0-15置位
 185              		@偏移0x28 = 端口关
 186              		@0X20 = 复用低
 187              		@GPIO口0（0-3位）每个IO口占用4位
 188              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 189              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 190              		@0x24 = 复用高
 191              		@GPIO口8 （0-3位）每个IO口占用4位
 192              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 193              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 194              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 195              	
 196 0100 E348     		ldr r0, = 0x48000000
 197 0102 E449     		ldr r1, = 0x2824540f
 198 0104 0160     		str r1, [r0]
 199 0106 E449     		ldr r1, = 0x200
 200 0108 4162     		str r1, [r0, # 0x24]
 201              	
 202              	
 203              	
 204              	_adcchushihua:
 205 010a E448     	        ldr r0, = 0x40012400  @ adc基地址
 206 010c E449     	        ldr r1, = 0x80000000
 207 010e 8160     	        str r1, [r0, # 0x08]  @ ADC 控制寄存器 (ADC_CR)  @adc校准
 208              	_dengadcjiaozhun:
 209 0110 8168     	        ldr r1, [r0, # 0x08]
 210 0112 0900     	        movs r1, r1
 211 0114 FCD4     	        bmi _dengadcjiaozhun   @ 等ADC校准
 212              	_kaiadc:
ARM GAS  1.s 			page 5


 213 0116 8168     		ldr r1, [r0, # 0x08]
 214 0118 0122     	        movs r2, # 0x01
 215 011a 1143     		orrs r1, r1, r2
 216 011c 8160     	        str r1, [r0, # 0x08]
 217              	_dengdaiadcwending:
 218 011e 0168     		ldr r1, [r0]
 219 0120 C907     		lsls r1, r1, # 31
 220 0122 FCD5     		bpl _dengdaiadcwending @ 等ADC稳定
 221              	_tongdaoxuanze:
 222 0124 DF49     		ldr r1, = 2
 223 0126 8162     	        str r1, [r0, # 0x28]    @ 通道选择寄存器 (ADC_CHSELR)
 224 0128 DF49     	        ldr r1, = 0xc03
 225 012a C160     	        str r1, [r0, # 0x0c]    @ 配置寄存器 1 (ADC_CFGR1)
 226 012c 0021     		movs r1, # 0
 227 012e 4161     	        str r1, [r0, # 0x14]    @ ADC 采样时间寄存器 (ADC_SMPR)
 228 0130 8168     		ldr r1, [r0, # 0x08]
 229 0132 DE4A     	        ldr r2, = 0x04         @ 开始转换
 230 0134 1143     	        orrs r1, r1, r2
 231 0136 8160     		str r1, [r0, # 0x08]    @ 控制寄存器 (ADC_CR)
 232              	
 233              	
 234              		
 235              	dmachushihua:
 236              	        @+0=LSR,+4=IFCR,
 237              	        @+8=CCR1,+c=CNDTR1,+10=CPAR1+14=CMAR1,
 238              	        @+1c=CCR2,+20=CNDTR2,+24=CPAR2,+28=CMAR2
 239              	        @+30=CCR3,+34=CNDTR3,+38=CPAR2,+3c=CMAR3
 240              	        @+44=CCR4,+48=CNDTR4,+4c=CPAR4,+50=CMAR4
 241              	        @+58=CCR5,+5c=CNDTR5,+60=CPAR5,+64=CMAR5
 242              	        @+6C=CCR6,+70=CNDTR6,+74=CPAR6,+78=CMAR6
 243              	        @+80=CCR7,+84=CNDTR7,+88=CPAR7,+8c=CMAR7
 244              	
 245              	        @tim1ch3DMA
 246 0138 DD48     	        ldr r0, = 0x40020000
 247 013a DE49     	        ldr r1, = 0x40012c3c @ 外设地址
 248 013c 0166     	        str r1, [r0, # 0x60]
 249 013e DE49     	        ldr r1, = zheng_xian_biao @ 储存器地址
 250 0140 4166     	        str r1, [r0, # 0x64]
 251 0142 DE49     	        ldr r1, = 101             @点数
 252 0144 C165     	        str r1, [r0, # 0x5c]
 253 0146 DE49     	        ldr r1, = 0x35b1         @ 储存到外设
 254 0148 8165     	        str r1, [r0, # 0x58]
 255              		@ adc dma
 256 014a D948     		ldr r0, = 0x40020000
 257 014c DD49     		ldr r1, = 0x40012440
 258 014e 0161     		str r1, [r0, # 0x10]
 259 0150 DD49     		ldr r1, = dianyabiao
 260 0152 4161     		str r1, [r0, # 0x14]
 261 0154 DD49     		ldr r1, =  202
 262 0156 C160     		str r1, [r0, # 0x0c]
 263 0158 DD49     		ldr r1, = 0x5a1		@ 5a1
 264 015a 8160     		str r1, [r0, # 0x08]
 265              	
 266              	
 267              	tim1chushiha:
 268 015c DD48     	        ldr r0, = 0x40012c00 @ tim1_cr1
 269 015e 0021     	        movs r1, # 0
ARM GAS  1.s 			page 6


 270 0160 8162     	        str r1, [r0, # 0x28] @ psc
 271 0162 DD49     	        ldr r1, = 46
 272 0164 C162     	        str r1, [r0, # 0x2c] @ ARR
 273 0166 4021     		movs r1, # 0x40
 274 0168 4160     		str r1, [r0, # 0x04] @ TRGO
 275 016a 3821     		movs r1, # 0x38
 276 016c 8161     		str r1, [r0, # 0x18] @ ccmr1 cc1
 277 016e 2E21     		movs r1, # 46
 278 0170 4163     		str r1, [r0, # 0x34]
 279 0172 DA49     	        ldr r1, = 0x68
 280 0174 C161     	        str r1, [r0, # 0x1c] @ ccmr2  CC3
 281 0176 DA49     	        ldr r1, = 0x100    @  CC3
 282 0178 0162     	        str r1, [r0, # 0x20] @ ccer
 283 017a DA49     	        ldr r1, = 0x8000
 284 017c 4164     	        str r1, [r0, # 0x44] @ BDTR
 285 017e DA49     	        ldr r1, = 0x800 @ CC3 DMA
 286 0180 C160     	        str r1, [r0, # 0x0c] @ DIER
 287 0182 DA49     	        ldr r1, = 0x81
 288 0184 0160     	        str r1, [r0]
 289              	
 290              	
 291              	
 292              	_lcdchushihua:
 293 0186 3320     		movs r0, # 0x33
 294 0188 0021     		movs r1, # 0
 295 018a 00F004F9 		bl _xielcd
 296 018e 00F0FDF8 		bl _lcdyanshi
 297 0192 3220     		movs r0, # 0x32
 298 0194 0021     		movs r1, # 0
 299 0196 00F0FEF8 		bl _xielcd
 300 019a 00F0F7F8 		bl _lcdyanshi
 301 019e 2820     		movs r0, # 0x28
 302 01a0 0021     		movs r1, # 0
 303 01a2 00F0F8F8 		bl _xielcd
 304 01a6 00F0F1F8 		bl _lcdyanshi
 305 01aa 0C20     		movs r0, # 0x0c
 306 01ac 0021     		movs r1, # 0
 307 01ae 00F0F2F8 		bl _xielcd
 308 01b2 00F0EBF8 		bl _lcdyanshi
 309 01b6 0120     		movs r0, # 0x01
 310 01b8 0021     		movs r1, # 0
 311 01ba 00F0ECF8 		bl _xielcd
 312 01be 00F0E5F8 		bl _lcdyanshi
 313              	
 314 01c2 8020     		movs r0, # 0x80
 315 01c4 CA49     		ldr r1, = lcdshuju
 316 01c6 1022     		movs r2, # 16
 317 01c8 FF23     		movs r3, # 0xff
 318 01ca 00F0D1F8 		bl _lcdxianshi
 319              		
 320 01ce C948     		ldr r0, = liangcheng
 321 01d0 C021     		movs r1, # 0xc0
 322 01d2 0160     		str r1, [r0]
 323 01d4 00F08EF8 		bl __zi_dong_liang_cheng
 324              	ting:
 325 01d8 BB48     	        ldr r0, = dianyabiao
 326 01da 3030     		adds r0, r0, # 0x30
ARM GAS  1.s 			page 7


 327 01dc 3221     	        movs r1, # 0x32
 328 01de 00F08EF8 	        bl _jianbo
 329 01e2 00F065F8 		bl __zhen_fu_lv_bo
 330 01e6 00F017F8 		bl __dian_zu_ji_suan
 331 01ea 0421     		movs r1, # 4
 332 01ec A44A     		ldr r2, = asciimabiao
 333 01ee FF23     		movs r3, # 0xff
 334 01f0 00F00DF9 		bl _zhuanascii
 335 01f4 C320     	        movs r0, # 0xc3
 336 01f6 A249     		ldr r1, = asciimabiao
 337 01f8 0422     	        movs r2, # 0x04
 338 01fa 00F0B9F8 	        bl _lcdxianshi
 339 01fe C120     	        movs r0, # 0xc1
 340 0200 BD49     	        ldr r1, = dianzu
 341 0202 0222     	        movs r2, # 2
 342 0204 FF23     	        movs r3, # 0xff
 343 0206 00F0B3F8 	        bl _lcdxianshi
 344 020a CA20     	        movs r0, # 0xca
 345 020c BB49     	        ldr r1, = pinlv
 346 020e 0522     	        movs r2, # 5
 347 0210 FF23     	        movs r3, # 0xff
 348 0212 00F0ADF8 	        bl _lcdxianshi
 349 0216 DFE7     		b ting
 350              	
 351              	
 352              	__dian_zu_ji_suan:
 353 0218 0EB5     		push {r1-r3,lr}
 354 021a B948     		ldr r0, = shang_bi_shi_bu
 355 021c B949     		ldr r1, = xia_bi_shi_bu
 356 021e BA4A     		ldr r2, = bu_chang_100r
 357 0220 0068     		ldr r0, [r0]
 358 0222 0968     		ldr r1, [r1]
 359 0224 1268     		ldr r2, [r2]
 360 0226 B94A     		ldr r2, = 76
 361 0228 8018     		adds r0, r0, r2
 362 022a A222     		movs r2, # 162
 363 022c 5043     		muls r0, r0, r2
 364 022e 00F007F9 		bl _chufa
 365 0232 0EBD     		pop {r1-r3,pc}
 366              		
 367              	__xian_shi_shang_xia_bi:
 368 0234 0FB5     		push {r0-r3,lr}
 369 0236 C420     	        movs r0, # 0xc4
 370 0238 B549     	        ldr r1, = xushu
 371 023a 0122     	        movs r2, # 1
 372 023c FF23     	        movs r3, # 0xff
 373 023e 00F097F8 	        bl _lcdxianshi
 374 0242 CF20     		movs r0, # 0xcf
 375 0244 B249     	        ldr r1, = xushu
 376 0246 0122     		movs r2, # 1
 377 0248 FF23     		movs r3, # 0xff
 378 024a 00F091F8 		bl _lcdxianshi
 379 024e AD48     		ldr r0, = xia_bi_shi_bu
 380 0250 0421     		movs r1, # 4
 381 0252 0068     		ldr r0, [r0]
 382 0254 8A4A     		ldr r2, = asciimabiao
 383 0256 FF23     		movs r3, # 0xff
ARM GAS  1.s 			page 8


 384 0258 00F0D9F8 		bl _zhuanascii
 385 025c 8B20     		movs r0, # 0x8b
 386 025e 8849     		ldr r1, = asciimabiao
 387 0260 0422     		movs r2, # 0x04
 388 0262 00F085F8 		bl _lcdxianshi
 389 0266 A648     	        ldr r0, = shang_bi_shi_bu
 390 0268 0421     	        movs r1, # 4
 391 026a 0068     	        ldr r0, [r0]
 392 026c 844A     	        ldr r2, = asciimabiao
 393 026e FF23     	        movs r3, # 0xff
 394 0270 00F0CDF8 	        bl _zhuanascii
 395 0274 8020     	        movs r0, # 0x80
 396 0276 8249     	        ldr r1, = asciimabiao
 397 0278 0422     	        movs r2, # 0x04
 398 027a 00F079F8 	        bl _lcdxianshi
 399 027e A548     	        ldr r0, = xia_bi_xu_bu
 400 0280 0421     	        movs r1, # 4
 401 0282 0068     	        ldr r0, [r0]
 402 0284 7E4A     	        ldr r2, = asciimabiao
 403 0286 FF23     	        movs r3, # 0xff
 404 0288 00F0C1F8 	        bl _zhuanascii
 405 028c CB20     	        movs r0, # 0xcb
 406 028e 7C49     	        ldr r1, = asciimabiao
 407 0290 0422     	        movs r2, # 0x04
 408 0292 00F06DF8 	        bl _lcdxianshi
 409 0296 A048     	        ldr r0, = shang_bi_xu_bu
 410 0298 0421     	        movs r1, # 4
 411 029a 0068     	        ldr r0, [r0]
 412 029c 784A     	        ldr r2, = asciimabiao
 413 029e FF23     	        movs r3, # 0xff
 414 02a0 00F0B5F8 	        bl _zhuanascii
 415 02a4 C020     	        movs r0, # 0xc0
 416 02a6 7649     	        ldr r1, = asciimabiao
 417 02a8 0422     	        movs r2, # 0x04
 418 02aa 00F061F8 	        bl _lcdxianshi
 419 02ae 0FBD     		pop {r0-r3,pc}
 420              	
 421              	
 422              	__zhen_fu_lv_bo:
 423              		@ 入口 R0= 下臂实部，R1=上臂实部，R2=下臂虚部，R3=上臂虚部
 424 02b0 FFB5     		push {r0-r7,lr}
 425 02b2 944F     		ldr r7, = xia_bi_shi_bu
 426 02b4 1546     		mov r5, r2
 427 02b6 1E46     		mov r6, r3
 428 02b8 0C46     		mov r4, r1
 429 02ba 0346     		mov r3, r0
 430 02bc 9748     		ldr r0, = lvboqihuanchong
 431 02be 9849     		ldr r1, = 64
 432 02c0 984A     		ldr r2, = lvboqizhizhen
 433 02c2 00F041F8 		bl _lvboqi
 434 02c6 3860     		str r0, [r7]			@保存下臂实部
 435 02c8 2346     	        mov r3, r4
 436 02ca 9748     	        ldr r0, = lvboqihuanchong1
 437 02cc 9449     		ldr r1, = 64
 438 02ce 974A     		ldr r2, = lvboqizhizhen1
 439 02d0 00F03AF8 	        bl _lvboqi
 440 02d4 7860     	        str r0, [r7, # 0x04]		@保存上臂实部
ARM GAS  1.s 			page 9


 441 02d6 2B46     		mov r3, r5
 442 02d8 9548     		ldr r0, = lvboqihuanchong2
 443 02da 9149     	        ldr r1, = 64
 444 02dc 954A     	        ldr r2, = lvboqizhizhen2
 445 02de 00F033F8 		bl _lvboqi
 446 02e2 B860     		str r0, [r7, # 0x08]		@保存下臂虚部
 447              	
 448 02e4 3346     	        mov r3, r6
 449 02e6 9448     		ldr r0, = lvboqihuanchong3
 450 02e8 8D49     		ldr r1, = 64
 451 02ea 944A     		ldr r2, = lvboqizhizhen3
 452 02ec 00F02CF8 	        bl _lvboqi
 453 02f0 F860     		str r0, [r7, # 0x0c]		@保存上臂虚部
 454 02f2 FFBD     		pop {r0-r7,pc}
 455              		
 456              	
 457              	__zi_dong_liang_cheng:
 458              		@ 0xc0=100,0x80=1k
 459              		@0x40=10k,0x00=100k
 460 02f4 03B5     		push {r0-r1,lr}
 461 02f6 7F48     		ldr r0, = liangcheng
 462 02f8 C021     		movs r1, # 0xc0
 463 02fa 0160     		str r1, [r0]
 464 02fc 03BD     		pop {r0-r1,pc}
 465              		
 466              	_jianbo:
 467              		@ 入口 R0=采样表首地址，R1=0度90度相差多少
 468              		@ 出口R0=下臂90度，R1=上臂90度，R2=下臂180度，R3=上臂180度
 469 02fe F0B5     		push {r4-r7,lr}
 470 0300 0C46     		mov r4, r1
 471 0302 0146     		mov r1, r0
 472 0304 0346     		mov r3, r0
 473 0306 1833     		adds r3, r3, # 0x18	@偏移90度
 474 0308 0919     		adds r1, r1, r4
 475 030a 0A46     		mov r2, r1
 476 030c 1832     		adds r2, r2, # 0x18	@偏移90度
 477 030e 604F     	        ldr r7, = 0x48000000
 478 0310 614E     	        ldr r6, = 0x200
 479 0312 BE62     		str r6, [r7, # 0x28]
 480 0314 8A4D     	        ldr r5, = 0x40012428
 481 0316 0224     	        movs r4, # 2
 482 0318 2C60     	        str r4, [r5]
 483 031a 00F010F8 		bl _jianboyanshi	
 484 031e 0088     		ldrh r0, [r0]
 485 0320 BE61     		str r6, [r7, # 0x18]
 486 0322 00F00CF8 		bl _jianboyanshi
 487 0326 0988     		ldrh r1, [r1]
 488 0328 0124     		movs r4, # 1
 489 032a 2C60     		str r4, [r5]
 490 032c BE62     		str r6, [r7, # 0x28]
 491 032e 00F006F8 		bl _jianboyanshi
 492 0332 1288     		ldrh r2, [r2]
 493 0334 BE61     		str r6, [r7, # 0x18]
 494 0336 00F002F8 		bl _jianboyanshi
 495 033a 1B88     		ldrh r3, [r3]
 496 033c F0BD     		pop {r4-r7,pc}
 497              	_jianboyanshi:
ARM GAS  1.s 			page 10


 498 033e 80B5     		push {r7,lr}
 499 0340 494F     		ldr r7, = 0xffff
 500              	_jianboyanshixunhuan:
 501 0342 013F     		subs r7, r7, # 1
 502 0344 FDD1     		bne _jianboyanshixunhuan
 503 0346 80BD     		pop {r7,pc}
 504              	_lvboqi:
 505              				@滤波器
 506              				@R0=地址，R1=长度,r2=表指针地址,r3=ADC数值
 507              				@出R0=结果
 508 0348 FEB5     		push {r1-r7,lr}	
 509 034a 1568     		ldr r5, [r2]		@读出表指针
 510 034c 4E00     		lsls r6, r1, # 1	
 511 034e 4353     		strh r3, [r0, r5]	@数值写到滤波器缓冲区
 512 0350 0235     		adds r5, r5, # 2
 513 0352 B542     		cmp r5, r6
 514 0354 00D1     		bne _lvboqimeidaohuanchongquding
 515 0356 0025     		movs r5, # 0
 516              	_lvboqimeidaohuanchongquding:
 517 0358 1560     		str r5, [r2]
 518 035a 0027     		movs r7, # 0
 519              	_lvboqixunhuan:
 520 035c B542     		cmp r5, r6
 521 035e 00D1     		bne _lvbozonghe
 522 0360 0025     		movs r5, # 0
 523              	_lvbozonghe:
 524 0362 445B     		ldrh r4, [r0, r5]
 525 0364 0235     		adds r5, r5, # 2
 526 0366 3F19     		adds r7, r7, r4
 527 0368 0139     		subs r1, r1, # 1
 528 036a F7D1     		bne _lvboqixunhuan
 529 036c B811     		asrs r0, r7, # 6	@修改
 530 036e FEBD     		pop {r1-r7,pc}
 531              	
 532              	
 533              		
 534              	_lcdxianshi:	  		@r0=LCD位置，r1=数据地址，r2=长度
 535 0370 1FB5     		push {r0-r4,lr}
 536 0372 0C46     		mov r4, r1
 537              	
 538 0374 0021     		movs r1, # 0
 539 0376 00F00EF8 		bl _xielcd
 540              	
 541 037a 0121     		movs r1, # 1
 542 037c 0023     		movs r3, # 0
 543              	_lcdxianshixunhuan:
 544 037e E05C     		ldrb r0, [r4,r3]
 545 0380 00F009F8 		bl _xielcd
 546 0384 0133     		adds r3, r3, # 1
 547 0386 9342     		cmp r3, r2
 548 0388 F9D1     		bne _lcdxianshixunhuan
 549 038a 1FBD     		pop {r0-r4,pc}
 550              	
 551              	_lcdyanshi:
 552 038c 20B5     		push {r5,lr}
 553 038e 6D4D     		ldr r5, = 0x2000
 554              	_lcdyanshixunhuan:
ARM GAS  1.s 			page 11


 555 0390 013D     		subs r5, r5, # 1
 556 0392 FDD1     		bne _lcdyanshixunhuan
 557 0394 20BD     		pop {r5,pc}
 558              	
 559              	_xielcd:			@入R0=8位,r1=0命令,r1=1数据
 560 0396 3FB5     		push {r0-r5,lr}
 561 0398 564C     		ldr r4, = liangcheng  @ 量程开关 (第6位和第7位)
 562 039a 0246     		mov r2, r0
 563 039c 2568     		ldr r5, [r4]
 564 039e 1209     		lsrs r2, r2, # 4
 565 03a0 9200     		lsls r2, r2, # 2	@ 高四位
 566 03a2 0007     		lsls r0, r0, # 28
 567 03a4 800E     		lsrs r0, r0, # 26	@ 低四位
 568 03a6 C907     		lsls r1, r1, # 31
 569 03a8 01D5     		bpl __lcd_ming_ling
 570              	__lcd_shu_ju:
 571 03aa 0323     		movs r3, # 0x03		@ RS = 1 E = 1
 572 03ac 00E0     		b __xie_lcd_shu_ju
 573              	__lcd_ming_ling:
 574 03ae 0223     		movs r3, # 0x02		@ RS = 0 E = 1
 575              	__xie_lcd_shu_ju:
 576 03b0 5B19     		adds r3, r3, r5
 577 03b2 0146     		mov r1, r0
 578 03b4 D218     		adds r2, r2, r3
 579 03b6 1000     		movs r0, r2
 580 03b8 00F00BF8 		bl __74hc595
 581 03bc 0238     		subs r0, r0, # 0x02
 582 03be 00F008F8 		bl __74hc595
 583 03c2 0846     		mov r0, r1
 584 03c4 C018     		adds r0, r0, r3
 585 03c6 00F004F8 		bl __74hc595
 586 03ca 0238     		subs r0, r0, # 0x02
 587 03cc 00F001F8 		bl __74hc595
 588 03d0 3FBD     		pop {r0-r5,pc}
 589              		
 590              	__74hc595:			@ 入R0=8位
 591 03d2 FFB5     		push {r0-r7,lr}
 592 03d4 2E4E     		ldr r6, = 0x48000000
 593 03d6 2025     		movs r5, # 0x20		@ SRCLK
 594 03d8 4022     		movs r2, # 0x40		@ RCLK
 595 03da 8023     		movs r3, # 0x80		@ SER
 596 03dc 1824     		movs r4, # 24
 597              	__595_yiweixunhuan:
 598 03de B261     		str r2, [r6, # 0x18]	@ rclk=0
 599 03e0 B561     		str r5, [r6, # 0x18]	@ srclk=0
 600 03e2 FF27     		movs r7, # 0xff
 601              	__595_yanshi:
 602 03e4 013F     		subs r7, r7, # 1
 603 03e6 FDD1     		bne __595_yanshi
 604 03e8 0146     		mov r1, r0
 605 03ea A140     		lsls r1, r1, r4
 606 03ec 01D5     		bpl __ser_0
 607              	__ser_1:
 608 03ee B362     		str r3, [r6, # 0x28]	@ ser=1
 609 03f0 00E0     		b __595_yiwei
 610              	__ser_0:
 611 03f2 B361     		str r3, [r6, # 0x18]	@ ser=0
ARM GAS  1.s 			page 12


 612              	__595_yiwei:
 613 03f4 B562     		str r5, [r6, # 0x28]
 614 03f6 FF27     		movs r7, # 0xff
 615              	__595_yanshi1:
 616 03f8 013F     		subs r7, r7, # 1
 617 03fa FDD1     		bne __595_yanshi1
 618 03fc 0134     		adds r4, r4, # 1
 619 03fe 202C     		cmp r4, # 32
 620 0400 EDD1     		bne __595_yiweixunhuan
 621 0402 B262     		str r2, [r6, # 0x28]	@ rclk=1
 622 0404 FF27     		movs r7, # 0xff
 623              	__595_yanshi2:
 624 0406 013F     		subs r7, r7, # 1
 625 0408 FDD1     		bne __595_yanshi2
 626 040a B261     		str r2, [r6, # 0x18]	@ rclk = 0
 627 040c FFBD     		pop {r0-r7,pc}
 628              	
 629              	
 630              	
 631              	_zhuanascii:					@ 16进制转ASCII
 632              			@ R0要转的数据， R1长度，R2结果表首地址, r3=小数点位置
 633 040e FFB5     		push {r0-r7,lr}
 634 0410 1F46     		mov r7, r3
 635 0412 0546     		mov r5, r0
 636 0414 0E46     		mov r6, r1
 637 0416 0A21     		movs r1, # 10
 638              	_xunhuanqiuma:
 639 0418 00F012F8 		bl _chufa
 640 041c 0446     		mov r4, r0
 641 041e 4C43     		muls r4, r1
 642 0420 2B1B     		subs r3, r5, r4
 643 0422 3033     		adds r3, r3, # 0x30
 644 0424 0546     		mov r5, r0
 645 0426 013E     		subs r6, r6, # 1
 646 0428 08D0     		beq _qiumafanhui
 647 042a BE42     		cmp r6, r7
 648 042c 02D1     		bne _meidaoxiaoshudian
 649 042e 2E24     		movs r4, # 0x2e		@小数点
 650 0430 9455     		strb r4, [r2,r6]	@插入小数点
 651 0432 013E     		subs r6, r6, # 1
 652              	_meidaoxiaoshudian:
 653 0434 9355     		strb r3, [r2,r6]
 654 0436 3600     		movs r6, r6
 655 0438 EED1     		bne _xunhuanqiuma
 656 043a FFBD     		pop {r0-r7,pc}
 657              	_qiumafanhui:
 658 043c 9355     		strb r3, [r2, r6]
 659 043e FFBD     		pop {r0-r7,pc}
 660              	
 661              		
 662              	_chufa:				@软件除法
 663              		@ r0 除以 r1 等于 商(r0)余数R1
 664 0440 1EB5     		push {r1-r4,lr}
 665 0442 0028     		cmp r0, # 0
 666 0444 0ED0     		beq _chufafanhui
 667 0446 0029     		cmp r1, # 0
 668 0448 0CD0     		beq _chufafanhui
ARM GAS  1.s 			page 13


 669 044a 0246     		mov r2, r0
 670 044c 0123     		movs r3, # 1
 671 044e DB07     		lsls r3, r3, # 31
 672 0450 0020     		movs r0, # 0
 673 0452 0446     		mov r4, r0
 674              	_chufaxunhuan:
 675 0454 5200     		lsls r2, r2, # 1
 676 0456 6441     		adcs r4, r4, r4
 677 0458 8C42     		cmp r4, r1
 678 045a 01D3     		bcc _chufaweishubudao0
 679 045c C018     		adds r0, r0, r3
 680 045e 641A     		subs r4, r4, r1
 681              	_chufaweishubudao0:
 682 0460 5B08     		lsrs r3, r3, # 1
 683 0462 F7D1     		bne _chufaxunhuan
 684              	_chufafanhui:
 685 0464 1EBD     		pop {r1-r4,pc}
 686 0466 0000FFFF 		.ltorg
 686      00000020 
 686      02400010 
 686      02400100 
 686      01000200 
 687              	
 688              	
 689              	_nmi_handler:
 690 0548 7047     		bx lr
 691              	_hard_fault:
 692 054a 7047     		bx lr
 693              	_svc_handler:
 694 054c 7047     		bx lr
 695              	_pendsv_handler:
 696 054e 7047     		bx lr
 697              	_systickzhongduan:
 698 0550 034A     		ldr r2, = jishu
 699 0552 0448     		ldr r0, = 0xe0000d04
 700 0554 1368     		ldr r3, [r2]
 701 0556 0449     		ldr r1, = 0x02000000
 702 0558 0133     		adds r3, r3, # 1
 703 055a 1360     		str r3, [r2]
 704 055c 0160     		str r1, [r0]                 @ 清除SYSTICK中断
 705              	aaa:
 706 055e 70473400 		bx lr
 706      0020040D 
 706      00E00000 
 706      0002
ARM GAS  1.s 			page 14


DEFINED SYMBOLS
                 1.s:9      .data:0000000000000000 zheng_xian_biao
                 1.s:11     .data:00000000000000cc lcdshuju
                 1.s:13     .data:00000000000000dc dianhua
                 1.s:15     .data:00000000000000ec qq
                 1.s:17     .data:00000000000000fc xushu
                 1.s:19     .data:00000000000000fd fu
                 1.s:21     .data:00000000000000fe zheng
                 1.s:23     .data:00000000000000ff dianzu
                 1.s:25     .data:0000000000000101 pinlv
                 1.s:27     .data:0000000000000106 xiaomai
                 1.s:29     *ABS*:0000000020001000 STACKINIT
                 1.s:30     *ABS*:0000000020000000 asciimabiao
                 1.s:31     *ABS*:0000000020000030 liangcheng
                 1.s:32     *ABS*:0000000020000034 jishu
                 1.s:33     *ABS*:0000000020000038 jianbo
                 1.s:34     *ABS*:0000000020000040 dianyabiao
                 1.s:35     *ABS*:0000000020000600 lvboqizhizhen
                 1.s:36     *ABS*:0000000020000604 lvboqihuanchong
                 1.s:37     *ABS*:0000000020000700 lvboqizhizhen1
                 1.s:38     *ABS*:0000000020000704 lvboqihuanchong1
                 1.s:39     *ABS*:0000000020000800 lvboqizhizhen2
                 1.s:40     *ABS*:0000000020000804 lvboqihuanchong2
                 1.s:41     *ABS*:0000000020000900 lvboqizhizhen3
                 1.s:42     *ABS*:0000000020000904 lvboqihuanchong3
                 1.s:43     *ABS*:0000000020000a00 xia_bi_shi_bu
                 1.s:44     *ABS*:0000000020000a04 shang_bi_shi_bu
                 1.s:45     *ABS*:0000000020000a08 xia_bi_xu_bu
                 1.s:46     *ABS*:0000000020000a0c shang_bi_xu_bu
                 1.s:47     *ABS*:0000000020000a10 bu_chang_100r
                 1.s:49     .text:0000000000000000 vectors
                 1.s:96     .text:00000000000000b0 _start
                 1.s:689    .text:0000000000000548 _nmi_handler
                 1.s:691    .text:000000000000054a _hard_fault
                 1.s:693    .text:000000000000054c _svc_handler
                 1.s:695    .text:000000000000054e _pendsv_handler
                 1.s:697    .text:0000000000000550 _systickzhongduan
                 1.s:705    .text:000000000000055e aaa
                            .text:0000000000000000 $d
                 1.s:94     .text:00000000000000b0 $t
                 1.s:98     .text:00000000000000b2 yanshi111
                 1.s:102    .text:00000000000000b6 shizhong
                 1.s:109    .text:00000000000000c2 denghse
                 1.s:113    .text:00000000000000c8 dengpllguan
                 1.s:121    .text:00000000000000d6 dengpll
                 1.s:128    .text:00000000000000e0 dengdai14mshizhongwending
                 1.s:133    .text:00000000000000e6 _neicunqingling
                 1.s:137    .text:00000000000000ec _neicunqinglingxunhuan
                 1.s:142    .text:00000000000000f2 _waisheshizhong
                 1.s:160    .text:0000000000000100 _waishezhongduan
                 1.s:175    .text:0000000000000100 io_she_zhi
                 1.s:204    .text:000000000000010a _adcchushihua
                 1.s:208    .text:0000000000000110 _dengadcjiaozhun
                 1.s:212    .text:0000000000000116 _kaiadc
                 1.s:217    .text:000000000000011e _dengdaiadcwending
                 1.s:221    .text:0000000000000124 _tongdaoxuanze
                 1.s:235    .text:0000000000000138 dmachushihua
ARM GAS  1.s 			page 15


                 1.s:267    .text:000000000000015c tim1chushiha
                 1.s:292    .text:0000000000000186 _lcdchushihua
                 1.s:559    .text:0000000000000396 _xielcd
                 1.s:551    .text:000000000000038c _lcdyanshi
                 1.s:534    .text:0000000000000370 _lcdxianshi
                 1.s:457    .text:00000000000002f4 __zi_dong_liang_cheng
                 1.s:324    .text:00000000000001d8 ting
                 1.s:466    .text:00000000000002fe _jianbo
                 1.s:422    .text:00000000000002b0 __zhen_fu_lv_bo
                 1.s:352    .text:0000000000000218 __dian_zu_ji_suan
                 1.s:631    .text:000000000000040e _zhuanascii
                 1.s:662    .text:0000000000000440 _chufa
                 1.s:367    .text:0000000000000234 __xian_shi_shang_xia_bi
                 1.s:504    .text:0000000000000348 _lvboqi
                 1.s:497    .text:000000000000033e _jianboyanshi
                 1.s:500    .text:0000000000000342 _jianboyanshixunhuan
                 1.s:516    .text:0000000000000358 _lvboqimeidaohuanchongquding
                 1.s:519    .text:000000000000035c _lvboqixunhuan
                 1.s:523    .text:0000000000000362 _lvbozonghe
                 1.s:543    .text:000000000000037e _lcdxianshixunhuan
                 1.s:554    .text:0000000000000390 _lcdyanshixunhuan
                 1.s:573    .text:00000000000003ae __lcd_ming_ling
                 1.s:570    .text:00000000000003aa __lcd_shu_ju
                 1.s:575    .text:00000000000003b0 __xie_lcd_shu_ju
                 1.s:590    .text:00000000000003d2 __74hc595
                 1.s:597    .text:00000000000003de __595_yiweixunhuan
                 1.s:601    .text:00000000000003e4 __595_yanshi
                 1.s:610    .text:00000000000003f2 __ser_0
                 1.s:607    .text:00000000000003ee __ser_1
                 1.s:612    .text:00000000000003f4 __595_yiwei
                 1.s:615    .text:00000000000003f8 __595_yanshi1
                 1.s:623    .text:0000000000000406 __595_yanshi2
                 1.s:638    .text:0000000000000418 _xunhuanqiuma
                 1.s:657    .text:000000000000043c _qiumafanhui
                 1.s:652    .text:0000000000000434 _meidaoxiaoshudian
                 1.s:684    .text:0000000000000464 _chufafanhui
                 1.s:674    .text:0000000000000454 _chufaxunhuan
                 1.s:681    .text:0000000000000460 _chufaweishubudao0
                 1.s:686    .text:0000000000000466 $d
                 1.s:686    .text:0000000000000468 $d
                 1.s:690    .text:0000000000000548 $t
                 1.s:706    .text:0000000000000560 $d

NO UNDEFINED SYMBOLS
