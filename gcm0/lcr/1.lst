ARM GAS  1.s 			page 1


   1              		@@ 单片机stm32f030f4p6
   2              		@@ 阻抗桥
   3              		@作者：yjmwxwx
   4              		@时间：2019-08-12
   5              		@编译器：ARM-NONE-EABI
   6              		 .thumb
   7              		         .syntax unified
   8              	.section .data
   9              	zheng_xian_biao:
  10 0000 30003300 		.short 0x30,0x33,0x36,0x38,0x3b,0x3e,0x41,0x44,0x47,0x49,0x4c,0x4e,0x50,0x52,0x54,0x56,0x58,0x59,0
  10      36003800 
  10      3B003E00 
  10      41004400 
  10      47004900 
  11              	lcdshuju:
  12 00c8 796A6D77 		.ascii  "yjmwxwx-20190812"
  12      7877782D 
  12      32303139 
  12      30383132 
  13              	dianhua:	
  14 00d8 20202020 		.ascii	"     15552208295"
  14      20313535 
  14      35323230 
  14      38323935 
  15              	qq:
  16 00e8 20202051 		.ascii	"   QQ:3341656346"
  16      513A3333 
  16      34313635 
  16      36333436 
  17              	fu:
  18 00f8 2D       		.ascii "-"
  19              	zheng:
  20 00f9 2B       		.ascii "+"
  21              	xiaomai:
  22 00fa 7869616F 		.ascii "xiaomai ="
  22      6D616920 
  22      3D
  23              		.equ STACKINIT,        	        0x20001000
  24              		.equ asciimabiao,		0x20000000
  25              		.equ xiangminkaiguan,		0x20000030
  26              		.equ jishu,			0x20000034
  27              		.equ dianyabiao,		0x20000038
  28              		.section .text
  29              	vectors:
  30 0000 00100020 		.word STACKINIT
  31 0004 B1000000 		.word _start + 1
  32 0008 CD030000 		.word _nmi_handler + 1
  33 000c CF030000 		.word _hard_fault  + 1
  34 0010 00000000 		.word 0
  35 0014 00000000 		.word 0
  36 0018 00000000 		.word 0
  37 001c 00000000 		.word 0
  38 0020 00000000 		.word 0
  39 0024 00000000 		.word 0
  40 0028 00000000 		.word 0
  41 002c D1030000 		.word _svc_handler +1
  42 0030 00000000 		.word 0
ARM GAS  1.s 			page 2


  43 0034 00000000 		.word 0
  44 0038 D3030000 		.word _pendsv_handler +1
  45 003c D5030000 		.word _systickzhongduan +1               @ 15
  46 0040 E3030000 		.word aaa +1     @ _wwdg +1          @ 0
  47 0044 E3030000 		.word aaa +1     @_pvd +1            @ 1
  48 0048 E3030000 		.word aaa +1     @_rtc +1            @ 2
  49 004c E3030000 		.word aaa +1     @_flash +1          @ 3
  50 0050 E3030000 		.word aaa +1	@ _rcc + 1          @ 4
  51 0054 E3030000 		.word aaa +1      @_exti0_1  +1      @ 5
  52 0058 E3030000 		.word aaa +1      @ _exti2_3 +1      @ 6
  53 005c E3030000 		.word aaa +1       @_exti4_15 +1     @ 7
  54 0060 E3030000 		.word aaa +1                         @ 8
  55 0064 E3030000 		.word aaa +1 	@_dma1_1  +1    @ 9
  56 0068 E3030000 		.word aaa +1    @_dma1_2_3 +1        @ 10
  57 006c E3030000 		.word aaa +1       @_dma1_4_5 +1     @ 11
  58 0070 E3030000 		.word aaa +1	 @_adc1 +1          @ 12
  59 0074 E3030000 		.word aaa +1       @_tim1_brk_up +1  @ 13
  60 0078 E3030000 		.word aaa +1        @ _tim1_cc +1    @ 14
  61 007c E3030000 		.word aaa +1         @_tim2 +1       @ 15
  62 0080 E3030000 		.word aaa +1          @_tim3 +1      @ 16
  63 0084 E3030000 		.word aaa +1                         @ 17
  64 0088 E3030000 		.word aaa +1		                @ 18
  65 008c E3030000 		.word aaa +1	@_tim14 +1    @ 19
  66 0090 E3030000 		.word aaa +1                         @ 20
  67 0094 E3030000 		.word aaa +1         @_tim16 +1      @ 21
  68 0098 E3030000 		.word aaa +1         @_tim17 +1      @ 22
  69 009c E3030000 		.word aaa +1          @_i2c   +1     @ 23
  70 00a0 E3030000 		.word aaa +1                         @ 24
  71 00a4 E3030000 		.word aaa +1           @_spi   +1    @ 25
  72 00a8 E3030000 		.word aaa +1                         @ 26
  73 00ac E3030000 		.word aaa +1         @_usart1 +1     @ 27
  74              		.align 2
  75              	
  76              	_start:
  77              	shizhong:
  78 00b0 A44A     		ldr r2, = 0x40022000   @FLASH访问控制
  79 00b2 3221     		movs r1, # 0x32
  80 00b4 1160     		str r1, [r2]           @FLASH缓冲 缓冲开启
  81 00b6 A448     		ldr r0, = 0x40021000 @ rcc
  82 00b8 A449     		ldr r1, = 0x10001
  83 00ba 0160     		str r1, [r0]
  84              	denghse:
  85 00bc 0168     		ldr r1, [r0]
  86 00be 8903     		lsls r1, r1, # 14
  87 00c0 FCD5     		bpl denghse
  88              	dengpllguan:
  89 00c2 0168     		ldr r1, [r0]
  90 00c4 8901     		lsls r1, r1, # 6
  91 00c6 FCD4     		bmi dengpllguan
  92 00c8 A149     	        ldr r1, = 0x110002
  93 00ca 4160     	        str r1, [r0, # 0x04]
  94 00cc A149     		ldr r1, = 0x1010001
  95 00ce 0160     		str r1, [r0]
  96              	dengpll:
  97 00d0 0168     		ldr r1, [r0]
  98 00d2 8901     		lsls r1, # 6
  99 00d4 FCD5     		bpl dengpll
ARM GAS  1.s 			page 3


 100              		@0x34时钟控制寄存器 2 (RCC_CR2)
 101 00d6 0121     		movs r1, # 0x01
 102 00d8 4163     		str r1, [r0, # 0x34]  @ HSI开14M时钟
 103              	dengdai14mshizhongwending:
 104 00da 416B     		ldr r1, [r0, # 0x34]
 105 00dc 8907     		lsls r1, r1, # 30     @ 左移30位
 106 00de FCD5     		bpl dengdai14mshizhongwending  @ 等待14M时钟稳定
 107              	
 108              	_neicunqingling:
 109 00e0 9D48     		ldr r0, = 0x20000000
 110 00e2 0021     		movs r1, # 0
 111 00e4 9D4B     		ldr r3, = 0x1000
 112              	_neicunqinglingxunhuan:
 113 00e6 043B     		subs r3, # 4
 114 00e8 C150     		str r1, [r0, r3]
 115 00ea FCD1     		bne _neicunqinglingxunhuan
 116              	
 117              	_waisheshizhong:			 @ 外设时钟
 118              		@+0x14=RCC_AHBENR
 119              		@0=DMA @2=SRAM @4=FLITF@6=CRC @17=PA @18=PB @19=PC @20=PD @22=PF
 120 00ec 9648     		ldr r0, = 0x40021000
 121 00ee 9C49     		ldr r1, = 0x460005
 122 00f0 4161     		str r1, [r0, # 0x14]
 123              	
 124              		@+0x18外设时钟使能寄存器 (RCC_APB2ENR)
 125              		@0=SYSCFG @5=USART6EN @9=ADC @11=TIM1 @12=SPI1 @14=USART1 @16=TIM15 @17=TIM16 @18=TIM17 @22=DBGMCU
 126 00f2 9C49     		ldr r1, = 0xa00
 127 00f4 8161     		str r1, [r0, # 0x18]
 128              		@+0X1C=RCC_APB1ENR
 129              		@1=TIM3 @4=TIM6 @5=TIM7 @8=TIM14 @11=WWDG @14=SPI @17=USRT2 @18=USART3 @20=USART5 @21=I2C1
 130              		@22=I2C2 @23=USB @28=PWR
 131              	
 132              	
 133              	
 134              	_waishezhongduan:				@外设中断
 135              		@0xE000E100    0-31  写1开，写0没效
 136              		@0XE000E180    0-31 写1关，写0没效
 137              		@0XE000E200    0-31 挂起，写0没效
 138              		@0XE000E280    0-31 清除， 写0没效
 139              	
 140              	@_systick:				@ systick定时器初始化
 141              	
 142              	@	ldr r0, = 0xe000e010
 143              	@	ldr r1, = 0xffffff
 144              	@	str r1, [r0, # 4]
 145              	@	str r1, [r0, # 8]
 146              	@	movs r1, # 0x07
 147              	@	str r1, [r0]
 148              		
 149              	io_she_zhi:
 150              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 151              		@a(0x48000000)b(0x48000400)c(0x48000800)d(0x48000c00)f(0x48001400)
 152              		@ 输入（00），通用输出（01），复用功能（10），模拟（11）
 153              		@偏移0x4 = 端口输出类型 @ （0 推挽），（ 1 开漏）
 154              		@偏移0x8 = 输出速度  00低速， 01中速， 11高速
 155              		@偏移0xC = 上拉下拉 (00无上下拉，  01 上拉， 10下拉)
 156              		@偏移0x10 = 输入数据寄存器
ARM GAS  1.s 			page 4


 157              		@偏移0x14 = 输出数据寄存器
 158              		@偏移0x18 = 端口开  0-15置位
 159              		@偏移0x28 = 端口关
 160              		@0X20 = 复用低
 161              		@GPIO口0（0-3位）每个IO口占用4位
 162              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 163              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 164              		@0x24 = 复用高
 165              		@GPIO口8 （0-3位）每个IO口占用4位
 166              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 167              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 168              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 169              	
 170 00f6 9C48     		ldr r0, = 0x48000000
 171 00f8 9C49     		ldr r1, = 0x2820543f
 172 00fa 0160     		str r1, [r0]
 173 00fc 9C49     		ldr r1, = 0x200
 174 00fe 4162     		str r1, [r0, # 0x24]
 175              	
 176              		
 177              	dmachushihua:
 178              	        @+0=LSR,+4=IFCR,
 179              	        @+8=CCR1,+c=CNDTR1,+10=CPAR1+14=CMAR1,
 180              	        @+1c=CCR2,+20=CNDTR2,+24=CPAR2,+28=CMAR2
 181              	        @+30=CCR3,+34=CNDTR3,+38=CPAR2,+3c=CMAR3
 182              	        @+44=CCR4,+48=CNDTR4,+4c=CPAR4,+50=CMAR4
 183              	        @+58=CCR5,+5c=CNDTR5,+60=CPAR5,+64=CMAR5
 184              	        @+6C=CCR6,+70=CNDTR6,+74=CPAR6,+78=CMAR6
 185              	        @+80=CCR7,+84=CNDTR7,+88=CPAR7,+8c=CMAR7
 186              	
 187              	        @tim1ch3DMA
 188 0100 9C48     	        ldr r0, = 0x40020000
 189 0102 9D49     	        ldr r1, = 0x40012c3c @ 外设地址
 190 0104 0166     	        str r1, [r0, # 0x60]
 191 0106 9D49     	        ldr r1, = zheng_xian_biao @ 储存器地址
 192 0108 4166     	        str r1, [r0, # 0x64]
 193 010a 9D49     	        ldr r1, = 100             @点数
 194 010c C165     	        str r1, [r0, # 0x5c]
 195 010e 9D49     	        ldr r1, = 0x25b1         @ 储存到外设
 196 0110 8165     	        str r1, [r0, # 0x58]
 197              	
 198              	@	ldr r0, = 0x40020000
 199              	@	ldr r1, = 0x40012440
 200              	@	str r1, [r0, # 0x10]
 201              	@	ldr r1, = dianyabiao
 202              	@	str r1, [r0, # 0x14]
 203              	 @       ldr r1, =  512
 204              	  @      str r1, [r0, # 0x0c]
 205              	   @     ldr r1, = 0xa81
 206              	    @    str r1, [r0, # 0x08]
 207              	
 208              	tim1chushiha:
 209 0112 9D48     	        ldr r0, = 0x40012c00 @ tim1_cr1
 210 0114 0021     	        movs r1, # 0
 211 0116 8162     	        str r1, [r0, # 0x28] @ psc
 212 0118 9C49     	        ldr r1, = 96
 213 011a C162     	        str r1, [r0, # 0x2c] @ ARR
ARM GAS  1.s 			page 5


 214 011c 9C49     	        ldr r1, = 0x68
 215 011e C161     	        str r1, [r0, # 0x1c] @ ccmr2  CC3
 216 0120 9C49     	        ldr r1, = 0x100    @  CC3
 217 0122 0162     	        str r1, [r0, # 0x20] @ ccer
 218 0124 9C49     	        ldr r1, = 0x8000
 219 0126 4164     	        str r1, [r0, # 0x44] @ BDTR
 220 0128 9C49     	        ldr r1, = 0x800 @ CC3 DMA
 221 012a C160     	        str r1, [r0, # 0x0c] @ DIER
 222 012c 9C49     	        ldr r1, = 0xe1
 223 012e 0160     	        str r1, [r0]
 224              	
 225              	
 226              	_adcchushihua:
 227 0130 9C48     	        ldr r0, = 0x40012400  @ adc基地址
 228 0132 9D49     		ldr r1, = 0x80000000
 229 0134 8160     	        str r1, [r0, # 0x08]  @ ADC 控制寄存器 (ADC_CR)  @adc校准
 230              	_dengadcjiaozhun:
 231 0136 8168     	        ldr r1, [r0, # 0x08]
 232 0138 0900     	         movs r1, r1
 233 013a FCD4     	        bmi _dengadcjiaozhun   @ 等ADC校准
 234              	_kaiadc:
 235 013c 8168     	        ldr r1, [r0, # 0x08]
 236 013e 0122     	        movs r2, # 0x01
 237 0140 1143     	        orrs r1, r1, r2
 238 0142 8160     	        str r1, [r0, # 0x08]
 239              	_dengdaiadcwending:
 240 0144 0168     	        ldr r1, [r0]
 241 0146 C907     	        lsls r1, r1, # 31
 242 0148 FCD5     	        bpl _dengdaiadcwending @ 等ADC稳定
 243              	_tongdaoxuanze:
 244 014a 9849     	        ldr r1, = 1
 245 014c 8162     	        str r1, [r0, # 0x28]    @ 通道选择寄存器 (ADC_CHSELR)
 246              	@       ldr r1, = 0xcC3         @ tim3触发ADC
 247 014e 9849     	        ldr r1, = 0x3000
 248 0150 C160     	        str r1, [r0, # 0x0c]    @ 配置寄存器 1 (ADC_CFGR1)
 249 0152 0021     	        movs r1, # 0
 250 0154 4161     	        str r1, [r0, # 0x14]    @ ADC 采样时间寄存器 (ADC_SMPR)
 251 0156 8168     	        ldr r1, [r0, # 0x08]
 252 0158 964A     	        ldr r2, = 0x04         @ 开始转换
 253 015a 1143     	        orrs r1, r1, r2
 254 015c 8160     	        str r1, [r0, # 0x08]    @ 控制寄存器 (ADC_CR)
 255              	
 256              	
 257              	_lcdchushihua:
 258 015e 3320     		movs r0, # 0x33
 259 0160 0021     		movs r1, # 0
 260 0162 00F080F8 		bl _xielcd
 261 0166 00F079F8 		bl _lcdyanshi
 262 016a 3220     		movs r0, # 0x32
 263 016c 0021     		movs r1, # 0
 264 016e 00F07AF8 		bl _xielcd
 265 0172 00F073F8 		bl _lcdyanshi
 266 0176 2820     		movs r0, # 0x28
 267 0178 0021     		movs r1, # 0
 268 017a 00F074F8 		bl _xielcd
 269 017e 00F06DF8 		bl _lcdyanshi
 270 0182 0C20     		movs r0, # 0x0c
ARM GAS  1.s 			page 6


 271 0184 0021     		movs r1, # 0
 272 0186 00F06EF8 		bl _xielcd
 273 018a 00F067F8 		bl _lcdyanshi
 274 018e 0120     		movs r0, # 0x01
 275 0190 0021     		movs r1, # 0
 276 0192 00F068F8 		bl _xielcd
 277 0196 00F061F8 		bl _lcdyanshi
 278              	
 279              	
 280              	ting:
 281 019a 8748     		ldr r0, = 0x40012428
 282 019c 0121     		movs r1, # 1
 283 019e 0160     		str r1, [r0]
 284 01a0 00F032F8 		bl _jianbo
 285 01a4 0C46     		mov r4, r1
 286 01a6 0421     		movs r1, # 4
 287 01a8 6B4A     		ldr r2, = asciimabiao
 288 01aa FF23     		movs r3, # 0xff
 289 01ac 00F09DF8 		bl _zhuanascii
 290 01b0 C020     		movs r0, # 0xc0
 291 01b2 6949     		ldr r1, = asciimabiao
 292 01b4 0422     		movs r2, # 4
 293 01b6 00F043F8 		bl _lcdxianshi
 294              	
 295 01ba 2000     		movs r0, r4
 296 01bc 0421     	        movs r1, # 4
 297 01be 664A     	        ldr r2, = asciimabiao
 298 01c0 FF23     	        movs r3, # 0xff
 299 01c2 00F092F8 	        bl _zhuanascii
 300 01c6 CC20     	        movs r0, # 0xcc
 301 01c8 6349     		ldr r1, = asciimabiao
 302 01ca 0422     	        movs r2, # 4
 303 01cc 00F038F8 	        bl _lcdxianshi
 304              	
 305 01d0 7948     		ldr r0, = 0x40012428
 306 01d2 0221     		movs r1, # 2
 307 01d4 0160     		str r1, [r0]
 308 01d6 00F025F8 		bl _jianbo1
 309 01da 0C46     	        mov r4,	r1
 310 01dc 0421     	        movs r1, # 4
 311 01de 5E4A     	        ldr r2, = asciimabiao
 312 01e0 FF23     	        movs r3, # 0xff
 313 01e2 00F082F8 	        bl _zhuanascii
 314 01e6 8020     	        movs r0, # 0x80
 315 01e8 5B49     		ldr r1, = asciimabiao
 316 01ea 0422     	        movs r2, # 4
 317 01ec 00F028F8 	        bl _lcdxianshi
 318              		
 319 01f0 2000     	        movs r0, r4
 320 01f2 0421     	        movs r1, # 4
 321 01f4 584A     		ldr r2, = asciimabiao
 322 01f6 FF23     	        movs r3, # 0xff
 323 01f8 00F077F8 	        bl _zhuanascii
 324 01fc 8C20     	        movs r0, # 0x8c
 325 01fe 5649     	        ldr r1, = asciimabiao
 326 0200 0422     	        movs r2, # 4
 327 0202 00F01DF8 	        bl _lcdxianshi
ARM GAS  1.s 			page 7


 328              		
 329 0206 C8E7     		b ting
 330              		
 331              	
 332              	_jianbo:				@检波
 333              						@输出r0=90度，R1=270度
 334 0208 1CB5     		push {r2-r4,lr}
 335 020a 6C4A     		ldr r2, = 0x4002005c
 336 020c 6C4B     		ldr r3, = 0x40012440
 337 020e 72B6     		cpsid i
 338              	_jianbo90du:
 339 0210 1468     		ldr r4, [r2]
 340 0212 192C     		cmp r4, # 25
 341 0214 FCD1     		bne _jianbo90du
 342 0216 1868     		ldr r0, [r3]			@取出90度
 343              	_jianbo270du:
 344 0218 1468     		ldr r4, [r2]
 345 021a 4B2C     		cmp r4, # 75
 346 021c FCD1     		bne _jianbo270du
 347 021e 1968     		ldr r1, [r3]
 348 0220 62B6     		cpsie i
 349 0222 1CBD     		pop {r2-r4,pc}
 350              	
 351              	_jianbo1:                                @检波
 352              	                                        @输出r0=90度，R1=270度
 353 0224 1CB5     	        push {r2-r4,lr}
 354 0226 654A     	        ldr r2, = 0x4002005c
 355 0228 654B     	        ldr r3, = 0x40012440
 356 022a 72B6     	        cpsid i
 357              	_jianbo0du:
 358 022c 1468     	        ldr r4, [r2]
 359 022e 642C     	        cmp r4, # 100
 360 0230 FCD1     	        bne _jianbo0du
 361 0232 1868     	        ldr r0, [r3]                    @取出90度
 362              	_jianbo180du:
 363 0234 1468     	        ldr r4, [r2]
 364 0236 322C     	        cmp r4, # 50
 365 0238 FCD1     	        bne _jianbo180du
 366 023a 1968     	        ldr r1, [r3]
 367 023c 62B6     	        cpsie i
 368 023e 1CBD     	        pop {r2-r4,pc}
 369              	
 370              		
 371              	_lcdxianshi:	  		@r0=LCD位置，r1=数据地址，r2=长度
 372 0240 1FB5     		push {r0-r4,lr}
 373 0242 0C46     		mov r4, r1
 374              	
 375 0244 0021     		movs r1, # 0
 376 0246 00F00EF8 		bl _xielcd
 377              	
 378 024a 0121     		movs r1, # 1
 379 024c 0023     		movs r3, # 0
 380              	_lcdxianshixunhuan:
 381 024e E05C     		ldrb r0, [r4,r3]
 382 0250 00F009F8 		bl _xielcd
 383 0254 0133     		adds r3, r3, # 1
 384 0256 9342     		cmp r3, r2
ARM GAS  1.s 			page 8


 385 0258 F9D1     		bne _lcdxianshixunhuan
 386 025a 1FBD     		pop {r0-r4,pc}
 387              	
 388              	_lcdyanshi:
 389 025c 20B5     		push {r5,lr}
 390 025e 594D     		ldr r5, = 0x2000
 391              	_lcdyanshixunhuan:
 392 0260 013D     		subs r5, r5, # 1
 393 0262 FDD1     		bne _lcdyanshixunhuan
 394 0264 20BD     		pop {r5,pc}
 395              	
 396              	_xielcd:			@入R0=8位,r1=0命令,r1=1数据
 397 0266 3FB5     		push {r0-r5,lr}
 398 0268 574C     		ldr r4, = xiangminkaiguan  @ 相敏开关
 399 026a 0246     		mov r2, r0
 400 026c 2568     		ldr r5, [r4]
 401 026e 1209     		lsrs r2, r2, # 4
 402 0270 9200     		lsls r2, r2, # 2	@ 高四位
 403 0272 0007     		lsls r0, r0, # 28
 404 0274 800E     		lsrs r0, r0, # 26	@ 低四位
 405 0276 C907     		lsls r1, r1, # 31
 406 0278 01D5     		bpl __lcd_ming_ling
 407              	__lcd_shu_ju:
 408 027a 0323     		movs r3, # 0x03		@ RS = 1 E = 1
 409 027c 00E0     		b __xiang_min_kai_guan
 410              	__lcd_ming_ling:
 411 027e 0223     		movs r3, # 0x02		@ RS = 0 E = 1
 412              	__xiang_min_kai_guan:
 413 0280 402D     		cmp r5, # 0x40
 414 0282 01D1     		bne __kai_zheng_xiang_wei
 415 0284 8025     		movs r5, # 0x80
 416 0286 00E0     		b __xie_lcd_shu_ju
 417              	__kai_zheng_xiang_wei:	
 418 0288 4025     		movs r5, # 0x40
 419              	__xie_lcd_shu_ju:
 420 028a 2560     		str r5, [r4]
 421 028c 5B19     		adds r3, r3, r5
 422 028e 0146     		mov r1, r0
 423 0290 D218     		adds r2, r2, r3
 424 0292 1000     		movs r0, r2
 425 0294 00F00BF8 		bl __74hc595
 426 0298 0238     		subs r0, r0, # 0x02
 427 029a 00F008F8 		bl __74hc595
 428 029e 0846     		mov r0, r1
 429 02a0 C018     		adds r0, r0, r3
 430 02a2 00F004F8 		bl __74hc595
 431 02a6 0238     		subs r0, r0, # 0x02
 432 02a8 00F001F8 		bl __74hc595
 433 02ac 3FBD     		pop {r0-r5,pc}
 434              		
 435              	__74hc595:			@ 入R0=8位
 436 02ae FFB5     		push {r0-r7,lr}
 437 02b0 2D4E     		ldr r6, = 0x48000000
 438 02b2 2025     		movs r5, # 0x20		@ SRCLK
 439 02b4 4022     		movs r2, # 0x40		@ RCLK
 440 02b6 8023     		movs r3, # 0x80		@ SER
 441 02b8 1824     		movs r4, # 24
ARM GAS  1.s 			page 9


 442              	__595_yiweixunhuan:
 443 02ba B261     		str r2, [r6, # 0x18]	@ rclk=0
 444 02bc B561     		str r5, [r6, # 0x18]	@ srclk=0
 445 02be FF27     		movs r7, # 0xff
 446              	__595_yanshi:
 447 02c0 013F     		subs r7, r7, # 1
 448 02c2 FDD1     		bne __595_yanshi
 449 02c4 0146     		mov r1, r0
 450 02c6 A140     		lsls r1, r1, r4
 451 02c8 01D5     		bpl __ser_0
 452              	__ser_1:
 453 02ca B362     		str r3, [r6, # 0x28]	@ ser=1
 454 02cc 00E0     		b __595_yiwei
 455              	__ser_0:
 456 02ce B361     		str r3, [r6, # 0x18]	@ ser=0
 457              	__595_yiwei:
 458 02d0 B562     		str r5, [r6, # 0x28]
 459 02d2 FF27     		movs r7, # 0xff
 460              	__595_yanshi1:
 461 02d4 013F     		subs r7, r7, # 1
 462 02d6 FDD1     		bne __595_yanshi1
 463 02d8 0134     		adds r4, r4, # 1
 464 02da 202C     		cmp r4, # 32
 465 02dc EDD1     		bne __595_yiweixunhuan
 466 02de B262     		str r2, [r6, # 0x28]	@ rclk=1
 467 02e0 FF27     		movs r7, # 0xff
 468              	__595_yanshi2:
 469 02e2 013F     		subs r7, r7, # 1
 470 02e4 FDD1     		bne __595_yanshi2
 471 02e6 B261     		str r2, [r6, # 0x18]	@ rclk = 0
 472 02e8 FFBD     		pop {r0-r7,pc}
 473              	
 474              	
 475              	
 476              	_zhuanascii:					@ 16进制转ASCII
 477              			@ R0要转的数据， R1长度，R2结果表首地址, r3=小数点位置
 478 02ea FFB5     		push {r0-r7,lr}
 479 02ec 1F46     		mov r7, r3
 480 02ee 0546     		mov r5, r0
 481 02f0 0E46     		mov r6, r1
 482 02f2 0A21     		movs r1, # 10
 483              	_xunhuanqiuma:
 484 02f4 00F012F8 		bl _chufa
 485 02f8 0446     		mov r4, r0
 486 02fa 4C43     		muls r4, r1
 487 02fc 2B1B     		subs r3, r5, r4
 488 02fe 3033     		adds r3, r3, # 0x30
 489 0300 0546     		mov r5, r0
 490 0302 013E     		subs r6, r6, # 1
 491 0304 08D0     		beq _qiumafanhui
 492 0306 BE42     		cmp r6, r7
 493 0308 02D1     		bne _meidaoxiaoshudian
 494 030a 2E24     		movs r4, # 0x2e		@小数点
 495 030c 9455     		strb r4, [r2,r6]	@插入小数点
 496 030e 013E     		subs r6, r6, # 1
 497              	_meidaoxiaoshudian:
 498 0310 9355     		strb r3, [r2,r6]
ARM GAS  1.s 			page 10


 499 0312 3600     		movs r6, r6
 500 0314 EED1     		bne _xunhuanqiuma
 501 0316 FFBD     		pop {r0-r7,pc}
 502              	_qiumafanhui:
 503 0318 9355     		strb r3, [r2, r6]
 504 031a FFBD     		pop {r0-r7,pc}
 505              	
 506              		
 507              	_chufa:				@软件除法
 508              		@ r0 除以 r1 等于 商(r0)余数R1
 509 031c 1EB5     		push {r1-r4,lr}
 510 031e 0028     		cmp r0, # 0
 511 0320 0ED0     		beq _chufafanhui
 512 0322 0029     		cmp r1, # 0
 513 0324 0CD0     		beq _chufafanhui
 514 0326 0246     		mov r2, r0
 515 0328 0123     		movs r3, # 1
 516 032a DB07     		lsls r3, r3, # 31
 517 032c 0020     		movs r0, # 0
 518 032e 0446     		mov r4, r0
 519              	_chufaxunhuan:
 520 0330 5200     		lsls r2, r2, # 1
 521 0332 6441     		adcs r4, r4, r4
 522 0334 8C42     		cmp r4, r1
 523 0336 01D3     		bcc _chufaweishubudao0
 524 0338 C018     		adds r0, r0, r3
 525 033a 641A     		subs r4, r4, r1
 526              	_chufaweishubudao0:
 527 033c 5B08     		lsrs r3, r3, # 1
 528 033e F7D1     		bne _chufaxunhuan
 529              	_chufafanhui:
 530 0340 1EBD     		pop {r1-r4,pc}
 531 0342 00000020 		.ltorg
 531      02400010 
 531      02400100 
 531      01000200 
 531      11000100 
 532              	
 533              	
 534              	_nmi_handler:
 535 03cc 7047     		bx lr
 536              	_hard_fault:
 537 03ce 7047     		bx lr
 538              	_svc_handler:
 539 03d0 7047     		bx lr
 540              	_pendsv_handler:
 541 03d2 7047     		bx lr
 542              	_systickzhongduan:
 543 03d4 034A     		ldr r2, = jishu
 544 03d6 0448     		ldr r0, = 0xe0000d04
 545 03d8 1368     		ldr r3, [r2]
 546 03da 0449     		ldr r1, = 0x02000000
 547 03dc 0133     		adds r3, r3, # 1
 548 03de 1360     		str r3, [r2]
 549 03e0 0160     		str r1, [r0]                 @ 清除SYSTICK中断
 550              	aaa:
 551 03e2 70473400 		bx lr
ARM GAS  1.s 			page 11


 551      0020040D 
 551      00E00000 
 551      0002
ARM GAS  1.s 			page 12


DEFINED SYMBOLS
                 1.s:9      .data:0000000000000000 zheng_xian_biao
                 1.s:11     .data:00000000000000c8 lcdshuju
                 1.s:13     .data:00000000000000d8 dianhua
                 1.s:15     .data:00000000000000e8 qq
                 1.s:17     .data:00000000000000f8 fu
                 1.s:19     .data:00000000000000f9 zheng
                 1.s:21     .data:00000000000000fa xiaomai
                 1.s:23     *ABS*:0000000020001000 STACKINIT
                 1.s:24     *ABS*:0000000020000000 asciimabiao
                 1.s:25     *ABS*:0000000020000030 xiangminkaiguan
                 1.s:26     *ABS*:0000000020000034 jishu
                 1.s:27     *ABS*:0000000020000038 dianyabiao
                 1.s:29     .text:0000000000000000 vectors
                 1.s:76     .text:00000000000000b0 _start
                 1.s:534    .text:00000000000003cc _nmi_handler
                 1.s:536    .text:00000000000003ce _hard_fault
                 1.s:538    .text:00000000000003d0 _svc_handler
                 1.s:540    .text:00000000000003d2 _pendsv_handler
                 1.s:542    .text:00000000000003d4 _systickzhongduan
                 1.s:550    .text:00000000000003e2 aaa
                            .text:0000000000000000 $d
                 1.s:74     .text:00000000000000b0 $t
                 1.s:77     .text:00000000000000b0 shizhong
                 1.s:84     .text:00000000000000bc denghse
                 1.s:88     .text:00000000000000c2 dengpllguan
                 1.s:96     .text:00000000000000d0 dengpll
                 1.s:103    .text:00000000000000da dengdai14mshizhongwending
                 1.s:108    .text:00000000000000e0 _neicunqingling
                 1.s:112    .text:00000000000000e6 _neicunqinglingxunhuan
                 1.s:117    .text:00000000000000ec _waisheshizhong
                 1.s:134    .text:00000000000000f6 _waishezhongduan
                 1.s:149    .text:00000000000000f6 io_she_zhi
                 1.s:177    .text:0000000000000100 dmachushihua
                 1.s:208    .text:0000000000000112 tim1chushiha
                 1.s:226    .text:0000000000000130 _adcchushihua
                 1.s:230    .text:0000000000000136 _dengadcjiaozhun
                 1.s:234    .text:000000000000013c _kaiadc
                 1.s:239    .text:0000000000000144 _dengdaiadcwending
                 1.s:243    .text:000000000000014a _tongdaoxuanze
                 1.s:257    .text:000000000000015e _lcdchushihua
                 1.s:396    .text:0000000000000266 _xielcd
                 1.s:388    .text:000000000000025c _lcdyanshi
                 1.s:280    .text:000000000000019a ting
                 1.s:332    .text:0000000000000208 _jianbo
                 1.s:476    .text:00000000000002ea _zhuanascii
                 1.s:371    .text:0000000000000240 _lcdxianshi
                 1.s:351    .text:0000000000000224 _jianbo1
                 1.s:338    .text:0000000000000210 _jianbo90du
                 1.s:343    .text:0000000000000218 _jianbo270du
                 1.s:357    .text:000000000000022c _jianbo0du
                 1.s:362    .text:0000000000000234 _jianbo180du
                 1.s:380    .text:000000000000024e _lcdxianshixunhuan
                 1.s:391    .text:0000000000000260 _lcdyanshixunhuan
                 1.s:410    .text:000000000000027e __lcd_ming_ling
                 1.s:407    .text:000000000000027a __lcd_shu_ju
                 1.s:412    .text:0000000000000280 __xiang_min_kai_guan
ARM GAS  1.s 			page 13


                 1.s:417    .text:0000000000000288 __kai_zheng_xiang_wei
                 1.s:419    .text:000000000000028a __xie_lcd_shu_ju
                 1.s:435    .text:00000000000002ae __74hc595
                 1.s:442    .text:00000000000002ba __595_yiweixunhuan
                 1.s:446    .text:00000000000002c0 __595_yanshi
                 1.s:455    .text:00000000000002ce __ser_0
                 1.s:452    .text:00000000000002ca __ser_1
                 1.s:457    .text:00000000000002d0 __595_yiwei
                 1.s:460    .text:00000000000002d4 __595_yanshi1
                 1.s:468    .text:00000000000002e2 __595_yanshi2
                 1.s:483    .text:00000000000002f4 _xunhuanqiuma
                 1.s:507    .text:000000000000031c _chufa
                 1.s:502    .text:0000000000000318 _qiumafanhui
                 1.s:497    .text:0000000000000310 _meidaoxiaoshudian
                 1.s:529    .text:0000000000000340 _chufafanhui
                 1.s:519    .text:0000000000000330 _chufaxunhuan
                 1.s:526    .text:000000000000033c _chufaweishubudao0
                 1.s:531    .text:0000000000000342 $d
                 1.s:531    .text:0000000000000344 $d
                 1.s:535    .text:00000000000003cc $t
                 1.s:551    .text:00000000000003e4 $d

NO UNDEFINED SYMBOLS
