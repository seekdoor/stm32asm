ARM GAS  1.s 			page 1


   1              		@@ 单片机stm32f030f4p6
   2              		@@ 阻抗桥
   3              		@作者：yjmwxwx
   4              		@时间：2019-08-12
   5              		@编译器：ARM-NONE-EABI
   6              		 .thumb
   7              		         .syntax unified
   8              	.section .data
   9              	zheng_xian_biao:
  10 0000 18001900 		.short 24,25,26,28,29,31,32,34,35,36,37,38,40,41,42,43,43,44,45,45,46,46,47,47,47,47,47,47,47,46,4
  10      1A001C00 
  10      1D001F00 
  10      20002200 
  10      23002400 
  11              	lcdshuju:
  12 00ca 796A6D77 		.ascii  "yjmwxwx-20190812"
  12      7877782D 
  12      32303139 
  12      30383132 
  13              	dianhua:	
  14 00da 20202020 		.ascii	"     15552208295"
  14      20313535 
  14      35323230 
  14      38323935 
  15              	qq:
  16 00ea 20202051 		.ascii	"   QQ:3341656346"
  16      513A3333 
  16      34313635 
  16      36333436 
  17              	xushu:
  18 00fa 6A       		.ascii "j"
  19              	fu:
  20 00fb 2D       		.ascii "-"
  21              	zheng:
  22 00fc 2B       		.ascii "+"
  23              	xiaomai:
  24 00fd 7869616F 		.ascii "xiaomai ="
  24      6D616920 
  24      3D
  25              		.equ STACKINIT,        	        0x20001000
  26              		.equ asciimabiao,		0x20000000
  27              		.equ xiangminkaiguan,		0x20000030
  28              		.equ jishu,			0x20000034
  29              		.equ jianbo,			0x20000038
  30              		.equ dianyabiao,		0x20000040
  31              		.equ lvboqizhizhen,		0x20000050
  32              		.equ lvboqihuanchong,		0x20000054
  33              		.equ lvboqizhizhen1,		0x20000550
  34              		.equ lvboqihuanchong1,		0x20000554
  35              		.section .text
  36              	vectors:
  37 0000 00100020 		.word STACKINIT
  38 0004 B1000000 		.word _start + 1
  39 0008 05040000 		.word _nmi_handler + 1
  40 000c 07040000 		.word _hard_fault  + 1
  41 0010 00000000 		.word 0
  42 0014 00000000 		.word 0
ARM GAS  1.s 			page 2


  43 0018 00000000 		.word 0
  44 001c 00000000 		.word 0
  45 0020 00000000 		.word 0
  46 0024 00000000 		.word 0
  47 0028 00000000 		.word 0
  48 002c 09040000 		.word _svc_handler +1
  49 0030 00000000 		.word 0
  50 0034 00000000 		.word 0
  51 0038 0B040000 		.word _pendsv_handler +1
  52 003c 0D040000 		.word _systickzhongduan +1               @ 15
  53 0040 1B040000 		.word aaa +1     @ _wwdg +1          @ 0
  54 0044 1B040000 		.word aaa +1     @_pvd +1            @ 1
  55 0048 1B040000 		.word aaa +1     @_rtc +1            @ 2
  56 004c 1B040000 		.word aaa +1     @_flash +1          @ 3
  57 0050 1B040000 		.word aaa +1	@ _rcc + 1          @ 4
  58 0054 1B040000 		.word aaa +1      @_exti0_1  +1      @ 5
  59 0058 1B040000 		.word aaa +1      @ _exti2_3 +1      @ 6
  60 005c 1B040000 		.word aaa +1       @_exti4_15 +1     @ 7
  61 0060 1B040000 		.word aaa +1                         @ 8
  62 0064 1B040000 		.word aaa +1 	@_dma1_1  +1    @ 9
  63 0068 1B040000 		.word aaa +1    @_dma1_2_3 +1        @ 10
  64 006c 1B040000 		.word aaa +1       @_dma1_4_5 +1     @ 11
  65 0070 1B040000 		.word aaa +1	 @_adc1 +1          @ 12
  66 0074 1B040000 		.word aaa +1       @_tim1_brk_up +1  @ 13
  67 0078 1B040000 		.word aaa +1        @ _tim1_cc +1    @ 14
  68 007c 1B040000 		.word aaa +1         @_tim2 +1       @ 15
  69 0080 1B040000 		.word aaa +1          @_tim3 +1      @ 16
  70 0084 1B040000 		.word aaa +1                         @ 17
  71 0088 1B040000 		.word aaa +1		                @ 18
  72 008c 1B040000 		.word aaa +1	@_tim14 +1    @ 19
  73 0090 1B040000 		.word aaa +1                         @ 20
  74 0094 1B040000 		.word aaa +1         @_tim16 +1      @ 21
  75 0098 1B040000 		.word aaa +1         @_tim17 +1      @ 22
  76 009c 1B040000 		.word aaa +1          @_i2c   +1     @ 23
  77 00a0 1B040000 		.word aaa +1                         @ 24
  78 00a4 1B040000 		.word aaa +1           @_spi   +1    @ 25
  79 00a8 1B040000 		.word aaa +1                         @ 26
  80 00ac 1B040000 		.word aaa +1         @_usart1 +1     @ 27
  81              		.align 2
  82              	
  83              	_start:
  84              	shizhong:
  85 00b0 AD4A     		ldr r2, = 0x40022000   @FLASH访问控制
  86 00b2 3221     		movs r1, # 0x32
  87 00b4 1160     		str r1, [r2]           @FLASH缓冲 缓冲开启
  88 00b6 AD48     		ldr r0, = 0x40021000 @ rcc
  89 00b8 AD49     		ldr r1, = 0x10001
  90 00ba 0160     		str r1, [r0]
  91              	denghse:
  92 00bc 0168     		ldr r1, [r0]
  93 00be 8903     		lsls r1, r1, # 14
  94 00c0 FCD5     		bpl denghse
  95              	dengpllguan:
  96 00c2 0168     		ldr r1, [r0]
  97 00c4 8901     		lsls r1, r1, # 6
  98 00c6 FCD4     		bmi dengpllguan
  99 00c8 AA49     	        ldr r1, = 0x110002
ARM GAS  1.s 			page 3


 100 00ca 4160     	        str r1, [r0, # 0x04]
 101 00cc AA49     		ldr r1, = 0x1010001
 102 00ce 0160     		str r1, [r0]
 103              	dengpll:
 104 00d0 0168     		ldr r1, [r0]
 105 00d2 8901     		lsls r1, # 6
 106 00d4 FCD5     		bpl dengpll
 107              		@0x34时钟控制寄存器 2 (RCC_CR2)
 108 00d6 0121     		movs r1, # 0x01
 109 00d8 4163     		str r1, [r0, # 0x34]  @ HSI开14M时钟
 110              	dengdai14mshizhongwending:
 111 00da 416B     		ldr r1, [r0, # 0x34]
 112 00dc 8907     		lsls r1, r1, # 30     @ 左移30位
 113 00de FCD5     		bpl dengdai14mshizhongwending  @ 等待14M时钟稳定
 114              	
 115              	_neicunqingling:
 116 00e0 A648     		ldr r0, = 0x20000000
 117 00e2 0021     		movs r1, # 0
 118 00e4 A64B     		ldr r3, = 0x1000
 119              	_neicunqinglingxunhuan:
 120 00e6 043B     		subs r3, # 4
 121 00e8 C150     		str r1, [r0, r3]
 122 00ea FCD1     		bne _neicunqinglingxunhuan
 123              	
 124              	_waisheshizhong:			 @ 外设时钟
 125              		@+0x14=RCC_AHBENR
 126              		@0=DMA @2=SRAM @4=FLITF@6=CRC @17=PA @18=PB @19=PC @20=PD @22=PF
 127 00ec 9F48     		ldr r0, = 0x40021000
 128 00ee A549     		ldr r1, = 0x460005
 129 00f0 4161     		str r1, [r0, # 0x14]
 130              	
 131              		@+0x18外设时钟使能寄存器 (RCC_APB2ENR)
 132              		@0=SYSCFG @5=USART6EN @9=ADC @11=TIM1 @12=SPI1 @14=USART1 @16=TIM15 @17=TIM16 @18=TIM17 @22=DBGMCU
 133 00f2 A549     		ldr r1, = 0xa00
 134 00f4 8161     		str r1, [r0, # 0x18]
 135              		@+0X1C=RCC_APB1ENR
 136              		@1=TIM3 @4=TIM6 @5=TIM7 @8=TIM14 @11=WWDG @14=SPI @17=USRT2 @18=USART3 @20=USART5 @21=I2C1
 137              		@22=I2C2 @23=USB @28=PWR
 138              	
 139              	
 140              	
 141              	_waishezhongduan:				@外设中断
 142              		@0xE000E100    0-31  写1开，写0没效
 143              		@0XE000E180    0-31 写1关，写0没效
 144              		@0XE000E200    0-31 挂起，写0没效
 145              		@0XE000E280    0-31 清除， 写0没效
 146              	
 147              	@_systick:				@ systick定时器初始化
 148              	
 149              	@	ldr r0, = 0xe000e010
 150              	@	ldr r1, = 0xffffff
 151              	@	str r1, [r0, # 4]
 152              	@	str r1, [r0, # 8]
 153              	@	movs r1, # 0x07
 154              	@	str r1, [r0]
 155              		
 156              	io_she_zhi:
ARM GAS  1.s 			page 4


 157              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 158              		@a(0x48000000)b(0x48000400)c(0x48000800)d(0x48000c00)f(0x48001400)
 159              		@ 输入（00），通用输出（01），复用功能（10），模拟（11）
 160              		@偏移0x4 = 端口输出类型 @ （0 推挽），（ 1 开漏）
 161              		@偏移0x8 = 输出速度  00低速， 01中速， 11高速
 162              		@偏移0xC = 上拉下拉 (00无上下拉，  01 上拉， 10下拉)
 163              		@偏移0x10 = 输入数据寄存器
 164              		@偏移0x14 = 输出数据寄存器
 165              		@偏移0x18 = 端口开  0-15置位
 166              		@偏移0x28 = 端口关
 167              		@0X20 = 复用低
 168              		@GPIO口0（0-3位）每个IO口占用4位
 169              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 170              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 171              		@0x24 = 复用高
 172              		@GPIO口8 （0-3位）每个IO口占用4位
 173              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 174              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 175              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 176              	
 177 00f6 A548     		ldr r0, = 0x48000000
 178 00f8 A549     		ldr r1, = 0x2820540f
 179 00fa 0160     		str r1, [r0]
 180 00fc A549     		ldr r1, = 0x200
 181 00fe 4162     		str r1, [r0, # 0x24]
 182              	
 183              		
 184              	dmachushihua:
 185              	        @+0=LSR,+4=IFCR,
 186              	        @+8=CCR1,+c=CNDTR1,+10=CPAR1+14=CMAR1,
 187              	        @+1c=CCR2,+20=CNDTR2,+24=CPAR2,+28=CMAR2
 188              	        @+30=CCR3,+34=CNDTR3,+38=CPAR2,+3c=CMAR3
 189              	        @+44=CCR4,+48=CNDTR4,+4c=CPAR4,+50=CMAR4
 190              	        @+58=CCR5,+5c=CNDTR5,+60=CPAR5,+64=CMAR5
 191              	        @+6C=CCR6,+70=CNDTR6,+74=CPAR6,+78=CMAR6
 192              	        @+80=CCR7,+84=CNDTR7,+88=CPAR7,+8c=CMAR7
 193              	
 194              	        @tim1ch3DMA
 195 0100 A548     	        ldr r0, = 0x40020000
 196 0102 A649     	        ldr r1, = 0x40012c3c @ 外设地址
 197 0104 0166     	        str r1, [r0, # 0x60]
 198 0106 A649     	        ldr r1, = zheng_xian_biao @ 储存器地址
 199 0108 4166     	        str r1, [r0, # 0x64]
 200 010a A649     	        ldr r1, = 100             @点数
 201 010c C165     	        str r1, [r0, # 0x5c]
 202 010e A649     	        ldr r1, = 0x35b1         @ 储存到外设
 203 0110 8165     	        str r1, [r0, # 0x58]
 204              	
 205              	tim1chushiha:
 206 0112 A648     	        ldr r0, = 0x40012c00 @ tim1_cr1
 207 0114 0021     	        movs r1, # 0
 208 0116 8162     	        str r1, [r0, # 0x28] @ psc
 209 0118 A549     	        ldr r1, = 47
 210 011a C162     	        str r1, [r0, # 0x2c] @ ARR
 211 011c A549     	        ldr r1, = 0x68
 212 011e C161     	        str r1, [r0, # 0x1c] @ ccmr2  CC3
 213 0120 A549     	        ldr r1, = 0x100    @  CC3
ARM GAS  1.s 			page 5


 214 0122 0162     	        str r1, [r0, # 0x20] @ ccer
 215 0124 A549     	        ldr r1, = 0x8000
 216 0126 4164     	        str r1, [r0, # 0x44] @ BDTR
 217 0128 A549     	        ldr r1, = 0x800 @ CC3 DMA
 218 012a C160     	        str r1, [r0, # 0x0c] @ DIER
 219 012c A549     	        ldr r1, = 0xe1
 220 012e 0160     	        str r1, [r0]
 221              	
 222              	_adcchushihua:
 223 0130 A548     	        ldr r0, = 0x40012400  @ adc基地址
 224 0132 A649     		ldr r1, = 0x80000000
 225 0134 8160     	        str r1, [r0, # 0x08]  @ ADC 控制寄存器 (ADC_CR)  @adc校准
 226              	_dengadcjiaozhun:
 227 0136 8168     	        ldr r1, [r0, # 0x08]
 228 0138 0900     	         movs r1, r1
 229 013a FCD4     	        bmi _dengadcjiaozhun   @ 等ADC校准
 230              	_kaiadc:
 231 013c 8168     	        ldr r1, [r0, # 0x08]
 232 013e 0122     	        movs r2, # 0x01
 233 0140 1143     	        orrs r1, r1, r2
 234 0142 8160     	        str r1, [r0, # 0x08]
 235              	_dengdaiadcwending:
 236 0144 0168     	        ldr r1, [r0]
 237 0146 C907     	        lsls r1, r1, # 31
 238 0148 FCD5     	        bpl _dengdaiadcwending @ 等ADC稳定
 239              	_tongdaoxuanze:
 240 014a A149     	        ldr r1, = 1
 241 014c 8162     	        str r1, [r0, # 0x28]    @ 通道选择寄存器 (ADC_CHSELR)
 242 014e A149     	        ldr r1, = 0x3000
 243 0150 C160     	        str r1, [r0, # 0x0c]    @ 配置寄存器 1 (ADC_CFGR1)
 244 0152 0021     	        movs r1, # 0
 245 0154 4161     	        str r1, [r0, # 0x14]    @ ADC 采样时间寄存器 (ADC_SMPR)
 246 0156 8168     	        ldr r1, [r0, # 0x08]
 247 0158 9F4A     	        ldr r2, = 0x04         @ 开始转换
 248 015a 1143     	        orrs r1, r1, r2
 249 015c 8160     	        str r1, [r0, # 0x08]    @ 控制寄存器 (ADC_CR)
 250              	
 251              	
 252              	_lcdchushihua:
 253 015e 3320     		movs r0, # 0x33
 254 0160 0021     		movs r1, # 0
 255 0162 00F092F8 		bl _xielcd
 256 0166 00F08BF8 		bl _lcdyanshi
 257 016a 3220     		movs r0, # 0x32
 258 016c 0021     		movs r1, # 0
 259 016e 00F08CF8 		bl _xielcd
 260 0172 00F085F8 		bl _lcdyanshi
 261 0176 2820     		movs r0, # 0x28
 262 0178 0021     		movs r1, # 0
 263 017a 00F086F8 		bl _xielcd
 264 017e 00F07FF8 		bl _lcdyanshi
 265 0182 0C20     		movs r0, # 0x0c
 266 0184 0021     		movs r1, # 0
 267 0186 00F080F8 		bl _xielcd
 268 018a 00F079F8 		bl _lcdyanshi
 269 018e 0120     		movs r0, # 0x01
 270 0190 0021     		movs r1, # 0
ARM GAS  1.s 			page 6


 271 0192 00F07AF8 		bl _xielcd
 272 0196 00F073F8 		bl _lcdyanshi
 273              	
 274              	
 275 019a C420     		movs r0, # 0xc4
 276 019c 8F49     		ldr r1, = xushu
 277 019e 0122     		movs r2, # 1
 278 01a0 FF23     		movs r3, # 0xff
 279 01a2 00F05FF8 		bl _lcdxianshi
 280              	ting:
 281 01a6 8E48     		ldr r0, = 0x40012428
 282 01a8 0121     		movs r1, # 1
 283 01aa 0160     		str r1, [r0]
 284 01ac 1920     		movs r0, # 25
 285 01ae 00F027F8 		bl _jianbo
 286 01b2 0346     		mov r3, r0
 287 01b4 8B48     	        ldr r0, = lvboqihuanchong
 288 01b6 8049     	        ldr r1, = 256
 289 01b8 8B4A     	        ldr r2, = lvboqizhizhen
 290 01ba 00F03FF8 	        bl _lvboqi1
 291 01be 0421     		movs r1, # 4
 292 01c0 6E4A     		ldr r2, = asciimabiao
 293 01c2 FF23     		movs r3, # 0xff
 294 01c4 00F0A3F8 		bl _zhuanascii
 295 01c8 C020     		movs r0, # 0xc0
 296 01ca 6C49     		ldr r1, = asciimabiao
 297 01cc 0422     		movs r2, # 4
 298 01ce 00F049F8 		bl _lcdxianshi
 299              	
 300 01d2 8348     	        ldr r0, = 0x40012428
 301 01d4 0221     	        movs r1, # 2
 302 01d6 0160     	        str r1, [r0]
 303 01d8 3220     	        movs r0, # 50
 304 01da 00F011F8 		bl _jianbo
 305 01de 0346     	        mov r3,	r0
 306 01e0 8248     	        ldr r0, = lvboqihuanchong1
 307 01e2 7549     	        ldr r1, = 256
 308 01e4 824A     		ldr r2, = lvboqizhizhen1
 309 01e6 00F029F8 		bl _lvboqi1
 310 01ea 0421     	        movs r1, # 4
 311 01ec 634A     		ldr r2, = asciimabiao
 312 01ee FF23     	        movs r3, # 0xff
 313 01f0 00F08DF8 	        bl _zhuanascii
 314 01f4 8020     	        movs r0, # 0x80
 315 01f6 6149     	        ldr r1, = asciimabiao
 316 01f8 0422     	        movs r2, # 4
 317 01fa 00F033F8 	        bl _lcdxianshi
 318              	
 319              	
 320 01fe D2E7     		b ting
 321              		
 322              	
 323              	_jianbo:				@ 检波 @ 入口 R0=度数
 324 0200 0EB5     		push {r1-r3,lr}
 325 0202 7C49     		ldr r1, = 0x4002005c
 326 0204 7C4A     		ldr r2, = 0x40012440
 327 0206 72B6     		cpsid i
ARM GAS  1.s 			page 7


 328              	_jianbo90du:
 329 0208 0B68     		ldr r3, [r1]
 330 020a 8342     		cmp r3, r0 
 331 020c FCD1     		bne _jianbo90du
 332 020e 1068     		ldr r0, [r2]
 333 0210 62B6     		cpsie i
 334 0212 1CBD     		pop {r2-r4,pc}
 335              	
 336              	_lvboqi:
 337              				@滤波器
 338              				@R0=地址，R1=长度,r2=表指针地址,r3=ADC数值
 339              				@出R0=结果
 340 0214 FEB5     		push {r1-r7,lr}	
 341 0216 1568     		ldr r5, [r2]		@读出表指针
 342 0218 4E00     		lsls r6, r1, # 1	
 343 021a 4353     		strh r3, [r0, r5]	@数值写到滤波器缓冲区
 344 021c 0235     		adds r5, r5, # 2
 345 021e B542     		cmp r5, r6
 346 0220 00D1     		bne _lvboqimeidaohuanchongquding
 347 0222 0025     		movs r5, # 0
 348              	_lvboqimeidaohuanchongquding:
 349 0224 1560     		str r5, [r2]
 350 0226 0027     		movs r7, # 0
 351              	_lvboqixunhuan:
 352 0228 B542     		cmp r5, r6
 353 022a 00D1     		bne _lvbozonghe
 354 022c 0025     		movs r5, # 0
 355              	_lvbozonghe:
 356 022e 445B     		ldrh r4, [r0, r5]
 357 0230 0235     		adds r5, r5, # 2
 358 0232 3F19     		adds r7, r7, r4
 359 0234 0139     		subs r1, r1, # 1
 360 0236 F7D1     		bne _lvboqixunhuan
 361 0238 3812     		asrs r0, r7, # 8	@修改
 362 023a FEBD     		pop {r1-r7,pc}
 363              	
 364              	_lvboqi1:
 365              				@滤波器
 366              				@R0=地址，R1=长度,r2=表指针地址,r3=ADC数值
 367              				@出R0=结果
 368 023c FEB5     		push {r1-r7,lr}	
 369 023e 1568     		ldr r5, [r2]		@读出表指针
 370 0240 4E00     		lsls r6, r1, # 1	
 371 0242 4353     		strh r3, [r0, r5]	@数值写到滤波器缓冲区
 372 0244 0235     		adds r5, r5, # 2
 373 0246 B542     		cmp r5, r6
 374 0248 00D1     		bne _lvboqimeidaohuanchongquding1
 375 024a 0025     		movs r5, # 0
 376              	_lvboqimeidaohuanchongquding1:
 377 024c 1560     		str r5, [r2]
 378 024e 0027     		movs r7, # 0
 379              	_lvboqixunhuan1:
 380 0250 B542     		cmp r5, r6
 381 0252 00D1     		bne _lvbozonghe1
 382 0254 0025     		movs r5, # 0
 383              	_lvbozonghe1:
 384 0256 445B     		ldrh r4, [r0, r5]
ARM GAS  1.s 			page 8


 385 0258 0235     		adds r5, r5, # 2
 386 025a 3F19     		adds r7, r7, r4
 387 025c 0139     		subs r1, r1, # 1
 388 025e F7D1     		bne _lvboqixunhuan1
 389 0260 3812     		asrs r0, r7, # 8	@修改
 390 0262 FEBD     		pop {r1-r7,pc}
 391              	
 392              		
 393              	_lcdxianshi:	  		@r0=LCD位置，r1=数据地址，r2=长度
 394 0264 1FB5     		push {r0-r4,lr}
 395 0266 0C46     		mov r4, r1
 396              	
 397 0268 0021     		movs r1, # 0
 398 026a 00F00EF8 		bl _xielcd
 399              	
 400 026e 0121     		movs r1, # 1
 401 0270 0023     		movs r3, # 0
 402              	_lcdxianshixunhuan:
 403 0272 E05C     		ldrb r0, [r4,r3]
 404 0274 00F009F8 		bl _xielcd
 405 0278 0133     		adds r3, r3, # 1
 406 027a 9342     		cmp r3, r2
 407 027c F9D1     		bne _lcdxianshixunhuan
 408 027e 1FBD     		pop {r0-r4,pc}
 409              	
 410              	_lcdyanshi:
 411 0280 20B5     		push {r5,lr}
 412 0282 5E4D     		ldr r5, = 0x2000
 413              	_lcdyanshixunhuan:
 414 0284 013D     		subs r5, r5, # 1
 415 0286 FDD1     		bne _lcdyanshixunhuan
 416 0288 20BD     		pop {r5,pc}
 417              	
 418              	_xielcd:			@入R0=8位,r1=0命令,r1=1数据
 419 028a 3FB5     		push {r0-r5,lr}
 420 028c 5C4C     		ldr r4, = xiangminkaiguan  @ 相敏开关
 421 028e 0246     		mov r2, r0
 422 0290 2568     		ldr r5, [r4]
 423 0292 1209     		lsrs r2, r2, # 4
 424 0294 9200     		lsls r2, r2, # 2	@ 高四位
 425 0296 0007     		lsls r0, r0, # 28
 426 0298 800E     		lsrs r0, r0, # 26	@ 低四位
 427 029a C907     		lsls r1, r1, # 31
 428 029c 01D5     		bpl __lcd_ming_ling
 429              	__lcd_shu_ju:
 430 029e 0323     		movs r3, # 0x03		@ RS = 1 E = 1
 431 02a0 00E0     		b __xiang_min_kai_guan
 432              	__lcd_ming_ling:
 433 02a2 0223     		movs r3, # 0x02		@ RS = 0 E = 1
 434              	__xiang_min_kai_guan:
 435 02a4 402D     		cmp r5, # 0x40
 436 02a6 01D1     		bne __kai_zheng_xiang_wei
 437 02a8 8025     		movs r5, # 0x80
 438 02aa 00E0     		b __xie_lcd_shu_ju
 439              	__kai_zheng_xiang_wei:	
 440 02ac 4025     		movs r5, # 0x40
 441              	__xie_lcd_shu_ju:
ARM GAS  1.s 			page 9


 442 02ae 2560     		str r5, [r4]
 443 02b0 5B19     		adds r3, r3, r5
 444 02b2 0146     		mov r1, r0
 445 02b4 D218     		adds r2, r2, r3
 446 02b6 1000     		movs r0, r2
 447 02b8 00F00BF8 		bl __74hc595
 448 02bc 0238     		subs r0, r0, # 0x02
 449 02be 00F008F8 		bl __74hc595
 450 02c2 0846     		mov r0, r1
 451 02c4 C018     		adds r0, r0, r3
 452 02c6 00F004F8 		bl __74hc595
 453 02ca 0238     		subs r0, r0, # 0x02
 454 02cc 00F001F8 		bl __74hc595
 455 02d0 3FBD     		pop {r0-r5,pc}
 456              		
 457              	__74hc595:			@ 入R0=8位
 458 02d2 FFB5     		push {r0-r7,lr}
 459 02d4 2D4E     		ldr r6, = 0x48000000
 460 02d6 2025     		movs r5, # 0x20		@ SRCLK
 461 02d8 4022     		movs r2, # 0x40		@ RCLK
 462 02da 8023     		movs r3, # 0x80		@ SER
 463 02dc 1824     		movs r4, # 24
 464              	__595_yiweixunhuan:
 465 02de B261     		str r2, [r6, # 0x18]	@ rclk=0
 466 02e0 B561     		str r5, [r6, # 0x18]	@ srclk=0
 467 02e2 FF27     		movs r7, # 0xff
 468              	__595_yanshi:
 469 02e4 013F     		subs r7, r7, # 1
 470 02e6 FDD1     		bne __595_yanshi
 471 02e8 0146     		mov r1, r0
 472 02ea A140     		lsls r1, r1, r4
 473 02ec 01D5     		bpl __ser_0
 474              	__ser_1:
 475 02ee B362     		str r3, [r6, # 0x28]	@ ser=1
 476 02f0 00E0     		b __595_yiwei
 477              	__ser_0:
 478 02f2 B361     		str r3, [r6, # 0x18]	@ ser=0
 479              	__595_yiwei:
 480 02f4 B562     		str r5, [r6, # 0x28]
 481 02f6 FF27     		movs r7, # 0xff
 482              	__595_yanshi1:
 483 02f8 013F     		subs r7, r7, # 1
 484 02fa FDD1     		bne __595_yanshi1
 485 02fc 0134     		adds r4, r4, # 1
 486 02fe 202C     		cmp r4, # 32
 487 0300 EDD1     		bne __595_yiweixunhuan
 488 0302 B262     		str r2, [r6, # 0x28]	@ rclk=1
 489 0304 FF27     		movs r7, # 0xff
 490              	__595_yanshi2:
 491 0306 013F     		subs r7, r7, # 1
 492 0308 FDD1     		bne __595_yanshi2
 493 030a B261     		str r2, [r6, # 0x18]	@ rclk = 0
 494 030c FFBD     		pop {r0-r7,pc}
 495              	
 496              	
 497              	
 498              	_zhuanascii:					@ 16进制转ASCII
ARM GAS  1.s 			page 10


 499              			@ R0要转的数据， R1长度，R2结果表首地址, r3=小数点位置
 500 030e FFB5     		push {r0-r7,lr}
 501 0310 1F46     		mov r7, r3
 502 0312 0546     		mov r5, r0
 503 0314 0E46     		mov r6, r1
 504 0316 0A21     		movs r1, # 10
 505              	_xunhuanqiuma:
 506 0318 00F012F8 		bl _chufa
 507 031c 0446     		mov r4, r0
 508 031e 4C43     		muls r4, r1
 509 0320 2B1B     		subs r3, r5, r4
 510 0322 3033     		adds r3, r3, # 0x30
 511 0324 0546     		mov r5, r0
 512 0326 013E     		subs r6, r6, # 1
 513 0328 08D0     		beq _qiumafanhui
 514 032a BE42     		cmp r6, r7
 515 032c 02D1     		bne _meidaoxiaoshudian
 516 032e 2E24     		movs r4, # 0x2e		@小数点
 517 0330 9455     		strb r4, [r2,r6]	@插入小数点
 518 0332 013E     		subs r6, r6, # 1
 519              	_meidaoxiaoshudian:
 520 0334 9355     		strb r3, [r2,r6]
 521 0336 3600     		movs r6, r6
 522 0338 EED1     		bne _xunhuanqiuma
 523 033a FFBD     		pop {r0-r7,pc}
 524              	_qiumafanhui:
 525 033c 9355     		strb r3, [r2, r6]
 526 033e FFBD     		pop {r0-r7,pc}
 527              	
 528              		
 529              	_chufa:				@软件除法
 530              		@ r0 除以 r1 等于 商(r0)余数R1
 531 0340 1EB5     		push {r1-r4,lr}
 532 0342 0028     		cmp r0, # 0
 533 0344 0ED0     		beq _chufafanhui
 534 0346 0029     		cmp r1, # 0
 535 0348 0CD0     		beq _chufafanhui
 536 034a 0246     		mov r2, r0
 537 034c 0123     		movs r3, # 1
 538 034e DB07     		lsls r3, r3, # 31
 539 0350 0020     		movs r0, # 0
 540 0352 0446     		mov r4, r0
 541              	_chufaxunhuan:
 542 0354 5200     		lsls r2, r2, # 1
 543 0356 6441     		adcs r4, r4, r4
 544 0358 8C42     		cmp r4, r1
 545 035a 01D3     		bcc _chufaweishubudao0
 546 035c C018     		adds r0, r0, r3
 547 035e 641A     		subs r4, r4, r1
 548              	_chufaweishubudao0:
 549 0360 5B08     		lsrs r3, r3, # 1
 550 0362 F7D1     		bne _chufaxunhuan
 551              	_chufafanhui:
 552 0364 1EBD     		pop {r1-r4,pc}
 553 0366 00000020 		.ltorg
 553      02400010 
 553      02400100 
ARM GAS  1.s 			page 11


 553      01000200 
 553      11000100 
 554              	
 555              	
 556              	_nmi_handler:
 557 0404 7047     		bx lr
 558              	_hard_fault:
 559 0406 7047     		bx lr
 560              	_svc_handler:
 561 0408 7047     		bx lr
 562              	_pendsv_handler:
 563 040a 7047     		bx lr
 564              	_systickzhongduan:
 565 040c 034A     		ldr r2, = jishu
 566 040e 0448     		ldr r0, = 0xe0000d04
 567 0410 1368     		ldr r3, [r2]
 568 0412 0449     		ldr r1, = 0x02000000
 569 0414 0133     		adds r3, r3, # 1
 570 0416 1360     		str r3, [r2]
 571 0418 0160     		str r1, [r0]                 @ 清除SYSTICK中断
 572              	aaa:
 573 041a 70473400 		bx lr
 573      0020040D 
 573      00E00000 
 573      0002
ARM GAS  1.s 			page 12


DEFINED SYMBOLS
                 1.s:9      .data:0000000000000000 zheng_xian_biao
                 1.s:11     .data:00000000000000ca lcdshuju
                 1.s:13     .data:00000000000000da dianhua
                 1.s:15     .data:00000000000000ea qq
                 1.s:17     .data:00000000000000fa xushu
                 1.s:19     .data:00000000000000fb fu
                 1.s:21     .data:00000000000000fc zheng
                 1.s:23     .data:00000000000000fd xiaomai
                 1.s:25     *ABS*:0000000020001000 STACKINIT
                 1.s:26     *ABS*:0000000020000000 asciimabiao
                 1.s:27     *ABS*:0000000020000030 xiangminkaiguan
                 1.s:28     *ABS*:0000000020000034 jishu
                 1.s:29     *ABS*:0000000020000038 jianbo
                 1.s:30     *ABS*:0000000020000040 dianyabiao
                 1.s:31     *ABS*:0000000020000050 lvboqizhizhen
                 1.s:32     *ABS*:0000000020000054 lvboqihuanchong
                 1.s:33     *ABS*:0000000020000550 lvboqizhizhen1
                 1.s:34     *ABS*:0000000020000554 lvboqihuanchong1
                 1.s:36     .text:0000000000000000 vectors
                 1.s:83     .text:00000000000000b0 _start
                 1.s:556    .text:0000000000000404 _nmi_handler
                 1.s:558    .text:0000000000000406 _hard_fault
                 1.s:560    .text:0000000000000408 _svc_handler
                 1.s:562    .text:000000000000040a _pendsv_handler
                 1.s:564    .text:000000000000040c _systickzhongduan
                 1.s:572    .text:000000000000041a aaa
                            .text:0000000000000000 $d
                 1.s:81     .text:00000000000000b0 $t
                 1.s:84     .text:00000000000000b0 shizhong
                 1.s:91     .text:00000000000000bc denghse
                 1.s:95     .text:00000000000000c2 dengpllguan
                 1.s:103    .text:00000000000000d0 dengpll
                 1.s:110    .text:00000000000000da dengdai14mshizhongwending
                 1.s:115    .text:00000000000000e0 _neicunqingling
                 1.s:119    .text:00000000000000e6 _neicunqinglingxunhuan
                 1.s:124    .text:00000000000000ec _waisheshizhong
                 1.s:141    .text:00000000000000f6 _waishezhongduan
                 1.s:156    .text:00000000000000f6 io_she_zhi
                 1.s:184    .text:0000000000000100 dmachushihua
                 1.s:205    .text:0000000000000112 tim1chushiha
                 1.s:222    .text:0000000000000130 _adcchushihua
                 1.s:226    .text:0000000000000136 _dengadcjiaozhun
                 1.s:230    .text:000000000000013c _kaiadc
                 1.s:235    .text:0000000000000144 _dengdaiadcwending
                 1.s:239    .text:000000000000014a _tongdaoxuanze
                 1.s:252    .text:000000000000015e _lcdchushihua
                 1.s:418    .text:000000000000028a _xielcd
                 1.s:410    .text:0000000000000280 _lcdyanshi
                 1.s:393    .text:0000000000000264 _lcdxianshi
                 1.s:280    .text:00000000000001a6 ting
                 1.s:323    .text:0000000000000200 _jianbo
                 1.s:364    .text:000000000000023c _lvboqi1
                 1.s:498    .text:000000000000030e _zhuanascii
                 1.s:328    .text:0000000000000208 _jianbo90du
                 1.s:336    .text:0000000000000214 _lvboqi
                 1.s:348    .text:0000000000000224 _lvboqimeidaohuanchongquding
ARM GAS  1.s 			page 13


                 1.s:351    .text:0000000000000228 _lvboqixunhuan
                 1.s:355    .text:000000000000022e _lvbozonghe
                 1.s:376    .text:000000000000024c _lvboqimeidaohuanchongquding1
                 1.s:379    .text:0000000000000250 _lvboqixunhuan1
                 1.s:383    .text:0000000000000256 _lvbozonghe1
                 1.s:402    .text:0000000000000272 _lcdxianshixunhuan
                 1.s:413    .text:0000000000000284 _lcdyanshixunhuan
                 1.s:432    .text:00000000000002a2 __lcd_ming_ling
                 1.s:429    .text:000000000000029e __lcd_shu_ju
                 1.s:434    .text:00000000000002a4 __xiang_min_kai_guan
                 1.s:439    .text:00000000000002ac __kai_zheng_xiang_wei
                 1.s:441    .text:00000000000002ae __xie_lcd_shu_ju
                 1.s:457    .text:00000000000002d2 __74hc595
                 1.s:464    .text:00000000000002de __595_yiweixunhuan
                 1.s:468    .text:00000000000002e4 __595_yanshi
                 1.s:477    .text:00000000000002f2 __ser_0
                 1.s:474    .text:00000000000002ee __ser_1
                 1.s:479    .text:00000000000002f4 __595_yiwei
                 1.s:482    .text:00000000000002f8 __595_yanshi1
                 1.s:490    .text:0000000000000306 __595_yanshi2
                 1.s:505    .text:0000000000000318 _xunhuanqiuma
                 1.s:529    .text:0000000000000340 _chufa
                 1.s:524    .text:000000000000033c _qiumafanhui
                 1.s:519    .text:0000000000000334 _meidaoxiaoshudian
                 1.s:551    .text:0000000000000364 _chufafanhui
                 1.s:541    .text:0000000000000354 _chufaxunhuan
                 1.s:548    .text:0000000000000360 _chufaweishubudao0
                 1.s:553    .text:0000000000000366 $d
                 1.s:553    .text:0000000000000368 $d
                 1.s:557    .text:0000000000000404 $t
                 1.s:573    .text:000000000000041c $d

NO UNDEFINED SYMBOLS
