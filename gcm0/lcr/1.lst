ARM GAS  1.s 			page 1


   1              		@@ 单片机stm32f030f4p6
   2              		@@ 阻抗桥
   3              		@作者：yjmwxwx
   4              		@时间：2019-08-12
   5              		@编译器：ARM-NONE-EABI
   6              		 .thumb
   7              		         .syntax unified
   8              	.section .data
   9              	zheng_xian_biao:
  10 0000 18001900 		.short 24,25,26,28,29,31,32,34,35,36,37,38,40,41,42,43,43,44,45,45,46,46,47,47,47,47,47,47,47,46,4
  10      1A001C00 
  10      1D001F00 
  10      20002200 
  10      23002400 
  11              	lcdshuju:
  12 00ca 796A6D77 		.ascii  "yjmwxwx-20190812"
  12      7877782D 
  12      32303139 
  12      30383132 
  13              	dianhua:	
  14 00da 20202020 		.ascii	"     15552208295"
  14      20313535 
  14      35323230 
  14      38323935 
  15              	qq:
  16 00ea 20202051 		.ascii	"   QQ:3341656346"
  16      513A3333 
  16      34313635 
  16      36333436 
  17              	xushu:
  18 00fa 6A       		.ascii "j"
  19              	fu:
  20 00fb 2D       		.ascii "-"
  21              	zheng:
  22 00fc 2B       		.ascii "+"
  23              	xiaomai:
  24 00fd 7869616F 		.ascii "xiaomai ="
  24      6D616920 
  24      3D
  25              		.equ STACKINIT,        	        0x20001000
  26              		.equ asciimabiao,		0x20000000
  27              		.equ xiangminkaiguan,		0x20000030
  28              		.equ jishu,			0x20000034
  29              		.equ jianbo,			0x20000038
  30              		.equ dianyabiao,		0x20000040
  31              		.equ lvboqizhizhen,		0x20000050
  32              		.equ lvboqihuanchong,		0x20000054
  33              		.equ lvboqizhizhen1,		0x20000550
  34              		.equ lvboqihuanchong1,		0x20000554
  35              	
  36              		.section .text
  37              	vectors:
  38 0000 00100020 		.word STACKINIT
  39 0004 B1000000 		.word _start + 1
  40 0008 E9030000 		.word _nmi_handler + 1
  41 000c EB030000 		.word _hard_fault  + 1
  42 0010 00000000 		.word 0
ARM GAS  1.s 			page 2


  43 0014 00000000 		.word 0
  44 0018 00000000 		.word 0
  45 001c 00000000 		.word 0
  46 0020 00000000 		.word 0
  47 0024 00000000 		.word 0
  48 0028 00000000 		.word 0
  49 002c ED030000 		.word _svc_handler +1
  50 0030 00000000 		.word 0
  51 0034 00000000 		.word 0
  52 0038 EF030000 		.word _pendsv_handler +1
  53 003c F1030000 		.word _systickzhongduan +1               @ 15
  54 0040 FF030000 		.word aaa +1     @ _wwdg +1          @ 0
  55 0044 FF030000 		.word aaa +1     @_pvd +1            @ 1
  56 0048 FF030000 		.word aaa +1     @_rtc +1            @ 2
  57 004c FF030000 		.word aaa +1     @_flash +1          @ 3
  58 0050 FF030000 		.word aaa +1	@ _rcc + 1          @ 4
  59 0054 FF030000 		.word aaa +1      @_exti0_1  +1      @ 5
  60 0058 FF030000 		.word aaa +1      @ _exti2_3 +1      @ 6
  61 005c FF030000 		.word aaa +1       @_exti4_15 +1     @ 7
  62 0060 FF030000 		.word aaa +1                         @ 8
  63 0064 FF030000 		.word aaa +1 	@_dma1_1  +1    @ 9
  64 0068 FF030000 		.word aaa +1    @_dma1_2_3 +1        @ 10
  65 006c FF030000 		.word aaa +1       @_dma1_4_5 +1     @ 11
  66 0070 FF030000 		.word aaa +1	 @_adc1 +1          @ 12
  67 0074 FF030000 		.word aaa +1       @_tim1_brk_up +1  @ 13
  68 0078 FF030000 		.word aaa +1        @ _tim1_cc +1    @ 14
  69 007c FF030000 		.word aaa +1         @_tim2 +1       @ 15
  70 0080 FF030000 		.word aaa +1          @_tim3 +1      @ 16
  71 0084 FF030000 		.word aaa +1                         @ 17
  72 0088 FF030000 		.word aaa +1		                @ 18
  73 008c FF030000 		.word aaa +1	@_tim14 +1    @ 19
  74 0090 FF030000 		.word aaa +1                         @ 20
  75 0094 FF030000 		.word aaa +1         @_tim16 +1      @ 21
  76 0098 FF030000 		.word aaa +1         @_tim17 +1      @ 22
  77 009c FF030000 		.word aaa +1          @_i2c   +1     @ 23
  78 00a0 FF030000 		.word aaa +1                         @ 24
  79 00a4 FF030000 		.word aaa +1           @_spi   +1    @ 25
  80 00a8 FF030000 		.word aaa +1                         @ 26
  81 00ac FF030000 		.word aaa +1         @_usart1 +1     @ 27
  82              		.align 2
  83              	
  84              	_start:
  85              	shizhong:
  86 00b0 A54A     		ldr r2, = 0x40022000   @FLASH访问控制
  87 00b2 3221     		movs r1, # 0x32
  88 00b4 1160     		str r1, [r2]           @FLASH缓冲 缓冲开启
  89 00b6 A548     		ldr r0, = 0x40021000 @ rcc
  90 00b8 A549     		ldr r1, = 0x10001
  91 00ba 0160     		str r1, [r0]
  92              	denghse:
  93 00bc 0168     		ldr r1, [r0]
  94 00be 8903     		lsls r1, r1, # 14
  95 00c0 FCD5     		bpl denghse
  96              	dengpllguan:
  97 00c2 0168     		ldr r1, [r0]
  98 00c4 8901     		lsls r1, r1, # 6
  99 00c6 FCD4     		bmi dengpllguan
ARM GAS  1.s 			page 3


 100 00c8 A249     	        ldr r1, = 0x110002
 101 00ca 4160     	        str r1, [r0, # 0x04]
 102 00cc A249     		ldr r1, = 0x1010001
 103 00ce 0160     		str r1, [r0]
 104              	dengpll:
 105 00d0 0168     		ldr r1, [r0]
 106 00d2 8901     		lsls r1, # 6
 107 00d4 FCD5     		bpl dengpll
 108              		@0x34时钟控制寄存器 2 (RCC_CR2)
 109 00d6 0121     		movs r1, # 0x01
 110 00d8 4163     		str r1, [r0, # 0x34]  @ HSI开14M时钟
 111              	dengdai14mshizhongwending:
 112 00da 416B     		ldr r1, [r0, # 0x34]
 113 00dc 8907     		lsls r1, r1, # 30     @ 左移30位
 114 00de FCD5     		bpl dengdai14mshizhongwending  @ 等待14M时钟稳定
 115              	
 116              	_neicunqingling:
 117 00e0 9E48     		ldr r0, = 0x20000000
 118 00e2 0021     		movs r1, # 0
 119 00e4 9E4B     		ldr r3, = 0x1000
 120              	_neicunqinglingxunhuan:
 121 00e6 043B     		subs r3, # 4
 122 00e8 C150     		str r1, [r0, r3]
 123 00ea FCD1     		bne _neicunqinglingxunhuan
 124              	
 125              	_waisheshizhong:			 @ 外设时钟
 126              		@+0x14=RCC_AHBENR
 127              		@0=DMA @2=SRAM @4=FLITF@6=CRC @17=PA @18=PB @19=PC @20=PD @22=PF
 128 00ec 9748     		ldr r0, = 0x40021000
 129 00ee 9D49     		ldr r1, = 0x460005
 130 00f0 4161     		str r1, [r0, # 0x14]
 131              	
 132              		@+0x18外设时钟使能寄存器 (RCC_APB2ENR)
 133              		@0=SYSCFG @5=USART6EN @9=ADC @11=TIM1 @12=SPI1 @14=USART1 @16=TIM15 @17=TIM16 @18=TIM17 @22=DBGMCU
 134 00f2 9D49     		ldr r1, = 0xa00
 135 00f4 8161     		str r1, [r0, # 0x18]
 136              		@+0X1C=RCC_APB1ENR
 137              		@1=TIM3 @4=TIM6 @5=TIM7 @8=TIM14 @11=WWDG @14=SPI @17=USRT2 @18=USART3 @20=USART5 @21=I2C1
 138              		@22=I2C2 @23=USB @28=PWR
 139              	
 140              	
 141              	
 142              	_waishezhongduan:				@外设中断
 143              		@0xE000E100    0-31  写1开，写0没效
 144              		@0XE000E180    0-31 写1关，写0没效
 145              		@0XE000E200    0-31 挂起，写0没效
 146              		@0XE000E280    0-31 清除， 写0没效
 147              	
 148              	@_systick:				@ systick定时器初始化
 149              	
 150              	@	ldr r0, = 0xe000e010
 151              	@	ldr r1, = 0xffffff
 152              	@	str r1, [r0, # 4]
 153              	@	str r1, [r0, # 8]
 154              	@	movs r1, # 0x07
 155              	@	str r1, [r0]
 156              		
ARM GAS  1.s 			page 4


 157              	io_she_zhi:
 158              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 159              		@a(0x48000000)b(0x48000400)c(0x48000800)d(0x48000c00)f(0x48001400)
 160              		@ 输入（00），通用输出（01），复用功能（10），模拟（11）
 161              		@偏移0x4 = 端口输出类型 @ （0 推挽），（ 1 开漏）
 162              		@偏移0x8 = 输出速度  00低速， 01中速， 11高速
 163              		@偏移0xC = 上拉下拉 (00无上下拉，  01 上拉， 10下拉)
 164              		@偏移0x10 = 输入数据寄存器
 165              		@偏移0x14 = 输出数据寄存器
 166              		@偏移0x18 = 端口开  0-15置位
 167              		@偏移0x28 = 端口关
 168              		@0X20 = 复用低
 169              		@GPIO口0（0-3位）每个IO口占用4位
 170              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 171              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 172              		@0x24 = 复用高
 173              		@GPIO口8 （0-3位）每个IO口占用4位
 174              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 175              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 176              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 177              	
 178 00f6 9D48     		ldr r0, = 0x48000000
 179 00f8 9D49     		ldr r1, = 0x2820540f
 180 00fa 0160     		str r1, [r0]
 181 00fc 9D49     		ldr r1, = 0x200
 182 00fe 4162     		str r1, [r0, # 0x24]
 183              	
 184              		
 185              	dmachushihua:
 186              	        @+0=LSR,+4=IFCR,
 187              	        @+8=CCR1,+c=CNDTR1,+10=CPAR1+14=CMAR1,
 188              	        @+1c=CCR2,+20=CNDTR2,+24=CPAR2,+28=CMAR2
 189              	        @+30=CCR3,+34=CNDTR3,+38=CPAR2,+3c=CMAR3
 190              	        @+44=CCR4,+48=CNDTR4,+4c=CPAR4,+50=CMAR4
 191              	        @+58=CCR5,+5c=CNDTR5,+60=CPAR5,+64=CMAR5
 192              	        @+6C=CCR6,+70=CNDTR6,+74=CPAR6,+78=CMAR6
 193              	        @+80=CCR7,+84=CNDTR7,+88=CPAR7,+8c=CMAR7
 194              	
 195              	        @tim1ch3DMA
 196 0100 9D48     	        ldr r0, = 0x40020000
 197 0102 9E49     	        ldr r1, = 0x40012c3c @ 外设地址
 198 0104 0166     	        str r1, [r0, # 0x60]
 199 0106 9E49     	        ldr r1, = zheng_xian_biao @ 储存器地址
 200 0108 4166     	        str r1, [r0, # 0x64]
 201 010a 9E49     	        ldr r1, = 100             @点数
 202 010c C165     	        str r1, [r0, # 0x5c]
 203 010e 9E49     	        ldr r1, = 0x35b1         @ 储存到外设
 204 0110 8165     	        str r1, [r0, # 0x58]
 205              	
 206              	tim1chushiha:
 207 0112 9E48     	        ldr r0, = 0x40012c00 @ tim1_cr1
 208 0114 0021     	        movs r1, # 0
 209 0116 8162     	        str r1, [r0, # 0x28] @ psc
 210 0118 9D49     	        ldr r1, = 47
 211 011a C162     	        str r1, [r0, # 0x2c] @ ARR
 212 011c 9D49     	        ldr r1, = 0x68
 213 011e C161     	        str r1, [r0, # 0x1c] @ ccmr2  CC3
ARM GAS  1.s 			page 5


 214 0120 9D49     	        ldr r1, = 0x100    @  CC3
 215 0122 0162     	        str r1, [r0, # 0x20] @ ccer
 216 0124 9D49     	        ldr r1, = 0x8000
 217 0126 4164     	        str r1, [r0, # 0x44] @ BDTR
 218 0128 9D49     	        ldr r1, = 0x800 @ CC3 DMA
 219 012a C160     	        str r1, [r0, # 0x0c] @ DIER
 220 012c 9D49     	        ldr r1, = 0xe1
 221 012e 0160     	        str r1, [r0]
 222              	
 223              	_adcchushihua:
 224 0130 9D48     	        ldr r0, = 0x40012400  @ adc基地址
 225 0132 9E49     		ldr r1, = 0x80000000
 226 0134 8160     	        str r1, [r0, # 0x08]  @ ADC 控制寄存器 (ADC_CR)  @adc校准
 227              	_dengadcjiaozhun:
 228 0136 8168     	        ldr r1, [r0, # 0x08]
 229 0138 0900     	         movs r1, r1
 230 013a FCD4     	        bmi _dengadcjiaozhun   @ 等ADC校准
 231              	_kaiadc:
 232 013c 8168     	        ldr r1, [r0, # 0x08]
 233 013e 0122     	        movs r2, # 0x01
 234 0140 1143     	        orrs r1, r1, r2
 235 0142 8160     	        str r1, [r0, # 0x08]
 236              	_dengdaiadcwending:
 237 0144 0168     	        ldr r1, [r0]
 238 0146 C907     	        lsls r1, r1, # 31
 239 0148 FCD5     	        bpl _dengdaiadcwending @ 等ADC稳定
 240              	_tongdaoxuanze:
 241 014a 9949     	        ldr r1, = 1
 242 014c 8162     	        str r1, [r0, # 0x28]    @ 通道选择寄存器 (ADC_CHSELR)
 243 014e 9949     	        ldr r1, = 0x3000
 244 0150 C160     	        str r1, [r0, # 0x0c]    @ 配置寄存器 1 (ADC_CFGR1)
 245 0152 0021     	        movs r1, # 0
 246 0154 4161     	        str r1, [r0, # 0x14]    @ ADC 采样时间寄存器 (ADC_SMPR)
 247 0156 8168     	        ldr r1, [r0, # 0x08]
 248 0158 974A     	        ldr r2, = 0x04         @ 开始转换
 249 015a 1143     	        orrs r1, r1, r2
 250 015c 8160     	        str r1, [r0, # 0x08]    @ 控制寄存器 (ADC_CR)
 251              	
 252              	
 253              	_lcdchushihua:
 254 015e 3320     		movs r0, # 0x33
 255 0160 0021     		movs r1, # 0
 256 0162 00F082F8 		bl _xielcd
 257 0166 00F07BF8 		bl _lcdyanshi
 258 016a 3220     		movs r0, # 0x32
 259 016c 0021     		movs r1, # 0
 260 016e 00F07CF8 		bl _xielcd
 261 0172 00F075F8 		bl _lcdyanshi
 262 0176 2820     		movs r0, # 0x28
 263 0178 0021     		movs r1, # 0
 264 017a 00F076F8 		bl _xielcd
 265 017e 00F06FF8 		bl _lcdyanshi
 266 0182 0C20     		movs r0, # 0x0c
 267 0184 0021     		movs r1, # 0
 268 0186 00F070F8 		bl _xielcd
 269 018a 00F069F8 		bl _lcdyanshi
 270 018e 0120     		movs r0, # 0x01
ARM GAS  1.s 			page 6


 271 0190 0021     		movs r1, # 0
 272 0192 00F06AF8 		bl _xielcd
 273 0196 00F063F8 		bl _lcdyanshi
 274              	
 275              	
 276 019a C420     		movs r0, # 0xc4
 277 019c 8749     		ldr r1, = xushu
 278 019e 0122     		movs r2, # 1
 279 01a0 FF23     		movs r3, # 0xff
 280 01a2 00F04FF8 		bl _lcdxianshi
 281 01a6 0046     		mov r0, r0
 282 01a8 0046     		mov r0, r0
 283              	ting:
 284 01aa 8548     		ldr r0, = 0x40012428
 285 01ac 0121     		movs r1, # 1
 286 01ae 0160     		str r1, [r0]
 287 01b0 3220     		movs r0, # 50
 288 01b2 00F029F8 		bl _jianbo
 289 01b6 834B     		ldr r3, = 516			@反相补偿
 290 01b8 C018     		adds r0, r0, r3
 291 01ba 0346     		mov r3, r0
 292 01bc 8248     	        ldr r0, = lvboqihuanchong
 293 01be 7649     	        ldr r1, = 256			
 294 01c0 824A     	        ldr r2, = lvboqizhizhen
 295 01c2 00F02BF8 	        bl _lvboqi
 296 01c6 0421     		movs r1, # 4
 297 01c8 644A     		ldr r2, = asciimabiao
 298 01ca FF23     		movs r3, # 0xff
 299 01cc 00F08FF8 		bl _zhuanascii
 300 01d0 C020     		movs r0, # 0xc0
 301 01d2 6249     		ldr r1, = asciimabiao
 302 01d4 0422     		movs r2, # 4
 303 01d6 00F035F8 		bl _lcdxianshi
 304              	
 305 01da 7948     	        ldr r0, = 0x40012428
 306 01dc 0221     	        movs r1, # 2
 307 01de 0160     	        str r1, [r0]
 308 01e0 1920     	        movs r0, # 25
 309 01e2 00F011F8 		bl _jianbo
 310 01e6 0346     	        mov r3,	r0
 311 01e8 7948     	        ldr r0, = lvboqihuanchong1
 312 01ea 6B49     	        ldr r1, = 256
 313 01ec 794A     		ldr r2, = lvboqizhizhen1
 314 01ee 00F015F8 		bl _lvboqi
 315 01f2 0421     	        movs r1, # 4
 316 01f4 594A     		ldr r2, = asciimabiao
 317 01f6 FF23     	        movs r3, # 0xff
 318 01f8 00F079F8 	        bl _zhuanascii
 319 01fc 8020     	        movs r0, # 0x80
 320 01fe 5749     	        ldr r1, = asciimabiao
 321 0200 0422     	        movs r2, # 4
 322 0202 00F01FF8 	        bl _lcdxianshi
 323              	
 324 0206 D0E7     		b ting
 325              		
 326              	
 327              	_jianbo:				@ 检波 @ 入口 R0=度数
ARM GAS  1.s 			page 7


 328 0208 0EB5     		push {r1-r3,lr}
 329 020a 7349     		ldr r1, = 0x4002005c
 330 020c 734A     		ldr r2, = 0x40012440
 331 020e 72B6     		cpsid i
 332              	_jianbo90du:
 333 0210 0B68     		ldr r3, [r1]
 334 0212 8342     		cmp r3, r0 
 335 0214 FCD1     		bne _jianbo90du
 336 0216 1068     		ldr r0, [r2]
 337 0218 62B6     		cpsie i
 338 021a 1CBD     		pop {r2-r4,pc}
 339              	
 340              	_lvboqi:
 341              				@滤波器
 342              				@R0=地址，R1=长度,r2=表指针地址,r3=ADC数值
 343              				@出R0=结果
 344 021c FEB5     		push {r1-r7,lr}	
 345 021e 1568     		ldr r5, [r2]		@读出表指针
 346 0220 4E00     		lsls r6, r1, # 1	
 347 0222 4353     		strh r3, [r0, r5]	@数值写到滤波器缓冲区
 348 0224 0235     		adds r5, r5, # 2
 349 0226 B542     		cmp r5, r6
 350 0228 00D1     		bne _lvboqimeidaohuanchongquding
 351 022a 0025     		movs r5, # 0
 352              	_lvboqimeidaohuanchongquding:
 353 022c 1560     		str r5, [r2]
 354 022e 0027     		movs r7, # 0
 355              	_lvboqixunhuan:
 356 0230 B542     		cmp r5, r6
 357 0232 00D1     		bne _lvbozonghe
 358 0234 0025     		movs r5, # 0
 359              	_lvbozonghe:
 360 0236 445B     		ldrh r4, [r0, r5]
 361 0238 0235     		adds r5, r5, # 2
 362 023a 3F19     		adds r7, r7, r4
 363 023c 0139     		subs r1, r1, # 1
 364 023e F7D1     		bne _lvboqixunhuan
 365 0240 3812     		asrs r0, r7, # 8	@修改
 366 0242 FEBD     		pop {r1-r7,pc}
 367              	
 368              	
 369              		
 370              	_lcdxianshi:	  		@r0=LCD位置，r1=数据地址，r2=长度
 371 0244 1FB5     		push {r0-r4,lr}
 372 0246 0C46     		mov r4, r1
 373              	
 374 0248 0021     		movs r1, # 0
 375 024a 00F00EF8 		bl _xielcd
 376              	
 377 024e 0121     		movs r1, # 1
 378 0250 0023     		movs r3, # 0
 379              	_lcdxianshixunhuan:
 380 0252 E05C     		ldrb r0, [r4,r3]
 381 0254 00F009F8 		bl _xielcd
 382 0258 0133     		adds r3, r3, # 1
 383 025a 9342     		cmp r3, r2
 384 025c F9D1     		bne _lcdxianshixunhuan
ARM GAS  1.s 			page 8


 385 025e 1FBD     		pop {r0-r4,pc}
 386              	
 387              	_lcdyanshi:
 388 0260 20B5     		push {r5,lr}
 389 0262 5F4D     		ldr r5, = 0x2000
 390              	_lcdyanshixunhuan:
 391 0264 013D     		subs r5, r5, # 1
 392 0266 FDD1     		bne _lcdyanshixunhuan
 393 0268 20BD     		pop {r5,pc}
 394              	
 395              	_xielcd:			@入R0=8位,r1=0命令,r1=1数据
 396 026a 3FB5     		push {r0-r5,lr}
 397 026c 5D4C     		ldr r4, = xiangminkaiguan  @ 相敏开关
 398 026e 0246     		mov r2, r0
 399 0270 2568     		ldr r5, [r4]
 400 0272 1209     		lsrs r2, r2, # 4
 401 0274 9200     		lsls r2, r2, # 2	@ 高四位
 402 0276 0007     		lsls r0, r0, # 28
 403 0278 800E     		lsrs r0, r0, # 26	@ 低四位
 404 027a C907     		lsls r1, r1, # 31
 405 027c 01D5     		bpl __lcd_ming_ling
 406              	__lcd_shu_ju:
 407 027e 0323     		movs r3, # 0x03		@ RS = 1 E = 1
 408 0280 00E0     		b __xiang_min_kai_guan
 409              	__lcd_ming_ling:
 410 0282 0223     		movs r3, # 0x02		@ RS = 0 E = 1
 411              	__xiang_min_kai_guan:
 412 0284 402D     		cmp r5, # 0x40
 413 0286 01D1     		bne __kai_zheng_xiang_wei
 414 0288 8025     		movs r5, # 0x80
 415 028a 00E0     		b __xie_lcd_shu_ju
 416              	__kai_zheng_xiang_wei:	
 417 028c 4025     		movs r5, # 0x40
 418              	__xie_lcd_shu_ju:
 419 028e 2560     		str r5, [r4]
 420 0290 5B19     		adds r3, r3, r5
 421 0292 0146     		mov r1, r0
 422 0294 D218     		adds r2, r2, r3
 423 0296 1000     		movs r0, r2
 424 0298 00F00BF8 		bl __74hc595
 425 029c 0238     		subs r0, r0, # 0x02
 426 029e 00F008F8 		bl __74hc595
 427 02a2 0846     		mov r0, r1
 428 02a4 C018     		adds r0, r0, r3
 429 02a6 00F004F8 		bl __74hc595
 430 02aa 0238     		subs r0, r0, # 0x02
 431 02ac 00F001F8 		bl __74hc595
 432 02b0 3FBD     		pop {r0-r5,pc}
 433              		
 434              	__74hc595:			@ 入R0=8位
 435 02b2 FFB5     		push {r0-r7,lr}
 436 02b4 2D4E     		ldr r6, = 0x48000000
 437 02b6 2025     		movs r5, # 0x20		@ SRCLK
 438 02b8 4022     		movs r2, # 0x40		@ RCLK
 439 02ba 8023     		movs r3, # 0x80		@ SER
 440 02bc 1824     		movs r4, # 24
 441              	__595_yiweixunhuan:
ARM GAS  1.s 			page 9


 442 02be B261     		str r2, [r6, # 0x18]	@ rclk=0
 443 02c0 B561     		str r5, [r6, # 0x18]	@ srclk=0
 444 02c2 FF27     		movs r7, # 0xff
 445              	__595_yanshi:
 446 02c4 013F     		subs r7, r7, # 1
 447 02c6 FDD1     		bne __595_yanshi
 448 02c8 0146     		mov r1, r0
 449 02ca A140     		lsls r1, r1, r4
 450 02cc 01D5     		bpl __ser_0
 451              	__ser_1:
 452 02ce B362     		str r3, [r6, # 0x28]	@ ser=1
 453 02d0 00E0     		b __595_yiwei
 454              	__ser_0:
 455 02d2 B361     		str r3, [r6, # 0x18]	@ ser=0
 456              	__595_yiwei:
 457 02d4 B562     		str r5, [r6, # 0x28]
 458 02d6 FF27     		movs r7, # 0xff
 459              	__595_yanshi1:
 460 02d8 013F     		subs r7, r7, # 1
 461 02da FDD1     		bne __595_yanshi1
 462 02dc 0134     		adds r4, r4, # 1
 463 02de 202C     		cmp r4, # 32
 464 02e0 EDD1     		bne __595_yiweixunhuan
 465 02e2 B262     		str r2, [r6, # 0x28]	@ rclk=1
 466 02e4 FF27     		movs r7, # 0xff
 467              	__595_yanshi2:
 468 02e6 013F     		subs r7, r7, # 1
 469 02e8 FDD1     		bne __595_yanshi2
 470 02ea B261     		str r2, [r6, # 0x18]	@ rclk = 0
 471 02ec FFBD     		pop {r0-r7,pc}
 472              	
 473              	
 474              	
 475              	_zhuanascii:					@ 16进制转ASCII
 476              			@ R0要转的数据， R1长度，R2结果表首地址, r3=小数点位置
 477 02ee FFB5     		push {r0-r7,lr}
 478 02f0 1F46     		mov r7, r3
 479 02f2 0546     		mov r5, r0
 480 02f4 0E46     		mov r6, r1
 481 02f6 0A21     		movs r1, # 10
 482              	_xunhuanqiuma:
 483 02f8 00F012F8 		bl _chufa
 484 02fc 0446     		mov r4, r0
 485 02fe 4C43     		muls r4, r1
 486 0300 2B1B     		subs r3, r5, r4
 487 0302 3033     		adds r3, r3, # 0x30
 488 0304 0546     		mov r5, r0
 489 0306 013E     		subs r6, r6, # 1
 490 0308 08D0     		beq _qiumafanhui
 491 030a BE42     		cmp r6, r7
 492 030c 02D1     		bne _meidaoxiaoshudian
 493 030e 2E24     		movs r4, # 0x2e		@小数点
 494 0310 9455     		strb r4, [r2,r6]	@插入小数点
 495 0312 013E     		subs r6, r6, # 1
 496              	_meidaoxiaoshudian:
 497 0314 9355     		strb r3, [r2,r6]
 498 0316 3600     		movs r6, r6
ARM GAS  1.s 			page 10


 499 0318 EED1     		bne _xunhuanqiuma
 500 031a FFBD     		pop {r0-r7,pc}
 501              	_qiumafanhui:
 502 031c 9355     		strb r3, [r2, r6]
 503 031e FFBD     		pop {r0-r7,pc}
 504              	
 505              		
 506              	_chufa:				@软件除法
 507              		@ r0 除以 r1 等于 商(r0)余数R1
 508 0320 1EB5     		push {r1-r4,lr}
 509 0322 0028     		cmp r0, # 0
 510 0324 0ED0     		beq _chufafanhui
 511 0326 0029     		cmp r1, # 0
 512 0328 0CD0     		beq _chufafanhui
 513 032a 0246     		mov r2, r0
 514 032c 0123     		movs r3, # 1
 515 032e DB07     		lsls r3, r3, # 31
 516 0330 0020     		movs r0, # 0
 517 0332 0446     		mov r4, r0
 518              	_chufaxunhuan:
 519 0334 5200     		lsls r2, r2, # 1
 520 0336 6441     		adcs r4, r4, r4
 521 0338 8C42     		cmp r4, r1
 522 033a 01D3     		bcc _chufaweishubudao0
 523 033c C018     		adds r0, r0, r3
 524 033e 641A     		subs r4, r4, r1
 525              	_chufaweishubudao0:
 526 0340 5B08     		lsrs r3, r3, # 1
 527 0342 F7D1     		bne _chufaxunhuan
 528              	_chufafanhui:
 529 0344 1EBD     		pop {r1-r4,pc}
 530 0346 00000020 		.ltorg
 530      02400010 
 530      02400100 
 530      01000200 
 530      11000100 
 531              	
 532              	
 533              	_nmi_handler:
 534 03e8 7047     		bx lr
 535              	_hard_fault:
 536 03ea 7047     		bx lr
 537              	_svc_handler:
 538 03ec 7047     		bx lr
 539              	_pendsv_handler:
 540 03ee 7047     		bx lr
 541              	_systickzhongduan:
 542 03f0 034A     		ldr r2, = jishu
 543 03f2 0448     		ldr r0, = 0xe0000d04
 544 03f4 1368     		ldr r3, [r2]
 545 03f6 0449     		ldr r1, = 0x02000000
 546 03f8 0133     		adds r3, r3, # 1
 547 03fa 1360     		str r3, [r2]
 548 03fc 0160     		str r1, [r0]                 @ 清除SYSTICK中断
 549              	aaa:
 550 03fe 70473400 		bx lr
 550      0020040D 
ARM GAS  1.s 			page 11


 550      00E00000 
 550      0002
ARM GAS  1.s 			page 12


DEFINED SYMBOLS
                 1.s:9      .data:0000000000000000 zheng_xian_biao
                 1.s:11     .data:00000000000000ca lcdshuju
                 1.s:13     .data:00000000000000da dianhua
                 1.s:15     .data:00000000000000ea qq
                 1.s:17     .data:00000000000000fa xushu
                 1.s:19     .data:00000000000000fb fu
                 1.s:21     .data:00000000000000fc zheng
                 1.s:23     .data:00000000000000fd xiaomai
                 1.s:25     *ABS*:0000000020001000 STACKINIT
                 1.s:26     *ABS*:0000000020000000 asciimabiao
                 1.s:27     *ABS*:0000000020000030 xiangminkaiguan
                 1.s:28     *ABS*:0000000020000034 jishu
                 1.s:29     *ABS*:0000000020000038 jianbo
                 1.s:30     *ABS*:0000000020000040 dianyabiao
                 1.s:31     *ABS*:0000000020000050 lvboqizhizhen
                 1.s:32     *ABS*:0000000020000054 lvboqihuanchong
                 1.s:33     *ABS*:0000000020000550 lvboqizhizhen1
                 1.s:34     *ABS*:0000000020000554 lvboqihuanchong1
                 1.s:37     .text:0000000000000000 vectors
                 1.s:84     .text:00000000000000b0 _start
                 1.s:533    .text:00000000000003e8 _nmi_handler
                 1.s:535    .text:00000000000003ea _hard_fault
                 1.s:537    .text:00000000000003ec _svc_handler
                 1.s:539    .text:00000000000003ee _pendsv_handler
                 1.s:541    .text:00000000000003f0 _systickzhongduan
                 1.s:549    .text:00000000000003fe aaa
                            .text:0000000000000000 $d
                 1.s:82     .text:00000000000000b0 $t
                 1.s:85     .text:00000000000000b0 shizhong
                 1.s:92     .text:00000000000000bc denghse
                 1.s:96     .text:00000000000000c2 dengpllguan
                 1.s:104    .text:00000000000000d0 dengpll
                 1.s:111    .text:00000000000000da dengdai14mshizhongwending
                 1.s:116    .text:00000000000000e0 _neicunqingling
                 1.s:120    .text:00000000000000e6 _neicunqinglingxunhuan
                 1.s:125    .text:00000000000000ec _waisheshizhong
                 1.s:142    .text:00000000000000f6 _waishezhongduan
                 1.s:157    .text:00000000000000f6 io_she_zhi
                 1.s:185    .text:0000000000000100 dmachushihua
                 1.s:206    .text:0000000000000112 tim1chushiha
                 1.s:223    .text:0000000000000130 _adcchushihua
                 1.s:227    .text:0000000000000136 _dengadcjiaozhun
                 1.s:231    .text:000000000000013c _kaiadc
                 1.s:236    .text:0000000000000144 _dengdaiadcwending
                 1.s:240    .text:000000000000014a _tongdaoxuanze
                 1.s:253    .text:000000000000015e _lcdchushihua
                 1.s:395    .text:000000000000026a _xielcd
                 1.s:387    .text:0000000000000260 _lcdyanshi
                 1.s:370    .text:0000000000000244 _lcdxianshi
                 1.s:283    .text:00000000000001aa ting
                 1.s:327    .text:0000000000000208 _jianbo
                 1.s:340    .text:000000000000021c _lvboqi
                 1.s:475    .text:00000000000002ee _zhuanascii
                 1.s:332    .text:0000000000000210 _jianbo90du
                 1.s:352    .text:000000000000022c _lvboqimeidaohuanchongquding
                 1.s:355    .text:0000000000000230 _lvboqixunhuan
ARM GAS  1.s 			page 13


                 1.s:359    .text:0000000000000236 _lvbozonghe
                 1.s:379    .text:0000000000000252 _lcdxianshixunhuan
                 1.s:390    .text:0000000000000264 _lcdyanshixunhuan
                 1.s:409    .text:0000000000000282 __lcd_ming_ling
                 1.s:406    .text:000000000000027e __lcd_shu_ju
                 1.s:411    .text:0000000000000284 __xiang_min_kai_guan
                 1.s:416    .text:000000000000028c __kai_zheng_xiang_wei
                 1.s:418    .text:000000000000028e __xie_lcd_shu_ju
                 1.s:434    .text:00000000000002b2 __74hc595
                 1.s:441    .text:00000000000002be __595_yiweixunhuan
                 1.s:445    .text:00000000000002c4 __595_yanshi
                 1.s:454    .text:00000000000002d2 __ser_0
                 1.s:451    .text:00000000000002ce __ser_1
                 1.s:456    .text:00000000000002d4 __595_yiwei
                 1.s:459    .text:00000000000002d8 __595_yanshi1
                 1.s:467    .text:00000000000002e6 __595_yanshi2
                 1.s:482    .text:00000000000002f8 _xunhuanqiuma
                 1.s:506    .text:0000000000000320 _chufa
                 1.s:501    .text:000000000000031c _qiumafanhui
                 1.s:496    .text:0000000000000314 _meidaoxiaoshudian
                 1.s:528    .text:0000000000000344 _chufafanhui
                 1.s:518    .text:0000000000000334 _chufaxunhuan
                 1.s:525    .text:0000000000000340 _chufaweishubudao0
                 1.s:530    .text:0000000000000346 $d
                 1.s:530    .text:0000000000000348 $d
                 1.s:534    .text:00000000000003e8 $t
                 1.s:550    .text:0000000000000400 $d

NO UNDEFINED SYMBOLS
