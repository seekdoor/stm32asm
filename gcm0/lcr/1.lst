ARM GAS  1.s 			page 1


   1              		@@ 单片机stm32f030f4p6
   2              		@@ 阻抗桥
   3              		@作者：yjmwxwx
   4              		@时间：2019-08-12
   5              		@编译器：ARM-NONE-EABI
   6              		 .thumb
   7              		         .syntax unified
   8              	.section .data
   9              	zheng_xian_biao:
  10 0000 18001900 		.short 24,25,26,28,29,31,32,34,35,36,37,38,40,41,42,43,43,44,45,45,46,46,47,47,47,47,47,47,47,46,4
  10      1A001C00 
  10      1D001F00 
  10      20002200 
  10      23002400 
  11              	lcdshuju:
  12 00ca 796A6D77 		.ascii  "yjmwxwx-20190812"
  12      7877782D 
  12      32303139 
  12      30383132 
  13              	dianhua:	
  14 00da 20202020 		.ascii	"     15552208295"
  14      20313535 
  14      35323230 
  14      38323935 
  15              	qq:
  16 00ea 20202051 		.ascii	"   QQ:3341656346"
  16      513A3333 
  16      34313635 
  16      36333436 
  17              	xushu:
  18 00fa 6A       		.ascii "j"
  19              	fu:
  20 00fb 2D       		.ascii "-"
  21              	zheng:
  22 00fc 2B       		.ascii "+"
  23              	xiaomai:
  24 00fd 7869616F 		.ascii "xiaomai ="
  24      6D616920 
  24      3D
  25              		.equ STACKINIT,        	        0x20001000
  26              		.equ asciimabiao,		0x20000000
  27              		.equ xiangminkaiguan,		0x20000030
  28              		.equ jishu,			0x20000034
  29              		.equ jianbo,			0x20000038
  30              		.equ dianyabiao,		0x20000040
  31              		.equ lvboqizhizhen,		0x20000050
  32              		.equ lvboqihuanchong,		0x20000054
  33              		.equ lvboqizhizhen1,		0x20000254
  34              		.equ lvboqihuanchong1,		0x20000258
  35              		.equ lvboqizhizhen2,		0x20000460
  36              		.equ lvboqihuanchong2,		0x20000464
  37              		.equ lvboqizhizhen3,		0x20000670
  38              		.equ lvboqihuanchong3,		0x20000674
  39              	
  40              		.section .text
  41              	vectors:
  42 0000 00100020 		.word STACKINIT
ARM GAS  1.s 			page 2


  43 0004 B1000000 		.word _start + 1
  44 0008 69040000 		.word _nmi_handler + 1
  45 000c 6B040000 		.word _hard_fault  + 1
  46 0010 00000000 		.word 0
  47 0014 00000000 		.word 0
  48 0018 00000000 		.word 0
  49 001c 00000000 		.word 0
  50 0020 00000000 		.word 0
  51 0024 00000000 		.word 0
  52 0028 00000000 		.word 0
  53 002c 6D040000 		.word _svc_handler +1
  54 0030 00000000 		.word 0
  55 0034 00000000 		.word 0
  56 0038 6F040000 		.word _pendsv_handler +1
  57 003c 71040000 		.word _systickzhongduan +1               @ 15
  58 0040 7F040000 		.word aaa +1     @ _wwdg +1          @ 0
  59 0044 7F040000 		.word aaa +1     @_pvd +1            @ 1
  60 0048 7F040000 		.word aaa +1     @_rtc +1            @ 2
  61 004c 7F040000 		.word aaa +1     @_flash +1          @ 3
  62 0050 7F040000 		.word aaa +1	@ _rcc + 1          @ 4
  63 0054 7F040000 		.word aaa +1      @_exti0_1  +1      @ 5
  64 0058 7F040000 		.word aaa +1      @ _exti2_3 +1      @ 6
  65 005c 7F040000 		.word aaa +1       @_exti4_15 +1     @ 7
  66 0060 7F040000 		.word aaa +1                         @ 8
  67 0064 7F040000 		.word aaa +1 	@_dma1_1  +1    @ 9
  68 0068 7F040000 		.word aaa +1    @_dma1_2_3 +1        @ 10
  69 006c 7F040000 		.word aaa +1       @_dma1_4_5 +1     @ 11
  70 0070 7F040000 		.word aaa +1	 @_adc1 +1          @ 12
  71 0074 7F040000 		.word aaa +1       @_tim1_brk_up +1  @ 13
  72 0078 7F040000 		.word aaa +1        @ _tim1_cc +1    @ 14
  73 007c 7F040000 		.word aaa +1         @_tim2 +1       @ 15
  74 0080 7F040000 		.word aaa +1          @_tim3 +1      @ 16
  75 0084 7F040000 		.word aaa +1                         @ 17
  76 0088 7F040000 		.word aaa +1		                @ 18
  77 008c 7F040000 		.word aaa +1	@_tim14 +1    @ 19
  78 0090 7F040000 		.word aaa +1                         @ 20
  79 0094 7F040000 		.word aaa +1         @_tim16 +1      @ 21
  80 0098 7F040000 		.word aaa +1         @_tim17 +1      @ 22
  81 009c 7F040000 		.word aaa +1          @_i2c   +1     @ 23
  82 00a0 7F040000 		.word aaa +1                         @ 24
  83 00a4 7F040000 		.word aaa +1           @_spi   +1    @ 25
  84 00a8 7F040000 		.word aaa +1                         @ 26
  85 00ac 7F040000 		.word aaa +1         @_usart1 +1     @ 27
  86              		.align 2
  87              	
  88              	_start:
  89 00b0 C048     		ldr r0, = 0xffff
  90              	yanshi111:
  91 00b2 0138     		subs r0, r0, # 1
  92 00b4 FDD1     		bne yanshi111
  93              		
  94              	shizhong:
  95 00b6 C04A     		ldr r2, = 0x40022000   @FLASH访问控制
  96 00b8 3221     		movs r1, # 0x32
  97 00ba 1160     		str r1, [r2]           @FLASH缓冲 缓冲开启
  98 00bc BF48     		ldr r0, = 0x40021000 @ rcc
  99 00be C049     		ldr r1, = 0x10001
ARM GAS  1.s 			page 3


 100 00c0 0160     		str r1, [r0]
 101              	denghse:
 102 00c2 0168     		ldr r1, [r0]
 103 00c4 8903     		lsls r1, r1, # 14
 104 00c6 FCD5     		bpl denghse
 105              	dengpllguan:
 106 00c8 0168     		ldr r1, [r0]
 107 00ca 8901     		lsls r1, r1, # 6
 108 00cc FCD4     		bmi dengpllguan
 109 00ce BD49     	        ldr r1, = 0x110002
 110 00d0 4160     	        str r1, [r0, # 0x04]
 111 00d2 BD49     		ldr r1, = 0x1010001
 112 00d4 0160     		str r1, [r0]
 113              	dengpll:
 114 00d6 0168     		ldr r1, [r0]
 115 00d8 8901     		lsls r1, # 6
 116 00da FCD5     		bpl dengpll
 117              		@0x34时钟控制寄存器 2 (RCC_CR2)
 118 00dc 0121     		movs r1, # 0x01
 119 00de 4163     		str r1, [r0, # 0x34]  @ HSI开14M时钟
 120              	dengdai14mshizhongwending:
 121 00e0 416B     		ldr r1, [r0, # 0x34]
 122 00e2 8907     		lsls r1, r1, # 30     @ 左移30位
 123 00e4 FCD5     		bpl dengdai14mshizhongwending  @ 等待14M时钟稳定
 124              	
 125              	_neicunqingling:
 126 00e6 B948     		ldr r0, = 0x20000000
 127 00e8 0021     		movs r1, # 0
 128 00ea B94B     		ldr r3, = 0x1000
 129              	_neicunqinglingxunhuan:
 130 00ec 043B     		subs r3, # 4
 131 00ee C150     		str r1, [r0, r3]
 132 00f0 FCD1     		bne _neicunqinglingxunhuan
 133              	
 134              	_waisheshizhong:			 @ 外设时钟
 135              		@+0x14=RCC_AHBENR
 136              		@0=DMA @2=SRAM @4=FLITF@6=CRC @17=PA @18=PB @19=PC @20=PD @22=PF
 137 00f2 B248     		ldr r0, = 0x40021000
 138 00f4 B749     		ldr r1, = 0x460005
 139 00f6 4161     		str r1, [r0, # 0x14]
 140              	
 141              		@+0x18外设时钟使能寄存器 (RCC_APB2ENR)
 142              		@0=SYSCFG @5=USART6EN @9=ADC @11=TIM1 @12=SPI1 @14=USART1 @16=TIM15 @17=TIM16 @18=TIM17 @22=DBGMCU
 143 00f8 B749     		ldr r1, = 0xa00
 144 00fa 8161     		str r1, [r0, # 0x18]
 145              		@+0X1C=RCC_APB1ENR
 146              		@1=TIM3 @4=TIM6 @5=TIM7 @8=TIM14 @11=WWDG @14=SPI @17=USRT2 @18=USART3 @20=USART5 @21=I2C1
 147              		@22=I2C2 @23=USB @28=PWR
 148              	
 149              	
 150              	
 151              	_waishezhongduan:				@外设中断
 152              		@0xE000E100    0-31  写1开，写0没效
 153              		@0XE000E180    0-31 写1关，写0没效
 154              		@0XE000E200    0-31 挂起，写0没效
 155              		@0XE000E280    0-31 清除， 写0没效
 156              	
ARM GAS  1.s 			page 4


 157              	@_systick:				@ systick定时器初始化
 158              	
 159              	@	ldr r0, = 0xe000e010
 160              	@	ldr r1, = 0xffffff
 161              	@	str r1, [r0, # 4]
 162              	@	str r1, [r0, # 8]
 163              	@	movs r1, # 0x07
 164              	@	str r1, [r0]
 165              		
 166              	io_she_zhi:
 167              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 168              		@a(0x48000000)b(0x48000400)c(0x48000800)d(0x48000c00)f(0x48001400)
 169              		@ 输入（00），通用输出（01），复用功能（10），模拟（11）
 170              		@偏移0x4 = 端口输出类型 @ （0 推挽），（ 1 开漏）
 171              		@偏移0x8 = 输出速度  00低速， 01中速， 11高速
 172              		@偏移0xC = 上拉下拉 (00无上下拉，  01 上拉， 10下拉)
 173              		@偏移0x10 = 输入数据寄存器
 174              		@偏移0x14 = 输出数据寄存器
 175              		@偏移0x18 = 端口开  0-15置位
 176              		@偏移0x28 = 端口关
 177              		@0X20 = 复用低
 178              		@GPIO口0（0-3位）每个IO口占用4位
 179              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 180              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 181              		@0x24 = 复用高
 182              		@GPIO口8 （0-3位）每个IO口占用4位
 183              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 184              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 185              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 186              	
 187 00fc B748     		ldr r0, = 0x48000000
 188 00fe B849     		ldr r1, = 0x2824540f
 189 0100 0160     		str r1, [r0]
 190 0102 B849     		ldr r1, = 0x200
 191 0104 4162     		str r1, [r0, # 0x24]
 192              	
 193              		
 194              	dmachushihua:
 195              	        @+0=LSR,+4=IFCR,
 196              	        @+8=CCR1,+c=CNDTR1,+10=CPAR1+14=CMAR1,
 197              	        @+1c=CCR2,+20=CNDTR2,+24=CPAR2,+28=CMAR2
 198              	        @+30=CCR3,+34=CNDTR3,+38=CPAR2,+3c=CMAR3
 199              	        @+44=CCR4,+48=CNDTR4,+4c=CPAR4,+50=CMAR4
 200              	        @+58=CCR5,+5c=CNDTR5,+60=CPAR5,+64=CMAR5
 201              	        @+6C=CCR6,+70=CNDTR6,+74=CPAR6,+78=CMAR6
 202              	        @+80=CCR7,+84=CNDTR7,+88=CPAR7,+8c=CMAR7
 203              	
 204              	        @tim1ch3DMA
 205 0106 B848     	        ldr r0, = 0x40020000
 206 0108 B849     	        ldr r1, = 0x40012c3c @ 外设地址
 207 010a 0166     	        str r1, [r0, # 0x60]
 208 010c B849     	        ldr r1, = zheng_xian_biao @ 储存器地址
 209 010e 4166     	        str r1, [r0, # 0x64]
 210 0110 B849     	        ldr r1, = 100             @点数
 211 0112 C165     	        str r1, [r0, # 0x5c]
 212 0114 B849     	        ldr r1, = 0x35b1         @ 储存到外设
 213 0116 8165     	        str r1, [r0, # 0x58]
ARM GAS  1.s 			page 5


 214              	
 215              	tim1chushiha:
 216 0118 B848     	        ldr r0, = 0x40012c00 @ tim1_cr1
 217 011a 0021     	        movs r1, # 0
 218 011c 8162     	        str r1, [r0, # 0x28] @ psc
 219 011e B849     	        ldr r1, = 47
 220 0120 C162     	        str r1, [r0, # 0x2c] @ ARR
 221 0122 B849     	        ldr r1, = 0x68
 222 0124 C161     	        str r1, [r0, # 0x1c] @ ccmr2  CC3
 223 0126 B849     	        ldr r1, = 0x100    @  CC3
 224 0128 0162     	        str r1, [r0, # 0x20] @ ccer
 225 012a B849     	        ldr r1, = 0x8000
 226 012c 4164     	        str r1, [r0, # 0x44] @ BDTR
 227 012e B849     	        ldr r1, = 0x800 @ CC3 DMA
 228 0130 C160     	        str r1, [r0, # 0x0c] @ DIER
 229 0132 B849     	        ldr r1, = 0xe1
 230 0134 0160     	        str r1, [r0]
 231              	
 232              	_adcchushihua:
 233 0136 B848     	        ldr r0, = 0x40012400  @ adc基地址
 234 0138 B849     		ldr r1, = 0x80000000
 235 013a 8160     	        str r1, [r0, # 0x08]  @ ADC 控制寄存器 (ADC_CR)  @adc校准
 236              	_dengadcjiaozhun:
 237 013c 8168     	        ldr r1, [r0, # 0x08]
 238 013e 0900     	         movs r1, r1
 239 0140 FCD4     	        bmi _dengadcjiaozhun   @ 等ADC校准
 240              	_kaiadc:
 241 0142 8168     	        ldr r1, [r0, # 0x08]
 242 0144 0122     	        movs r2, # 0x01
 243 0146 1143     	        orrs r1, r1, r2
 244 0148 8160     	        str r1, [r0, # 0x08]
 245              	_dengdaiadcwending:
 246 014a 0168     	        ldr r1, [r0]
 247 014c C907     	        lsls r1, r1, # 31
 248 014e FCD5     	        bpl _dengdaiadcwending @ 等ADC稳定
 249              	_tongdaoxuanze:
 250 0150 B349     	        ldr r1, = 1
 251 0152 8162     	        str r1, [r0, # 0x28]    @ 通道选择寄存器 (ADC_CHSELR)
 252 0154 B349     	        ldr r1, = 0x3000
 253 0156 C160     	        str r1, [r0, # 0x0c]    @ 配置寄存器 1 (ADC_CFGR1)
 254 0158 0021     	        movs r1, # 0
 255 015a 4161     	        str r1, [r0, # 0x14]    @ ADC 采样时间寄存器 (ADC_SMPR)
 256 015c 8168     	        ldr r1, [r0, # 0x08]
 257 015e B24A     	        ldr r2, = 0x04         @ 开始转换
 258 0160 1143     	        orrs r1, r1, r2
 259 0162 8160     	        str r1, [r0, # 0x08]    @ 控制寄存器 (ADC_CR)
 260              	
 261              	
 262              	_lcdchushihua:
 263 0164 3320     		movs r0, # 0x33
 264 0166 0021     		movs r1, # 0
 265 0168 00F0B6F8 		bl _xielcd
 266 016c 00F0AFF8 		bl _lcdyanshi
 267 0170 3220     		movs r0, # 0x32
 268 0172 0021     		movs r1, # 0
 269 0174 00F0B0F8 		bl _xielcd
 270 0178 00F0A9F8 		bl _lcdyanshi
ARM GAS  1.s 			page 6


 271 017c 2820     		movs r0, # 0x28
 272 017e 0021     		movs r1, # 0
 273 0180 00F0AAF8 		bl _xielcd
 274 0184 00F0A3F8 		bl _lcdyanshi
 275 0188 0C20     		movs r0, # 0x0c
 276 018a 0021     		movs r1, # 0
 277 018c 00F0A4F8 		bl _xielcd
 278 0190 00F09DF8 		bl _lcdyanshi
 279 0194 0120     		movs r0, # 0x01
 280 0196 0021     		movs r1, # 0
 281 0198 00F09EF8 		bl _xielcd
 282 019c 00F097F8 		bl _lcdyanshi
 283              	
 284              	
 285 01a0 C420     		movs r0, # 0xc4
 286 01a2 A249     		ldr r1, = xushu
 287 01a4 0122     		movs r2, # 1
 288 01a6 FF23     		movs r3, # 0xff
 289 01a8 00F083F8 		bl _lcdxianshi
 290 01ac 0046     		mov r0, r0
 291 01ae 0046     		mov r0, r0
 292              		
 293              	ting:
 294 01b0 8A48     		ldr r0, = 0x48000000
 295 01b2 0121     		movs r1, # 1
 296 01b4 4902     		lsls r1, r1, # 9
 297 01b6 8161     		str r1, [r0, # 0x18]
 298 01b8 9D48     		ldr r0, = 0x40012428
 299 01ba 0121     		movs r1, # 1
 300 01bc 0160     		str r1, [r0]
 301 01be 3220     		movs r0, # 50
 302 01c0 00F059F8 		bl _jianbo
 303 01c4 0346     		mov r3, r0
 304 01c6 9B48     	        ldr r0, = lvboqihuanchong
 305 01c8 8F49     	        ldr r1, = 256			
 306 01ca 9B4A     	        ldr r2, = lvboqizhizhen
 307 01cc 00F05DF8 	        bl _lvboqi
 308 01d0 0421     		movs r1, # 4
 309 01d2 7E4A     		ldr r2, = asciimabiao
 310 01d4 FF23     		movs r3, # 0xff
 311 01d6 00F0C1F8 		bl _zhuanascii
 312 01da C020     		movs r0, # 0xc0
 313 01dc 7B49     		ldr r1, = asciimabiao
 314 01de 0422     		movs r2, # 4
 315 01e0 00F067F8 		bl _lcdxianshi
 316              	
 317 01e4 9248     	        ldr r0, = 0x40012428
 318 01e6 0221     	        movs r1, # 2
 319 01e8 0160     	        str r1, [r0]
 320 01ea 1920     	        movs r0, # 25
 321 01ec 00F043F8 		bl _jianbo
 322 01f0 0346     	        mov r3,	r0
 323 01f2 9248     	        ldr r0, = lvboqihuanchong1
 324 01f4 8449     	        ldr r1, = 256
 325 01f6 924A     		ldr r2, = lvboqizhizhen1
 326 01f8 00F047F8 		bl _lvboqi
 327 01fc 0421     	        movs r1, # 4
ARM GAS  1.s 			page 7


 328 01fe 734A     		ldr r2, = asciimabiao
 329 0200 FF23     	        movs r3, # 0xff
 330 0202 00F0ABF8 	        bl _zhuanascii
 331 0206 8020     	        movs r0, # 0x80
 332 0208 7049     	        ldr r1, = asciimabiao
 333 020a 0422     	        movs r2, # 4
 334 020c 00F051F8 	        bl _lcdxianshi
 335              	
 336 0210 7248     		ldr r0, = 0x48000000
 337 0212 0121     	        movs r1, # 1
 338 0214 4902     	        lsls r1, r1, # 9
 339 0216 8162     	        str r1, [r0, # 0x28]
 340 0218 8548     	        ldr r0, = 0x40012428
 341 021a 0121     		movs r1, # 1
 342 021c 0160     	        str r1, [r0]
 343 021e 1920     	        movs r0, # 25
 344 0220 00F029F8 	        bl _jianbo
 345 0224 874B     		ldr r3, =  276
 346 0226 C018     		adds r0, r0, r3
 347 0228 0346     	        mov r3, r0
 348 022a 8748     	        ldr r0, = lvboqihuanchong2
 349 022c 7649     	        ldr r1, = 256
 350 022e 874A     	        ldr r2, = lvboqizhizhen2
 351 0230 00F02BF8 	        bl _lvboqi
 352 0234 0421     	        movs r1, # 4
 353 0236 654A     	        ldr r2, = asciimabiao
 354 0238 FF23     	        movs r3, # 0xff
 355 023a 00F08FF8 	        bl _zhuanascii
 356 023e 8C20     	        movs r0, # 0x8c
 357 0240 6249     	        ldr r1, = asciimabiao
 358 0242 0422     		movs r2, # 4
 359 0244 00F035F8 	        bl _lcdxianshi
 360              	
 361 0248 7948     	        ldr r0, = 0x40012428
 362 024a 0221     	        movs r1, # 2
 363 024c 0160     	        str r1, [r0]
 364 024e 3220     	        movs r0, # 50
 365 0250 00F011F8 	        bl _jianbo
 366 0254 0346     	        mov r3, r0
 367 0256 7E48     	        ldr r0, = lvboqihuanchong3
 368 0258 6B49     	        ldr r1, = 256
 369 025a 7E4A     	        ldr r2, = lvboqizhizhen3
 370 025c 00F015F8 	        bl _lvboqi
 371 0260 0421     	        movs r1, # 4
 372 0262 5A4A     	        ldr r2, = asciimabiao
 373 0264 FF23     	        movs r3, # 0xff
 374 0266 00F079F8 	        bl _zhuanascii
 375 026a CC20     	        movs r0, # 0xcc
 376 026c 5749     	        ldr r1, = asciimabiao
 377 026e 0422     	        movs r2, # 4
 378 0270 00F01FF8 	        bl _lcdxianshi
 379              	
 380 0274 9CE7     		b ting
 381              	
 382              	_jianbo:				@ 检波 @ 入口 R0=度数
 383 0276 0EB5     		push {r1-r3,lr}
 384 0278 7749     		ldr r1, = 0x4002005c
ARM GAS  1.s 			page 8


 385 027a 784A     		ldr r2, = 0x40012440
 386 027c 72B6     		cpsid i
 387              	_jianbo90du:
 388 027e 0B68     		ldr r3, [r1]
 389 0280 8342     		cmp r3, r0 
 390 0282 FCD1     		bne _jianbo90du
 391 0284 1068     		ldr r0, [r2]
 392 0286 62B6     		cpsie i
 393 0288 1CBD     		pop {r2-r4,pc}
 394              	
 395              	_lvboqi:
 396              				@滤波器
 397              				@R0=地址，R1=长度,r2=表指针地址,r3=ADC数值
 398              				@出R0=结果
 399 028a FEB5     		push {r1-r7,lr}	
 400 028c 1568     		ldr r5, [r2]		@读出表指针
 401 028e 4E00     		lsls r6, r1, # 1	
 402 0290 4353     		strh r3, [r0, r5]	@数值写到滤波器缓冲区
 403 0292 0235     		adds r5, r5, # 2
 404 0294 B542     		cmp r5, r6
 405 0296 00D1     		bne _lvboqimeidaohuanchongquding
 406 0298 0025     		movs r5, # 0
 407              	_lvboqimeidaohuanchongquding:
 408 029a 1560     		str r5, [r2]
 409 029c 0027     		movs r7, # 0
 410              	_lvboqixunhuan:
 411 029e B542     		cmp r5, r6
 412 02a0 00D1     		bne _lvbozonghe
 413 02a2 0025     		movs r5, # 0
 414              	_lvbozonghe:
 415 02a4 445B     		ldrh r4, [r0, r5]
 416 02a6 0235     		adds r5, r5, # 2
 417 02a8 3F19     		adds r7, r7, r4
 418 02aa 0139     		subs r1, r1, # 1
 419 02ac F7D1     		bne _lvboqixunhuan
 420 02ae 3812     		asrs r0, r7, # 8	@修改
 421 02b0 FEBD     		pop {r1-r7,pc}
 422              	
 423              	
 424              		
 425              	_lcdxianshi:	  		@r0=LCD位置，r1=数据地址，r2=长度
 426 02b2 1FB5     		push {r0-r4,lr}
 427 02b4 0C46     		mov r4, r1
 428              	
 429 02b6 0021     		movs r1, # 0
 430 02b8 00F00EF8 		bl _xielcd
 431              	
 432 02bc 0121     		movs r1, # 1
 433 02be 0023     		movs r3, # 0
 434              	_lcdxianshixunhuan:
 435 02c0 E05C     		ldrb r0, [r4,r3]
 436 02c2 00F009F8 		bl _xielcd
 437 02c6 0133     		adds r3, r3, # 1
 438 02c8 9342     		cmp r3, r2
 439 02ca F9D1     		bne _lcdxianshixunhuan
 440 02cc 1FBD     		pop {r0-r4,pc}
 441              	
ARM GAS  1.s 			page 9


 442              	_lcdyanshi:
 443 02ce 20B5     		push {r5,lr}
 444 02d0 634D     		ldr r5, = 0x2000
 445              	_lcdyanshixunhuan:
 446 02d2 013D     		subs r5, r5, # 1
 447 02d4 FDD1     		bne _lcdyanshixunhuan
 448 02d6 20BD     		pop {r5,pc}
 449              	
 450              	_xielcd:			@入R0=8位,r1=0命令,r1=1数据
 451 02d8 3FB5     		push {r0-r5,lr}
 452 02da 624C     		ldr r4, = xiangminkaiguan  @ 相敏开关
 453 02dc 0246     		mov r2, r0
 454 02de 2568     		ldr r5, [r4]
 455 02e0 1209     		lsrs r2, r2, # 4
 456 02e2 9200     		lsls r2, r2, # 2	@ 高四位
 457 02e4 0007     		lsls r0, r0, # 28
 458 02e6 800E     		lsrs r0, r0, # 26	@ 低四位
 459 02e8 C907     		lsls r1, r1, # 31
 460 02ea 01D5     		bpl __lcd_ming_ling
 461              	__lcd_shu_ju:
 462 02ec 0323     		movs r3, # 0x03		@ RS = 1 E = 1
 463 02ee 00E0     		b __xiang_min_kai_guan
 464              	__lcd_ming_ling:
 465 02f0 0223     		movs r3, # 0x02		@ RS = 0 E = 1
 466              	__xiang_min_kai_guan:
 467 02f2 402D     		cmp r5, # 0x40
 468 02f4 01D1     		bne __kai_zheng_xiang_wei
 469 02f6 8025     		movs r5, # 0x80
 470 02f8 00E0     		b __xie_lcd_shu_ju
 471              	__kai_zheng_xiang_wei:	
 472 02fa 4025     		movs r5, # 0x40
 473              	__xie_lcd_shu_ju:
 474 02fc 2560     		str r5, [r4]
 475 02fe 5B19     		adds r3, r3, r5
 476 0300 0146     		mov r1, r0
 477 0302 D218     		adds r2, r2, r3
 478 0304 1000     		movs r0, r2
 479 0306 00F00BF8 		bl __74hc595
 480 030a 0238     		subs r0, r0, # 0x02
 481 030c 00F008F8 		bl __74hc595
 482 0310 0846     		mov r0, r1
 483 0312 C018     		adds r0, r0, r3
 484 0314 00F004F8 		bl __74hc595
 485 0318 0238     		subs r0, r0, # 0x02
 486 031a 00F001F8 		bl __74hc595
 487 031e 3FBD     		pop {r0-r5,pc}
 488              		
 489              	__74hc595:			@ 入R0=8位
 490 0320 FFB5     		push {r0-r7,lr}
 491 0322 2E4E     		ldr r6, = 0x48000000
 492 0324 2025     		movs r5, # 0x20		@ SRCLK
 493 0326 4022     		movs r2, # 0x40		@ RCLK
 494 0328 8023     		movs r3, # 0x80		@ SER
 495 032a 1824     		movs r4, # 24
 496              	__595_yiweixunhuan:
 497 032c B261     		str r2, [r6, # 0x18]	@ rclk=0
 498 032e B561     		str r5, [r6, # 0x18]	@ srclk=0
ARM GAS  1.s 			page 10


 499 0330 FF27     		movs r7, # 0xff
 500              	__595_yanshi:
 501 0332 013F     		subs r7, r7, # 1
 502 0334 FDD1     		bne __595_yanshi
 503 0336 0146     		mov r1, r0
 504 0338 A140     		lsls r1, r1, r4
 505 033a 01D5     		bpl __ser_0
 506              	__ser_1:
 507 033c B362     		str r3, [r6, # 0x28]	@ ser=1
 508 033e 00E0     		b __595_yiwei
 509              	__ser_0:
 510 0340 B361     		str r3, [r6, # 0x18]	@ ser=0
 511              	__595_yiwei:
 512 0342 B562     		str r5, [r6, # 0x28]
 513 0344 FF27     		movs r7, # 0xff
 514              	__595_yanshi1:
 515 0346 013F     		subs r7, r7, # 1
 516 0348 FDD1     		bne __595_yanshi1
 517 034a 0134     		adds r4, r4, # 1
 518 034c 202C     		cmp r4, # 32
 519 034e EDD1     		bne __595_yiweixunhuan
 520 0350 B262     		str r2, [r6, # 0x28]	@ rclk=1
 521 0352 FF27     		movs r7, # 0xff
 522              	__595_yanshi2:
 523 0354 013F     		subs r7, r7, # 1
 524 0356 FDD1     		bne __595_yanshi2
 525 0358 B261     		str r2, [r6, # 0x18]	@ rclk = 0
 526 035a FFBD     		pop {r0-r7,pc}
 527              	
 528              	
 529              	
 530              	_zhuanascii:					@ 16进制转ASCII
 531              			@ R0要转的数据， R1长度，R2结果表首地址, r3=小数点位置
 532 035c FFB5     		push {r0-r7,lr}
 533 035e 1F46     		mov r7, r3
 534 0360 0546     		mov r5, r0
 535 0362 0E46     		mov r6, r1
 536 0364 0A21     		movs r1, # 10
 537              	_xunhuanqiuma:
 538 0366 00F012F8 		bl _chufa
 539 036a 0446     		mov r4, r0
 540 036c 4C43     		muls r4, r1
 541 036e 2B1B     		subs r3, r5, r4
 542 0370 3033     		adds r3, r3, # 0x30
 543 0372 0546     		mov r5, r0
 544 0374 013E     		subs r6, r6, # 1
 545 0376 08D0     		beq _qiumafanhui
 546 0378 BE42     		cmp r6, r7
 547 037a 02D1     		bne _meidaoxiaoshudian
 548 037c 2E24     		movs r4, # 0x2e		@小数点
 549 037e 9455     		strb r4, [r2,r6]	@插入小数点
 550 0380 013E     		subs r6, r6, # 1
 551              	_meidaoxiaoshudian:
 552 0382 9355     		strb r3, [r2,r6]
 553 0384 3600     		movs r6, r6
 554 0386 EED1     		bne _xunhuanqiuma
 555 0388 FFBD     		pop {r0-r7,pc}
ARM GAS  1.s 			page 11


 556              	_qiumafanhui:
 557 038a 9355     		strb r3, [r2, r6]
 558 038c FFBD     		pop {r0-r7,pc}
 559              	
 560              		
 561              	_chufa:				@软件除法
 562              		@ r0 除以 r1 等于 商(r0)余数R1
 563 038e 1EB5     		push {r1-r4,lr}
 564 0390 0028     		cmp r0, # 0
 565 0392 0ED0     		beq _chufafanhui
 566 0394 0029     		cmp r1, # 0
 567 0396 0CD0     		beq _chufafanhui
 568 0398 0246     		mov r2, r0
 569 039a 0123     		movs r3, # 1
 570 039c DB07     		lsls r3, r3, # 31
 571 039e 0020     		movs r0, # 0
 572 03a0 0446     		mov r4, r0
 573              	_chufaxunhuan:
 574 03a2 5200     		lsls r2, r2, # 1
 575 03a4 6441     		adcs r4, r4, r4
 576 03a6 8C42     		cmp r4, r1
 577 03a8 01D3     		bcc _chufaweishubudao0
 578 03aa C018     		adds r0, r0, r3
 579 03ac 641A     		subs r4, r4, r1
 580              	_chufaweishubudao0:
 581 03ae 5B08     		lsrs r3, r3, # 1
 582 03b0 F7D1     		bne _chufaxunhuan
 583              	_chufafanhui:
 584 03b2 1EBD     		pop {r1-r4,pc}
 585 03b4 FFFF0000 		.ltorg
 585      00200240 
 585      00100240 
 585      01000100 
 585      02001100 
 586              	
 587              	
 588              	_nmi_handler:
 589 0468 7047     		bx lr
 590              	_hard_fault:
 591 046a 7047     		bx lr
 592              	_svc_handler:
 593 046c 7047     		bx lr
 594              	_pendsv_handler:
 595 046e 7047     		bx lr
 596              	_systickzhongduan:
 597 0470 034A     		ldr r2, = jishu
 598 0472 0448     		ldr r0, = 0xe0000d04
 599 0474 1368     		ldr r3, [r2]
 600 0476 0449     		ldr r1, = 0x02000000
 601 0478 0133     		adds r3, r3, # 1
 602 047a 1360     		str r3, [r2]
 603 047c 0160     		str r1, [r0]                 @ 清除SYSTICK中断
 604              	aaa:
 605 047e 70473400 		bx lr
 605      0020040D 
 605      00E00000 
 605      0002
ARM GAS  1.s 			page 12


ARM GAS  1.s 			page 13


DEFINED SYMBOLS
                 1.s:9      .data:0000000000000000 zheng_xian_biao
                 1.s:11     .data:00000000000000ca lcdshuju
                 1.s:13     .data:00000000000000da dianhua
                 1.s:15     .data:00000000000000ea qq
                 1.s:17     .data:00000000000000fa xushu
                 1.s:19     .data:00000000000000fb fu
                 1.s:21     .data:00000000000000fc zheng
                 1.s:23     .data:00000000000000fd xiaomai
                 1.s:25     *ABS*:0000000020001000 STACKINIT
                 1.s:26     *ABS*:0000000020000000 asciimabiao
                 1.s:27     *ABS*:0000000020000030 xiangminkaiguan
                 1.s:28     *ABS*:0000000020000034 jishu
                 1.s:29     *ABS*:0000000020000038 jianbo
                 1.s:30     *ABS*:0000000020000040 dianyabiao
                 1.s:31     *ABS*:0000000020000050 lvboqizhizhen
                 1.s:32     *ABS*:0000000020000054 lvboqihuanchong
                 1.s:33     *ABS*:0000000020000254 lvboqizhizhen1
                 1.s:34     *ABS*:0000000020000258 lvboqihuanchong1
                 1.s:35     *ABS*:0000000020000460 lvboqizhizhen2
                 1.s:36     *ABS*:0000000020000464 lvboqihuanchong2
                 1.s:37     *ABS*:0000000020000670 lvboqizhizhen3
                 1.s:38     *ABS*:0000000020000674 lvboqihuanchong3
                 1.s:41     .text:0000000000000000 vectors
                 1.s:88     .text:00000000000000b0 _start
                 1.s:588    .text:0000000000000468 _nmi_handler
                 1.s:590    .text:000000000000046a _hard_fault
                 1.s:592    .text:000000000000046c _svc_handler
                 1.s:594    .text:000000000000046e _pendsv_handler
                 1.s:596    .text:0000000000000470 _systickzhongduan
                 1.s:604    .text:000000000000047e aaa
                            .text:0000000000000000 $d
                 1.s:86     .text:00000000000000b0 $t
                 1.s:90     .text:00000000000000b2 yanshi111
                 1.s:94     .text:00000000000000b6 shizhong
                 1.s:101    .text:00000000000000c2 denghse
                 1.s:105    .text:00000000000000c8 dengpllguan
                 1.s:113    .text:00000000000000d6 dengpll
                 1.s:120    .text:00000000000000e0 dengdai14mshizhongwending
                 1.s:125    .text:00000000000000e6 _neicunqingling
                 1.s:129    .text:00000000000000ec _neicunqinglingxunhuan
                 1.s:134    .text:00000000000000f2 _waisheshizhong
                 1.s:151    .text:00000000000000fc _waishezhongduan
                 1.s:166    .text:00000000000000fc io_she_zhi
                 1.s:194    .text:0000000000000106 dmachushihua
                 1.s:215    .text:0000000000000118 tim1chushiha
                 1.s:232    .text:0000000000000136 _adcchushihua
                 1.s:236    .text:000000000000013c _dengadcjiaozhun
                 1.s:240    .text:0000000000000142 _kaiadc
                 1.s:245    .text:000000000000014a _dengdaiadcwending
                 1.s:249    .text:0000000000000150 _tongdaoxuanze
                 1.s:262    .text:0000000000000164 _lcdchushihua
                 1.s:450    .text:00000000000002d8 _xielcd
                 1.s:442    .text:00000000000002ce _lcdyanshi
                 1.s:425    .text:00000000000002b2 _lcdxianshi
                 1.s:293    .text:00000000000001b0 ting
                 1.s:382    .text:0000000000000276 _jianbo
ARM GAS  1.s 			page 14


                 1.s:395    .text:000000000000028a _lvboqi
                 1.s:530    .text:000000000000035c _zhuanascii
                 1.s:387    .text:000000000000027e _jianbo90du
                 1.s:407    .text:000000000000029a _lvboqimeidaohuanchongquding
                 1.s:410    .text:000000000000029e _lvboqixunhuan
                 1.s:414    .text:00000000000002a4 _lvbozonghe
                 1.s:434    .text:00000000000002c0 _lcdxianshixunhuan
                 1.s:445    .text:00000000000002d2 _lcdyanshixunhuan
                 1.s:464    .text:00000000000002f0 __lcd_ming_ling
                 1.s:461    .text:00000000000002ec __lcd_shu_ju
                 1.s:466    .text:00000000000002f2 __xiang_min_kai_guan
                 1.s:471    .text:00000000000002fa __kai_zheng_xiang_wei
                 1.s:473    .text:00000000000002fc __xie_lcd_shu_ju
                 1.s:489    .text:0000000000000320 __74hc595
                 1.s:496    .text:000000000000032c __595_yiweixunhuan
                 1.s:500    .text:0000000000000332 __595_yanshi
                 1.s:509    .text:0000000000000340 __ser_0
                 1.s:506    .text:000000000000033c __ser_1
                 1.s:511    .text:0000000000000342 __595_yiwei
                 1.s:514    .text:0000000000000346 __595_yanshi1
                 1.s:522    .text:0000000000000354 __595_yanshi2
                 1.s:537    .text:0000000000000366 _xunhuanqiuma
                 1.s:561    .text:000000000000038e _chufa
                 1.s:556    .text:000000000000038a _qiumafanhui
                 1.s:551    .text:0000000000000382 _meidaoxiaoshudian
                 1.s:583    .text:00000000000003b2 _chufafanhui
                 1.s:573    .text:00000000000003a2 _chufaxunhuan
                 1.s:580    .text:00000000000003ae _chufaweishubudao0
                 1.s:585    .text:00000000000003b4 $d
                 1.s:589    .text:0000000000000468 $t
                 1.s:605    .text:0000000000000480 $d

NO UNDEFINED SYMBOLS
