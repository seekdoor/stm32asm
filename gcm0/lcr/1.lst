ARM GAS  1.s 			page 1


   1              		@@ 单片机stm32f030f4p6
   2              		@@ 阻抗桥
   3              		@作者：yjmwxwx
   4              		@时间：2019-08-12
   5              		@编译器：ARM-NONE-EABI
   6              		 .thumb
   7              		         .syntax unified
   8              	.section .data
   9              	zheng_xian_biao:
  10 0000 18001900 		.short 0x18,0x19,0x1a,0x1c,0x1d,0x1f,0x20,0x22,0x23,0x24,0x25,0x26,0x28,0x29,0x2a,0x2b,0x2b,0x2c,0
  10      1A001C00 
  10      1D001F00 
  10      20002200 
  10      23002400 
  11              	lcdshuju:
  12 00ca 796A6D77 		.ascii  "yjmwxwx-20190812"
  12      7877782D 
  12      32303139 
  12      30383132 
  13              	dianhua:	
  14 00da 20202020 		.ascii	"     15552208295"
  14      20313535 
  14      35323230 
  14      38323935 
  15              	qq:
  16 00ea 20202051 		.ascii	"   QQ:3341656346"
  16      513A3333 
  16      34313635 
  16      36333436 
  17              	xushu:
  18 00fa 69       		.ascii "i"
  19              	fu:
  20 00fb 2D       		.ascii "-"
  21              	zheng:
  22 00fc 2B       		.ascii "+"
  23              	dianzu:
  24 00fd 523D     		.ascii	"R="
  25              	dianrong:
  26 00ff 433D     		.ascii	"C="
  27              	pinlv:
  28 0101 31304B48 		.ascii	"10KHZ"
  28      5A
  29              	qianou:
  30 0106 4B       		.ascii	"K"
  31              	ou:
  32 0107 F4000000 	        .int    0xf4
  33              	kong:
  34 010b 20202020 		.int 0x20202020
  35              	pifa:
  36 010f 5046     		.ascii "PF"
  37              	xiaomai:
  38 0111 7869616F 		.ascii "xiaomai ="
  38      6D616920 
  38      3D
  39              		.equ STACKINIT,        	        0x20001000
  40              		.equ asciimabiao,		0x20000000
  41              		.equ liangcheng,		0x20000030
ARM GAS  1.s 			page 2


  42              		.equ jishu,			0x20000034
  43              		.equ jianbo,			0x20000038
  44              		.equ dianyabiao,		0x20000040
  45              		.equ lvboqizhizhen,		0x20000600
  46              		.equ lvboqihuanchong,		0x20000604
  47              		.equ lvboqizhizhen1,		0x20000700
  48              		.equ lvboqihuanchong1,		0x20000704
  49              		.equ lvboqizhizhen2,		0x20000800
  50              		.equ lvboqihuanchong2,		0x20000804
  51              		.equ lvboqizhizhen3,		0x20000900
  52              		.equ lvboqihuanchong3,		0x20000904
  53              		.equ xia_bi_shi_bu,		0x20000a00
  54              		.equ shang_bi_shi_bu,		0x20000a04
  55              		.equ xia_bi_xu_bu,		0x20000a08
  56              		.equ shang_bi_xu_bu,		0x20000a0c
  57              		.equ bu_chang_100r,		0x20000a10
  58              		.equ zidongliangchengyanshi,	0x20000a14
  59              		.equ dianzuzhi,			0x20000a18
  60              		.equ dianrongzhi,		0x20000a1c
  61              		.section .text
  62              	vectors:
  63 0000 00100020 		.word STACKINIT
  64 0004 B1000000 		.word _start + 1
  65 0008 15080000 		.word _nmi_handler + 1
  66 000c 17080000 		.word _hard_fault  + 1
  67 0010 00000000 		.word 0
  68 0014 00000000 		.word 0
  69 0018 00000000 		.word 0
  70 001c 00000000 		.word 0
  71 0020 00000000 		.word 0
  72 0024 00000000 		.word 0
  73 0028 00000000 		.word 0
  74 002c 19080000 		.word _svc_handler +1
  75 0030 00000000 		.word 0
  76 0034 00000000 		.word 0
  77 0038 1B080000 		.word _pendsv_handler +1
  78 003c 1D080000 		.word _systickzhongduan +1               @ 15
  79 0040 2B080000 		.word aaa +1     @ _wwdg +1          @ 0
  80 0044 2B080000 		.word aaa +1     @_pvd +1            @ 1
  81 0048 2B080000 		.word aaa +1     @_rtc +1            @ 2
  82 004c 2B080000 		.word aaa +1     @_flash +1          @ 3
  83 0050 2B080000 		.word aaa +1	@ _rcc + 1          @ 4
  84 0054 2B080000 		.word aaa +1      @_exti0_1  +1      @ 5
  85 0058 2B080000 		.word aaa +1      @ _exti2_3 +1      @ 6
  86 005c 2B080000 		.word aaa +1       @_exti4_15 +1     @ 7
  87 0060 2B080000 		.word aaa +1                         @ 8
  88 0064 2B080000 		.word aaa +1 	@_dma1_1  +1    @ 9
  89 0068 2B080000 		.word aaa +1    @_dma1_2_3 +1        @ 10
  90 006c 2B080000 		.word aaa +1       @_dma1_4_5 +1     @ 11
  91 0070 2B080000 		.word aaa +1	 @_adc1 +1          @ 12
  92 0074 2B080000 		.word aaa +1       @_tim1_brk_up +1  @ 13
  93 0078 2B080000 		.word aaa +1        @ _tim1_cc +1    @ 14
  94 007c 2B080000 		.word aaa +1         @_tim2 +1       @ 15
  95 0080 2B080000 		.word aaa +1          @_tim3 +1      @ 16
  96 0084 2B080000 		.word aaa +1                         @ 17
  97 0088 2B080000 		.word aaa +1		                @ 18
  98 008c 2B080000 		.word aaa +1	@_tim14 +1    @ 19
ARM GAS  1.s 			page 3


  99 0090 2B080000 		.word aaa +1                         @ 20
 100 0094 2B080000 		.word aaa +1         @_tim16 +1      @ 21
 101 0098 2B080000 		.word aaa +1         @_tim17 +1      @ 22
 102 009c 2B080000 		.word aaa +1          @_i2c   +1     @ 23
 103 00a0 2B080000 		.word aaa +1                         @ 24
 104 00a4 2B080000 		.word aaa +1           @_spi   +1    @ 25
 105 00a8 2B080000 		.word aaa +1                         @ 26
 106 00ac 2B080000 		.word aaa +1         @_usart1 +1     @ 27
 107              		.align 2
 108              	
 109              	_start:
 110 00b0 9348     		ldr r0, = 0xffff
 111              	yanshi111:
 112 00b2 0138     		subs r0, r0, # 1
 113 00b4 FDD1     		bne yanshi111
 114              		
 115              	shizhong:
 116 00b6 934A     		ldr r2, = 0x40022000   @FLASH访问控制
 117 00b8 3221     		movs r1, # 0x32
 118 00ba 1160     		str r1, [r2]           @FLASH缓冲 缓冲开启
 119 00bc 9248     		ldr r0, = 0x40021000 @ rcc
 120 00be 9349     		ldr r1, = 0x10001
 121 00c0 0160     		str r1, [r0]
 122              	denghse:
 123 00c2 0168     		ldr r1, [r0]
 124 00c4 8903     		lsls r1, r1, # 14
 125 00c6 FCD5     		bpl denghse
 126              	dengpllguan:
 127 00c8 0168     		ldr r1, [r0]
 128 00ca 8901     		lsls r1, r1, # 6
 129 00cc FCD4     		bmi dengpllguan
 130 00ce 9049     	        ldr r1, = 0x110002
 131 00d0 4160     	        str r1, [r0, # 0x04]
 132 00d2 9049     		ldr r1, = 0x1010001
 133 00d4 0160     		str r1, [r0]
 134              	dengpll:
 135 00d6 0168     		ldr r1, [r0]
 136 00d8 8901     		lsls r1, # 6
 137 00da FCD5     		bpl dengpll
 138              		@0x34时钟控制寄存器 2 (RCC_CR2)
 139 00dc 0121     		movs r1, # 0x01
 140 00de 4163     		str r1, [r0, # 0x34]  @ HSI开14M时钟
 141              	dengdai14mshizhongwending:
 142 00e0 416B     		ldr r1, [r0, # 0x34]
 143 00e2 8907     		lsls r1, r1, # 30     @ 左移30位
 144 00e4 FCD5     		bpl dengdai14mshizhongwending  @ 等待14M时钟稳定
 145              	
 146              	_neicunqingling:
 147 00e6 8C48     		ldr r0, = 0x20000000
 148 00e8 0021     		movs r1, # 0
 149 00ea 8C4B     		ldr r3, = 0x1000
 150              	_neicunqinglingxunhuan:
 151 00ec 043B     		subs r3, # 4
 152 00ee C150     		str r1, [r0, r3]
 153 00f0 FCD1     		bne _neicunqinglingxunhuan
 154              	
 155              	_waisheshizhong:			 @ 外设时钟
ARM GAS  1.s 			page 4


 156              		@+0x14=RCC_AHBENR
 157              		@0=DMA @2=SRAM @4=FLITF@6=CRC @17=PA @18=PB @19=PC @20=PD @22=PF
 158 00f2 8548     		ldr r0, = 0x40021000
 159 00f4 8A49     		ldr r1, = 0x460005
 160 00f6 4161     		str r1, [r0, # 0x14]
 161              	
 162              		@+0x18外设时钟使能寄存器 (RCC_APB2ENR)
 163              		@0=SYSCFG @5=USART6EN @9=ADC @11=TIM1 @12=SPI1 @14=USART1 @16=TIM15 @17=TIM16 @18=TIM17 @22=DBGMCU
 164 00f8 8A49     		ldr r1, = 0xa00
 165 00fa 8161     		str r1, [r0, # 0x18]
 166              		@+0X1C=RCC_APB1ENR
 167              		@1=TIM3 @4=TIM6 @5=TIM7 @8=TIM14 @11=WWDG @14=SPI @17=USRT2 @18=USART3 @20=USART5 @21=I2C1
 168              		@22=I2C2 @23=USB @28=PWR
 169              	
 170              	
 171              	_waishezhongduan:				@外设中断
 172              		@0xE000E100    0-31  写1开，写0没效
 173              		@0XE000E180    0-31 写1关，写0没效
 174              		@0XE000E200    0-31 挂起，写0没效
 175              		@0XE000E280    0-31 清除， 写0没效
 176              	
 177              	@_systick:				@ systick定时器初始化
 178              	
 179              	@	ldr r0, = 0xe000e010
 180              	@	ldr r1, = 0xffffff
 181              	@	str r1, [r0, # 4]
 182              	@	str r1, [r0, # 8]
 183              	@	movs r1, # 0x07
 184              	@	str r1, [r0]
 185              		
 186              	io_she_zhi:
 187              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 188              		@a(0x48000000)b(0x48000400)c(0x48000800)d(0x48000c00)f(0x48001400)
 189              		@ 输入（00），通用输出（01），复用功能（10），模拟（11）
 190              		@偏移0x4 = 端口输出类型 @ （0 推挽），（ 1 开漏）
 191              		@偏移0x8 = 输出速度  00低速， 01中速， 11高速
 192              		@偏移0xC = 上拉下拉 (00无上下拉，  01 上拉， 10下拉)
 193              		@偏移0x10 = 输入数据寄存器
 194              		@偏移0x14 = 输出数据寄存器
 195              		@偏移0x18 = 端口开  0-15置位
 196              		@偏移0x28 = 端口关
 197              		@0X20 = 复用低
 198              		@GPIO口0（0-3位）每个IO口占用4位
 199              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 200              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 201              		@0x24 = 复用高
 202              		@GPIO口8 （0-3位）每个IO口占用4位
 203              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 204              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 205              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 206              	
 207 00fc 8A48     		ldr r0, = 0x48000000
 208 00fe 8B49     		ldr r1, = 0x2824540f
 209 0100 0160     		str r1, [r0]
 210 0102 8B49     		ldr r1, = 0x200
 211 0104 4162     		str r1, [r0, # 0x24]
 212              	
ARM GAS  1.s 			page 5


 213              	
 214              	
 215              	_adcchushihua:
 216 0106 8B48     	        ldr r0, = 0x40012400  @ adc基地址
 217 0108 8B49     	        ldr r1, = 0x80000000
 218 010a 8160     	        str r1, [r0, # 0x08]  @ ADC 控制寄存器 (ADC_CR)  @adc校准
 219              	_dengadcjiaozhun:
 220 010c 8168     	        ldr r1, [r0, # 0x08]
 221 010e 0900     	        movs r1, r1
 222 0110 FCD4     	        bmi _dengadcjiaozhun   @ 等ADC校准
 223              	_kaiadc:
 224 0112 8168     		ldr r1, [r0, # 0x08]
 225 0114 0122     	        movs r2, # 0x01
 226 0116 1143     		orrs r1, r1, r2
 227 0118 8160     	        str r1, [r0, # 0x08]
 228              	_dengdaiadcwending:
 229 011a 0168     		ldr r1, [r0]
 230 011c C907     		lsls r1, r1, # 31
 231 011e FCD5     		bpl _dengdaiadcwending @ 等ADC稳定
 232              	_tongdaoxuanze:
 233 0120 8649     		ldr r1, = 2
 234 0122 8162     	        str r1, [r0, # 0x28]    @ 通道选择寄存器 (ADC_CHSELR)
 235 0124 8649     	        ldr r1, = 0xc03
 236 0126 C160     	        str r1, [r0, # 0x0c]    @ 配置寄存器 1 (ADC_CFGR1)
 237 0128 0021     		movs r1, # 0
 238 012a 4161     	        str r1, [r0, # 0x14]    @ ADC 采样时间寄存器 (ADC_SMPR)
 239 012c 8168     		ldr r1, [r0, # 0x08]
 240 012e 854A     	        ldr r2, = 0x04         @ 开始转换
 241 0130 1143     	        orrs r1, r1, r2
 242 0132 8160     		str r1, [r0, # 0x08]    @ 控制寄存器 (ADC_CR)
 243              	
 244              	
 245              		
 246              	dmachushihua:
 247              	        @+0=LSR,+4=IFCR,
 248              	        @+8=CCR1,+c=CNDTR1,+10=CPAR1+14=CMAR1,
 249              	        @+1c=CCR2,+20=CNDTR2,+24=CPAR2,+28=CMAR2
 250              	        @+30=CCR3,+34=CNDTR3,+38=CPAR2,+3c=CMAR3
 251              	        @+44=CCR4,+48=CNDTR4,+4c=CPAR4,+50=CMAR4
 252              	        @+58=CCR5,+5c=CNDTR5,+60=CPAR5,+64=CMAR5
 253              	        @+6C=CCR6,+70=CNDTR6,+74=CPAR6,+78=CMAR6
 254              	        @+80=CCR7,+84=CNDTR7,+88=CPAR7,+8c=CMAR7
 255              	
 256              	        @tim1ch3DMA
 257 0134 8448     	        ldr r0, = 0x40020000
 258 0136 8549     	        ldr r1, = 0x40012c3c @ 外设地址
 259 0138 0166     	        str r1, [r0, # 0x60]
 260 013a 8549     	        ldr r1, = zheng_xian_biao @ 储存器地址
 261 013c 4166     	        str r1, [r0, # 0x64]
 262 013e 8549     	        ldr r1, = 100             @点数
 263 0140 C165     	        str r1, [r0, # 0x5c]
 264 0142 8549     	        ldr r1, = 0x35b1         @ 储存到外设
 265 0144 8165     	        str r1, [r0, # 0x58]
 266              		@ adc dma
 267 0146 8048     		ldr r0, = 0x40020000
 268 0148 8449     		ldr r1, = 0x40012440
 269 014a 0161     		str r1, [r0, # 0x10]
ARM GAS  1.s 			page 6


 270 014c 8449     		ldr r1, = dianyabiao
 271 014e 4161     		str r1, [r0, # 0x14]
 272 0150 8449     		ldr r1, =  50
 273 0152 C160     		str r1, [r0, # 0x0c]
 274 0154 8449     		ldr r1, = 0x5a1		@ 5a1
 275 0156 8160     		str r1, [r0, # 0x08]
 276              	
 277              	tim1chushiha:
 278 0158 8448     	        ldr r0, = 0x40012c00 @ tim1_cr1
 279 015a 0021     	        movs r1, # 0
 280 015c 8162     	        str r1, [r0, # 0x28] @ psc
 281 015e 8449     	        ldr r1, = 47
 282 0160 C162     	        str r1, [r0, # 0x2c] @ ARR
 283              		@	movs r1, # 0x40
 284 0162 2021     		movs r1, # 0x20
 285 0164 4160     		str r1, [r0, # 0x04] @ TRGO
 286 0166 3821     		movs r1, # 0x38
 287 0168 8161     		str r1, [r0, # 0x18] @ ccmr1 cc1
 288 016a 2F21     		movs r1, # 47
 289 016c 4163     		str r1, [r0, # 0x34]
 290 016e 8149     	        ldr r1, = 0x68
 291 0170 C161     	        str r1, [r0, # 0x1c] @ ccmr2  CC3
 292 0172 8149     	        ldr r1, = 0x100    @  CC3
 293 0174 0162     	        str r1, [r0, # 0x20] @ ccer
 294 0176 8149     	        ldr r1, = 0x8000
 295 0178 4164     	        str r1, [r0, # 0x44] @ BDTR
 296 017a 8149     	        ldr r1, = 0x800 @ CC3 DMA
 297 017c C160     	        str r1, [r0, # 0x0c] @ DIER
 298 017e 8149     	        ldr r1, = 0x81
 299 0180 0160     	        str r1, [r0]
 300              	
 301              	
 302              	
 303              	_lcdchushihua:
 304 0182 3320     		movs r0, # 0x33
 305 0184 0021     		movs r1, # 0
 306 0186 00F0D4FA 		bl _xielcd
 307 018a 00F0CDFA 		bl _lcdyanshi
 308 018e 3220     		movs r0, # 0x32
 309 0190 0021     		movs r1, # 0
 310 0192 00F0CEFA 		bl _xielcd
 311 0196 00F0C7FA 		bl _lcdyanshi
 312 019a 2820     		movs r0, # 0x28
 313 019c 0021     		movs r1, # 0
 314 019e 00F0C8FA 		bl _xielcd
 315 01a2 00F0C1FA 		bl _lcdyanshi
 316 01a6 0C20     		movs r0, # 0x0c
 317 01a8 0021     		movs r1, # 0
 318 01aa 00F0C2FA 		bl _xielcd
 319 01ae 00F0BBFA 		bl _lcdyanshi
 320 01b2 0120     		movs r0, # 0x01
 321 01b4 0021     		movs r1, # 0
 322 01b6 00F0BCFA 		bl _xielcd
 323 01ba 00F0B5FA 		bl _lcdyanshi
 324              	
 325              	@	movs r0, # 0x80
 326              	@	ldr r1, = lcdshuju
ARM GAS  1.s 			page 7


 327              	@	movs r2, # 16
 328              	@	movs r3, # 0xff
 329              	@	bl _lcdxianshi
 330              		
 331 01be 7248     		ldr r0, = liangcheng
 332 01c0 0021     		movs r1, # 0x00
 333 01c2 0160     		str r1, [r0]
 334              	
 335 01c4 F8E0     		b dd
 336              	
 337              	ting:
 338 01c6 00F0F2F9 		bl __zi_dong_liang_cheng
 339 01ca 00F011FA 	        bl _jianbo
 340 01ce 00F0CCF9 		bl __zhen_fu_lv_bo
 341 01d2 00F040F9 		bl __zu_kang_ji_suan
 342 01d6 6D48     		ldr r0, = dianrongzhi
 343 01d8 0821     	        movs r1, # 8
 344 01da 0068     		ldr r0, [r0]
 345 01dc 4E4A     	        ldr r2, = asciimabiao
 346 01de FF23     	        movs r3, # 0xff
 347 01e0 00F0E3FA 	        bl _zhuanascii
 348 01e4 8520     	        movs r0, # 0x85
 349 01e6 4C49     	        ldr r1, = asciimabiao
 350 01e8 0822     	        movs r2, # 8
 351 01ea 00F08FFA 	        bl _lcdxianshi
 352 01ee 6648     		ldr r0, = liangcheng
 353 01f0 0168     		ldr r1, [r0]
 354              	__liangcheng100k:
 355 01f2 0029     		cmp r1, # 0x00
 356 01f4 19D1     		bne __liangcheng10k
 357 01f6 6648     	        ldr r0, = dianzuzhi
 358 01f8 6649     	        ldr r1, = 1000
 359 01fa 0068     	        ldr r0, [r0]
 360 01fc 00F0F0FA 		bl _chufa
 361 0200 0421     		movs r1, # 4
 362 0202 454A     		ldr r2, = asciimabiao
 363 0204 FF23     		movs r3, # 0xff
 364 0206 00F0D0FA 	        bl _zhuanascii
 365 020a C320     		movs r0, # 0xc3
 366 020c 4249     		ldr r1, = asciimabiao
 367 020e 0422     		movs r2, # 4
 368 0210 00F07CFA 	        bl _lcdxianshi
 369 0214 C720     		movs r0, # 0xc7
 370 0216 6049     	        ldr r1, = qianou
 371 0218 0222     	        movs r2, # 2
 372 021a 00F077FA 	        bl _lcdxianshi
 373 021e C920     		movs r0, # 0xc9
 374 0220 5E49     	        ldr r1, = kong
 375 0222 0122     	        movs r2, # 1
 376 0224 00F072FA 	        bl _lcdxianshi
 377 0228 48E0     		b __xian_shi_qi_ta
 378              	__liangcheng10k:
 379 022a 5748     	        ldr r0, = liangcheng
 380 022c 0168     	        ldr r1, [r0]
 381 022e 4029     		cmp r1, # 0x40
 382 0230 14D1     		bne __liangcheng1k
 383 0232 5748     	        ldr r0, = dianzuzhi
ARM GAS  1.s 			page 8


 384 0234 4749     	        ldr r1, = 100
 385 0236 0068     	        ldr r0, [r0]
 386 0238 00F0D2FA 	        bl _chufa
 387 023c 0521     	        movs r1, # 5
 388 023e 364A     	        ldr r2, = asciimabiao
 389 0240 0323     		movs r3, # 3
 390 0242 00F0B2FA 	        bl _zhuanascii
 391 0246 C320     	        movs r0, # 0xc3
 392 0248 3349     	        ldr r1, = asciimabiao
 393 024a 0522     	        movs r2, # 5
 394 024c 00F05EFA 	        bl _lcdxianshi
 395 0250 C820     	        movs r0, # 0xc8
 396 0252 5149     	        ldr r1, = qianou
 397 0254 0222     	        movs r2, # 2
 398 0256 00F059FA 	        bl _lcdxianshi
 399 025a 2FE0     		b __xian_shi_qi_ta
 400              	__liangcheng1k:
 401 025c 4A48     	        ldr r0, = liangcheng
 402 025e 0168     	        ldr r1, [r0]
 403 0260 8029     	        cmp r1, # 0x80
 404 0262 14D1     	        bne __liangcheng100r
 405 0264 4A48     		ldr r0, = dianzuzhi
 406 0266 4E49     	        ldr r1, = 10
 407 0268 0068     	        ldr r0, [r0]
 408 026a 00F0B9FA 	        bl _chufa
 409 026e 0521     	        movs r1, # 5
 410 0270 294A     	        ldr r2, = asciimabiao
 411 0272 0223     	        movs r3, # 2
 412 0274 00F099FA 	        bl _zhuanascii
 413 0278 C320     	        movs r0, # 0xc3
 414 027a 2749     	        ldr r1, = asciimabiao
 415 027c 0522     	        movs r2, # 5
 416 027e 00F045FA 	        bl _lcdxianshi
 417 0282 C820     	        movs r0, # 0xc8
 418 0284 4449     	        ldr r1, = qianou
 419 0286 0222     	        movs r2, # 2
 420 0288 00F040FA 	        bl _lcdxianshi
 421 028c 16E0     		b __xian_shi_qi_ta
 422              	__liangcheng100r:
 423 028e 4048     	        ldr r0, = dianzuzhi
 424 0290 0421     		movs r1, # 4
 425 0292 0068     	        ldr r0, [r0]
 426 0294 204A     	        ldr r2, = asciimabiao
 427 0296 FF23     	        movs r3, # 0xff
 428 0298 00F087FA 	        bl _zhuanascii
 429 029c C320     	        movs r0, # 0xc3
 430 029e 1E49     	        ldr r1, = asciimabiao
 431 02a0 0422     	        movs r2, # 4
 432 02a2 00F033FA 	        bl _lcdxianshi
 433 02a6 C720     	        movs r0, # 0xc7
 434 02a8 3E49     	        ldr r1, = ou
 435 02aa 0122     	        movs r2, # 1
 436 02ac 00F02EFA 	        bl _lcdxianshi
 437 02b0 C820     	        movs r0, # 0xc8
 438 02b2 3A49     	        ldr r1, = kong
 439 02b4 0222     	        movs r2, # 2
 440 02b6 00F029FA 	        bl _lcdxianshi
ARM GAS  1.s 			page 9


 441 02ba FFE7     	        b __xian_shi_qi_ta
 442              	
 443              	__xian_shi_qi_ta:
 444 02bc 3248     		ldr r0, = liangcheng
 445 02be 0068     		ldr r0, [r0]
 446 02c0 8009     		lsrs r0, r0, # 6
 447 02c2 0121     		movs r1, # 1
 448 02c4 144A     	        ldr r2, = asciimabiao
 449 02c6 FF23     	        movs r3, # 0xff
 450 02c8 00F06FFA 	        bl _zhuanascii
 451 02cc 8020     	        movs r0, # 0x80
 452 02ce 1249     	        ldr r1, = asciimabiao
 453 02d0 0122     	        movs r2, # 1
 454 02d2 00F01BFA 	        bl _lcdxianshi
 455              	
 456 02d6 C120     	        movs r0, # 0xc1
 457 02d8 3349     	        ldr r1, = dianzu
 458 02da 0222     	        movs r2, # 2
 459 02dc 00F016FA 	        bl _lcdxianshi
 460 02e0 CB20     	        movs r0, # 0xcb
 461 02e2 3249     	        ldr r1, = pinlv
 462 02e4 0522     	        movs r2, # 5
 463 02e6 00F011FA 	        bl _lcdxianshi
 464              	__xian_shi_dian_rong:
 465 02ea 8320     		movs r0, # 0x83
 466 02ec 3049     		ldr r1, = dianrong
 467 02ee 0222     		movs r2, # 2
 468 02f0 00F00CFA 		bl _lcdxianshi
 469 02f4 8E20     	        movs r0, # 0x8e
 470 02f6 2F49     	        ldr r1, = pifa
 471 02f8 0222     	        movs r2, # 2
 472 02fa 00F007FA 		bl _lcdxianshi
 473              	
 474 02fe 62E7     		b ting
 475              	
 476 0300 FFFF0000 		.ltorg
 476      00200240 
 476      00100240 
 476      01000100 
 476      02001100 
 477              	
 478              	dd:
 479 03b8 00F0F9F8 	   	bl __zi_dong_liang_cheng
 480 03bc B248     		ldr r0, = liangcheng
 481 03be 0068     	        ldr r0, [r0]
 482 03c0 0421     	        movs r1, # 4
 483 03c2 B24A     	        ldr r2, = asciimabiao
 484 03c4 FF23     	        movs r3, # 0xff
 485 03c6 00F0F0F9 	        bl _zhuanascii
 486 03ca C620     	        movs r0, # 0xc6
 487 03cc AF49     	        ldr r1, = asciimabiao
 488 03ce 0422     		movs r2, # 0x04
 489 03d0 00F09CF9 		bl _lcdxianshi
 490 03d4 00F00CF9 	        bl _jianbo
 491 03d8 00F0C7F8 	        bl __zhen_fu_lv_bo
 492 03dc 00F089F8 	        bl __xian_shi_shang_xia_bi
 493 03e0 EAE7     		b dd
ARM GAS  1.s 			page 10


 494              	
 495              	
 496              		
 497              	__dian_zu_ji_suan:
 498 03e2 0EB5     		push {r1-r3,lr}
 499 03e4 AA48     		ldr r0, = shang_bi_shi_bu
 500 03e6 AB49     		ldr r1, = xia_bi_shi_bu
 501 03e8 A74B     		ldr r3, = liangcheng
 502              		@ldr r2, = bu_chang_100r
 503 03ea 0068     		ldr r0, [r0]
 504 03ec 1B68     		ldr r3, [r3]
 505 03ee 0968     		ldr r1, [r1]
 506              		@ldr r2, [r2]
 507              	__liang_cheng_100k:	
 508 03f0 002B     		cmp r3, # 0x00
 509 03f2 01D1     		bne __liang_cheng10k
 510 03f4 A84A     		ldr r2, = 100000
 511 03f6 08E0     		b __ji_suan_dian_zu
 512              	__liang_cheng10k:
 513 03f8 402B     		cmp r3, # 0x40
 514 03fa 01D1     		bne __liang_cheng1k
 515 03fc A74A     		ldr r2, = 10000
 516 03fe 04E0     		b __ji_suan_dian_zu
 517              	__liang_cheng1k:
 518 0400 802B     		cmp r3, # 0x80
 519 0402 01D1     		bne __liang_cheng100ou
 520 0404 A64A     		ldr r2, = 1000
 521 0406 00E0     		b __ji_suan_dian_zu
 522              	__liang_cheng100ou:	
 523 0408 6422     		movs r2, # 100
 524              	__ji_suan_dian_zu:	
 525 040a 5043     		muls r0, r0, r2
 526 040c 00F0E8F9 		bl _chufa
 527 0410 0EBD     		pop {r1-r3,pc}
 528              	__ji_suan_fu_du:    @ 计算幅度
 529              	                @ 入r0= 实部，r1= 虚部
 530              	                @ 出r0 = 幅度
 531              	                @ Mag ~=Alpha * max(|I|, |Q|) + Beta * min(|I|, |Q|)
 532              	                @ Alpha * Max + Beta * Min
 533 0412 0EB5     	        push {r1-r3,lr}
 534 0414 0000     	        movs r0, r0
 535 0416 01D5     	        bpl _shibubushifushu
 536 0418 C043     	        mvns r0, r0                             @ 是负数转成正数
 537 041a 0130     	        adds r0, r0, # 1
 538              	_shibubushifushu:                               @ 实部不是负数
 539 041c 0900     	        movs r1, r1
 540 041e 01D5     	        bpl _xububushifushu
 541 0420 C943     	        mvns r1, r1                             @ 是负数转成正数
 542 0422 0131     	        adds r1, r1, # 1
 543              	_xububushifushu:                                @ 虚部不是负数
 544 0424 0028     	        cmp r0, # 0
 545 0426 01D1     	        bne _panduanxubushibushi0
 546 0428 0846     	        mov r0, r1
 547 042a 0EBD     	        pop {r1-r3,pc}
 548              	_panduanxubushibushi0:	
 549 042c 0029     		cmp r1, # 0
 550 042e 00D1     		bne _jisuanfudu1
ARM GAS  1.s 			page 11


 551 0430 0EBD     		pop {r1-r3,pc}
 552              	_jisuanfudu1:
 553 0432 9C4A     		ldr r2, = 31066		@ Alpha q15 0.948059448969
 554 0434 9C4B     		ldr r3, = 12867		@ Beta q15 0.392699081699
 555 0436 8142     		cmp r1, r0
 556 0438 06D8     		bhi _alpha_min_beta_max
 557              	_alpha_max_beta_min:
 558 043a 5043     		muls r0, r0, r2
 559 043c 5943     		muls r1, r1, r3
 560 043e C013     		asrs r0, r0, # 15
 561 0440 C913     		asrs r1, r1, # 15
 562 0442 4018     		adds r0, r0, r1
 563 0444 0121     		movs r1, # 1
 564 0446 0EBD     		pop {r1-r3,pc}
 565              	_alpha_min_beta_max:
 566 0448 5843     		muls r0, r0, r3
 567 044a 5143     		muls r1, r1, r2
 568 044c C013     		asrs r0, r0, # 15
 569 044e C913     		asrs r1, r1, # 15
 570 0450 4018     		adds r0, r0, r1
 571 0452 0021     		movs r1, # 0
 572 0454 0EBD     		pop {r1-r3,pc}
 573              		
 574              	__zu_kang_ji_suan:
 575 0456 FFB5     		push {r0-r7,lr}
 576 0458 8D48     		ldr r0, = shang_bi_shi_bu
 577 045a 9449     		ldr r1, = shang_bi_xu_bu
 578 045c 8D4A     		ldr r2, = xia_bi_shi_bu
 579 045e 944B     		ldr r3, = xia_bi_xu_bu
 580 0460 894C     		ldr r4, = liangcheng
 581 0462 0068     		ldr r0, [r0]
 582 0464 0968     		ldr r1, [r1]
 583 0466 1268     		ldr r2, [r2]
 584 0468 1B68     		ldr r3, [r3]
 585 046a 2568     		ldr r5, [r4]
 586              	__c_liang_cheng_100k:
 587 046c 002D     	        cmp r5, # 0x00
 588 046e 01D1     		bne __c_liang_cheng10k
 589 0470 894C     	        ldr r4, = 100000
 590 0472 08E0     		b __ji_suan_dian_rong
 591              	__c_liang_cheng10k:
 592 0474 402D     	        cmp r5, # 0x40
 593 0476 01D1     	        bne __c_liang_cheng1k
 594 0478 884C     	        ldr r4, = 10000
 595 047a 04E0     	        b __ji_suan_dian_rong
 596              	__c_liang_cheng1k:
 597 047c 802D     	        cmp r5, # 0x80
 598 047e 01D1     		bne __c_liang_cheng100ou
 599 0480 874C     	        ldr r4, = 1000
 600 0482 00E0     	        b __ji_suan_dian_rong
 601              	__c_liang_cheng100ou:
 602 0484 6424     		movs r4, # 100
 603              	__ji_suan_dian_rong:
 604              	@ Z=R+jx
 605              	@ Z=R*[(a+bi)/(c+di)]=R*[(ac+bd)/(c*c+d*d)+(bc-ad)/(c*c+d*d)]
 606              	@c=1/[(2*pi*f)*xc]
 607 0486 10B4     		push {r4}
ARM GAS  1.s 			page 12


 608 0488 0446     		mov r4, r0
 609 048a 0D46     		mov r5, r1
 610 048c 1646     		mov r6, r2
 611 048e 1F46     		mov r7, r3
 612 0490 5043     		muls r0, r0, r2		@ac
 613 0492 5943     		muls r1, r1, r3		@bd
 614 0494 4018     		adds r0, r0, r1		@ac+bd
 615 0496 5243     		muls r2, r2, r2		@c*c
 616 0498 5B43     		muls r3, r3, r3		@d*d
 617 049a D218     		adds r2, r2, r3		@c*c+d*d
 618 049c 1146     		mov r1, r2
 619 049e 8002     		lsls r0, r0, # 10
 620 04a0 00F09EF9 		bl _chufa		@(ac+bd)/(c*c+d*d)
 621 04a4 01B4     		push {r0}
 622 04a6 7543     		muls r5, r5, r6		@ bc
 623 04a8 7C43     		muls r4, r4, r7		@ ad
 624 04aa 2D1B     		subs r5, r5, r4		@ bc-ad
 625 04ac 1146     		mov r1, r2
 626 04ae 2846     		mov r0, r5
 627 04b0 8002     		lsls r0, r0, # 10
 628 04b2 00F095F9 		bl _chufa
 629 04b6 0146     		mov r1, r0		@ R1=结果虚部
 630 04b8 01BC     		pop {r0}		@ R0=结果实部
 631 04ba 04BC     		pop {r2}		@ R2=R（量程）
 632 04bc 5043     		muls r0, r0, r2		@ 
 633 04be 5143     		muls r1, r1, r2		@
 634 04c0 8012     		asrs r0, r0, # 10
 635 04c2 7C4A     		ldr r2, = dianzuzhi
 636 04c4 8912     		asrs r1, r1, # 10
 637 04c6 1060     		str r0, [r2]
 638 04c8 FFF7A3FF 		bl __ji_suan_fu_du
 639 04cc 7A4B     		ldr r3, = 62831		@ 2pi*10khz
 640 04ce 0146     		mov r1, r0
 641 04d0 5943     		muls r1, r1, r3
 642 04d2 0C46     		mov r4, r1
 643 04d4 7948     		ldr r0, = 1000000000
 644 04d6 00F083F9 		bl _chufa
 645 04da 0346     		mov r3, r0
 646 04dc 704A     		ldr r2, = 1000
 647 04de 0846     		mov r0, r1
 648 04e0 5043     		muls r0, r0, r2
 649 04e2 5343     		muls r3, r3, r2
 650 04e4 2146     		mov r1, r4
 651 04e6 00F07BF9 		bl _chufa
 652 04ea 754A     		ldr r2, = dianrongzhi
 653 04ec 1B18     		adds r3, r3, r0
 654 04ee 1360     		str r3, [r2]
 655 04f0 FFBD     		pop {r0-r7,pc}
 656              		
 657              	__xian_shi_shang_xia_bi:
 658 04f2 0FB5     		push {r0-r3,lr}
 659 04f4 C420     	        movs r0, # 0xc4
 660 04f6 7349     	        ldr r1, = xushu
 661 04f8 0122     	        movs r2, # 1
 662 04fa 00F007F9 	        bl _lcdxianshi
 663 04fe CF20     		movs r0, # 0xcf
 664 0500 7049     	        ldr r1, = xushu
ARM GAS  1.s 			page 13


 665 0502 0122     		movs r2, # 1
 666 0504 00F002F9 		bl _lcdxianshi
 667 0508 6248     		ldr r0, = xia_bi_shi_bu
 668 050a 0421     		movs r1, # 4
 669 050c 0068     		ldr r0, [r0]
 670 050e 5F4A     		ldr r2, = asciimabiao
 671 0510 FF23     		movs r3, # 0xff
 672 0512 00F04AF9 		bl _zhuanascii
 673 0516 8B20     		movs r0, # 0x8b
 674 0518 5C49     		ldr r1, = asciimabiao
 675 051a 0422     		movs r2, # 0x04
 676 051c 00F0F6F8 		bl _lcdxianshi
 677 0520 5B48     	        ldr r0, = shang_bi_shi_bu
 678 0522 0421     	        movs r1, # 4
 679 0524 0068     	        ldr r0, [r0]
 680 0526 594A     	        ldr r2, = asciimabiao
 681 0528 FF23     	        movs r3, # 0xff
 682 052a 00F03EF9 	        bl _zhuanascii
 683 052e 8020     	        movs r0, # 0x80
 684 0530 5649     	        ldr r1, = asciimabiao
 685 0532 0422     	        movs r2, # 0x04
 686 0534 00F0EAF8 	        bl _lcdxianshi
 687 0538 5D48     	        ldr r0, = xia_bi_xu_bu
 688 053a 0421     	        movs r1, # 4
 689 053c 0068     	        ldr r0, [r0]
 690 053e 534A     	        ldr r2, = asciimabiao
 691 0540 FF23     	        movs r3, # 0xff
 692 0542 00F032F9 	        bl _zhuanascii
 693 0546 CB20     	        movs r0, # 0xcb
 694 0548 5049     	        ldr r1, = asciimabiao
 695 054a 0422     	        movs r2, # 0x04
 696 054c 00F0DEF8 	        bl _lcdxianshi
 697 0550 5648     	        ldr r0, = shang_bi_xu_bu
 698 0552 0421     	        movs r1, # 4
 699 0554 0068     	        ldr r0, [r0]
 700 0556 4D4A     	        ldr r2, = asciimabiao
 701 0558 FF23     	        movs r3, # 0xff
 702 055a 00F026F9 	        bl _zhuanascii
 703 055e C020     	        movs r0, # 0xc0
 704 0560 4A49     	        ldr r1, = asciimabiao
 705 0562 0422     	        movs r2, # 0x04
 706 0564 00F0D2F8 	        bl _lcdxianshi
 707 0568 0FBD     		pop {r0-r3,pc}
 708              	
 709              	
 710              	__zhen_fu_lv_bo:
 711              		@ 入口 R0= 下臂实部，R1=上臂实部，R2=下臂虚部，R3=上臂虚部
 712 056a FFB5     		push {r0-r7,lr}
 713 056c 494F     		ldr r7, = xia_bi_shi_bu
 714 056e 1546     		mov r5, r2
 715 0570 1E46     		mov r6, r3
 716 0572 0C46     		mov r4, r1
 717 0574 0346     		mov r3, r0
 718 0576 5448     		ldr r0, = lvboqihuanchong
 719 0578 5449     		ldr r1, = 32
 720 057a 554A     		ldr r2, = lvboqizhizhen
 721 057c 00F070F8 		bl _lvboqi
ARM GAS  1.s 			page 14


 722 0580 3860     		str r0, [r7]			@保存下臂实部
 723 0582 2346     	        mov r3, r4
 724 0584 5348     	        ldr r0, = lvboqihuanchong1
 725 0586 5149     		ldr r1, = 32
 726 0588 534A     		ldr r2, = lvboqizhizhen1
 727 058a 00F069F8 	        bl _lvboqi
 728 058e 7860     	        str r0, [r7, # 0x04]		@保存上臂实部
 729 0590 2B46     		mov r3, r5
 730 0592 5248     		ldr r0, = lvboqihuanchong2
 731 0594 4D49     	        ldr r1, = 32
 732 0596 524A     	        ldr r2, = lvboqizhizhen2
 733 0598 00F062F8 		bl _lvboqi
 734 059c B860     		str r0, [r7, # 0x08]		@保存下臂虚部
 735              	
 736 059e 3346     	        mov r3, r6
 737 05a0 5048     		ldr r0, = lvboqihuanchong3
 738 05a2 4A49     		ldr r1, = 32
 739 05a4 504A     		ldr r2, = lvboqizhizhen3
 740 05a6 00F05BF8 	        bl _lvboqi
 741 05aa F860     		str r0, [r7, # 0x0c]		@保存上臂虚部
 742 05ac FFBD     		pop {r0-r7,pc}
 743              		
 744              	
 745              	__zi_dong_liang_cheng:
 746              		@ 0xc0=100,0x80=1k
 747              		@0x40=10k,0x00=100k
 748 05ae 7FB5     		push {r0-r6,lr}
 749 05b0 4E48     		ldr r0, = zidongliangchengyanshi
 750 05b2 1422     		movs r2, # 20
 751 05b4 0168     		ldr r1, [r0]
 752 05b6 0131     		adds r1, r1, # 1
 753 05b8 0160     		str r1, [r0]
 754 05ba 9142     		cmp r1, r2
 755 05bc 17D3     		bcc __liang_cheng_fan_hui
 756 05be 0021     		movs r1, # 0
 757 05c0 0160     		str r1, [r0]
 758 05c2 3348     		ldr r0, = shang_bi_shi_bu
 759 05c4 334D     		ldr r5, = xia_bi_shi_bu
 760 05c6 3049     		ldr r1, = liangcheng
 761 05c8 0A68     		ldr r2, [r1]
 762 05ca 494E     		ldr r6, = 2300
 763 05cc 494B     		ldr r3, = 20
 764 05ce C02A     		cmp r2, # 0xc0
 765 05d0 07D0     		beq __xuan_kong
 766              	__pan_duan_liang_cheng:
 767 05d2 2C68     		ldr r4, [r5]
 768 05d4 B442     		cmp r4, r6
 769 05d6 02D2     		bcs __gai_liang_cheng
 770 05d8 0468     		ldr r4, [r0]
 771 05da 9C42     		cmp r4,	r3
 772 05dc 00D2     		bcs __bao_cun_liang_cheng
 773              	__gai_liang_cheng:
 774 05de 4032     		adds r2, r2, # 0x40
 775              	__bao_cun_liang_cheng:
 776 05e0 0A60     		str r2, [r1]
 777              	__xuan_kong:
 778 05e2 2C48     		ldr r0, = xia_bi_shi_bu
ARM GAS  1.s 			page 15


 779 05e4 0468     		ldr r4, [r0]
 780 05e6 142C     		cmp r4, # 20
 781 05e8 01D2     		bcs __liang_cheng_fan_hui
 782              	__liang_cheng_chong_zhi:
 783 05ea 0022     		movs r2, # 0
 784 05ec 0A60     		str r2, [r1]
 785              	__liang_cheng_fan_hui:	
 786 05ee 7FBD     		pop {r0-r6,pc}
 787              		
 788              	_jianbo:
 789              		@ 入口 R0=采样表首地址，R1=0度90度相差多少
 790              		@ 出口R0=下臂90度，R1=上臂90度，R2=下臂180度，R3=上臂180度
 791 05f0 F0B5     		push {r4-r7,lr}
 792 05f2 414F     	        ldr r7, = 0x48000000
 793 05f4 414E     	        ldr r6, = 0x200
 794 05f6 BE62     		str r6, [r7, # 0x28]
 795 05f8 414D     	        ldr r5, = 0x40012428
 796 05fa 0224     	        movs r4, # 2
 797 05fc 2C60     	        str r4, [r5]
 798 05fe 00F01AF8 		bl _jianboyanshi	
 799 0602 00F01DF8 		bl __zhao_zui_da_shu
 800 0606 01B4     		push {r0}
 801 0608 BE61     		str r6, [r7, # 0x18]
 802 060a 00F014F8 		bl _jianboyanshi
 803 060e 00F017F8 	        bl __zhao_zui_da_shu
 804 0612 01B4     		push {r0}
 805 0614 0124     		movs r4, # 1
 806 0616 2C60     		str r4, [r5]
 807 0618 BE62     		str r6, [r7, # 0x28]
 808 061a 00F00CF8 		bl _jianboyanshi
 809 061e 00F00FF8 	        bl __zhao_zui_da_shu
 810 0622 8A89     		ldrh r2, [r1, # 0x0c]
 811 0624 BE61     		str r6, [r7, # 0x18]
 812 0626 00F006F8 		bl _jianboyanshi
 813 062a 00F009F8 	        bl __zhao_zui_da_shu
 814 062e 8B89     		ldrh r3, [r1, # 0x0c]
 815 0630 02BC     		pop {r1}
 816 0632 01BC     		pop {r0}
 817 0634 F0BD     		pop {r4-r7,pc}
 818              	_jianboyanshi:
 819 0636 80B5     		push {r7,lr}
 820 0638 324F     		ldr r7, = 0xffff
 821              	_jianboyanshixunhuan:
 822 063a 013F     		subs r7, r7, # 1
 823 063c FDD1     		bne _jianboyanshixunhuan
 824 063e 80BD     		pop {r7,pc}
 825              	
 826              	__zhao_zui_da_shu:
 827 0640 1CB5     		push {r2-r4,lr}
 828 0642 3148     		ldr r0, = dianyabiao
 829 0644 6522     		movs r2, # 101
 830 0646 5200     		lsls r2, r2, # 1
 831 0648 0023     		movs r3, # 0
 832              	__zhao:
 833 064a 815A     		ldrh r1, [r0, r2]
 834 064c 9942     		cmp r1, r3
 835 064e 01D3     		bcc __di_zhi_jian
ARM GAS  1.s 			page 16


 836 0650 0B46     		mov r3, r1
 837 0652 1446     		mov r4, r2
 838              	__di_zhi_jian:	
 839 0654 023A     		subs r2, r2, # 2
 840 0656 F8D1     		bne __zhao
 841 0658 0146     		mov r1, r0
 842 065a 1846     		mov r0, r3
 843 065c 0919     		adds r1, r1, r4
 844 065e 1CBD     		pop {r2-r4,pc}
 845              		
 846              	_lvboqi:
 847              				@滤波器
 848              				@R0=地址，R1=长度,r2=表指针地址,r3=ADC数值
 849              				@出R0=结果
 850 0660 FEB5     		push {r1-r7,lr}	
 851 0662 1568     		ldr r5, [r2]		@读出表指针
 852 0664 4E00     		lsls r6, r1, # 1	
 853 0666 4353     		strh r3, [r0, r5]	@数值写到滤波器缓冲区
 854 0668 0235     		adds r5, r5, # 2
 855 066a B542     		cmp r5, r6
 856 066c 00D1     		bne _lvboqimeidaohuanchongquding
 857 066e 0025     		movs r5, # 0
 858              	_lvboqimeidaohuanchongquding:
 859 0670 1560     		str r5, [r2]
 860 0672 0027     		movs r7, # 0
 861              	_lvboqixunhuan:
 862 0674 B542     		cmp r5, r6
 863 0676 00D1     		bne _lvbozonghe
 864 0678 0025     		movs r5, # 0
 865              	_lvbozonghe:
 866 067a 445B     		ldrh r4, [r0, r5]
 867 067c 0235     		adds r5, r5, # 2
 868 067e 3F19     		adds r7, r7, r4
 869 0680 0139     		subs r1, r1, # 1
 870 0682 F7D1     		bne _lvboqixunhuan
 871 0684 7811     		asrs r0, r7, # 5	@修改
 872 0686 FEBD     		pop {r1-r7,pc}
 873 0688 30000020 		.ltorg
 873      00000020 
 873      040A0020 
 873      000A0020 
 873      A0860100 
 874              	
 875              		
 876              	_lcdxianshi:	  		@r0=LCD位置，r1=数据地址，r2=长度
 877 070c 1FB5     		push {r0-r4,lr}
 878 070e 0C46     		mov r4, r1
 879              	
 880 0710 0021     		movs r1, # 0
 881 0712 00F00EF8 		bl _xielcd
 882              	
 883 0716 0121     		movs r1, # 1
 884 0718 0023     		movs r3, # 0
 885              	_lcdxianshixunhuan:
 886 071a E05C     		ldrb r0, [r4,r3]
 887 071c 00F009F8 		bl _xielcd
 888 0720 0133     		adds r3, r3, # 1
ARM GAS  1.s 			page 17


 889 0722 9342     		cmp r3, r2
 890 0724 F9D1     		bne _lcdxianshixunhuan
 891 0726 1FBD     		pop {r0-r4,pc}
 892              	
 893              	_lcdyanshi:
 894 0728 20B5     		push {r5,lr}
 895 072a 374D     		ldr r5, = 0x2000
 896              	_lcdyanshixunhuan:
 897 072c 013D     		subs r5, r5, # 1
 898 072e FDD1     		bne _lcdyanshixunhuan
 899 0730 20BD     		pop {r5,pc}
 900              	
 901              	_xielcd:			@入R0=8位,r1=0命令,r1=1数据
 902 0732 3FB5     		push {r0-r5,lr}
 903 0734 354C     		ldr r4, = liangcheng  @ 量程开关 (第6位和第7位)
 904 0736 0246     		mov r2, r0
 905 0738 2568     		ldr r5, [r4]
 906 073a 1209     		lsrs r2, r2, # 4
 907 073c 9200     		lsls r2, r2, # 2	@ 高四位
 908 073e 0007     		lsls r0, r0, # 28
 909 0740 800E     		lsrs r0, r0, # 26	@ 低四位
 910 0742 C907     		lsls r1, r1, # 31
 911 0744 01D5     		bpl __lcd_ming_ling
 912              	__lcd_shu_ju:
 913 0746 0323     		movs r3, # 0x03		@ RS = 1 E = 1
 914 0748 00E0     		b __xie_lcd_shu_ju
 915              	__lcd_ming_ling:
 916 074a 0223     		movs r3, # 0x02		@ RS = 0 E = 1
 917              	__xie_lcd_shu_ju:
 918 074c 5B19     		adds r3, r3, r5
 919 074e 0146     		mov r1, r0
 920 0750 D218     		adds r2, r2, r3
 921 0752 1000     		movs r0, r2
 922 0754 00F00BF8 		bl __74hc595
 923 0758 0238     		subs r0, r0, # 0x02
 924 075a 00F008F8 		bl __74hc595
 925 075e 0846     		mov r0, r1
 926 0760 C018     		adds r0, r0, r3
 927 0762 00F004F8 		bl __74hc595
 928 0766 0238     		subs r0, r0, # 0x02
 929 0768 00F001F8 		bl __74hc595
 930 076c 3FBD     		pop {r0-r5,pc}
 931              		
 932              	__74hc595:			@ 入R0=8位
 933 076e FFB5     		push {r0-r7,lr}
 934 0770 274E     		ldr r6, = 0x48000000
 935 0772 2025     		movs r5, # 0x20		@ SRCLK
 936 0774 4022     		movs r2, # 0x40		@ RCLK
 937 0776 8023     		movs r3, # 0x80		@ SER
 938 0778 1824     		movs r4, # 24
 939              	__595_yiweixunhuan:
 940 077a B261     		str r2, [r6, # 0x18]	@ rclk=0
 941 077c B561     		str r5, [r6, # 0x18]	@ srclk=0
 942 077e FF27     		movs r7, # 0xff
 943              	__595_yanshi:
 944 0780 013F     		subs r7, r7, # 1
 945 0782 FDD1     		bne __595_yanshi
ARM GAS  1.s 			page 18


 946 0784 0146     		mov r1, r0
 947 0786 A140     		lsls r1, r1, r4
 948 0788 01D5     		bpl __ser_0
 949              	__ser_1:
 950 078a B362     		str r3, [r6, # 0x28]	@ ser=1
 951 078c 00E0     		b __595_yiwei
 952              	__ser_0:
 953 078e B361     		str r3, [r6, # 0x18]	@ ser=0
 954              	__595_yiwei:
 955 0790 B562     		str r5, [r6, # 0x28]
 956 0792 FF27     		movs r7, # 0xff
 957              	__595_yanshi1:
 958 0794 013F     		subs r7, r7, # 1
 959 0796 FDD1     		bne __595_yanshi1
 960 0798 0134     		adds r4, r4, # 1
 961 079a 202C     		cmp r4, # 32
 962 079c EDD1     		bne __595_yiweixunhuan
 963 079e B262     		str r2, [r6, # 0x28]	@ rclk=1
 964 07a0 FF27     		movs r7, # 0xff
 965              	__595_yanshi2:
 966 07a2 013F     		subs r7, r7, # 1
 967 07a4 FDD1     		bne __595_yanshi2
 968 07a6 B261     		str r2, [r6, # 0x18]	@ rclk = 0
 969 07a8 FFBD     		pop {r0-r7,pc}
 970              	
 971              	
 972              	
 973              	_zhuanascii:					@ 16进制转ASCII
 974              			@ R0要转的数据， R1长度，R2结果表首地址, r3=小数点位置
 975 07aa FFB5     		push {r0-r7,lr}
 976 07ac 1F46     		mov r7, r3
 977 07ae 0546     		mov r5, r0
 978 07b0 0E46     		mov r6, r1
 979 07b2 0A21     		movs r1, # 10
 980              	_xunhuanqiuma:
 981 07b4 02B4     		push {r1}
 982 07b6 00F013F8 		bl _chufa
 983 07ba 02BC     		pop {r1}
 984 07bc 0446     		mov r4, r0
 985 07be 4C43     		muls r4, r1
 986 07c0 2B1B     		subs r3, r5, r4
 987 07c2 3033     		adds r3, r3, # 0x30
 988 07c4 0546     		mov r5, r0
 989 07c6 013E     		subs r6, r6, # 1
 990 07c8 08D0     		beq _qiumafanhui
 991 07ca BE42     		cmp r6, r7
 992 07cc 02D1     		bne _meidaoxiaoshudian
 993 07ce 2E24     		movs r4, # 0x2e		@小数点
 994 07d0 9455     		strb r4, [r2,r6]	@插入小数点
 995 07d2 013E     		subs r6, r6, # 1
 996              	_meidaoxiaoshudian:
 997 07d4 9355     		strb r3, [r2,r6]
 998 07d6 3600     		movs r6, r6
 999 07d8 ECD1     		bne _xunhuanqiuma
 1000 07da FFBD     		pop {r0-r7,pc}
 1001              	_qiumafanhui:
 1002 07dc 9355     		strb r3, [r2, r6]
ARM GAS  1.s 			page 19


 1003 07de FFBD     		pop {r0-r7,pc}
 1004              	
 1005              	
 1006              		
 1007              	_chufa:				@软件除法
 1008              		@ r0 除以 r1 等于 商(r0)余数R1
 1009 07e0 1CB5     		push {r2-r4,lr}
 1010 07e2 0028     		cmp r0, # 0
 1011 07e4 0FD0     		beq _chufafanhui
 1012 07e6 0029     		cmp r1, # 0
 1013 07e8 0DD0     		beq _chufafanhui
 1014 07ea 0246     		mov r2, r0
 1015 07ec 0123     		movs r3, # 1
 1016 07ee DB07     		lsls r3, r3, # 31
 1017 07f0 0020     		movs r0, # 0
 1018 07f2 0446     		mov r4, r0
 1019              	_chufaxunhuan:
 1020 07f4 5200     		lsls r2, r2, # 1
 1021 07f6 6441     		adcs r4, r4, r4
 1022 07f8 8C42     		cmp r4, r1
 1023 07fa 01D3     		bcc _chufaweishubudao0
 1024 07fc C018     		adds r0, r0, r3
 1025 07fe 641A     		subs r4, r4, r1
 1026              	_chufaweishubudao0:
 1027 0800 5B08     		lsrs r3, r3, # 1
 1028 0802 F7D1     		bne _chufaxunhuan
 1029 0804 2146     		mov r1, r4
 1030              	_chufafanhui:
 1031 0806 1CBD     		pop {r2-r4,pc}
 1032 0808 00200000 		.ltorg
 1032      30000020 
 1032      00000048 
 1033              	
 1034              	
 1035              	_nmi_handler:
 1036 0814 7047     		bx lr
 1037              	_hard_fault:
 1038 0816 7047     		bx lr
 1039              	_svc_handler:
 1040 0818 7047     		bx lr
 1041              	_pendsv_handler:
 1042 081a 7047     		bx lr
 1043              	_systickzhongduan:
 1044 081c 034A     		ldr r2, = jishu
 1045 081e 0448     		ldr r0, = 0xe0000d04
 1046 0820 1368     		ldr r3, [r2]
 1047 0822 0449     		ldr r1, = 0x02000000
 1048 0824 0133     		adds r3, r3, # 1
 1049 0826 1360     		str r3, [r2]
 1050 0828 0160     		str r1, [r0]                 @ 清除SYSTICK中断
 1051              	aaa:
 1052 082a 70473400 		bx lr
 1052      0020040D 
 1052      00E00000 
 1052      0002
ARM GAS  1.s 			page 20


DEFINED SYMBOLS
                 1.s:9      .data:0000000000000000 zheng_xian_biao
                 1.s:11     .data:00000000000000ca lcdshuju
                 1.s:13     .data:00000000000000da dianhua
                 1.s:15     .data:00000000000000ea qq
                 1.s:17     .data:00000000000000fa xushu
                 1.s:19     .data:00000000000000fb fu
                 1.s:21     .data:00000000000000fc zheng
                 1.s:23     .data:00000000000000fd dianzu
                 1.s:25     .data:00000000000000ff dianrong
                 1.s:27     .data:0000000000000101 pinlv
                 1.s:29     .data:0000000000000106 qianou
                 1.s:31     .data:0000000000000107 ou
                 1.s:33     .data:000000000000010b kong
                 1.s:35     .data:000000000000010f pifa
                 1.s:37     .data:0000000000000111 xiaomai
                 1.s:39     *ABS*:0000000020001000 STACKINIT
                 1.s:40     *ABS*:0000000020000000 asciimabiao
                 1.s:41     *ABS*:0000000020000030 liangcheng
                 1.s:42     *ABS*:0000000020000034 jishu
                 1.s:43     *ABS*:0000000020000038 jianbo
                 1.s:44     *ABS*:0000000020000040 dianyabiao
                 1.s:45     *ABS*:0000000020000600 lvboqizhizhen
                 1.s:46     *ABS*:0000000020000604 lvboqihuanchong
                 1.s:47     *ABS*:0000000020000700 lvboqizhizhen1
                 1.s:48     *ABS*:0000000020000704 lvboqihuanchong1
                 1.s:49     *ABS*:0000000020000800 lvboqizhizhen2
                 1.s:50     *ABS*:0000000020000804 lvboqihuanchong2
                 1.s:51     *ABS*:0000000020000900 lvboqizhizhen3
                 1.s:52     *ABS*:0000000020000904 lvboqihuanchong3
                 1.s:53     *ABS*:0000000020000a00 xia_bi_shi_bu
                 1.s:54     *ABS*:0000000020000a04 shang_bi_shi_bu
                 1.s:55     *ABS*:0000000020000a08 xia_bi_xu_bu
                 1.s:56     *ABS*:0000000020000a0c shang_bi_xu_bu
                 1.s:57     *ABS*:0000000020000a10 bu_chang_100r
                 1.s:58     *ABS*:0000000020000a14 zidongliangchengyanshi
                 1.s:59     *ABS*:0000000020000a18 dianzuzhi
                 1.s:60     *ABS*:0000000020000a1c dianrongzhi
                 1.s:62     .text:0000000000000000 vectors
                 1.s:109    .text:00000000000000b0 _start
                 1.s:1035   .text:0000000000000814 _nmi_handler
                 1.s:1037   .text:0000000000000816 _hard_fault
                 1.s:1039   .text:0000000000000818 _svc_handler
                 1.s:1041   .text:000000000000081a _pendsv_handler
                 1.s:1043   .text:000000000000081c _systickzhongduan
                 1.s:1051   .text:000000000000082a aaa
                            .text:0000000000000000 $d
                 1.s:107    .text:00000000000000b0 $t
                 1.s:111    .text:00000000000000b2 yanshi111
                 1.s:115    .text:00000000000000b6 shizhong
                 1.s:122    .text:00000000000000c2 denghse
                 1.s:126    .text:00000000000000c8 dengpllguan
                 1.s:134    .text:00000000000000d6 dengpll
                 1.s:141    .text:00000000000000e0 dengdai14mshizhongwending
                 1.s:146    .text:00000000000000e6 _neicunqingling
                 1.s:150    .text:00000000000000ec _neicunqinglingxunhuan
                 1.s:155    .text:00000000000000f2 _waisheshizhong
ARM GAS  1.s 			page 21


                 1.s:171    .text:00000000000000fc _waishezhongduan
                 1.s:186    .text:00000000000000fc io_she_zhi
                 1.s:215    .text:0000000000000106 _adcchushihua
                 1.s:219    .text:000000000000010c _dengadcjiaozhun
                 1.s:223    .text:0000000000000112 _kaiadc
                 1.s:228    .text:000000000000011a _dengdaiadcwending
                 1.s:232    .text:0000000000000120 _tongdaoxuanze
                 1.s:246    .text:0000000000000134 dmachushihua
                 1.s:277    .text:0000000000000158 tim1chushiha
                 1.s:303    .text:0000000000000182 _lcdchushihua
                 1.s:901    .text:0000000000000732 _xielcd
                 1.s:893    .text:0000000000000728 _lcdyanshi
                 1.s:478    .text:00000000000003b8 dd
                 1.s:337    .text:00000000000001c6 ting
                 1.s:745    .text:00000000000005ae __zi_dong_liang_cheng
                 1.s:788    .text:00000000000005f0 _jianbo
                 1.s:710    .text:000000000000056a __zhen_fu_lv_bo
                 1.s:574    .text:0000000000000456 __zu_kang_ji_suan
                 1.s:973    .text:00000000000007aa _zhuanascii
                 1.s:876    .text:000000000000070c _lcdxianshi
                 1.s:354    .text:00000000000001f2 __liangcheng100k
                 1.s:378    .text:000000000000022a __liangcheng10k
                 1.s:1007   .text:00000000000007e0 _chufa
                 1.s:443    .text:00000000000002bc __xian_shi_qi_ta
                 1.s:400    .text:000000000000025c __liangcheng1k
                 1.s:422    .text:000000000000028e __liangcheng100r
                 1.s:464    .text:00000000000002ea __xian_shi_dian_rong
                 1.s:476    .text:0000000000000300 $d
                 1.s:479    .text:00000000000003b8 $t
                 1.s:657    .text:00000000000004f2 __xian_shi_shang_xia_bi
                 1.s:497    .text:00000000000003e2 __dian_zu_ji_suan
                 1.s:507    .text:00000000000003f0 __liang_cheng_100k
                 1.s:512    .text:00000000000003f8 __liang_cheng10k
                 1.s:524    .text:000000000000040a __ji_suan_dian_zu
                 1.s:517    .text:0000000000000400 __liang_cheng1k
                 1.s:522    .text:0000000000000408 __liang_cheng100ou
                 1.s:528    .text:0000000000000412 __ji_suan_fu_du
                 1.s:538    .text:000000000000041c _shibubushifushu
                 1.s:543    .text:0000000000000424 _xububushifushu
                 1.s:548    .text:000000000000042c _panduanxubushibushi0
                 1.s:552    .text:0000000000000432 _jisuanfudu1
                 1.s:565    .text:0000000000000448 _alpha_min_beta_max
                 1.s:557    .text:000000000000043a _alpha_max_beta_min
                 1.s:586    .text:000000000000046c __c_liang_cheng_100k
                 1.s:591    .text:0000000000000474 __c_liang_cheng10k
                 1.s:603    .text:0000000000000486 __ji_suan_dian_rong
                 1.s:596    .text:000000000000047c __c_liang_cheng1k
                 1.s:601    .text:0000000000000484 __c_liang_cheng100ou
                 1.s:846    .text:0000000000000660 _lvboqi
                 1.s:785    .text:00000000000005ee __liang_cheng_fan_hui
                 1.s:777    .text:00000000000005e2 __xuan_kong
                 1.s:766    .text:00000000000005d2 __pan_duan_liang_cheng
                 1.s:773    .text:00000000000005de __gai_liang_cheng
                 1.s:775    .text:00000000000005e0 __bao_cun_liang_cheng
                 1.s:782    .text:00000000000005ea __liang_cheng_chong_zhi
                 1.s:818    .text:0000000000000636 _jianboyanshi
                 1.s:826    .text:0000000000000640 __zhao_zui_da_shu
ARM GAS  1.s 			page 22


                 1.s:821    .text:000000000000063a _jianboyanshixunhuan
                 1.s:832    .text:000000000000064a __zhao
                 1.s:838    .text:0000000000000654 __di_zhi_jian
                 1.s:858    .text:0000000000000670 _lvboqimeidaohuanchongquding
                 1.s:861    .text:0000000000000674 _lvboqixunhuan
                 1.s:865    .text:000000000000067a _lvbozonghe
                 1.s:873    .text:0000000000000688 $d
                 1.s:877    .text:000000000000070c $t
                 1.s:885    .text:000000000000071a _lcdxianshixunhuan
                 1.s:896    .text:000000000000072c _lcdyanshixunhuan
                 1.s:915    .text:000000000000074a __lcd_ming_ling
                 1.s:912    .text:0000000000000746 __lcd_shu_ju
                 1.s:917    .text:000000000000074c __xie_lcd_shu_ju
                 1.s:932    .text:000000000000076e __74hc595
                 1.s:939    .text:000000000000077a __595_yiweixunhuan
                 1.s:943    .text:0000000000000780 __595_yanshi
                 1.s:952    .text:000000000000078e __ser_0
                 1.s:949    .text:000000000000078a __ser_1
                 1.s:954    .text:0000000000000790 __595_yiwei
                 1.s:957    .text:0000000000000794 __595_yanshi1
                 1.s:965    .text:00000000000007a2 __595_yanshi2
                 1.s:980    .text:00000000000007b4 _xunhuanqiuma
                 1.s:1001   .text:00000000000007dc _qiumafanhui
                 1.s:996    .text:00000000000007d4 _meidaoxiaoshudian
                 1.s:1030   .text:0000000000000806 _chufafanhui
                 1.s:1019   .text:00000000000007f4 _chufaxunhuan
                 1.s:1026   .text:0000000000000800 _chufaweishubudao0
                 1.s:1032   .text:0000000000000808 $d
                 1.s:1036   .text:0000000000000814 $t
                 1.s:1052   .text:000000000000082c $d

NO UNDEFINED SYMBOLS
