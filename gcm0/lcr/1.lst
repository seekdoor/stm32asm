ARM GAS  1.s 			page 1


   1              		@@ 单片机stm32f030f4p6
   2              		@@ 阻抗桥
   3              		@作者：yjmwxwx
   4              		@时间：2019-08-12
   5              		@编译器：ARM-NONE-EABI
   6              		 .thumb
   7              		         .syntax unified
   8              	.section .data
   9              	zheng_xian_biao:
  10 0000 18001900 		.short 24,25,26,28,29,31,32,34,35,36,37,38,40,41,42,43,43,44,45,45,46,46,47,47,47,47,47,47,47,46,4
  10      1A001C00 
  10      1D001F00 
  10      20002200 
  10      23002400 
  11              	lcdshuju:
  12 00ca 796A6D77 		.ascii  "yjmwxwx-20190812"
  12      7877782D 
  12      32303139 
  12      30383132 
  13              	dianhua:	
  14 00da 20202020 		.ascii	"     15552208295"
  14      20313535 
  14      35323230 
  14      38323935 
  15              	qq:
  16 00ea 20202051 		.ascii	"   QQ:3341656346"
  16      513A3333 
  16      34313635 
  16      36333436 
  17              	xushu:
  18 00fa 69       		.ascii "i"
  19              	fu:
  20 00fb 2D       		.ascii "-"
  21              	zheng:
  22 00fc 2B       		.ascii "+"
  23              	xiaomai:
  24 00fd 7869616F 		.ascii "xiaomai ="
  24      6D616920 
  24      3D
  25              		.equ STACKINIT,        	        0x20001000
  26              		.equ asciimabiao,		0x20000000
  27              		.equ liangcheng,		0x20000030
  28              		.equ jishu,			0x20000034
  29              		.equ jianbo,			0x20000038
  30              		.equ dianyabiao,		0x20000040
  31              		.equ lvboqizhizhen,		0x20000200
  32              		.equ lvboqihuanchong,		0x20000204
  33              		.equ lvboqizhizhen1,		0x20000410
  34              		.equ lvboqihuanchong1,		0x20000414
  35              		.equ lvboqizhizhen2,		0x20000620
  36              		.equ lvboqihuanchong2,		0x20000624
  37              		.equ lvboqizhizhen3,		0x20000830
  38              		.equ lvboqihuanchong3,		0x20000834
  39              	
  40              		.section .text
  41              	vectors:
  42 0000 00100020 		.word STACKINIT
ARM GAS  1.s 			page 2


  43 0004 B1000000 		.word _start + 1
  44 0008 91040000 		.word _nmi_handler + 1
  45 000c 93040000 		.word _hard_fault  + 1
  46 0010 00000000 		.word 0
  47 0014 00000000 		.word 0
  48 0018 00000000 		.word 0
  49 001c 00000000 		.word 0
  50 0020 00000000 		.word 0
  51 0024 00000000 		.word 0
  52 0028 00000000 		.word 0
  53 002c 95040000 		.word _svc_handler +1
  54 0030 00000000 		.word 0
  55 0034 00000000 		.word 0
  56 0038 97040000 		.word _pendsv_handler +1
  57 003c 99040000 		.word _systickzhongduan +1               @ 15
  58 0040 A7040000 		.word aaa +1     @ _wwdg +1          @ 0
  59 0044 A7040000 		.word aaa +1     @_pvd +1            @ 1
  60 0048 A7040000 		.word aaa +1     @_rtc +1            @ 2
  61 004c A7040000 		.word aaa +1     @_flash +1          @ 3
  62 0050 A7040000 		.word aaa +1	@ _rcc + 1          @ 4
  63 0054 A7040000 		.word aaa +1      @_exti0_1  +1      @ 5
  64 0058 A7040000 		.word aaa +1      @ _exti2_3 +1      @ 6
  65 005c A7040000 		.word aaa +1       @_exti4_15 +1     @ 7
  66 0060 A7040000 		.word aaa +1                         @ 8
  67 0064 A7040000 		.word aaa +1 	@_dma1_1  +1    @ 9
  68 0068 A7040000 		.word aaa +1    @_dma1_2_3 +1        @ 10
  69 006c A7040000 		.word aaa +1       @_dma1_4_5 +1     @ 11
  70 0070 A7040000 		.word aaa +1	 @_adc1 +1          @ 12
  71 0074 A7040000 		.word aaa +1       @_tim1_brk_up +1  @ 13
  72 0078 A7040000 		.word aaa +1        @ _tim1_cc +1    @ 14
  73 007c A7040000 		.word aaa +1         @_tim2 +1       @ 15
  74 0080 A7040000 		.word aaa +1          @_tim3 +1      @ 16
  75 0084 A7040000 		.word aaa +1                         @ 17
  76 0088 A7040000 		.word aaa +1		                @ 18
  77 008c A7040000 		.word aaa +1	@_tim14 +1    @ 19
  78 0090 A7040000 		.word aaa +1                         @ 20
  79 0094 A7040000 		.word aaa +1         @_tim16 +1      @ 21
  80 0098 A7040000 		.word aaa +1         @_tim17 +1      @ 22
  81 009c A7040000 		.word aaa +1          @_i2c   +1     @ 23
  82 00a0 A7040000 		.word aaa +1                         @ 24
  83 00a4 A7040000 		.word aaa +1           @_spi   +1    @ 25
  84 00a8 A7040000 		.word aaa +1                         @ 26
  85 00ac A7040000 		.word aaa +1         @_usart1 +1     @ 27
  86              		.align 2
  87              	
  88              	_start:
  89 00b0 C748     		ldr r0, = 0xffff
  90              	yanshi111:
  91 00b2 0138     		subs r0, r0, # 1
  92 00b4 FDD1     		bne yanshi111
  93              		
  94              	shizhong:
  95 00b6 C74A     		ldr r2, = 0x40022000   @FLASH访问控制
  96 00b8 3221     		movs r1, # 0x32
  97 00ba 1160     		str r1, [r2]           @FLASH缓冲 缓冲开启
  98 00bc C648     		ldr r0, = 0x40021000 @ rcc
  99 00be C749     		ldr r1, = 0x10001
ARM GAS  1.s 			page 3


 100 00c0 0160     		str r1, [r0]
 101              	denghse:
 102 00c2 0168     		ldr r1, [r0]
 103 00c4 8903     		lsls r1, r1, # 14
 104 00c6 FCD5     		bpl denghse
 105              	dengpllguan:
 106 00c8 0168     		ldr r1, [r0]
 107 00ca 8901     		lsls r1, r1, # 6
 108 00cc FCD4     		bmi dengpllguan
 109 00ce C449     	        ldr r1, = 0x110002
 110 00d0 4160     	        str r1, [r0, # 0x04]
 111 00d2 C449     		ldr r1, = 0x1010001
 112 00d4 0160     		str r1, [r0]
 113              	dengpll:
 114 00d6 0168     		ldr r1, [r0]
 115 00d8 8901     		lsls r1, # 6
 116 00da FCD5     		bpl dengpll
 117              		@0x34时钟控制寄存器 2 (RCC_CR2)
 118 00dc 0121     		movs r1, # 0x01
 119 00de 4163     		str r1, [r0, # 0x34]  @ HSI开14M时钟
 120              	dengdai14mshizhongwending:
 121 00e0 416B     		ldr r1, [r0, # 0x34]
 122 00e2 8907     		lsls r1, r1, # 30     @ 左移30位
 123 00e4 FCD5     		bpl dengdai14mshizhongwending  @ 等待14M时钟稳定
 124              	
 125              	_neicunqingling:
 126 00e6 C048     		ldr r0, = 0x20000000
 127 00e8 0021     		movs r1, # 0
 128 00ea C04B     		ldr r3, = 0x1000
 129              	_neicunqinglingxunhuan:
 130 00ec 043B     		subs r3, # 4
 131 00ee C150     		str r1, [r0, r3]
 132 00f0 FCD1     		bne _neicunqinglingxunhuan
 133              	
 134              	_waisheshizhong:			 @ 外设时钟
 135              		@+0x14=RCC_AHBENR
 136              		@0=DMA @2=SRAM @4=FLITF@6=CRC @17=PA @18=PB @19=PC @20=PD @22=PF
 137 00f2 B948     		ldr r0, = 0x40021000
 138 00f4 BE49     		ldr r1, = 0x460005
 139 00f6 4161     		str r1, [r0, # 0x14]
 140              	
 141              		@+0x18外设时钟使能寄存器 (RCC_APB2ENR)
 142              		@0=SYSCFG @5=USART6EN @9=ADC @11=TIM1 @12=SPI1 @14=USART1 @16=TIM15 @17=TIM16 @18=TIM17 @22=DBGMCU
 143 00f8 BE49     		ldr r1, = 0xa00
 144 00fa 8161     		str r1, [r0, # 0x18]
 145              		@+0X1C=RCC_APB1ENR
 146              		@1=TIM3 @4=TIM6 @5=TIM7 @8=TIM14 @11=WWDG @14=SPI @17=USRT2 @18=USART3 @20=USART5 @21=I2C1
 147              		@22=I2C2 @23=USB @28=PWR
 148 00fc 0221     		movs r1, # 0x02
 149 00fe C161     		str r1, [r0, # 0x1c]
 150              	
 151              	
 152              	_waishezhongduan:				@外设中断
 153              		@0xE000E100    0-31  写1开，写0没效
 154              		@0XE000E180    0-31 写1关，写0没效
 155              		@0XE000E200    0-31 挂起，写0没效
 156              		@0XE000E280    0-31 清除， 写0没效
ARM GAS  1.s 			page 4


 157              	
 158              	@_systick:				@ systick定时器初始化
 159              	
 160              	@	ldr r0, = 0xe000e010
 161              	@	ldr r1, = 0xffffff
 162              	@	str r1, [r0, # 4]
 163              	@	str r1, [r0, # 8]
 164              	@	movs r1, # 0x07
 165              	@	str r1, [r0]
 166              		
 167              	io_she_zhi:
 168              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 169              		@a(0x48000000)b(0x48000400)c(0x48000800)d(0x48000c00)f(0x48001400)
 170              		@ 输入（00），通用输出（01），复用功能（10），模拟（11）
 171              		@偏移0x4 = 端口输出类型 @ （0 推挽），（ 1 开漏）
 172              		@偏移0x8 = 输出速度  00低速， 01中速， 11高速
 173              		@偏移0xC = 上拉下拉 (00无上下拉，  01 上拉， 10下拉)
 174              		@偏移0x10 = 输入数据寄存器
 175              		@偏移0x14 = 输出数据寄存器
 176              		@偏移0x18 = 端口开  0-15置位
 177              		@偏移0x28 = 端口关
 178              		@0X20 = 复用低
 179              		@GPIO口0（0-3位）每个IO口占用4位
 180              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 181              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 182              		@0x24 = 复用高
 183              		@GPIO口8 （0-3位）每个IO口占用4位
 184              		@ AF0 = 0X0000, AF1 = 0X0001, AF2 = 0X0010 AF3 = 0X0011, AF4 = 0X0100
 185              		@ AF5 = 0X0101, AF6 = 0X0111, AF7 = 0X1000
 186              		@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 187              	
 188 0100 BD48     		ldr r0, = 0x48000000
 189 0102 BE49     		ldr r1, = 0x2824540f
 190 0104 0160     		str r1, [r0]
 191 0106 BE49     		ldr r1, = 0x200
 192 0108 4162     		str r1, [r0, # 0x24]
 193              	
 194              	
 195              	
 196              	
 197              	
 198              		
 199              	dmachushihua:
 200              	        @+0=LSR,+4=IFCR,
 201              	        @+8=CCR1,+c=CNDTR1,+10=CPAR1+14=CMAR1,
 202              	        @+1c=CCR2,+20=CNDTR2,+24=CPAR2,+28=CMAR2
 203              	        @+30=CCR3,+34=CNDTR3,+38=CPAR2,+3c=CMAR3
 204              	        @+44=CCR4,+48=CNDTR4,+4c=CPAR4,+50=CMAR4
 205              	        @+58=CCR5,+5c=CNDTR5,+60=CPAR5,+64=CMAR5
 206              	        @+6C=CCR6,+70=CNDTR6,+74=CPAR6,+78=CMAR6
 207              	        @+80=CCR7,+84=CNDTR7,+88=CPAR7,+8c=CMAR7
 208              	
 209              	        @tim1ch3DMA
 210 010a BE48     	        ldr r0, = 0x40020000
 211 010c BE49     	        ldr r1, = 0x40012c3c @ 外设地址
 212 010e 0166     	        str r1, [r0, # 0x60]
 213 0110 BE49     	        ldr r1, = zheng_xian_biao @ 储存器地址
ARM GAS  1.s 			page 5


 214 0112 4166     	        str r1, [r0, # 0x64]
 215 0114 BE49     	        ldr r1, = 100             @点数
 216 0116 C165     	        str r1, [r0, # 0x5c]
 217 0118 BE49     	        ldr r1, = 0x35b1         @ 储存到外设
 218 011a 8165     	        str r1, [r0, # 0x58]
 219              		@ adc dma
 220 011c B948     		ldr r0, = 0x40020000
 221 011e BE49     		ldr r1, = 0x40012440
 222 0120 0161     		str r1, [r0, # 0x10]
 223 0122 BE49     		ldr r1, = dianyabiao
 224 0124 4161     		str r1, [r0, # 0x14]
 225 0126 BA49     		ldr r1, =  100
 226 0128 C160     		str r1, [r0, # 0x0c]
 227 012a BD49     		ldr r1, = 0x5a1		@ 5a1
 228 012c 8160     		str r1, [r0, # 0x08]
 229              	
 230              	
 231              	tim1chushiha:
 232 012e BD48     	        ldr r0, = 0x40012c00 @ tim1_cr1
 233 0130 0021     	        movs r1, # 0
 234 0132 8162     	        str r1, [r0, # 0x28] @ psc
 235 0134 BC49     	        ldr r1, = 47
 236 0136 C162     	        str r1, [r0, # 0x2c] @ ARR
 237 0138 4021     		movs r1, # 0x40
 238 013a 4160     		str r1, [r0, # 0x04] @ TRGO
 239 013c 3821     		movs r1, # 0x38
 240 013e 8161     		str r1, [r0, # 0x18] @ ccmr1 cc1
 241 0140 2F21     		movs r1, # 47
 242 0142 4163     		str r1, [r0, # 0x34]
 243 0144 B949     	        ldr r1, = 0x68
 244 0146 C161     	        str r1, [r0, # 0x1c] @ ccmr2  CC3
 245 0148 B949     	        ldr r1, = 0x100    @  CC3
 246 014a 0162     	        str r1, [r0, # 0x20] @ ccer
 247 014c B949     	        ldr r1, = 0x8000
 248 014e 4164     	        str r1, [r0, # 0x44] @ BDTR
 249 0150 B949     	        ldr r1, = 0x800 @ CC3 DMA
 250 0152 C160     	        str r1, [r0, # 0x0c] @ DIER
 251 0154 B949     	        ldr r1, = 0x81
 252 0156 0160     	        str r1, [r0]
 253              	
 254              	_adcchushihua:
 255 0158 B948     	        ldr r0, = 0x40012400  @ adc基地址
 256 015a BA49     	        ldr r1, = 0x80000000
 257 015c 8160     	        str r1, [r0, # 0x08]  @ ADC 控制寄存器 (ADC_CR)  @adc校准
 258              	_dengadcjiaozhun:
 259 015e 8168     	        ldr r1, [r0, # 0x08]
 260 0160 0900     	        movs r1, r1
 261 0162 FCD4     	        bmi _dengadcjiaozhun   @ 等ADC校准
 262              	_kaiadc:
 263 0164 8168     	        ldr r1, [r0, # 0x08]
 264 0166 0122     	        movs r2, # 0x01
 265 0168 1143     	        orrs r1, r1, r2
 266 016a 8160     	        str r1, [r0, # 0x08]
 267              	_dengdaiadcwending:
 268 016c 0168     	        ldr r1, [r0]
 269 016e C907     	        lsls r1, r1, # 31
 270 0170 FCD5     	        bpl _dengdaiadcwending @ 等ADC稳定
ARM GAS  1.s 			page 6


 271              	_tongdaoxuanze:
 272 0172 B549     	        ldr r1, = 1
 273 0174 8162     	        str r1, [r0, # 0x28]    @ 通道选择寄存器 (ADC_CHSELR)
 274 0176 B549     	        ldr r1, = 0xc03
 275 0178 C160     	        str r1, [r0, # 0x0c]    @ 配置寄存器 1 (ADC_CFGR1)
 276 017a 0021     	        movs r1, # 0
 277 017c 4161     	        str r1, [r0, # 0x14]    @ ADC 采样时间寄存器 (ADC_SMPR)
 278 017e 8168     		ldr r1, [r0, # 0x08]
 279 0180 B34A     		ldr r2, = 0x04         @ 开始转换
 280 0182 1143     		orrs r1, r1, r2
 281 0184 8160     		str r1, [r0, # 0x08]    @ 控制寄存器 (ADC_CR)
 282              	
 283              	_lcdchushihua:
 284 0186 3320     		movs r0, # 0x33
 285 0188 0021     		movs r1, # 0
 286 018a 00F0B8F8 		bl _xielcd
 287 018e 00F0B1F8 		bl _lcdyanshi
 288 0192 3220     		movs r0, # 0x32
 289 0194 0021     		movs r1, # 0
 290 0196 00F0B2F8 		bl _xielcd
 291 019a 00F0ABF8 		bl _lcdyanshi
 292 019e 2820     		movs r0, # 0x28
 293 01a0 0021     		movs r1, # 0
 294 01a2 00F0ACF8 		bl _xielcd
 295 01a6 00F0A5F8 		bl _lcdyanshi
 296 01aa 0C20     		movs r0, # 0x0c
 297 01ac 0021     		movs r1, # 0
 298 01ae 00F0A6F8 		bl _xielcd
 299 01b2 00F09FF8 		bl _lcdyanshi
 300 01b6 0120     		movs r0, # 0x01
 301 01b8 0021     		movs r1, # 0
 302 01ba 00F0A0F8 		bl _xielcd
 303 01be 00F099F8 		bl _lcdyanshi
 304              	
 305              	
 306 01c2 C420     		movs r0, # 0xc4
 307 01c4 A349     		ldr r1, = xushu
 308 01c6 0122     		movs r2, # 1
 309 01c8 FF23     		movs r3, # 0xff
 310 01ca 00F085F8 		bl _lcdxianshi
 311              	
 312 01ce CF20     	        movs r0, # 0xcf
 313 01d0 A049     	        ldr r1, = xushu
 314 01d2 0122     	        movs r2, # 1
 315 01d4 FF23     	        movs r3, # 0xff
 316 01d6 00F07FF8 	        bl _lcdxianshi
 317              	
 318              	
 319 01da 9F48     		ldr r0, = liangcheng
 320 01dc 8021     		movs r1, # 0x80
 321 01de 0160     		str r1, [r0]
 322              	
 323              	ting:
 324 01e0 00F044F8 		bl _jianbo
 325 01e4 1546     		mov r5, r2
 326 01e6 1E46     		mov r6, r3
 327 01e8 0C46     		mov r4, r1
ARM GAS  1.s 			page 7


 328 01ea 0346     		mov r3, r0
 329 01ec 9B48     		ldr r0, = lvboqihuanchong
 330 01ee 9C49     		ldr r1, = 16
 331 01f0 9C4A     		ldr r2, = lvboqizhizhen
 332 01f2 00F05DF8 		bl _lvboqi
 333 01f6 0421     		movs r1, # 4
 334 01f8 7B4A     		ldr r2, = asciimabiao
 335 01fa FF23     		movs r3, # 0xff
 336 01fc 00F0BBF8 		bl _zhuanascii
 337 0200 8B20     		movs r0, # 0x8b
 338 0202 7949     		ldr r1, = asciimabiao
 339 0204 0422     		movs r2, # 0x04
 340 0206 00F067F8 		bl _lcdxianshi
 341              	
 342 020a 2346     	        mov r3, r4
 343 020c 9648     	        ldr r0, = lvboqihuanchong1
 344 020e 9449     		ldr r1, = 16
 345 0210 964A     		ldr r2, = lvboqizhizhen1
 346 0212 00F04DF8 	        bl _lvboqi
 347 0216 0421     	        movs r1, # 4
 348 0218 734A     		ldr r2, = asciimabiao
 349 021a FF23     	        movs r3, # 0xff
 350 021c 00F0ABF8 	        bl _zhuanascii
 351 0220 8020     	        movs r0, # 0x80
 352 0222 7149     	        ldr r1, = asciimabiao
 353 0224 0422     	        movs r2, # 0x04
 354 0226 00F057F8 	        bl _lcdxianshi
 355              	
 356 022a 2B46     		mov r3, r5
 357 022c 9048     		ldr r0, = lvboqihuanchong2
 358 022e 8C49     	        ldr r1, = 16
 359 0230 904A     	        ldr r2, = lvboqizhizhen2
 360 0232 00F03DF8 		bl _lvboqi
 361 0236 0421     	        movs r1, # 4
 362 0238 6B4A     	        ldr r2, = asciimabiao
 363 023a FF23     		movs r3, # 0xff
 364 023c 00F09BF8 	        bl _zhuanascii
 365 0240 CB20     	        movs r0, # 0xcb
 366 0242 6949     	        ldr r1, = asciimabiao
 367 0244 0422     		movs r2, # 0x04
 368 0246 00F047F8 		bl _lcdxianshi
 369              	
 370 024a 3346     	        mov r3, r6
 371 024c 8A48     		ldr r0, = lvboqihuanchong3
 372 024e 8449     		ldr r1, = 16
 373 0250 8A4A     		ldr r2, = lvboqizhizhen3
 374 0252 00F02DF8 	        bl _lvboqi
 375 0256 0421     		movs r1, # 4
 376 0258 634A     		ldr r2, = asciimabiao
 377 025a FF23     	        movs r3, # 0xff
 378 025c 00F08BF8 	        bl _zhuanascii
 379 0260 C020     	        movs r0, # 0xc0
 380 0262 6149     		ldr r1, = asciimabiao
 381 0264 0422     	        movs r2, # 0x04
 382 0266 00F037F8 		bl _lcdxianshi
 383              	
 384              	
ARM GAS  1.s 			page 8


 385 026a B9E7     		b ting
 386              		
 387              	
 388              	
 389              	
 390              	_jianbo:				@ 出口r0 r1 r2 r3
 391 026c F0B5     		push {r4-r7,lr}
 392 026e 624F     	        ldr r7, = 0x48000000
 393 0270 634E     	        ldr r6, = 0x200
 394 0272 BE62     		str r6, [r7, # 0x28]
 395 0274 824D     	        ldr r5, = 0x40012428
 396 0276 0124     	        movs r4, # 1
 397 0278 2C60     	        str r4, [r5]
 398              	
 399 027a 00F014F8 		bl _jianboyanshi
 400 027e 814C     		ldr r4, = 0x20000088
 401 0280 2088     		ldrh r0, [r4]
 402              	
 403              	
 404 0282 BE61     		str r6, [r7, # 0x18]
 405 0284 00F00FF8 		bl _jianboyanshi
 406 0288 7F4C     		ldr r4, = 0x200000b8
 407 028a 2188     		ldrh r1, [r4]
 408              		
 409 028c 0224     		movs r4, # 2
 410 028e 2C60     		str r4, [r5]
 411 0290 BE62     		str r6, [r7, # 0x28]
 412 0292 00F008F8 		bl _jianboyanshi
 413 0296 7C4C     		ldr r4, = 0x200000b8
 414 0298 2288     		ldrh r2, [r4]
 415              	
 416 029a BE61     		str r6, [r7, # 0x18]
 417 029c 00F003F8 		bl _jianboyanshi
 418 02a0 784C     		ldr r4, = 0x20000088
 419 02a2 2388     		ldrh r3, [r4]
 420 02a4 F0BD     		pop {r4-r7,pc}
 421              	_jianboyanshi:
 422 02a6 80B5     		push {r7,lr}
 423 02a8 494F     		ldr r7, = 0xffff
 424              	_jianboyanshixunhuan:
 425 02aa 013F     		subs r7, r7, # 1
 426 02ac FDD1     		bne _jianboyanshixunhuan
 427 02ae 80BD     		pop {r7,pc}
 428              	_lvboqi:
 429              				@滤波器
 430              				@R0=地址，R1=长度,r2=表指针地址,r3=ADC数值
 431              				@出R0=结果
 432 02b0 FEB5     		push {r1-r7,lr}	
 433 02b2 1568     		ldr r5, [r2]		@读出表指针
 434 02b4 4E00     		lsls r6, r1, # 1	
 435 02b6 4353     		strh r3, [r0, r5]	@数值写到滤波器缓冲区
 436 02b8 0235     		adds r5, r5, # 2
 437 02ba B542     		cmp r5, r6
 438 02bc 00D1     		bne _lvboqimeidaohuanchongquding
 439 02be 0025     		movs r5, # 0
 440              	_lvboqimeidaohuanchongquding:
 441 02c0 1560     		str r5, [r2]
ARM GAS  1.s 			page 9


 442 02c2 0027     		movs r7, # 0
 443              	_lvboqixunhuan:
 444 02c4 B542     		cmp r5, r6
 445 02c6 00D1     		bne _lvbozonghe
 446 02c8 0025     		movs r5, # 0
 447              	_lvbozonghe:
 448 02ca 445B     		ldrh r4, [r0, r5]
 449 02cc 0235     		adds r5, r5, # 2
 450 02ce 3F19     		adds r7, r7, r4
 451 02d0 0139     		subs r1, r1, # 1
 452 02d2 F7D1     		bne _lvboqixunhuan
 453 02d4 3811     		asrs r0, r7, # 4	@修改
 454 02d6 FEBD     		pop {r1-r7,pc}
 455              	
 456              	
 457              		
 458              	_lcdxianshi:	  		@r0=LCD位置，r1=数据地址，r2=长度
 459 02d8 1FB5     		push {r0-r4,lr}
 460 02da 0C46     		mov r4, r1
 461              	
 462 02dc 0021     		movs r1, # 0
 463 02de 00F00EF8 		bl _xielcd
 464              	
 465 02e2 0121     		movs r1, # 1
 466 02e4 0023     		movs r3, # 0
 467              	_lcdxianshixunhuan:
 468 02e6 E05C     		ldrb r0, [r4,r3]
 469 02e8 00F009F8 		bl _xielcd
 470 02ec 0133     		adds r3, r3, # 1
 471 02ee 9342     		cmp r3, r2
 472 02f0 F9D1     		bne _lcdxianshixunhuan
 473 02f2 1FBD     		pop {r0-r4,pc}
 474              	
 475              	_lcdyanshi:
 476 02f4 20B5     		push {r5,lr}
 477 02f6 654D     		ldr r5, = 0x2000
 478              	_lcdyanshixunhuan:
 479 02f8 013D     		subs r5, r5, # 1
 480 02fa FDD1     		bne _lcdyanshixunhuan
 481 02fc 20BD     		pop {r5,pc}
 482              	
 483              	_xielcd:			@入R0=8位,r1=0命令,r1=1数据
 484 02fe 3FB5     		push {r0-r5,lr}
 485 0300 554C     		ldr r4, = liangcheng  @ 量程开关 (第6位和第7位)
 486 0302 0246     		mov r2, r0
 487 0304 2568     		ldr r5, [r4]
 488 0306 1209     		lsrs r2, r2, # 4
 489 0308 9200     		lsls r2, r2, # 2	@ 高四位
 490 030a 0007     		lsls r0, r0, # 28
 491 030c 800E     		lsrs r0, r0, # 26	@ 低四位
 492 030e C907     		lsls r1, r1, # 31
 493 0310 01D5     		bpl __lcd_ming_ling
 494              	__lcd_shu_ju:
 495 0312 0323     		movs r3, # 0x03		@ RS = 1 E = 1
 496 0314 00E0     		b __xie_lcd_shu_ju
 497              	__lcd_ming_ling:
 498 0316 0223     		movs r3, # 0x02		@ RS = 0 E = 1
ARM GAS  1.s 			page 10


 499              	__xie_lcd_shu_ju:
 500 0318 5B19     		adds r3, r3, r5
 501 031a 0146     		mov r1, r0
 502 031c D218     		adds r2, r2, r3
 503 031e 1000     		movs r0, r2
 504 0320 00F00BF8 		bl __74hc595
 505 0324 0238     		subs r0, r0, # 0x02
 506 0326 00F008F8 		bl __74hc595
 507 032a 0846     		mov r0, r1
 508 032c C018     		adds r0, r0, r3
 509 032e 00F004F8 		bl __74hc595
 510 0332 0238     		subs r0, r0, # 0x02
 511 0334 00F001F8 		bl __74hc595
 512 0338 3FBD     		pop {r0-r5,pc}
 513              		
 514              	__74hc595:			@ 入R0=8位
 515 033a FFB5     		push {r0-r7,lr}
 516 033c 2E4E     		ldr r6, = 0x48000000
 517 033e 2025     		movs r5, # 0x20		@ SRCLK
 518 0340 4022     		movs r2, # 0x40		@ RCLK
 519 0342 8023     		movs r3, # 0x80		@ SER
 520 0344 1824     		movs r4, # 24
 521              	__595_yiweixunhuan:
 522 0346 B261     		str r2, [r6, # 0x18]	@ rclk=0
 523 0348 B561     		str r5, [r6, # 0x18]	@ srclk=0
 524 034a FF27     		movs r7, # 0xff
 525              	__595_yanshi:
 526 034c 013F     		subs r7, r7, # 1
 527 034e FDD1     		bne __595_yanshi
 528 0350 0146     		mov r1, r0
 529 0352 A140     		lsls r1, r1, r4
 530 0354 01D5     		bpl __ser_0
 531              	__ser_1:
 532 0356 B362     		str r3, [r6, # 0x28]	@ ser=1
 533 0358 00E0     		b __595_yiwei
 534              	__ser_0:
 535 035a B361     		str r3, [r6, # 0x18]	@ ser=0
 536              	__595_yiwei:
 537 035c B562     		str r5, [r6, # 0x28]
 538 035e FF27     		movs r7, # 0xff
 539              	__595_yanshi1:
 540 0360 013F     		subs r7, r7, # 1
 541 0362 FDD1     		bne __595_yanshi1
 542 0364 0134     		adds r4, r4, # 1
 543 0366 202C     		cmp r4, # 32
 544 0368 EDD1     		bne __595_yiweixunhuan
 545 036a B262     		str r2, [r6, # 0x28]	@ rclk=1
 546 036c FF27     		movs r7, # 0xff
 547              	__595_yanshi2:
 548 036e 013F     		subs r7, r7, # 1
 549 0370 FDD1     		bne __595_yanshi2
 550 0372 B261     		str r2, [r6, # 0x18]	@ rclk = 0
 551 0374 FFBD     		pop {r0-r7,pc}
 552              	
 553              	
 554              	
 555              	_zhuanascii:					@ 16进制转ASCII
ARM GAS  1.s 			page 11


 556              			@ R0要转的数据， R1长度，R2结果表首地址, r3=小数点位置
 557 0376 FFB5     		push {r0-r7,lr}
 558 0378 1F46     		mov r7, r3
 559 037a 0546     		mov r5, r0
 560 037c 0E46     		mov r6, r1
 561 037e 0A21     		movs r1, # 10
 562              	_xunhuanqiuma:
 563 0380 00F012F8 		bl _chufa
 564 0384 0446     		mov r4, r0
 565 0386 4C43     		muls r4, r1
 566 0388 2B1B     		subs r3, r5, r4
 567 038a 3033     		adds r3, r3, # 0x30
 568 038c 0546     		mov r5, r0
 569 038e 013E     		subs r6, r6, # 1
 570 0390 08D0     		beq _qiumafanhui
 571 0392 BE42     		cmp r6, r7
 572 0394 02D1     		bne _meidaoxiaoshudian
 573 0396 2E24     		movs r4, # 0x2e		@小数点
 574 0398 9455     		strb r4, [r2,r6]	@插入小数点
 575 039a 013E     		subs r6, r6, # 1
 576              	_meidaoxiaoshudian:
 577 039c 9355     		strb r3, [r2,r6]
 578 039e 3600     		movs r6, r6
 579 03a0 EED1     		bne _xunhuanqiuma
 580 03a2 FFBD     		pop {r0-r7,pc}
 581              	_qiumafanhui:
 582 03a4 9355     		strb r3, [r2, r6]
 583 03a6 FFBD     		pop {r0-r7,pc}
 584              	
 585              		
 586              	_chufa:				@软件除法
 587              		@ r0 除以 r1 等于 商(r0)余数R1
 588 03a8 1EB5     		push {r1-r4,lr}
 589 03aa 0028     		cmp r0, # 0
 590 03ac 0ED0     		beq _chufafanhui
 591 03ae 0029     		cmp r1, # 0
 592 03b0 0CD0     		beq _chufafanhui
 593 03b2 0246     		mov r2, r0
 594 03b4 0123     		movs r3, # 1
 595 03b6 DB07     		lsls r3, r3, # 31
 596 03b8 0020     		movs r0, # 0
 597 03ba 0446     		mov r4, r0
 598              	_chufaxunhuan:
 599 03bc 5200     		lsls r2, r2, # 1
 600 03be 6441     		adcs r4, r4, r4
 601 03c0 8C42     		cmp r4, r1
 602 03c2 01D3     		bcc _chufaweishubudao0
 603 03c4 C018     		adds r0, r0, r3
 604 03c6 641A     		subs r4, r4, r1
 605              	_chufaweishubudao0:
 606 03c8 5B08     		lsrs r3, r3, # 1
 607 03ca F7D1     		bne _chufaxunhuan
 608              	_chufafanhui:
 609 03cc 1EBD     		pop {r1-r4,pc}
 610 03ce 0000FFFF 		.ltorg
 610      00000020 
 610      02400010 
ARM GAS  1.s 			page 12


 610      02400100 
 610      01000200 
 611              	
 612              	
 613              	_nmi_handler:
 614 0490 7047     		bx lr
 615              	_hard_fault:
 616 0492 7047     		bx lr
 617              	_svc_handler:
 618 0494 7047     		bx lr
 619              	_pendsv_handler:
 620 0496 7047     		bx lr
 621              	_systickzhongduan:
 622 0498 034A     		ldr r2, = jishu
 623 049a 0448     		ldr r0, = 0xe0000d04
 624 049c 1368     		ldr r3, [r2]
 625 049e 0449     		ldr r1, = 0x02000000
 626 04a0 0133     		adds r3, r3, # 1
 627 04a2 1360     		str r3, [r2]
 628 04a4 0160     		str r1, [r0]                 @ 清除SYSTICK中断
 629              	aaa:
 630 04a6 70473400 		bx lr
 630      0020040D 
 630      00E00000 
 630      0002
ARM GAS  1.s 			page 13


DEFINED SYMBOLS
                 1.s:9      .data:0000000000000000 zheng_xian_biao
                 1.s:11     .data:00000000000000ca lcdshuju
                 1.s:13     .data:00000000000000da dianhua
                 1.s:15     .data:00000000000000ea qq
                 1.s:17     .data:00000000000000fa xushu
                 1.s:19     .data:00000000000000fb fu
                 1.s:21     .data:00000000000000fc zheng
                 1.s:23     .data:00000000000000fd xiaomai
                 1.s:25     *ABS*:0000000020001000 STACKINIT
                 1.s:26     *ABS*:0000000020000000 asciimabiao
                 1.s:27     *ABS*:0000000020000030 liangcheng
                 1.s:28     *ABS*:0000000020000034 jishu
                 1.s:29     *ABS*:0000000020000038 jianbo
                 1.s:30     *ABS*:0000000020000040 dianyabiao
                 1.s:31     *ABS*:0000000020000200 lvboqizhizhen
                 1.s:32     *ABS*:0000000020000204 lvboqihuanchong
                 1.s:33     *ABS*:0000000020000410 lvboqizhizhen1
                 1.s:34     *ABS*:0000000020000414 lvboqihuanchong1
                 1.s:35     *ABS*:0000000020000620 lvboqizhizhen2
                 1.s:36     *ABS*:0000000020000624 lvboqihuanchong2
                 1.s:37     *ABS*:0000000020000830 lvboqizhizhen3
                 1.s:38     *ABS*:0000000020000834 lvboqihuanchong3
                 1.s:41     .text:0000000000000000 vectors
                 1.s:88     .text:00000000000000b0 _start
                 1.s:613    .text:0000000000000490 _nmi_handler
                 1.s:615    .text:0000000000000492 _hard_fault
                 1.s:617    .text:0000000000000494 _svc_handler
                 1.s:619    .text:0000000000000496 _pendsv_handler
                 1.s:621    .text:0000000000000498 _systickzhongduan
                 1.s:629    .text:00000000000004a6 aaa
                            .text:0000000000000000 $d
                 1.s:86     .text:00000000000000b0 $t
                 1.s:90     .text:00000000000000b2 yanshi111
                 1.s:94     .text:00000000000000b6 shizhong
                 1.s:101    .text:00000000000000c2 denghse
                 1.s:105    .text:00000000000000c8 dengpllguan
                 1.s:113    .text:00000000000000d6 dengpll
                 1.s:120    .text:00000000000000e0 dengdai14mshizhongwending
                 1.s:125    .text:00000000000000e6 _neicunqingling
                 1.s:129    .text:00000000000000ec _neicunqinglingxunhuan
                 1.s:134    .text:00000000000000f2 _waisheshizhong
                 1.s:152    .text:0000000000000100 _waishezhongduan
                 1.s:167    .text:0000000000000100 io_she_zhi
                 1.s:199    .text:000000000000010a dmachushihua
                 1.s:231    .text:000000000000012e tim1chushiha
                 1.s:254    .text:0000000000000158 _adcchushihua
                 1.s:258    .text:000000000000015e _dengadcjiaozhun
                 1.s:262    .text:0000000000000164 _kaiadc
                 1.s:267    .text:000000000000016c _dengdaiadcwending
                 1.s:271    .text:0000000000000172 _tongdaoxuanze
                 1.s:283    .text:0000000000000186 _lcdchushihua
                 1.s:483    .text:00000000000002fe _xielcd
                 1.s:475    .text:00000000000002f4 _lcdyanshi
                 1.s:458    .text:00000000000002d8 _lcdxianshi
                 1.s:323    .text:00000000000001e0 ting
                 1.s:390    .text:000000000000026c _jianbo
ARM GAS  1.s 			page 14


                 1.s:428    .text:00000000000002b0 _lvboqi
                 1.s:555    .text:0000000000000376 _zhuanascii
                 1.s:421    .text:00000000000002a6 _jianboyanshi
                 1.s:424    .text:00000000000002aa _jianboyanshixunhuan
                 1.s:440    .text:00000000000002c0 _lvboqimeidaohuanchongquding
                 1.s:443    .text:00000000000002c4 _lvboqixunhuan
                 1.s:447    .text:00000000000002ca _lvbozonghe
                 1.s:467    .text:00000000000002e6 _lcdxianshixunhuan
                 1.s:478    .text:00000000000002f8 _lcdyanshixunhuan
                 1.s:497    .text:0000000000000316 __lcd_ming_ling
                 1.s:494    .text:0000000000000312 __lcd_shu_ju
                 1.s:499    .text:0000000000000318 __xie_lcd_shu_ju
                 1.s:514    .text:000000000000033a __74hc595
                 1.s:521    .text:0000000000000346 __595_yiweixunhuan
                 1.s:525    .text:000000000000034c __595_yanshi
                 1.s:534    .text:000000000000035a __ser_0
                 1.s:531    .text:0000000000000356 __ser_1
                 1.s:536    .text:000000000000035c __595_yiwei
                 1.s:539    .text:0000000000000360 __595_yanshi1
                 1.s:547    .text:000000000000036e __595_yanshi2
                 1.s:562    .text:0000000000000380 _xunhuanqiuma
                 1.s:586    .text:00000000000003a8 _chufa
                 1.s:581    .text:00000000000003a4 _qiumafanhui
                 1.s:576    .text:000000000000039c _meidaoxiaoshudian
                 1.s:608    .text:00000000000003cc _chufafanhui
                 1.s:598    .text:00000000000003bc _chufaxunhuan
                 1.s:605    .text:00000000000003c8 _chufaweishubudao0
                 1.s:610    .text:00000000000003ce $d
                 1.s:610    .text:00000000000003d0 $d
                 1.s:614    .text:0000000000000490 $t
                 1.s:630    .text:00000000000004a8 $d

NO UNDEFINED SYMBOLS
